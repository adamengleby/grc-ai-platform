var Hb=Object.defineProperty;var zb=(e,t,n)=>t in e?Hb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var _e=(e,t,n)=>zb(e,typeof t!="symbol"?t+"":t,n);function $b(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(r,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var Xl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Oo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var P0={exports:{}},Do={},M0={exports:{}},Te={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yi=Symbol.for("react.element"),qb=Symbol.for("react.portal"),Vb=Symbol.for("react.fragment"),Yb=Symbol.for("react.strict_mode"),Wb=Symbol.for("react.profiler"),Kb=Symbol.for("react.provider"),Gb=Symbol.for("react.context"),Qb=Symbol.for("react.forward_ref"),Xb=Symbol.for("react.suspense"),Jb=Symbol.for("react.memo"),Zb=Symbol.for("react.lazy"),Rm=Symbol.iterator;function ev(e){return e===null||typeof e!="object"?null:(e=Rm&&e[Rm]||e["@@iterator"],typeof e=="function"?e:null)}var O0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D0=Object.assign,F0={};function pa(e,t,n){this.props=e,this.context=t,this.refs=F0,this.updater=n||O0}pa.prototype.isReactComponent={};pa.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};pa.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function B0(){}B0.prototype=pa.prototype;function Gd(e,t,n){this.props=e,this.context=t,this.refs=F0,this.updater=n||O0}var Qd=Gd.prototype=new B0;Qd.constructor=Gd;D0(Qd,pa.prototype);Qd.isPureReactComponent=!0;var Pm=Array.isArray,U0=Object.prototype.hasOwnProperty,Xd={current:null},H0={key:!0,ref:!0,__self:!0,__source:!0};function z0(e,t,n){var r,a={},i=null,l=null;if(t!=null)for(r in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)U0.call(t,r)&&!H0.hasOwnProperty(r)&&(a[r]=t[r]);var o=arguments.length-2;if(o===1)a.children=n;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)a[r]===void 0&&(a[r]=o[r]);return{$$typeof:Yi,type:e,key:i,ref:l,props:a,_owner:Xd.current}}function tv(e,t){return{$$typeof:Yi,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Jd(e){return typeof e=="object"&&e!==null&&e.$$typeof===Yi}function nv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Mm=/\/+/g;function Ec(e,t){return typeof e=="object"&&e!==null&&e.key!=null?nv(""+e.key):t.toString(36)}function _l(e,t,n,r,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Yi:case qb:l=!0}}if(l)return l=e,a=a(l),e=r===""?"."+Ec(l,0):r,Pm(a)?(n="",e!=null&&(n=e.replace(Mm,"$&/")+"/"),_l(a,t,n,"",function(u){return u})):a!=null&&(Jd(a)&&(a=tv(a,n+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(Mm,"$&/")+"/")+e)),t.push(a)),1;if(l=0,r=r===""?".":r+":",Pm(e))for(var o=0;o<e.length;o++){i=e[o];var c=r+Ec(i,o);l+=_l(i,t,n,c,a)}else if(c=ev(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=r+Ec(i,o++),l+=_l(i,t,n,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function al(e,t,n){if(e==null)return e;var r=[],a=0;return _l(e,r,"","",function(i){return t.call(n,i,a++)}),r}function rv(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var It={current:null},Il={transition:null},sv={ReactCurrentDispatcher:It,ReactCurrentBatchConfig:Il,ReactCurrentOwner:Xd};function $0(){throw Error("act(...) is not supported in production builds of React.")}Te.Children={map:al,forEach:function(e,t,n){al(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return al(e,function(){t++}),t},toArray:function(e){return al(e,function(t){return t})||[]},only:function(e){if(!Jd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Te.Component=pa;Te.Fragment=Vb;Te.Profiler=Wb;Te.PureComponent=Gd;Te.StrictMode=Yb;Te.Suspense=Xb;Te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sv;Te.act=$0;Te.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=D0({},e.props),a=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=Xd.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)U0.call(t,c)&&!H0.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];r.children=o}return{$$typeof:Yi,type:e.type,key:a,ref:i,props:r,_owner:l}};Te.createContext=function(e){return e={$$typeof:Gb,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Kb,_context:e},e.Consumer=e};Te.createElement=z0;Te.createFactory=function(e){var t=z0.bind(null,e);return t.type=e,t};Te.createRef=function(){return{current:null}};Te.forwardRef=function(e){return{$$typeof:Qb,render:e}};Te.isValidElement=Jd;Te.lazy=function(e){return{$$typeof:Zb,_payload:{_status:-1,_result:e},_init:rv}};Te.memo=function(e,t){return{$$typeof:Jb,type:e,compare:t===void 0?null:t}};Te.startTransition=function(e){var t=Il.transition;Il.transition={};try{e()}finally{Il.transition=t}};Te.unstable_act=$0;Te.useCallback=function(e,t){return It.current.useCallback(e,t)};Te.useContext=function(e){return It.current.useContext(e)};Te.useDebugValue=function(){};Te.useDeferredValue=function(e){return It.current.useDeferredValue(e)};Te.useEffect=function(e,t){return It.current.useEffect(e,t)};Te.useId=function(){return It.current.useId()};Te.useImperativeHandle=function(e,t,n){return It.current.useImperativeHandle(e,t,n)};Te.useInsertionEffect=function(e,t){return It.current.useInsertionEffect(e,t)};Te.useLayoutEffect=function(e,t){return It.current.useLayoutEffect(e,t)};Te.useMemo=function(e,t){return It.current.useMemo(e,t)};Te.useReducer=function(e,t,n){return It.current.useReducer(e,t,n)};Te.useRef=function(e){return It.current.useRef(e)};Te.useState=function(e){return It.current.useState(e)};Te.useSyncExternalStore=function(e,t,n){return It.current.useSyncExternalStore(e,t,n)};Te.useTransition=function(){return It.current.useTransition()};Te.version="18.3.1";M0.exports=Te;var S=M0.exports;const Wi=Oo(S),av=$b({__proto__:null,default:Wi},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iv=S,lv=Symbol.for("react.element"),ov=Symbol.for("react.fragment"),cv=Object.prototype.hasOwnProperty,uv=iv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dv={key:!0,ref:!0,__self:!0,__source:!0};function q0(e,t,n){var r,a={},i=null,l=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(r in t)cv.call(t,r)&&!dv.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:lv,type:e,key:i,ref:l,props:a,_owner:uv.current}}Do.Fragment=ov;Do.jsx=q0;Do.jsxs=q0;P0.exports=Do;var s=P0.exports,Nu={},V0={exports:{}},tn={},Y0={exports:{}},W0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(B,W){var k=B.length;B.push(W);e:for(;0<k;){var le=k-1>>>1,xe=B[le];if(0<a(xe,W))B[le]=W,B[k]=xe,k=le;else break e}}function n(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var W=B[0],k=B.pop();if(k!==W){B[0]=k;e:for(var le=0,xe=B.length,_=xe>>>1;le<_;){var ce=2*(le+1)-1,qe=B[ce],we=ce+1,Rt=B[we];if(0>a(qe,k))we<xe&&0>a(Rt,qe)?(B[le]=Rt,B[we]=k,le=we):(B[le]=qe,B[ce]=k,le=ce);else if(we<xe&&0>a(Rt,k))B[le]=Rt,B[we]=k,le=we;else break e}}return W}function a(B,W){var k=B.sortIndex-W.sortIndex;return k!==0?k:B.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var c=[],u=[],m=1,d=null,p=3,f=!1,g=!1,v=!1,T=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(B){for(var W=n(u);W!==null;){if(W.callback===null)r(u);else if(W.startTime<=B)r(u),W.sortIndex=W.expirationTime,t(c,W);else break;W=n(u)}}function I(B){if(v=!1,x(B),!g)if(n(c)!==null)g=!0,P(C);else{var W=n(u);W!==null&&q(I,W.startTime-B)}}function C(B,W){g=!1,v&&(v=!1,y(O),O=-1),f=!0;var k=p;try{for(x(W),d=n(c);d!==null&&(!(d.expirationTime>W)||B&&!z());){var le=d.callback;if(typeof le=="function"){d.callback=null,p=d.priorityLevel;var xe=le(d.expirationTime<=W);W=e.unstable_now(),typeof xe=="function"?d.callback=xe:d===n(c)&&r(c),x(W)}else r(c);d=n(c)}if(d!==null)var _=!0;else{var ce=n(u);ce!==null&&q(I,ce.startTime-W),_=!1}return _}finally{d=null,p=k,f=!1}}var E=!1,N=null,O=-1,D=5,A=-1;function z(){return!(e.unstable_now()-A<D)}function M(){if(N!==null){var B=e.unstable_now();A=B;var W=!0;try{W=N(!0,B)}finally{W?R():(E=!1,N=null)}}else E=!1}var R;if(typeof b=="function")R=function(){b(M)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,Y=H.port2;H.port1.onmessage=M,R=function(){Y.postMessage(null)}}else R=function(){T(M,0)};function P(B){N=B,E||(E=!0,R())}function q(B,W){O=T(function(){B(e.unstable_now())},W)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(B){B.callback=null},e.unstable_continueExecution=function(){g||f||(g=!0,P(C))},e.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<B?Math.floor(1e3/B):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(B){switch(p){case 1:case 2:case 3:var W=3;break;default:W=p}var k=p;p=W;try{return B()}finally{p=k}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(B,W){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var k=p;p=B;try{return W()}finally{p=k}},e.unstable_scheduleCallback=function(B,W,k){var le=e.unstable_now();switch(typeof k=="object"&&k!==null?(k=k.delay,k=typeof k=="number"&&0<k?le+k:le):k=le,B){case 1:var xe=-1;break;case 2:xe=250;break;case 5:xe=1073741823;break;case 4:xe=1e4;break;default:xe=5e3}return xe=k+xe,B={id:m++,callback:W,priorityLevel:B,startTime:k,expirationTime:xe,sortIndex:-1},k>le?(B.sortIndex=k,t(u,B),n(c)===null&&B===n(u)&&(v?(y(O),O=-1):v=!0,q(I,k-le))):(B.sortIndex=xe,t(c,B),g||f||(g=!0,P(C))),B},e.unstable_shouldYield=z,e.unstable_wrapCallback=function(B){var W=p;return function(){var k=p;p=W;try{return B.apply(this,arguments)}finally{p=k}}}})(W0);Y0.exports=W0;var hv=Y0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mv=S,en=hv;function Z(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var K0=new Set,bi={};function Ss(e,t){ra(e,t),ra(e+"Capture",t)}function ra(e,t){for(bi[e]=t,e=0;e<t.length;e++)K0.add(t[e])}var tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tu=Object.prototype.hasOwnProperty,fv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Om={},Dm={};function pv(e){return Tu.call(Dm,e)?!0:Tu.call(Om,e)?!1:fv.test(e)?Dm[e]=!0:(Om[e]=!0,!1)}function gv(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function xv(e,t,n,r){if(t===null||typeof t>"u"||gv(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Lt(e,t,n,r,a,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var pt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){pt[e]=new Lt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];pt[t]=new Lt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){pt[e]=new Lt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){pt[e]=new Lt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){pt[e]=new Lt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){pt[e]=new Lt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){pt[e]=new Lt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){pt[e]=new Lt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){pt[e]=new Lt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Zd=/[\-:]([a-z])/g;function eh(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Zd,eh);pt[t]=new Lt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Zd,eh);pt[t]=new Lt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Zd,eh);pt[t]=new Lt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){pt[e]=new Lt(e,1,!1,e.toLowerCase(),null,!1,!1)});pt.xlinkHref=new Lt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){pt[e]=new Lt(e,1,!1,e.toLowerCase(),null,!0,!0)});function th(e,t,n,r){var a=pt.hasOwnProperty(t)?pt[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(xv(t,n,a,r)&&(n=null),r||a===null?pv(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ir=mv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,il=Symbol.for("react.element"),Ms=Symbol.for("react.portal"),Os=Symbol.for("react.fragment"),nh=Symbol.for("react.strict_mode"),wu=Symbol.for("react.profiler"),G0=Symbol.for("react.provider"),Q0=Symbol.for("react.context"),rh=Symbol.for("react.forward_ref"),Su=Symbol.for("react.suspense"),Cu=Symbol.for("react.suspense_list"),sh=Symbol.for("react.memo"),gr=Symbol.for("react.lazy"),X0=Symbol.for("react.offscreen"),Fm=Symbol.iterator;function La(e){return e===null||typeof e!="object"?null:(e=Fm&&e[Fm]||e["@@iterator"],typeof e=="function"?e:null)}var Ke=Object.assign,Nc;function Qa(e){if(Nc===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Nc=t&&t[1]||""}return`
`+Nc+e}var Tc=!1;function wc(e,t){if(!e||Tc)return"";Tc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=r.stack.split(`
`),l=a.length-1,o=i.length-1;1<=l&&0<=o&&a[l]!==i[o];)o--;for(;1<=l&&0<=o;l--,o--)if(a[l]!==i[o]){if(l!==1||o!==1)do if(l--,o--,0>o||a[l]!==i[o]){var c=`
`+a[l].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=l&&0<=o);break}}}finally{Tc=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Qa(e):""}function yv(e){switch(e.tag){case 5:return Qa(e.type);case 16:return Qa("Lazy");case 13:return Qa("Suspense");case 19:return Qa("SuspenseList");case 0:case 2:case 15:return e=wc(e.type,!1),e;case 11:return e=wc(e.type.render,!1),e;case 1:return e=wc(e.type,!0),e;default:return""}}function ku(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Os:return"Fragment";case Ms:return"Portal";case wu:return"Profiler";case nh:return"StrictMode";case Su:return"Suspense";case Cu:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Q0:return(e.displayName||"Context")+".Consumer";case G0:return(e._context.displayName||"Context")+".Provider";case rh:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case sh:return t=e.displayName||null,t!==null?t:ku(e.type)||"Memo";case gr:t=e._payload,e=e._init;try{return ku(e(t))}catch{}}return null}function bv(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ku(t);case 8:return t===nh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Dr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function J0(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function vv(e){var t=J0(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(l){r=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ll(e){e._valueTracker||(e._valueTracker=vv(e))}function Z0(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=J0(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Jl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ju(e,t){var n=t.checked;return Ke({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Bm(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Dr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function eg(e,t){t=t.checked,t!=null&&th(e,"checked",t,!1)}function Au(e,t){eg(e,t);var n=Dr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?_u(e,t.type,n):t.hasOwnProperty("defaultValue")&&_u(e,t.type,Dr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Um(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function _u(e,t,n){(t!=="number"||Jl(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Xa=Array.isArray;function Gs(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Dr(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Iu(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Z(91));return Ke({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Hm(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Z(92));if(Xa(n)){if(1<n.length)throw Error(Z(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Dr(n)}}function tg(e,t){var n=Dr(t.value),r=Dr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function zm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ng(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lu(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ng(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ol,rg=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ol=ol||document.createElement("div"),ol.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ol.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function vi(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ni={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ev=["Webkit","ms","Moz","O"];Object.keys(ni).forEach(function(e){Ev.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ni[t]=ni[e]})});function sg(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ni.hasOwnProperty(e)&&ni[e]?(""+t).trim():t+"px"}function ag(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=sg(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var Nv=Ke({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ru(e,t){if(t){if(Nv[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Z(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Z(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Z(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Z(62))}}function Pu(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mu=null;function ah(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ou=null,Qs=null,Xs=null;function $m(e){if(e=Qi(e)){if(typeof Ou!="function")throw Error(Z(280));var t=e.stateNode;t&&(t=zo(t),Ou(e.stateNode,e.type,t))}}function ig(e){Qs?Xs?Xs.push(e):Xs=[e]:Qs=e}function lg(){if(Qs){var e=Qs,t=Xs;if(Xs=Qs=null,$m(e),t)for(e=0;e<t.length;e++)$m(t[e])}}function og(e,t){return e(t)}function cg(){}var Sc=!1;function ug(e,t,n){if(Sc)return e(t,n);Sc=!0;try{return og(e,t,n)}finally{Sc=!1,(Qs!==null||Xs!==null)&&(cg(),lg())}}function Ei(e,t){var n=e.stateNode;if(n===null)return null;var r=zo(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Z(231,t,typeof n));return n}var Du=!1;if(tr)try{var Ra={};Object.defineProperty(Ra,"passive",{get:function(){Du=!0}}),window.addEventListener("test",Ra,Ra),window.removeEventListener("test",Ra,Ra)}catch{Du=!1}function Tv(e,t,n,r,a,i,l,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(m){this.onError(m)}}var ri=!1,Zl=null,eo=!1,Fu=null,wv={onError:function(e){ri=!0,Zl=e}};function Sv(e,t,n,r,a,i,l,o,c){ri=!1,Zl=null,Tv.apply(wv,arguments)}function Cv(e,t,n,r,a,i,l,o,c){if(Sv.apply(this,arguments),ri){if(ri){var u=Zl;ri=!1,Zl=null}else throw Error(Z(198));eo||(eo=!0,Fu=u)}}function Cs(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function dg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function qm(e){if(Cs(e)!==e)throw Error(Z(188))}function kv(e){var t=e.alternate;if(!t){if(t=Cs(e),t===null)throw Error(Z(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return qm(a),e;if(i===r)return qm(a),t;i=i.sibling}throw Error(Z(188))}if(n.return!==r.return)n=a,r=i;else{for(var l=!1,o=a.child;o;){if(o===n){l=!0,n=a,r=i;break}if(o===r){l=!0,r=a,n=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===n){l=!0,n=i,r=a;break}if(o===r){l=!0,r=i,n=a;break}o=o.sibling}if(!l)throw Error(Z(189))}}if(n.alternate!==r)throw Error(Z(190))}if(n.tag!==3)throw Error(Z(188));return n.stateNode.current===n?e:t}function hg(e){return e=kv(e),e!==null?mg(e):null}function mg(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=mg(e);if(t!==null)return t;e=e.sibling}return null}var fg=en.unstable_scheduleCallback,Vm=en.unstable_cancelCallback,jv=en.unstable_shouldYield,Av=en.unstable_requestPaint,Qe=en.unstable_now,_v=en.unstable_getCurrentPriorityLevel,ih=en.unstable_ImmediatePriority,pg=en.unstable_UserBlockingPriority,to=en.unstable_NormalPriority,Iv=en.unstable_LowPriority,gg=en.unstable_IdlePriority,Fo=null,Bn=null;function Lv(e){if(Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(Fo,e,void 0,(e.current.flags&128)===128)}catch{}}var kn=Math.clz32?Math.clz32:Mv,Rv=Math.log,Pv=Math.LN2;function Mv(e){return e>>>=0,e===0?32:31-(Rv(e)/Pv|0)|0}var cl=64,ul=4194304;function Ja(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function no(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,l=n&268435455;if(l!==0){var o=l&~a;o!==0?r=Ja(o):(i&=l,i!==0&&(r=Ja(i)))}else l=n&~a,l!==0?r=Ja(l):i!==0&&(r=Ja(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-kn(t),a=1<<n,r|=e[n],t&=~a;return r}function Ov(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Dv(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-kn(i),o=1<<l,c=a[l];c===-1?(!(o&n)||o&r)&&(a[l]=Ov(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}function Bu(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function xg(){var e=cl;return cl<<=1,!(cl&4194240)&&(cl=64),e}function Cc(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ki(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-kn(t),e[t]=n}function Fv(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-kn(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}function lh(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-kn(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var Re=0;function yg(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var bg,oh,vg,Eg,Ng,Uu=!1,dl=[],Cr=null,kr=null,jr=null,Ni=new Map,Ti=new Map,yr=[],Bv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ym(e,t){switch(e){case"focusin":case"focusout":Cr=null;break;case"dragenter":case"dragleave":kr=null;break;case"mouseover":case"mouseout":jr=null;break;case"pointerover":case"pointerout":Ni.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ti.delete(t.pointerId)}}function Pa(e,t,n,r,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Qi(t),t!==null&&oh(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Uv(e,t,n,r,a){switch(t){case"focusin":return Cr=Pa(Cr,e,t,n,r,a),!0;case"dragenter":return kr=Pa(kr,e,t,n,r,a),!0;case"mouseover":return jr=Pa(jr,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Ni.set(i,Pa(Ni.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Ti.set(i,Pa(Ti.get(i)||null,e,t,n,r,a)),!0}return!1}function Tg(e){var t=ls(e.target);if(t!==null){var n=Cs(t);if(n!==null){if(t=n.tag,t===13){if(t=dg(n),t!==null){e.blockedOn=t,Ng(e.priority,function(){vg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ll(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Hu(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Mu=r,n.target.dispatchEvent(r),Mu=null}else return t=Qi(n),t!==null&&oh(t),e.blockedOn=n,!1;t.shift()}return!0}function Wm(e,t,n){Ll(e)&&n.delete(t)}function Hv(){Uu=!1,Cr!==null&&Ll(Cr)&&(Cr=null),kr!==null&&Ll(kr)&&(kr=null),jr!==null&&Ll(jr)&&(jr=null),Ni.forEach(Wm),Ti.forEach(Wm)}function Ma(e,t){e.blockedOn===t&&(e.blockedOn=null,Uu||(Uu=!0,en.unstable_scheduleCallback(en.unstable_NormalPriority,Hv)))}function wi(e){function t(a){return Ma(a,e)}if(0<dl.length){Ma(dl[0],e);for(var n=1;n<dl.length;n++){var r=dl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Cr!==null&&Ma(Cr,e),kr!==null&&Ma(kr,e),jr!==null&&Ma(jr,e),Ni.forEach(t),Ti.forEach(t),n=0;n<yr.length;n++)r=yr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<yr.length&&(n=yr[0],n.blockedOn===null);)Tg(n),n.blockedOn===null&&yr.shift()}var Js=ir.ReactCurrentBatchConfig,ro=!0;function zv(e,t,n,r){var a=Re,i=Js.transition;Js.transition=null;try{Re=1,ch(e,t,n,r)}finally{Re=a,Js.transition=i}}function $v(e,t,n,r){var a=Re,i=Js.transition;Js.transition=null;try{Re=4,ch(e,t,n,r)}finally{Re=a,Js.transition=i}}function ch(e,t,n,r){if(ro){var a=Hu(e,t,n,r);if(a===null)Oc(e,t,r,so,n),Ym(e,r);else if(Uv(a,e,t,n,r))r.stopPropagation();else if(Ym(e,r),t&4&&-1<Bv.indexOf(e)){for(;a!==null;){var i=Qi(a);if(i!==null&&bg(i),i=Hu(e,t,n,r),i===null&&Oc(e,t,r,so,n),i===a)break;a=i}a!==null&&r.stopPropagation()}else Oc(e,t,r,null,n)}}var so=null;function Hu(e,t,n,r){if(so=null,e=ah(r),e=ls(e),e!==null)if(t=Cs(e),t===null)e=null;else if(n=t.tag,n===13){if(e=dg(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return so=e,null}function wg(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_v()){case ih:return 1;case pg:return 4;case to:case Iv:return 16;case gg:return 536870912;default:return 16}default:return 16}}var Er=null,uh=null,Rl=null;function Sg(){if(Rl)return Rl;var e,t=uh,n=t.length,r,a="value"in Er?Er.value:Er.textContent,i=a.length;for(e=0;e<n&&t[e]===a[e];e++);var l=n-e;for(r=1;r<=l&&t[n-r]===a[i-r];r++);return Rl=a.slice(e,1<r?1-r:void 0)}function Pl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function hl(){return!0}function Km(){return!1}function nn(e){function t(n,r,a,i,l){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?hl:Km,this.isPropagationStopped=Km,this}return Ke(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=hl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=hl)},persist:function(){},isPersistent:hl}),t}var ga={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dh=nn(ga),Gi=Ke({},ga,{view:0,detail:0}),qv=nn(Gi),kc,jc,Oa,Bo=Ke({},Gi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hh,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Oa&&(Oa&&e.type==="mousemove"?(kc=e.screenX-Oa.screenX,jc=e.screenY-Oa.screenY):jc=kc=0,Oa=e),kc)},movementY:function(e){return"movementY"in e?e.movementY:jc}}),Gm=nn(Bo),Vv=Ke({},Bo,{dataTransfer:0}),Yv=nn(Vv),Wv=Ke({},Gi,{relatedTarget:0}),Ac=nn(Wv),Kv=Ke({},ga,{animationName:0,elapsedTime:0,pseudoElement:0}),Gv=nn(Kv),Qv=Ke({},ga,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Xv=nn(Qv),Jv=Ke({},ga,{data:0}),Qm=nn(Jv),Zv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nE(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=tE[e])?!!t[e]:!1}function hh(){return nE}var rE=Ke({},Gi,{key:function(e){if(e.key){var t=Zv[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Pl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?eE[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hh,charCode:function(e){return e.type==="keypress"?Pl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Pl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),sE=nn(rE),aE=Ke({},Bo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xm=nn(aE),iE=Ke({},Gi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hh}),lE=nn(iE),oE=Ke({},ga,{propertyName:0,elapsedTime:0,pseudoElement:0}),cE=nn(oE),uE=Ke({},Bo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),dE=nn(uE),hE=[9,13,27,32],mh=tr&&"CompositionEvent"in window,si=null;tr&&"documentMode"in document&&(si=document.documentMode);var mE=tr&&"TextEvent"in window&&!si,Cg=tr&&(!mh||si&&8<si&&11>=si),Jm=" ",Zm=!1;function kg(e,t){switch(e){case"keyup":return hE.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ds=!1;function fE(e,t){switch(e){case"compositionend":return jg(t);case"keypress":return t.which!==32?null:(Zm=!0,Jm);case"textInput":return e=t.data,e===Jm&&Zm?null:e;default:return null}}function pE(e,t){if(Ds)return e==="compositionend"||!mh&&kg(e,t)?(e=Sg(),Rl=uh=Er=null,Ds=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Cg&&t.locale!=="ko"?null:t.data;default:return null}}var gE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ef(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!gE[e.type]:t==="textarea"}function Ag(e,t,n,r){ig(r),t=ao(t,"onChange"),0<t.length&&(n=new dh("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var ai=null,Si=null;function xE(e){Ug(e,0)}function Uo(e){var t=Us(e);if(Z0(t))return e}function yE(e,t){if(e==="change")return t}var _g=!1;if(tr){var _c;if(tr){var Ic="oninput"in document;if(!Ic){var tf=document.createElement("div");tf.setAttribute("oninput","return;"),Ic=typeof tf.oninput=="function"}_c=Ic}else _c=!1;_g=_c&&(!document.documentMode||9<document.documentMode)}function nf(){ai&&(ai.detachEvent("onpropertychange",Ig),Si=ai=null)}function Ig(e){if(e.propertyName==="value"&&Uo(Si)){var t=[];Ag(t,Si,e,ah(e)),ug(xE,t)}}function bE(e,t,n){e==="focusin"?(nf(),ai=t,Si=n,ai.attachEvent("onpropertychange",Ig)):e==="focusout"&&nf()}function vE(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Uo(Si)}function EE(e,t){if(e==="click")return Uo(t)}function NE(e,t){if(e==="input"||e==="change")return Uo(t)}function TE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _n=typeof Object.is=="function"?Object.is:TE;function Ci(e,t){if(_n(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!Tu.call(t,a)||!_n(e[a],t[a]))return!1}return!0}function rf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function sf(e,t){var n=rf(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=rf(n)}}function Lg(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Lg(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Rg(){for(var e=window,t=Jl();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Jl(e.document)}return t}function fh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function wE(e){var t=Rg(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Lg(n.ownerDocument.documentElement,n)){if(r!==null&&fh(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=r.end===void 0?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=sf(n,i);var l=sf(n,r);a&&l&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var SE=tr&&"documentMode"in document&&11>=document.documentMode,Fs=null,zu=null,ii=null,$u=!1;function af(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;$u||Fs==null||Fs!==Jl(r)||(r=Fs,"selectionStart"in r&&fh(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ii&&Ci(ii,r)||(ii=r,r=ao(zu,"onSelect"),0<r.length&&(t=new dh("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Fs)))}function ml(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Bs={animationend:ml("Animation","AnimationEnd"),animationiteration:ml("Animation","AnimationIteration"),animationstart:ml("Animation","AnimationStart"),transitionend:ml("Transition","TransitionEnd")},Lc={},Pg={};tr&&(Pg=document.createElement("div").style,"AnimationEvent"in window||(delete Bs.animationend.animation,delete Bs.animationiteration.animation,delete Bs.animationstart.animation),"TransitionEvent"in window||delete Bs.transitionend.transition);function Ho(e){if(Lc[e])return Lc[e];if(!Bs[e])return e;var t=Bs[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Pg)return Lc[e]=t[n];return e}var Mg=Ho("animationend"),Og=Ho("animationiteration"),Dg=Ho("animationstart"),Fg=Ho("transitionend"),Bg=new Map,lf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zr(e,t){Bg.set(e,t),Ss(t,[e])}for(var Rc=0;Rc<lf.length;Rc++){var Pc=lf[Rc],CE=Pc.toLowerCase(),kE=Pc[0].toUpperCase()+Pc.slice(1);zr(CE,"on"+kE)}zr(Mg,"onAnimationEnd");zr(Og,"onAnimationIteration");zr(Dg,"onAnimationStart");zr("dblclick","onDoubleClick");zr("focusin","onFocus");zr("focusout","onBlur");zr(Fg,"onTransitionEnd");ra("onMouseEnter",["mouseout","mouseover"]);ra("onMouseLeave",["mouseout","mouseover"]);ra("onPointerEnter",["pointerout","pointerover"]);ra("onPointerLeave",["pointerout","pointerover"]);Ss("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ss("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ss("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ss("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ss("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ss("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Za="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jE=new Set("cancel close invalid load scroll toggle".split(" ").concat(Za));function of(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Cv(r,t,void 0,e),e.currentTarget=null}function Ug(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var l=r.length-1;0<=l;l--){var o=r[l],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==i&&a.isPropagationStopped())break e;of(a,o,u),i=c}else for(l=0;l<r.length;l++){if(o=r[l],c=o.instance,u=o.currentTarget,o=o.listener,c!==i&&a.isPropagationStopped())break e;of(a,o,u),i=c}}}if(eo)throw e=Fu,eo=!1,Fu=null,e}function Be(e,t){var n=t[Ku];n===void 0&&(n=t[Ku]=new Set);var r=e+"__bubble";n.has(r)||(Hg(t,e,2,!1),n.add(r))}function Mc(e,t,n){var r=0;t&&(r|=4),Hg(n,e,r,t)}var fl="_reactListening"+Math.random().toString(36).slice(2);function ki(e){if(!e[fl]){e[fl]=!0,K0.forEach(function(n){n!=="selectionchange"&&(jE.has(n)||Mc(n,!1,e),Mc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[fl]||(t[fl]=!0,Mc("selectionchange",!1,t))}}function Hg(e,t,n,r){switch(wg(t)){case 1:var a=zv;break;case 4:a=$v;break;default:a=ch}n=a.bind(null,t,n,e),a=void 0,!Du||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Oc(e,t,n,r,a){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var o=r.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(l===4)for(l=r.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;l=l.return}for(;o!==null;){if(l=ls(o),l===null)return;if(c=l.tag,c===5||c===6){r=i=l;continue e}o=o.parentNode}}r=r.return}ug(function(){var u=i,m=ah(n),d=[];e:{var p=Bg.get(e);if(p!==void 0){var f=dh,g=e;switch(e){case"keypress":if(Pl(n)===0)break e;case"keydown":case"keyup":f=sE;break;case"focusin":g="focus",f=Ac;break;case"focusout":g="blur",f=Ac;break;case"beforeblur":case"afterblur":f=Ac;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Gm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=Yv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=lE;break;case Mg:case Og:case Dg:f=Gv;break;case Fg:f=cE;break;case"scroll":f=qv;break;case"wheel":f=dE;break;case"copy":case"cut":case"paste":f=Xv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=Xm}var v=(t&4)!==0,T=!v&&e==="scroll",y=v?p!==null?p+"Capture":null:p;v=[];for(var b=u,x;b!==null;){x=b;var I=x.stateNode;if(x.tag===5&&I!==null&&(x=I,y!==null&&(I=Ei(b,y),I!=null&&v.push(ji(b,I,x)))),T)break;b=b.return}0<v.length&&(p=new f(p,g,null,n,m),d.push({event:p,listeners:v}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",p&&n!==Mu&&(g=n.relatedTarget||n.fromElement)&&(ls(g)||g[nr]))break e;if((f||p)&&(p=m.window===m?m:(p=m.ownerDocument)?p.defaultView||p.parentWindow:window,f?(g=n.relatedTarget||n.toElement,f=u,g=g?ls(g):null,g!==null&&(T=Cs(g),g!==T||g.tag!==5&&g.tag!==6)&&(g=null)):(f=null,g=u),f!==g)){if(v=Gm,I="onMouseLeave",y="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(v=Xm,I="onPointerLeave",y="onPointerEnter",b="pointer"),T=f==null?p:Us(f),x=g==null?p:Us(g),p=new v(I,b+"leave",f,n,m),p.target=T,p.relatedTarget=x,I=null,ls(m)===u&&(v=new v(y,b+"enter",g,n,m),v.target=x,v.relatedTarget=T,I=v),T=I,f&&g)t:{for(v=f,y=g,b=0,x=v;x;x=Is(x))b++;for(x=0,I=y;I;I=Is(I))x++;for(;0<b-x;)v=Is(v),b--;for(;0<x-b;)y=Is(y),x--;for(;b--;){if(v===y||y!==null&&v===y.alternate)break t;v=Is(v),y=Is(y)}v=null}else v=null;f!==null&&cf(d,p,f,v,!1),g!==null&&T!==null&&cf(d,T,g,v,!0)}}e:{if(p=u?Us(u):window,f=p.nodeName&&p.nodeName.toLowerCase(),f==="select"||f==="input"&&p.type==="file")var C=yE;else if(ef(p))if(_g)C=NE;else{C=vE;var E=bE}else(f=p.nodeName)&&f.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=EE);if(C&&(C=C(e,u))){Ag(d,C,n,m);break e}E&&E(e,p,u),e==="focusout"&&(E=p._wrapperState)&&E.controlled&&p.type==="number"&&_u(p,"number",p.value)}switch(E=u?Us(u):window,e){case"focusin":(ef(E)||E.contentEditable==="true")&&(Fs=E,zu=u,ii=null);break;case"focusout":ii=zu=Fs=null;break;case"mousedown":$u=!0;break;case"contextmenu":case"mouseup":case"dragend":$u=!1,af(d,n,m);break;case"selectionchange":if(SE)break;case"keydown":case"keyup":af(d,n,m)}var N;if(mh)e:{switch(e){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else Ds?kg(e,n)&&(O="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(O="onCompositionStart");O&&(Cg&&n.locale!=="ko"&&(Ds||O!=="onCompositionStart"?O==="onCompositionEnd"&&Ds&&(N=Sg()):(Er=m,uh="value"in Er?Er.value:Er.textContent,Ds=!0)),E=ao(u,O),0<E.length&&(O=new Qm(O,e,null,n,m),d.push({event:O,listeners:E}),N?O.data=N:(N=jg(n),N!==null&&(O.data=N)))),(N=mE?fE(e,n):pE(e,n))&&(u=ao(u,"onBeforeInput"),0<u.length&&(m=new Qm("onBeforeInput","beforeinput",null,n,m),d.push({event:m,listeners:u}),m.data=N))}Ug(d,t)})}function ji(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ao(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Ei(e,n),i!=null&&r.unshift(ji(e,i,a)),i=Ei(e,t),i!=null&&r.push(ji(e,i,a))),e=e.return}return r}function Is(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function cf(e,t,n,r,a){for(var i=t._reactName,l=[];n!==null&&n!==r;){var o=n,c=o.alternate,u=o.stateNode;if(c!==null&&c===r)break;o.tag===5&&u!==null&&(o=u,a?(c=Ei(n,i),c!=null&&l.unshift(ji(n,c,o))):a||(c=Ei(n,i),c!=null&&l.push(ji(n,c,o)))),n=n.return}l.length!==0&&e.push({event:t,listeners:l})}var AE=/\r\n?/g,_E=/\u0000|\uFFFD/g;function uf(e){return(typeof e=="string"?e:""+e).replace(AE,`
`).replace(_E,"")}function pl(e,t,n){if(t=uf(t),uf(e)!==t&&n)throw Error(Z(425))}function io(){}var qu=null,Vu=null;function Yu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Wu=typeof setTimeout=="function"?setTimeout:void 0,IE=typeof clearTimeout=="function"?clearTimeout:void 0,df=typeof Promise=="function"?Promise:void 0,LE=typeof queueMicrotask=="function"?queueMicrotask:typeof df<"u"?function(e){return df.resolve(null).then(e).catch(RE)}:Wu;function RE(e){setTimeout(function(){throw e})}function Dc(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),wi(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);wi(t)}function Ar(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function hf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var xa=Math.random().toString(36).slice(2),Fn="__reactFiber$"+xa,Ai="__reactProps$"+xa,nr="__reactContainer$"+xa,Ku="__reactEvents$"+xa,PE="__reactListeners$"+xa,ME="__reactHandles$"+xa;function ls(e){var t=e[Fn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[nr]||n[Fn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=hf(e);e!==null;){if(n=e[Fn])return n;e=hf(e)}return t}e=n,n=e.parentNode}return null}function Qi(e){return e=e[Fn]||e[nr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Us(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Z(33))}function zo(e){return e[Ai]||null}var Gu=[],Hs=-1;function $r(e){return{current:e}}function He(e){0>Hs||(e.current=Gu[Hs],Gu[Hs]=null,Hs--)}function Fe(e,t){Hs++,Gu[Hs]=e.current,e.current=t}var Fr={},wt=$r(Fr),Ut=$r(!1),gs=Fr;function sa(e,t){var n=e.type.contextTypes;if(!n)return Fr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ht(e){return e=e.childContextTypes,e!=null}function lo(){He(Ut),He(wt)}function mf(e,t,n){if(wt.current!==Fr)throw Error(Z(168));Fe(wt,t),Fe(Ut,n)}function zg(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(Z(108,bv(e)||"Unknown",a));return Ke({},n,r)}function oo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Fr,gs=wt.current,Fe(wt,e),Fe(Ut,Ut.current),!0}function ff(e,t,n){var r=e.stateNode;if(!r)throw Error(Z(169));n?(e=zg(e,t,gs),r.__reactInternalMemoizedMergedChildContext=e,He(Ut),He(wt),Fe(wt,e)):He(Ut),Fe(Ut,n)}var Qn=null,$o=!1,Fc=!1;function $g(e){Qn===null?Qn=[e]:Qn.push(e)}function OE(e){$o=!0,$g(e)}function qr(){if(!Fc&&Qn!==null){Fc=!0;var e=0,t=Re;try{var n=Qn;for(Re=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Qn=null,$o=!1}catch(a){throw Qn!==null&&(Qn=Qn.slice(e+1)),fg(ih,qr),a}finally{Re=t,Fc=!1}}return null}var zs=[],$s=0,co=null,uo=0,sn=[],an=0,xs=null,Jn=1,Zn="";function rs(e,t){zs[$s++]=uo,zs[$s++]=co,co=e,uo=t}function qg(e,t,n){sn[an++]=Jn,sn[an++]=Zn,sn[an++]=xs,xs=e;var r=Jn;e=Zn;var a=32-kn(r)-1;r&=~(1<<a),n+=1;var i=32-kn(t)+a;if(30<i){var l=a-a%5;i=(r&(1<<l)-1).toString(32),r>>=l,a-=l,Jn=1<<32-kn(t)+a|n<<a|r,Zn=i+e}else Jn=1<<i|n<<a|r,Zn=e}function ph(e){e.return!==null&&(rs(e,1),qg(e,1,0))}function gh(e){for(;e===co;)co=zs[--$s],zs[$s]=null,uo=zs[--$s],zs[$s]=null;for(;e===xs;)xs=sn[--an],sn[an]=null,Zn=sn[--an],sn[an]=null,Jn=sn[--an],sn[an]=null}var Jt=null,Xt=null,$e=!1,wn=null;function Vg(e,t){var n=un(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function pf(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Jt=e,Xt=Ar(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Jt=e,Xt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=xs!==null?{id:Jn,overflow:Zn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=un(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Jt=e,Xt=null,!0):!1;default:return!1}}function Qu(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Xu(e){if($e){var t=Xt;if(t){var n=t;if(!pf(e,t)){if(Qu(e))throw Error(Z(418));t=Ar(n.nextSibling);var r=Jt;t&&pf(e,t)?Vg(r,n):(e.flags=e.flags&-4097|2,$e=!1,Jt=e)}}else{if(Qu(e))throw Error(Z(418));e.flags=e.flags&-4097|2,$e=!1,Jt=e}}}function gf(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Jt=e}function gl(e){if(e!==Jt)return!1;if(!$e)return gf(e),$e=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Yu(e.type,e.memoizedProps)),t&&(t=Xt)){if(Qu(e))throw Yg(),Error(Z(418));for(;t;)Vg(e,t),t=Ar(t.nextSibling)}if(gf(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Z(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Xt=Ar(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Xt=null}}else Xt=Jt?Ar(e.stateNode.nextSibling):null;return!0}function Yg(){for(var e=Xt;e;)e=Ar(e.nextSibling)}function aa(){Xt=Jt=null,$e=!1}function xh(e){wn===null?wn=[e]:wn.push(e)}var DE=ir.ReactCurrentBatchConfig;function Da(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Z(309));var r=n.stateNode}if(!r)throw Error(Z(147,e));var a=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var o=a.refs;l===null?delete o[i]:o[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(Z(284));if(!n._owner)throw Error(Z(290,e))}return e}function xl(e,t){throw e=Object.prototype.toString.call(t),Error(Z(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function xf(e){var t=e._init;return t(e._payload)}function Wg(e){function t(y,b){if(e){var x=y.deletions;x===null?(y.deletions=[b],y.flags|=16):x.push(b)}}function n(y,b){if(!e)return null;for(;b!==null;)t(y,b),b=b.sibling;return null}function r(y,b){for(y=new Map;b!==null;)b.key!==null?y.set(b.key,b):y.set(b.index,b),b=b.sibling;return y}function a(y,b){return y=Rr(y,b),y.index=0,y.sibling=null,y}function i(y,b,x){return y.index=x,e?(x=y.alternate,x!==null?(x=x.index,x<b?(y.flags|=2,b):x):(y.flags|=2,b)):(y.flags|=1048576,b)}function l(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,b,x,I){return b===null||b.tag!==6?(b=Vc(x,y.mode,I),b.return=y,b):(b=a(b,x),b.return=y,b)}function c(y,b,x,I){var C=x.type;return C===Os?m(y,b,x.props.children,I,x.key):b!==null&&(b.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===gr&&xf(C)===b.type)?(I=a(b,x.props),I.ref=Da(y,b,x),I.return=y,I):(I=Hl(x.type,x.key,x.props,null,y.mode,I),I.ref=Da(y,b,x),I.return=y,I)}function u(y,b,x,I){return b===null||b.tag!==4||b.stateNode.containerInfo!==x.containerInfo||b.stateNode.implementation!==x.implementation?(b=Yc(x,y.mode,I),b.return=y,b):(b=a(b,x.children||[]),b.return=y,b)}function m(y,b,x,I,C){return b===null||b.tag!==7?(b=ms(x,y.mode,I,C),b.return=y,b):(b=a(b,x),b.return=y,b)}function d(y,b,x){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Vc(""+b,y.mode,x),b.return=y,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case il:return x=Hl(b.type,b.key,b.props,null,y.mode,x),x.ref=Da(y,null,b),x.return=y,x;case Ms:return b=Yc(b,y.mode,x),b.return=y,b;case gr:var I=b._init;return d(y,I(b._payload),x)}if(Xa(b)||La(b))return b=ms(b,y.mode,x,null),b.return=y,b;xl(y,b)}return null}function p(y,b,x,I){var C=b!==null?b.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return C!==null?null:o(y,b,""+x,I);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case il:return x.key===C?c(y,b,x,I):null;case Ms:return x.key===C?u(y,b,x,I):null;case gr:return C=x._init,p(y,b,C(x._payload),I)}if(Xa(x)||La(x))return C!==null?null:m(y,b,x,I,null);xl(y,x)}return null}function f(y,b,x,I,C){if(typeof I=="string"&&I!==""||typeof I=="number")return y=y.get(x)||null,o(b,y,""+I,C);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case il:return y=y.get(I.key===null?x:I.key)||null,c(b,y,I,C);case Ms:return y=y.get(I.key===null?x:I.key)||null,u(b,y,I,C);case gr:var E=I._init;return f(y,b,x,E(I._payload),C)}if(Xa(I)||La(I))return y=y.get(x)||null,m(b,y,I,C,null);xl(b,I)}return null}function g(y,b,x,I){for(var C=null,E=null,N=b,O=b=0,D=null;N!==null&&O<x.length;O++){N.index>O?(D=N,N=null):D=N.sibling;var A=p(y,N,x[O],I);if(A===null){N===null&&(N=D);break}e&&N&&A.alternate===null&&t(y,N),b=i(A,b,O),E===null?C=A:E.sibling=A,E=A,N=D}if(O===x.length)return n(y,N),$e&&rs(y,O),C;if(N===null){for(;O<x.length;O++)N=d(y,x[O],I),N!==null&&(b=i(N,b,O),E===null?C=N:E.sibling=N,E=N);return $e&&rs(y,O),C}for(N=r(y,N);O<x.length;O++)D=f(N,y,O,x[O],I),D!==null&&(e&&D.alternate!==null&&N.delete(D.key===null?O:D.key),b=i(D,b,O),E===null?C=D:E.sibling=D,E=D);return e&&N.forEach(function(z){return t(y,z)}),$e&&rs(y,O),C}function v(y,b,x,I){var C=La(x);if(typeof C!="function")throw Error(Z(150));if(x=C.call(x),x==null)throw Error(Z(151));for(var E=C=null,N=b,O=b=0,D=null,A=x.next();N!==null&&!A.done;O++,A=x.next()){N.index>O?(D=N,N=null):D=N.sibling;var z=p(y,N,A.value,I);if(z===null){N===null&&(N=D);break}e&&N&&z.alternate===null&&t(y,N),b=i(z,b,O),E===null?C=z:E.sibling=z,E=z,N=D}if(A.done)return n(y,N),$e&&rs(y,O),C;if(N===null){for(;!A.done;O++,A=x.next())A=d(y,A.value,I),A!==null&&(b=i(A,b,O),E===null?C=A:E.sibling=A,E=A);return $e&&rs(y,O),C}for(N=r(y,N);!A.done;O++,A=x.next())A=f(N,y,O,A.value,I),A!==null&&(e&&A.alternate!==null&&N.delete(A.key===null?O:A.key),b=i(A,b,O),E===null?C=A:E.sibling=A,E=A);return e&&N.forEach(function(M){return t(y,M)}),$e&&rs(y,O),C}function T(y,b,x,I){if(typeof x=="object"&&x!==null&&x.type===Os&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case il:e:{for(var C=x.key,E=b;E!==null;){if(E.key===C){if(C=x.type,C===Os){if(E.tag===7){n(y,E.sibling),b=a(E,x.props.children),b.return=y,y=b;break e}}else if(E.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===gr&&xf(C)===E.type){n(y,E.sibling),b=a(E,x.props),b.ref=Da(y,E,x),b.return=y,y=b;break e}n(y,E);break}else t(y,E);E=E.sibling}x.type===Os?(b=ms(x.props.children,y.mode,I,x.key),b.return=y,y=b):(I=Hl(x.type,x.key,x.props,null,y.mode,I),I.ref=Da(y,b,x),I.return=y,y=I)}return l(y);case Ms:e:{for(E=x.key;b!==null;){if(b.key===E)if(b.tag===4&&b.stateNode.containerInfo===x.containerInfo&&b.stateNode.implementation===x.implementation){n(y,b.sibling),b=a(b,x.children||[]),b.return=y,y=b;break e}else{n(y,b);break}else t(y,b);b=b.sibling}b=Yc(x,y.mode,I),b.return=y,y=b}return l(y);case gr:return E=x._init,T(y,b,E(x._payload),I)}if(Xa(x))return g(y,b,x,I);if(La(x))return v(y,b,x,I);xl(y,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,b!==null&&b.tag===6?(n(y,b.sibling),b=a(b,x),b.return=y,y=b):(n(y,b),b=Vc(x,y.mode,I),b.return=y,y=b),l(y)):n(y,b)}return T}var ia=Wg(!0),Kg=Wg(!1),ho=$r(null),mo=null,qs=null,yh=null;function bh(){yh=qs=mo=null}function vh(e){var t=ho.current;He(ho),e._currentValue=t}function Ju(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Zs(e,t){mo=e,yh=qs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Bt=!0),e.firstContext=null)}function mn(e){var t=e._currentValue;if(yh!==e)if(e={context:e,memoizedValue:t,next:null},qs===null){if(mo===null)throw Error(Z(308));qs=e,mo.dependencies={lanes:0,firstContext:e}}else qs=qs.next=e;return t}var os=null;function Eh(e){os===null?os=[e]:os.push(e)}function Gg(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,Eh(t)):(n.next=a.next,a.next=n),t.interleaved=n,rr(e,r)}function rr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var xr=!1;function Nh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qg(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function er(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function _r(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,je&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,rr(e,n)}return a=r.interleaved,a===null?(t.next=t,Eh(r)):(t.next=a.next,a.next=t),r.interleaved=t,rr(e,n)}function Ml(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,lh(e,n)}}function yf(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=l:i=i.next=l,n=n.next}while(n!==null);i===null?a=i=t:i=i.next=t}else a=i=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function fo(e,t,n,r){var a=e.updateQueue;xr=!1;var i=a.firstBaseUpdate,l=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var c=o,u=c.next;c.next=null,l===null?i=u:l.next=u,l=c;var m=e.alternate;m!==null&&(m=m.updateQueue,o=m.lastBaseUpdate,o!==l&&(o===null?m.firstBaseUpdate=u:o.next=u,m.lastBaseUpdate=c))}if(i!==null){var d=a.baseState;l=0,m=u=c=null,o=i;do{var p=o.lane,f=o.eventTime;if((r&p)===p){m!==null&&(m=m.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,v=o;switch(p=t,f=n,v.tag){case 1:if(g=v.payload,typeof g=="function"){d=g.call(f,d,p);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=v.payload,p=typeof g=="function"?g.call(f,d,p):g,p==null)break e;d=Ke({},d,p);break e;case 2:xr=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[o]:p.push(o))}else f={eventTime:f,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},m===null?(u=m=f,c=d):m=m.next=f,l|=p;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;p=o,o=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(m===null&&(c=d),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=m,t=a.shared.interleaved,t!==null){a=t;do l|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);bs|=l,e.lanes=l,e.memoizedState=d}}function bf(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(Z(191,a));a.call(r)}}}var Xi={},Un=$r(Xi),_i=$r(Xi),Ii=$r(Xi);function cs(e){if(e===Xi)throw Error(Z(174));return e}function Th(e,t){switch(Fe(Ii,t),Fe(_i,e),Fe(Un,Xi),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Lu(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Lu(t,e)}He(Un),Fe(Un,t)}function la(){He(Un),He(_i),He(Ii)}function Xg(e){cs(Ii.current);var t=cs(Un.current),n=Lu(t,e.type);t!==n&&(Fe(_i,e),Fe(Un,n))}function wh(e){_i.current===e&&(He(Un),He(_i))}var Ve=$r(0);function po(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Bc=[];function Sh(){for(var e=0;e<Bc.length;e++)Bc[e]._workInProgressVersionPrimary=null;Bc.length=0}var Ol=ir.ReactCurrentDispatcher,Uc=ir.ReactCurrentBatchConfig,ys=0,Ye=null,rt=null,ot=null,go=!1,li=!1,Li=0,FE=0;function gt(){throw Error(Z(321))}function Ch(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!_n(e[n],t[n]))return!1;return!0}function kh(e,t,n,r,a,i){if(ys=i,Ye=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ol.current=e===null||e.memoizedState===null?zE:$E,e=n(r,a),li){i=0;do{if(li=!1,Li=0,25<=i)throw Error(Z(301));i+=1,ot=rt=null,t.updateQueue=null,Ol.current=qE,e=n(r,a)}while(li)}if(Ol.current=xo,t=rt!==null&&rt.next!==null,ys=0,ot=rt=Ye=null,go=!1,t)throw Error(Z(300));return e}function jh(){var e=Li!==0;return Li=0,e}function Mn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ot===null?Ye.memoizedState=ot=e:ot=ot.next=e,ot}function fn(){if(rt===null){var e=Ye.alternate;e=e!==null?e.memoizedState:null}else e=rt.next;var t=ot===null?Ye.memoizedState:ot.next;if(t!==null)ot=t,rt=e;else{if(e===null)throw Error(Z(310));rt=e,e={memoizedState:rt.memoizedState,baseState:rt.baseState,baseQueue:rt.baseQueue,queue:rt.queue,next:null},ot===null?Ye.memoizedState=ot=e:ot=ot.next=e}return ot}function Ri(e,t){return typeof t=="function"?t(e):t}function Hc(e){var t=fn(),n=t.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=e;var r=rt,a=r.baseQueue,i=n.pending;if(i!==null){if(a!==null){var l=a.next;a.next=i.next,i.next=l}r.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,r=r.baseState;var o=l=null,c=null,u=i;do{var m=u.lane;if((ys&m)===m)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:m,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=d,l=r):c=c.next=d,Ye.lanes|=m,bs|=m}u=u.next}while(u!==null&&u!==i);c===null?l=r:c.next=o,_n(r,t.memoizedState)||(Bt=!0),t.memoizedState=r,t.baseState=l,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do i=a.lane,Ye.lanes|=i,bs|=i,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function zc(e){var t=fn(),n=t.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(a!==null){n.pending=null;var l=a=a.next;do i=e(i,l.action),l=l.next;while(l!==a);_n(i,t.memoizedState)||(Bt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Jg(){}function Zg(e,t){var n=Ye,r=fn(),a=t(),i=!_n(r.memoizedState,a);if(i&&(r.memoizedState=a,Bt=!0),r=r.queue,Ah(nx.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||ot!==null&&ot.memoizedState.tag&1){if(n.flags|=2048,Pi(9,tx.bind(null,n,r,a,t),void 0,null),ut===null)throw Error(Z(349));ys&30||ex(n,t,a)}return a}function ex(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ye.updateQueue,t===null?(t={lastEffect:null,stores:null},Ye.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function tx(e,t,n,r){t.value=n,t.getSnapshot=r,rx(t)&&sx(e)}function nx(e,t,n){return n(function(){rx(t)&&sx(e)})}function rx(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!_n(e,n)}catch{return!0}}function sx(e){var t=rr(e,1);t!==null&&jn(t,e,1,-1)}function vf(e){var t=Mn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ri,lastRenderedState:e},t.queue=e,e=e.dispatch=HE.bind(null,Ye,e),[t.memoizedState,e]}function Pi(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ye.updateQueue,t===null?(t={lastEffect:null,stores:null},Ye.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function ax(){return fn().memoizedState}function Dl(e,t,n,r){var a=Mn();Ye.flags|=e,a.memoizedState=Pi(1|t,n,void 0,r===void 0?null:r)}function qo(e,t,n,r){var a=fn();r=r===void 0?null:r;var i=void 0;if(rt!==null){var l=rt.memoizedState;if(i=l.destroy,r!==null&&Ch(r,l.deps)){a.memoizedState=Pi(t,n,i,r);return}}Ye.flags|=e,a.memoizedState=Pi(1|t,n,i,r)}function Ef(e,t){return Dl(8390656,8,e,t)}function Ah(e,t){return qo(2048,8,e,t)}function ix(e,t){return qo(4,2,e,t)}function lx(e,t){return qo(4,4,e,t)}function ox(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function cx(e,t,n){return n=n!=null?n.concat([e]):null,qo(4,4,ox.bind(null,t,e),n)}function _h(){}function ux(e,t){var n=fn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Ch(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function dx(e,t){var n=fn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Ch(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function hx(e,t,n){return ys&21?(_n(n,t)||(n=xg(),Ye.lanes|=n,bs|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Bt=!0),e.memoizedState=n)}function BE(e,t){var n=Re;Re=n!==0&&4>n?n:4,e(!0);var r=Uc.transition;Uc.transition={};try{e(!1),t()}finally{Re=n,Uc.transition=r}}function mx(){return fn().memoizedState}function UE(e,t,n){var r=Lr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},fx(e))px(t,n);else if(n=Gg(e,t,n,r),n!==null){var a=_t();jn(n,e,r,a),gx(n,t,r)}}function HE(e,t,n){var r=Lr(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(fx(e))px(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,o=i(l,n);if(a.hasEagerState=!0,a.eagerState=o,_n(o,l)){var c=t.interleaved;c===null?(a.next=a,Eh(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}n=Gg(e,t,a,r),n!==null&&(a=_t(),jn(n,e,r,a),gx(n,t,r))}}function fx(e){var t=e.alternate;return e===Ye||t!==null&&t===Ye}function px(e,t){li=go=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function gx(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,lh(e,n)}}var xo={readContext:mn,useCallback:gt,useContext:gt,useEffect:gt,useImperativeHandle:gt,useInsertionEffect:gt,useLayoutEffect:gt,useMemo:gt,useReducer:gt,useRef:gt,useState:gt,useDebugValue:gt,useDeferredValue:gt,useTransition:gt,useMutableSource:gt,useSyncExternalStore:gt,useId:gt,unstable_isNewReconciler:!1},zE={readContext:mn,useCallback:function(e,t){return Mn().memoizedState=[e,t===void 0?null:t],e},useContext:mn,useEffect:Ef,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Dl(4194308,4,ox.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Dl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Dl(4,2,e,t)},useMemo:function(e,t){var n=Mn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Mn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=UE.bind(null,Ye,e),[r.memoizedState,e]},useRef:function(e){var t=Mn();return e={current:e},t.memoizedState=e},useState:vf,useDebugValue:_h,useDeferredValue:function(e){return Mn().memoizedState=e},useTransition:function(){var e=vf(!1),t=e[0];return e=BE.bind(null,e[1]),Mn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ye,a=Mn();if($e){if(n===void 0)throw Error(Z(407));n=n()}else{if(n=t(),ut===null)throw Error(Z(349));ys&30||ex(r,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,Ef(nx.bind(null,r,i,e),[e]),r.flags|=2048,Pi(9,tx.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Mn(),t=ut.identifierPrefix;if($e){var n=Zn,r=Jn;n=(r&~(1<<32-kn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Li++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=FE++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},$E={readContext:mn,useCallback:ux,useContext:mn,useEffect:Ah,useImperativeHandle:cx,useInsertionEffect:ix,useLayoutEffect:lx,useMemo:dx,useReducer:Hc,useRef:ax,useState:function(){return Hc(Ri)},useDebugValue:_h,useDeferredValue:function(e){var t=fn();return hx(t,rt.memoizedState,e)},useTransition:function(){var e=Hc(Ri)[0],t=fn().memoizedState;return[e,t]},useMutableSource:Jg,useSyncExternalStore:Zg,useId:mx,unstable_isNewReconciler:!1},qE={readContext:mn,useCallback:ux,useContext:mn,useEffect:Ah,useImperativeHandle:cx,useInsertionEffect:ix,useLayoutEffect:lx,useMemo:dx,useReducer:zc,useRef:ax,useState:function(){return zc(Ri)},useDebugValue:_h,useDeferredValue:function(e){var t=fn();return rt===null?t.memoizedState=e:hx(t,rt.memoizedState,e)},useTransition:function(){var e=zc(Ri)[0],t=fn().memoizedState;return[e,t]},useMutableSource:Jg,useSyncExternalStore:Zg,useId:mx,unstable_isNewReconciler:!1};function En(e,t){if(e&&e.defaultProps){t=Ke({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Zu(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Ke({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Vo={isMounted:function(e){return(e=e._reactInternals)?Cs(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=_t(),a=Lr(e),i=er(r,a);i.payload=t,n!=null&&(i.callback=n),t=_r(e,i,a),t!==null&&(jn(t,e,a,r),Ml(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=_t(),a=Lr(e),i=er(r,a);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=_r(e,i,a),t!==null&&(jn(t,e,a,r),Ml(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=_t(),r=Lr(e),a=er(n,r);a.tag=2,t!=null&&(a.callback=t),t=_r(e,a,r),t!==null&&(jn(t,e,r,n),Ml(t,e,r))}};function Nf(e,t,n,r,a,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,l):t.prototype&&t.prototype.isPureReactComponent?!Ci(n,r)||!Ci(a,i):!0}function xx(e,t,n){var r=!1,a=Fr,i=t.contextType;return typeof i=="object"&&i!==null?i=mn(i):(a=Ht(t)?gs:wt.current,r=t.contextTypes,i=(r=r!=null)?sa(e,a):Fr),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Vo,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Tf(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Vo.enqueueReplaceState(t,t.state,null)}function ed(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Nh(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=mn(i):(i=Ht(t)?gs:wt.current,a.context=sa(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Zu(e,t,i,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Vo.enqueueReplaceState(a,a.state,null),fo(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function oa(e,t){try{var n="",r=t;do n+=yv(r),r=r.return;while(r);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function $c(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function td(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var VE=typeof WeakMap=="function"?WeakMap:Map;function yx(e,t,n){n=er(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){bo||(bo=!0,dd=r),td(e,t)},n}function bx(e,t,n){n=er(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){td(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){td(e,t),typeof r!="function"&&(Ir===null?Ir=new Set([this]):Ir.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),n}function wf(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new VE;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=aN.bind(null,e,t,n),t.then(e,e))}function Sf(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Cf(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=er(-1,1),t.tag=2,_r(n,t,1))),n.lanes|=1),e)}var YE=ir.ReactCurrentOwner,Bt=!1;function kt(e,t,n,r){t.child=e===null?Kg(t,null,n,r):ia(t,e.child,n,r)}function kf(e,t,n,r,a){n=n.render;var i=t.ref;return Zs(t,a),r=kh(e,t,n,r,i,a),n=jh(),e!==null&&!Bt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,sr(e,t,a)):($e&&n&&ph(t),t.flags|=1,kt(e,t,r,a),t.child)}function jf(e,t,n,r,a){if(e===null){var i=n.type;return typeof i=="function"&&!Fh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,vx(e,t,i,r,a)):(e=Hl(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var l=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ci,n(l,r)&&e.ref===t.ref)return sr(e,t,a)}return t.flags|=1,e=Rr(i,r),e.ref=t.ref,e.return=t,t.child=e}function vx(e,t,n,r,a){if(e!==null){var i=e.memoizedProps;if(Ci(i,r)&&e.ref===t.ref)if(Bt=!1,t.pendingProps=r=i,(e.lanes&a)!==0)e.flags&131072&&(Bt=!0);else return t.lanes=e.lanes,sr(e,t,a)}return nd(e,t,n,r,a)}function Ex(e,t,n){var r=t.pendingProps,a=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fe(Ys,Qt),Qt|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Fe(Ys,Qt),Qt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Fe(Ys,Qt),Qt|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Fe(Ys,Qt),Qt|=r;return kt(e,t,a,n),t.child}function Nx(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function nd(e,t,n,r,a){var i=Ht(n)?gs:wt.current;return i=sa(t,i),Zs(t,a),n=kh(e,t,n,r,i,a),r=jh(),e!==null&&!Bt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,sr(e,t,a)):($e&&r&&ph(t),t.flags|=1,kt(e,t,n,a),t.child)}function Af(e,t,n,r,a){if(Ht(n)){var i=!0;oo(t)}else i=!1;if(Zs(t,a),t.stateNode===null)Fl(e,t),xx(t,n,r),ed(t,n,r,a),r=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var c=l.context,u=n.contextType;typeof u=="object"&&u!==null?u=mn(u):(u=Ht(n)?gs:wt.current,u=sa(t,u));var m=n.getDerivedStateFromProps,d=typeof m=="function"||typeof l.getSnapshotBeforeUpdate=="function";d||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==r||c!==u)&&Tf(t,l,r,u),xr=!1;var p=t.memoizedState;l.state=p,fo(t,r,l,a),c=t.memoizedState,o!==r||p!==c||Ut.current||xr?(typeof m=="function"&&(Zu(t,n,m,r),c=t.memoizedState),(o=xr||Nf(t,n,o,r,p,c,u))?(d||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),l.props=r,l.state=c,l.context=u,r=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{l=t.stateNode,Qg(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:En(t.type,o),l.props=u,d=t.pendingProps,p=l.context,c=n.contextType,typeof c=="object"&&c!==null?c=mn(c):(c=Ht(n)?gs:wt.current,c=sa(t,c));var f=n.getDerivedStateFromProps;(m=typeof f=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==d||p!==c)&&Tf(t,l,r,c),xr=!1,p=t.memoizedState,l.state=p,fo(t,r,l,a);var g=t.memoizedState;o!==d||p!==g||Ut.current||xr?(typeof f=="function"&&(Zu(t,n,f,r),g=t.memoizedState),(u=xr||Nf(t,n,u,r,p,g,c)||!1)?(m||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,g,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,g,c)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=g),l.props=r,l.state=g,l.context=c,r=u):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return rd(e,t,n,r,i,a)}function rd(e,t,n,r,a,i){Nx(e,t);var l=(t.flags&128)!==0;if(!r&&!l)return a&&ff(t,n,!1),sr(e,t,i);r=t.stateNode,YE.current=t;var o=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&l?(t.child=ia(t,e.child,null,i),t.child=ia(t,null,o,i)):kt(e,t,o,i),t.memoizedState=r.state,a&&ff(t,n,!0),t.child}function Tx(e){var t=e.stateNode;t.pendingContext?mf(e,t.pendingContext,t.pendingContext!==t.context):t.context&&mf(e,t.context,!1),Th(e,t.containerInfo)}function _f(e,t,n,r,a){return aa(),xh(a),t.flags|=256,kt(e,t,n,r),t.child}var sd={dehydrated:null,treeContext:null,retryLane:0};function ad(e){return{baseLanes:e,cachePool:null,transitions:null}}function wx(e,t,n){var r=t.pendingProps,a=Ve.current,i=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Fe(Ve,a&1),e===null)return Xu(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=r.children,e=r.fallback,i?(r=t.mode,i=t.child,l={mode:"hidden",children:l},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=Ko(l,r,0,null),e=ms(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=ad(n),t.memoizedState=sd,e):Ih(t,l));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return WE(e,t,l,r,o,a,n);if(i){i=r.fallback,l=t.mode,a=e.child,o=a.sibling;var c={mode:"hidden",children:r.children};return!(l&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Rr(a,c),r.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=Rr(o,i):(i=ms(i,l,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,l=e.child.memoizedState,l=l===null?ad(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~n,t.memoizedState=sd,r}return i=e.child,e=i.sibling,r=Rr(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Ih(e,t){return t=Ko({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function yl(e,t,n,r){return r!==null&&xh(r),ia(t,e.child,null,n),e=Ih(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function WE(e,t,n,r,a,i,l){if(n)return t.flags&256?(t.flags&=-257,r=$c(Error(Z(422))),yl(e,t,l,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,a=t.mode,r=Ko({mode:"visible",children:r.children},a,0,null),i=ms(i,a,l,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&ia(t,e.child,null,l),t.child.memoizedState=ad(l),t.memoizedState=sd,i);if(!(t.mode&1))return yl(e,t,l,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var o=r.dgst;return r=o,i=Error(Z(419)),r=$c(i,r,void 0),yl(e,t,l,r)}if(o=(l&e.childLanes)!==0,Bt||o){if(r=ut,r!==null){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|l)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,rr(e,a),jn(r,e,a,-1))}return Dh(),r=$c(Error(Z(421))),yl(e,t,l,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=iN.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Xt=Ar(a.nextSibling),Jt=t,$e=!0,wn=null,e!==null&&(sn[an++]=Jn,sn[an++]=Zn,sn[an++]=xs,Jn=e.id,Zn=e.overflow,xs=t),t=Ih(t,r.children),t.flags|=4096,t)}function If(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Ju(e.return,t,n)}function qc(e,t,n,r,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Sx(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(kt(e,t,r.children,n),r=Ve.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&If(e,n,t);else if(e.tag===19)If(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Fe(Ve,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&po(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),qc(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&po(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}qc(t,!0,n,null,i);break;case"together":qc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Fl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function sr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),bs|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Z(153));if(t.child!==null){for(e=t.child,n=Rr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Rr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function KE(e,t,n){switch(t.tag){case 3:Tx(t),aa();break;case 5:Xg(t);break;case 1:Ht(t.type)&&oo(t);break;case 4:Th(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Fe(ho,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Fe(Ve,Ve.current&1),t.flags|=128,null):n&t.child.childLanes?wx(e,t,n):(Fe(Ve,Ve.current&1),e=sr(e,t,n),e!==null?e.sibling:null);Fe(Ve,Ve.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Sx(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Fe(Ve,Ve.current),r)break;return null;case 22:case 23:return t.lanes=0,Ex(e,t,n)}return sr(e,t,n)}var Cx,id,kx,jx;Cx=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};id=function(){};kx=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,cs(Un.current);var i=null;switch(n){case"input":a=ju(e,a),r=ju(e,r),i=[];break;case"select":a=Ke({},a,{value:void 0}),r=Ke({},r,{value:void 0}),i=[];break;case"textarea":a=Iu(e,a),r=Iu(e,r),i=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=io)}Ru(n,r);var l;n=null;for(u in a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(l in o)o.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(bi.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(o=a!=null?a[u]:void 0,r.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(l in o)!o.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in c)c.hasOwnProperty(l)&&o[l]!==c[l]&&(n||(n={}),n[l]=c[l])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(bi.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Be("scroll",e),i||o===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};jx=function(e,t,n,r){n!==r&&(t.flags|=4)};function Fa(e,t){if(!$e)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function xt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function GE(e,t,n){var r=t.pendingProps;switch(gh(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xt(t),null;case 1:return Ht(t.type)&&lo(),xt(t),null;case 3:return r=t.stateNode,la(),He(Ut),He(wt),Sh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(gl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,wn!==null&&(fd(wn),wn=null))),id(e,t),xt(t),null;case 5:wh(t);var a=cs(Ii.current);if(n=t.type,e!==null&&t.stateNode!=null)kx(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Z(166));return xt(t),null}if(e=cs(Un.current),gl(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Fn]=t,r[Ai]=i,e=(t.mode&1)!==0,n){case"dialog":Be("cancel",r),Be("close",r);break;case"iframe":case"object":case"embed":Be("load",r);break;case"video":case"audio":for(a=0;a<Za.length;a++)Be(Za[a],r);break;case"source":Be("error",r);break;case"img":case"image":case"link":Be("error",r),Be("load",r);break;case"details":Be("toggle",r);break;case"input":Bm(r,i),Be("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Be("invalid",r);break;case"textarea":Hm(r,i),Be("invalid",r)}Ru(n,i),a=null;for(var l in i)if(i.hasOwnProperty(l)){var o=i[l];l==="children"?typeof o=="string"?r.textContent!==o&&(i.suppressHydrationWarning!==!0&&pl(r.textContent,o,e),a=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&pl(r.textContent,o,e),a=["children",""+o]):bi.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&Be("scroll",r)}switch(n){case"input":ll(r),Um(r,i,!0);break;case"textarea":ll(r),zm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=io)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{l=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ng(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),n==="select"&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[Fn]=t,e[Ai]=r,Cx(e,t,!1,!1),t.stateNode=e;e:{switch(l=Pu(n,r),n){case"dialog":Be("cancel",e),Be("close",e),a=r;break;case"iframe":case"object":case"embed":Be("load",e),a=r;break;case"video":case"audio":for(a=0;a<Za.length;a++)Be(Za[a],e);a=r;break;case"source":Be("error",e),a=r;break;case"img":case"image":case"link":Be("error",e),Be("load",e),a=r;break;case"details":Be("toggle",e),a=r;break;case"input":Bm(e,r),a=ju(e,r),Be("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=Ke({},r,{value:void 0}),Be("invalid",e);break;case"textarea":Hm(e,r),a=Iu(e,r),Be("invalid",e);break;default:a=r}Ru(n,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?ag(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&rg(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&vi(e,c):typeof c=="number"&&vi(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(bi.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Be("scroll",e):c!=null&&th(e,i,c,l))}switch(n){case"input":ll(e),Um(e,r,!1);break;case"textarea":ll(e),zm(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Dr(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Gs(e,!!r.multiple,i,!1):r.defaultValue!=null&&Gs(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=io)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return xt(t),null;case 6:if(e&&t.stateNode!=null)jx(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Z(166));if(n=cs(Ii.current),cs(Un.current),gl(t)){if(r=t.stateNode,n=t.memoizedProps,r[Fn]=t,(i=r.nodeValue!==n)&&(e=Jt,e!==null))switch(e.tag){case 3:pl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&pl(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Fn]=t,t.stateNode=r}return xt(t),null;case 13:if(He(Ve),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if($e&&Xt!==null&&t.mode&1&&!(t.flags&128))Yg(),aa(),t.flags|=98560,i=!1;else if(i=gl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(Z(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Z(317));i[Fn]=t}else aa(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;xt(t),i=!1}else wn!==null&&(fd(wn),wn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ve.current&1?st===0&&(st=3):Dh())),t.updateQueue!==null&&(t.flags|=4),xt(t),null);case 4:return la(),id(e,t),e===null&&ki(t.stateNode.containerInfo),xt(t),null;case 10:return vh(t.type._context),xt(t),null;case 17:return Ht(t.type)&&lo(),xt(t),null;case 19:if(He(Ve),i=t.memoizedState,i===null)return xt(t),null;if(r=(t.flags&128)!==0,l=i.rendering,l===null)if(r)Fa(i,!1);else{if(st!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=po(e),l!==null){for(t.flags|=128,Fa(i,!1),r=l.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Fe(Ve,Ve.current&1|2),t.child}e=e.sibling}i.tail!==null&&Qe()>ca&&(t.flags|=128,r=!0,Fa(i,!1),t.lanes=4194304)}else{if(!r)if(e=po(l),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Fa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!$e)return xt(t),null}else 2*Qe()-i.renderingStartTime>ca&&n!==1073741824&&(t.flags|=128,r=!0,Fa(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(n=i.last,n!==null?n.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Qe(),t.sibling=null,n=Ve.current,Fe(Ve,r?n&1|2:n&1),t):(xt(t),null);case 22:case 23:return Oh(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Qt&1073741824&&(xt(t),t.subtreeFlags&6&&(t.flags|=8192)):xt(t),null;case 24:return null;case 25:return null}throw Error(Z(156,t.tag))}function QE(e,t){switch(gh(t),t.tag){case 1:return Ht(t.type)&&lo(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return la(),He(Ut),He(wt),Sh(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return wh(t),null;case 13:if(He(Ve),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Z(340));aa()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return He(Ve),null;case 4:return la(),null;case 10:return vh(t.type._context),null;case 22:case 23:return Oh(),null;case 24:return null;default:return null}}var bl=!1,bt=!1,XE=typeof WeakSet=="function"?WeakSet:Set,ae=null;function Vs(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ge(e,t,r)}else n.current=null}function ld(e,t,n){try{n()}catch(r){Ge(e,t,r)}}var Lf=!1;function JE(e,t){if(qu=ro,e=Rg(),fh(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var l=0,o=-1,c=-1,u=0,m=0,d=e,p=null;t:for(;;){for(var f;d!==n||a!==0&&d.nodeType!==3||(o=l+a),d!==i||r!==0&&d.nodeType!==3||(c=l+r),d.nodeType===3&&(l+=d.nodeValue.length),(f=d.firstChild)!==null;)p=d,d=f;for(;;){if(d===e)break t;if(p===n&&++u===a&&(o=l),p===i&&++m===r&&(c=l),(f=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=f}n=o===-1||c===-1?null:{start:o,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Vu={focusedElem:e,selectionRange:n},ro=!1,ae=t;ae!==null;)if(t=ae,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ae=e;else for(;ae!==null;){t=ae;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var v=g.memoizedProps,T=g.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?v:En(t.type,v),T);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Z(163))}}catch(I){Ge(t,t.return,I)}if(e=t.sibling,e!==null){e.return=t.return,ae=e;break}ae=t.return}return g=Lf,Lf=!1,g}function oi(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&ld(t,n,i)}a=a.next}while(a!==r)}}function Yo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function od(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Ax(e){var t=e.alternate;t!==null&&(e.alternate=null,Ax(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Fn],delete t[Ai],delete t[Ku],delete t[PE],delete t[ME])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function _x(e){return e.tag===5||e.tag===3||e.tag===4}function Rf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||_x(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function cd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=io));else if(r!==4&&(e=e.child,e!==null))for(cd(e,t,n),e=e.sibling;e!==null;)cd(e,t,n),e=e.sibling}function ud(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(ud(e,t,n),e=e.sibling;e!==null;)ud(e,t,n),e=e.sibling}var mt=null,Nn=!1;function dr(e,t,n){for(n=n.child;n!==null;)Ix(e,t,n),n=n.sibling}function Ix(e,t,n){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(Fo,n)}catch{}switch(n.tag){case 5:bt||Vs(n,t);case 6:var r=mt,a=Nn;mt=null,dr(e,t,n),mt=r,Nn=a,mt!==null&&(Nn?(e=mt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):mt.removeChild(n.stateNode));break;case 18:mt!==null&&(Nn?(e=mt,n=n.stateNode,e.nodeType===8?Dc(e.parentNode,n):e.nodeType===1&&Dc(e,n),wi(e)):Dc(mt,n.stateNode));break;case 4:r=mt,a=Nn,mt=n.stateNode.containerInfo,Nn=!0,dr(e,t,n),mt=r,Nn=a;break;case 0:case 11:case 14:case 15:if(!bt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var i=a,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&ld(n,t,l),a=a.next}while(a!==r)}dr(e,t,n);break;case 1:if(!bt&&(Vs(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Ge(n,t,o)}dr(e,t,n);break;case 21:dr(e,t,n);break;case 22:n.mode&1?(bt=(r=bt)||n.memoizedState!==null,dr(e,t,n),bt=r):dr(e,t,n);break;default:dr(e,t,n)}}function Pf(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new XE),t.forEach(function(r){var a=lN.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function vn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var i=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:mt=o.stateNode,Nn=!1;break e;case 3:mt=o.stateNode.containerInfo,Nn=!0;break e;case 4:mt=o.stateNode.containerInfo,Nn=!0;break e}o=o.return}if(mt===null)throw Error(Z(160));Ix(i,l,a),mt=null,Nn=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){Ge(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Lx(t,e),t=t.sibling}function Lx(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vn(t,e),Pn(e),r&4){try{oi(3,e,e.return),Yo(3,e)}catch(v){Ge(e,e.return,v)}try{oi(5,e,e.return)}catch(v){Ge(e,e.return,v)}}break;case 1:vn(t,e),Pn(e),r&512&&n!==null&&Vs(n,n.return);break;case 5:if(vn(t,e),Pn(e),r&512&&n!==null&&Vs(n,n.return),e.flags&32){var a=e.stateNode;try{vi(a,"")}catch(v){Ge(e,e.return,v)}}if(r&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,l=n!==null?n.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&eg(a,i),Pu(o,l);var u=Pu(o,i);for(l=0;l<c.length;l+=2){var m=c[l],d=c[l+1];m==="style"?ag(a,d):m==="dangerouslySetInnerHTML"?rg(a,d):m==="children"?vi(a,d):th(a,m,d,u)}switch(o){case"input":Au(a,i);break;case"textarea":tg(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Gs(a,!!i.multiple,f,!1):p!==!!i.multiple&&(i.defaultValue!=null?Gs(a,!!i.multiple,i.defaultValue,!0):Gs(a,!!i.multiple,i.multiple?[]:"",!1))}a[Ai]=i}catch(v){Ge(e,e.return,v)}}break;case 6:if(vn(t,e),Pn(e),r&4){if(e.stateNode===null)throw Error(Z(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(v){Ge(e,e.return,v)}}break;case 3:if(vn(t,e),Pn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{wi(t.containerInfo)}catch(v){Ge(e,e.return,v)}break;case 4:vn(t,e),Pn(e);break;case 13:vn(t,e),Pn(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Ph=Qe())),r&4&&Pf(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(bt=(u=bt)||m,vn(t,e),bt=u):vn(t,e),Pn(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!m&&e.mode&1)for(ae=e,m=e.child;m!==null;){for(d=ae=m;ae!==null;){switch(p=ae,f=p.child,p.tag){case 0:case 11:case 14:case 15:oi(4,p,p.return);break;case 1:Vs(p,p.return);var g=p.stateNode;if(typeof g.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(v){Ge(r,n,v)}}break;case 5:Vs(p,p.return);break;case 22:if(p.memoizedState!==null){Of(d);continue}}f!==null?(f.return=p,ae=f):Of(d)}m=m.sibling}e:for(m=null,d=e;;){if(d.tag===5){if(m===null){m=d;try{a=d.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=d.stateNode,c=d.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=sg("display",l))}catch(v){Ge(e,e.return,v)}}}else if(d.tag===6){if(m===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(v){Ge(e,e.return,v)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;m===d&&(m=null),d=d.return}m===d&&(m=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:vn(t,e),Pn(e),r&4&&Pf(e);break;case 21:break;default:vn(t,e),Pn(e)}}function Pn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(_x(n)){var r=n;break e}n=n.return}throw Error(Z(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(vi(a,""),r.flags&=-33);var i=Rf(e);ud(e,i,a);break;case 3:case 4:var l=r.stateNode.containerInfo,o=Rf(e);cd(e,o,l);break;default:throw Error(Z(161))}}catch(c){Ge(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function ZE(e,t,n){ae=e,Rx(e)}function Rx(e,t,n){for(var r=(e.mode&1)!==0;ae!==null;){var a=ae,i=a.child;if(a.tag===22&&r){var l=a.memoizedState!==null||bl;if(!l){var o=a.alternate,c=o!==null&&o.memoizedState!==null||bt;o=bl;var u=bt;if(bl=l,(bt=c)&&!u)for(ae=a;ae!==null;)l=ae,c=l.child,l.tag===22&&l.memoizedState!==null?Df(a):c!==null?(c.return=l,ae=c):Df(a);for(;i!==null;)ae=i,Rx(i),i=i.sibling;ae=a,bl=o,bt=u}Mf(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,ae=i):Mf(e)}}function Mf(e){for(;ae!==null;){var t=ae;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:bt||Yo(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!bt)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:En(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&bf(t,i,r);break;case 3:var l=t.updateQueue;if(l!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}bf(t,l,n)}break;case 5:var o=t.stateNode;if(n===null&&t.flags&4){n=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var m=u.memoizedState;if(m!==null){var d=m.dehydrated;d!==null&&wi(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Z(163))}bt||t.flags&512&&od(t)}catch(p){Ge(t,t.return,p)}}if(t===e){ae=null;break}if(n=t.sibling,n!==null){n.return=t.return,ae=n;break}ae=t.return}}function Of(e){for(;ae!==null;){var t=ae;if(t===e){ae=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ae=n;break}ae=t.return}}function Df(e){for(;ae!==null;){var t=ae;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Yo(4,t)}catch(c){Ge(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(c){Ge(t,a,c)}}var i=t.return;try{od(t)}catch(c){Ge(t,i,c)}break;case 5:var l=t.return;try{od(t)}catch(c){Ge(t,l,c)}}}catch(c){Ge(t,t.return,c)}if(t===e){ae=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ae=o;break}ae=t.return}}var eN=Math.ceil,yo=ir.ReactCurrentDispatcher,Lh=ir.ReactCurrentOwner,hn=ir.ReactCurrentBatchConfig,je=0,ut=null,et=null,ft=0,Qt=0,Ys=$r(0),st=0,Mi=null,bs=0,Wo=0,Rh=0,ci=null,Ft=null,Ph=0,ca=1/0,Gn=null,bo=!1,dd=null,Ir=null,vl=!1,Nr=null,vo=0,ui=0,hd=null,Bl=-1,Ul=0;function _t(){return je&6?Qe():Bl!==-1?Bl:Bl=Qe()}function Lr(e){return e.mode&1?je&2&&ft!==0?ft&-ft:DE.transition!==null?(Ul===0&&(Ul=xg()),Ul):(e=Re,e!==0||(e=window.event,e=e===void 0?16:wg(e.type)),e):1}function jn(e,t,n,r){if(50<ui)throw ui=0,hd=null,Error(Z(185));Ki(e,n,r),(!(je&2)||e!==ut)&&(e===ut&&(!(je&2)&&(Wo|=n),st===4&&br(e,ft)),zt(e,r),n===1&&je===0&&!(t.mode&1)&&(ca=Qe()+500,$o&&qr()))}function zt(e,t){var n=e.callbackNode;Dv(e,t);var r=no(e,e===ut?ft:0);if(r===0)n!==null&&Vm(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Vm(n),t===1)e.tag===0?OE(Ff.bind(null,e)):$g(Ff.bind(null,e)),LE(function(){!(je&6)&&qr()}),n=null;else{switch(yg(r)){case 1:n=ih;break;case 4:n=pg;break;case 16:n=to;break;case 536870912:n=gg;break;default:n=to}n=Hx(n,Px.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Px(e,t){if(Bl=-1,Ul=0,je&6)throw Error(Z(327));var n=e.callbackNode;if(ea()&&e.callbackNode!==n)return null;var r=no(e,e===ut?ft:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Eo(e,r);else{t=r;var a=je;je|=2;var i=Ox();(ut!==e||ft!==t)&&(Gn=null,ca=Qe()+500,hs(e,t));do try{rN();break}catch(o){Mx(e,o)}while(!0);bh(),yo.current=i,je=a,et!==null?t=0:(ut=null,ft=0,t=st)}if(t!==0){if(t===2&&(a=Bu(e),a!==0&&(r=a,t=md(e,a))),t===1)throw n=Mi,hs(e,0),br(e,r),zt(e,Qe()),n;if(t===6)br(e,r);else{if(a=e.current.alternate,!(r&30)&&!tN(a)&&(t=Eo(e,r),t===2&&(i=Bu(e),i!==0&&(r=i,t=md(e,i))),t===1))throw n=Mi,hs(e,0),br(e,r),zt(e,Qe()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(Z(345));case 2:ss(e,Ft,Gn);break;case 3:if(br(e,r),(r&130023424)===r&&(t=Ph+500-Qe(),10<t)){if(no(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){_t(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Wu(ss.bind(null,e,Ft,Gn),t);break}ss(e,Ft,Gn);break;case 4:if(br(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var l=31-kn(r);i=1<<l,l=t[l],l>a&&(a=l),r&=~i}if(r=a,r=Qe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*eN(r/1960))-r,10<r){e.timeoutHandle=Wu(ss.bind(null,e,Ft,Gn),r);break}ss(e,Ft,Gn);break;case 5:ss(e,Ft,Gn);break;default:throw Error(Z(329))}}}return zt(e,Qe()),e.callbackNode===n?Px.bind(null,e):null}function md(e,t){var n=ci;return e.current.memoizedState.isDehydrated&&(hs(e,t).flags|=256),e=Eo(e,t),e!==2&&(t=Ft,Ft=n,t!==null&&fd(t)),e}function fd(e){Ft===null?Ft=e:Ft.push.apply(Ft,e)}function tN(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!_n(i(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function br(e,t){for(t&=~Rh,t&=~Wo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-kn(t),r=1<<n;e[n]=-1,t&=~r}}function Ff(e){if(je&6)throw Error(Z(327));ea();var t=no(e,0);if(!(t&1))return zt(e,Qe()),null;var n=Eo(e,t);if(e.tag!==0&&n===2){var r=Bu(e);r!==0&&(t=r,n=md(e,r))}if(n===1)throw n=Mi,hs(e,0),br(e,t),zt(e,Qe()),n;if(n===6)throw Error(Z(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ss(e,Ft,Gn),zt(e,Qe()),null}function Mh(e,t){var n=je;je|=1;try{return e(t)}finally{je=n,je===0&&(ca=Qe()+500,$o&&qr())}}function vs(e){Nr!==null&&Nr.tag===0&&!(je&6)&&ea();var t=je;je|=1;var n=hn.transition,r=Re;try{if(hn.transition=null,Re=1,e)return e()}finally{Re=r,hn.transition=n,je=t,!(je&6)&&qr()}}function Oh(){Qt=Ys.current,He(Ys)}function hs(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,IE(n)),et!==null)for(n=et.return;n!==null;){var r=n;switch(gh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&lo();break;case 3:la(),He(Ut),He(wt),Sh();break;case 5:wh(r);break;case 4:la();break;case 13:He(Ve);break;case 19:He(Ve);break;case 10:vh(r.type._context);break;case 22:case 23:Oh()}n=n.return}if(ut=e,et=e=Rr(e.current,null),ft=Qt=t,st=0,Mi=null,Rh=Wo=bs=0,Ft=ci=null,os!==null){for(t=0;t<os.length;t++)if(n=os[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,i=n.pending;if(i!==null){var l=i.next;i.next=a,r.next=l}n.pending=r}os=null}return e}function Mx(e,t){do{var n=et;try{if(bh(),Ol.current=xo,go){for(var r=Ye.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}go=!1}if(ys=0,ot=rt=Ye=null,li=!1,Li=0,Lh.current=null,n===null||n.return===null){st=1,Mi=t,et=null;break}e:{var i=e,l=n.return,o=n,c=t;if(t=ft,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,m=o,d=m.tag;if(!(m.mode&1)&&(d===0||d===11||d===15)){var p=m.alternate;p?(m.updateQueue=p.updateQueue,m.memoizedState=p.memoizedState,m.lanes=p.lanes):(m.updateQueue=null,m.memoizedState=null)}var f=Sf(l);if(f!==null){f.flags&=-257,Cf(f,l,o,i,t),f.mode&1&&wf(i,u,t),t=f,c=u;var g=t.updateQueue;if(g===null){var v=new Set;v.add(c),t.updateQueue=v}else g.add(c);break e}else{if(!(t&1)){wf(i,u,t),Dh();break e}c=Error(Z(426))}}else if($e&&o.mode&1){var T=Sf(l);if(T!==null){!(T.flags&65536)&&(T.flags|=256),Cf(T,l,o,i,t),xh(oa(c,o));break e}}i=c=oa(c,o),st!==4&&(st=2),ci===null?ci=[i]:ci.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var y=yx(i,c,t);yf(i,y);break e;case 1:o=c;var b=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ir===null||!Ir.has(x)))){i.flags|=65536,t&=-t,i.lanes|=t;var I=bx(i,o,t);yf(i,I);break e}}i=i.return}while(i!==null)}Fx(n)}catch(C){t=C,et===n&&n!==null&&(et=n=n.return);continue}break}while(!0)}function Ox(){var e=yo.current;return yo.current=xo,e===null?xo:e}function Dh(){(st===0||st===3||st===2)&&(st=4),ut===null||!(bs&268435455)&&!(Wo&268435455)||br(ut,ft)}function Eo(e,t){var n=je;je|=2;var r=Ox();(ut!==e||ft!==t)&&(Gn=null,hs(e,t));do try{nN();break}catch(a){Mx(e,a)}while(!0);if(bh(),je=n,yo.current=r,et!==null)throw Error(Z(261));return ut=null,ft=0,st}function nN(){for(;et!==null;)Dx(et)}function rN(){for(;et!==null&&!jv();)Dx(et)}function Dx(e){var t=Ux(e.alternate,e,Qt);e.memoizedProps=e.pendingProps,t===null?Fx(e):et=t,Lh.current=null}function Fx(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=QE(n,t),n!==null){n.flags&=32767,et=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{st=6,et=null;return}}else if(n=GE(n,t,Qt),n!==null){et=n;return}if(t=t.sibling,t!==null){et=t;return}et=t=e}while(t!==null);st===0&&(st=5)}function ss(e,t,n){var r=Re,a=hn.transition;try{hn.transition=null,Re=1,sN(e,t,n,r)}finally{hn.transition=a,Re=r}return null}function sN(e,t,n,r){do ea();while(Nr!==null);if(je&6)throw Error(Z(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Z(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(Fv(e,i),e===ut&&(et=ut=null,ft=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||vl||(vl=!0,Hx(to,function(){return ea(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=hn.transition,hn.transition=null;var l=Re;Re=1;var o=je;je|=4,Lh.current=null,JE(e,n),Lx(n,e),wE(Vu),ro=!!qu,Vu=qu=null,e.current=n,ZE(n),Av(),je=o,Re=l,hn.transition=i}else e.current=n;if(vl&&(vl=!1,Nr=e,vo=a),i=e.pendingLanes,i===0&&(Ir=null),Lv(n.stateNode),zt(e,Qe()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(bo)throw bo=!1,e=dd,dd=null,e;return vo&1&&e.tag!==0&&ea(),i=e.pendingLanes,i&1?e===hd?ui++:(ui=0,hd=e):ui=0,qr(),null}function ea(){if(Nr!==null){var e=yg(vo),t=hn.transition,n=Re;try{if(hn.transition=null,Re=16>e?16:e,Nr===null)var r=!1;else{if(e=Nr,Nr=null,vo=0,je&6)throw Error(Z(331));var a=je;for(je|=4,ae=e.current;ae!==null;){var i=ae,l=i.child;if(ae.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(ae=u;ae!==null;){var m=ae;switch(m.tag){case 0:case 11:case 15:oi(8,m,i)}var d=m.child;if(d!==null)d.return=m,ae=d;else for(;ae!==null;){m=ae;var p=m.sibling,f=m.return;if(Ax(m),m===u){ae=null;break}if(p!==null){p.return=f,ae=p;break}ae=f}}}var g=i.alternate;if(g!==null){var v=g.child;if(v!==null){g.child=null;do{var T=v.sibling;v.sibling=null,v=T}while(v!==null)}}ae=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,ae=l;else e:for(;ae!==null;){if(i=ae,i.flags&2048)switch(i.tag){case 0:case 11:case 15:oi(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,ae=y;break e}ae=i.return}}var b=e.current;for(ae=b;ae!==null;){l=ae;var x=l.child;if(l.subtreeFlags&2064&&x!==null)x.return=l,ae=x;else e:for(l=b;ae!==null;){if(o=ae,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Yo(9,o)}}catch(C){Ge(o,o.return,C)}if(o===l){ae=null;break e}var I=o.sibling;if(I!==null){I.return=o.return,ae=I;break e}ae=o.return}}if(je=a,qr(),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(Fo,e)}catch{}r=!0}return r}finally{Re=n,hn.transition=t}}return!1}function Bf(e,t,n){t=oa(n,t),t=yx(e,t,1),e=_r(e,t,1),t=_t(),e!==null&&(Ki(e,1,t),zt(e,t))}function Ge(e,t,n){if(e.tag===3)Bf(e,e,n);else for(;t!==null;){if(t.tag===3){Bf(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ir===null||!Ir.has(r))){e=oa(n,e),e=bx(t,e,1),t=_r(t,e,1),e=_t(),t!==null&&(Ki(t,1,e),zt(t,e));break}}t=t.return}}function aN(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=_t(),e.pingedLanes|=e.suspendedLanes&n,ut===e&&(ft&n)===n&&(st===4||st===3&&(ft&130023424)===ft&&500>Qe()-Ph?hs(e,0):Rh|=n),zt(e,t)}function Bx(e,t){t===0&&(e.mode&1?(t=ul,ul<<=1,!(ul&130023424)&&(ul=4194304)):t=1);var n=_t();e=rr(e,t),e!==null&&(Ki(e,t,n),zt(e,n))}function iN(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Bx(e,n)}function lN(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Z(314))}r!==null&&r.delete(t),Bx(e,n)}var Ux;Ux=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ut.current)Bt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Bt=!1,KE(e,t,n);Bt=!!(e.flags&131072)}else Bt=!1,$e&&t.flags&1048576&&qg(t,uo,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Fl(e,t),e=t.pendingProps;var a=sa(t,wt.current);Zs(t,n),a=kh(null,t,r,e,a,n);var i=jh();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ht(r)?(i=!0,oo(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Nh(t),a.updater=Vo,t.stateNode=a,a._reactInternals=t,ed(t,r,e,n),t=rd(null,t,r,!0,i,n)):(t.tag=0,$e&&i&&ph(t),kt(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Fl(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=cN(r),e=En(r,e),a){case 0:t=nd(null,t,r,e,n);break e;case 1:t=Af(null,t,r,e,n);break e;case 11:t=kf(null,t,r,e,n);break e;case 14:t=jf(null,t,r,En(r.type,e),n);break e}throw Error(Z(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:En(r,a),nd(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:En(r,a),Af(e,t,r,a,n);case 3:e:{if(Tx(t),e===null)throw Error(Z(387));r=t.pendingProps,i=t.memoizedState,a=i.element,Qg(e,t),fo(t,r,null,n);var l=t.memoizedState;if(r=l.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=oa(Error(Z(423)),t),t=_f(e,t,r,n,a);break e}else if(r!==a){a=oa(Error(Z(424)),t),t=_f(e,t,r,n,a);break e}else for(Xt=Ar(t.stateNode.containerInfo.firstChild),Jt=t,$e=!0,wn=null,n=Kg(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(aa(),r===a){t=sr(e,t,n);break e}kt(e,t,r,n)}t=t.child}return t;case 5:return Xg(t),e===null&&Xu(t),r=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,l=a.children,Yu(r,a)?l=null:i!==null&&Yu(r,i)&&(t.flags|=32),Nx(e,t),kt(e,t,l,n),t.child;case 6:return e===null&&Xu(t),null;case 13:return wx(e,t,n);case 4:return Th(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ia(t,null,r,n):kt(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:En(r,a),kf(e,t,r,a,n);case 7:return kt(e,t,t.pendingProps,n),t.child;case 8:return kt(e,t,t.pendingProps.children,n),t.child;case 12:return kt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,i=t.memoizedProps,l=a.value,Fe(ho,r._currentValue),r._currentValue=l,i!==null)if(_n(i.value,l)){if(i.children===a.children&&!Ut.current){t=sr(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){l=i.child;for(var c=o.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=er(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var m=u.pending;m===null?c.next=c:(c.next=m.next,m.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Ju(i.return,n,t),o.lanes|=n;break}c=c.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(Z(341));l.lanes|=n,o=l.alternate,o!==null&&(o.lanes|=n),Ju(l,n,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}kt(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Zs(t,n),a=mn(a),r=r(a),t.flags|=1,kt(e,t,r,n),t.child;case 14:return r=t.type,a=En(r,t.pendingProps),a=En(r.type,a),jf(e,t,r,a,n);case 15:return vx(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:En(r,a),Fl(e,t),t.tag=1,Ht(r)?(e=!0,oo(t)):e=!1,Zs(t,n),xx(t,r,a),ed(t,r,a,n),rd(null,t,r,!0,e,n);case 19:return Sx(e,t,n);case 22:return Ex(e,t,n)}throw Error(Z(156,t.tag))};function Hx(e,t){return fg(e,t)}function oN(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function un(e,t,n,r){return new oN(e,t,n,r)}function Fh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function cN(e){if(typeof e=="function")return Fh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===rh)return 11;if(e===sh)return 14}return 2}function Rr(e,t){var n=e.alternate;return n===null?(n=un(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Hl(e,t,n,r,a,i){var l=2;if(r=e,typeof e=="function")Fh(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case Os:return ms(n.children,a,i,t);case nh:l=8,a|=8;break;case wu:return e=un(12,n,t,a|2),e.elementType=wu,e.lanes=i,e;case Su:return e=un(13,n,t,a),e.elementType=Su,e.lanes=i,e;case Cu:return e=un(19,n,t,a),e.elementType=Cu,e.lanes=i,e;case X0:return Ko(n,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case G0:l=10;break e;case Q0:l=9;break e;case rh:l=11;break e;case sh:l=14;break e;case gr:l=16,r=null;break e}throw Error(Z(130,e==null?e:typeof e,""))}return t=un(l,n,t,a),t.elementType=e,t.type=r,t.lanes=i,t}function ms(e,t,n,r){return e=un(7,e,r,t),e.lanes=n,e}function Ko(e,t,n,r){return e=un(22,e,r,t),e.elementType=X0,e.lanes=n,e.stateNode={isHidden:!1},e}function Vc(e,t,n){return e=un(6,e,null,t),e.lanes=n,e}function Yc(e,t,n){return t=un(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function uN(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cc(0),this.expirationTimes=Cc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cc(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Bh(e,t,n,r,a,i,l,o,c){return e=new uN(e,t,n,o,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=un(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nh(i),e}function dN(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ms,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function zx(e){if(!e)return Fr;e=e._reactInternals;e:{if(Cs(e)!==e||e.tag!==1)throw Error(Z(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ht(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Z(171))}if(e.tag===1){var n=e.type;if(Ht(n))return zg(e,n,t)}return t}function $x(e,t,n,r,a,i,l,o,c){return e=Bh(n,r,!0,e,a,i,l,o,c),e.context=zx(null),n=e.current,r=_t(),a=Lr(n),i=er(r,a),i.callback=t??null,_r(n,i,a),e.current.lanes=a,Ki(e,a,r),zt(e,r),e}function Go(e,t,n,r){var a=t.current,i=_t(),l=Lr(a);return n=zx(n),t.context===null?t.context=n:t.pendingContext=n,t=er(i,l),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=_r(a,t,l),e!==null&&(jn(e,a,l,i),Ml(e,a,l)),l}function No(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Uf(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Uh(e,t){Uf(e,t),(e=e.alternate)&&Uf(e,t)}function hN(){return null}var qx=typeof reportError=="function"?reportError:function(e){console.error(e)};function Hh(e){this._internalRoot=e}Qo.prototype.render=Hh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Z(409));Go(e,t,null,null)};Qo.prototype.unmount=Hh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;vs(function(){Go(null,e,null,null)}),t[nr]=null}};function Qo(e){this._internalRoot=e}Qo.prototype.unstable_scheduleHydration=function(e){if(e){var t=Eg();e={blockedOn:null,target:e,priority:t};for(var n=0;n<yr.length&&t!==0&&t<yr[n].priority;n++);yr.splice(n,0,e),n===0&&Tg(e)}};function zh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Xo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Hf(){}function mN(e,t,n,r,a){if(a){if(typeof r=="function"){var i=r;r=function(){var u=No(l);i.call(u)}}var l=$x(t,r,e,0,null,!1,!1,"",Hf);return e._reactRootContainer=l,e[nr]=l.current,ki(e.nodeType===8?e.parentNode:e),vs(),l}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var o=r;r=function(){var u=No(c);o.call(u)}}var c=Bh(e,0,!1,null,null,!1,!1,"",Hf);return e._reactRootContainer=c,e[nr]=c.current,ki(e.nodeType===8?e.parentNode:e),vs(function(){Go(t,c,n,r)}),c}function Jo(e,t,n,r,a){var i=n._reactRootContainer;if(i){var l=i;if(typeof a=="function"){var o=a;a=function(){var c=No(l);o.call(c)}}Go(t,l,e,a)}else l=mN(n,t,e,a,r);return No(l)}bg=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Ja(t.pendingLanes);n!==0&&(lh(t,n|1),zt(t,Qe()),!(je&6)&&(ca=Qe()+500,qr()))}break;case 13:vs(function(){var r=rr(e,1);if(r!==null){var a=_t();jn(r,e,1,a)}}),Uh(e,1)}};oh=function(e){if(e.tag===13){var t=rr(e,134217728);if(t!==null){var n=_t();jn(t,e,134217728,n)}Uh(e,134217728)}};vg=function(e){if(e.tag===13){var t=Lr(e),n=rr(e,t);if(n!==null){var r=_t();jn(n,e,t,r)}Uh(e,t)}};Eg=function(){return Re};Ng=function(e,t){var n=Re;try{return Re=e,t()}finally{Re=n}};Ou=function(e,t,n){switch(t){case"input":if(Au(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=zo(r);if(!a)throw Error(Z(90));Z0(r),Au(r,a)}}}break;case"textarea":tg(e,n);break;case"select":t=n.value,t!=null&&Gs(e,!!n.multiple,t,!1)}};og=Mh;cg=vs;var fN={usingClientEntryPoint:!1,Events:[Qi,Us,zo,ig,lg,Mh]},Ba={findFiberByHostInstance:ls,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pN={bundleType:Ba.bundleType,version:Ba.version,rendererPackageName:Ba.rendererPackageName,rendererConfig:Ba.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ir.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=hg(e),e===null?null:e.stateNode},findFiberByHostInstance:Ba.findFiberByHostInstance||hN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var El=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!El.isDisabled&&El.supportsFiber)try{Fo=El.inject(pN),Bn=El}catch{}}tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fN;tn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zh(t))throw Error(Z(200));return dN(e,t,null,n)};tn.createRoot=function(e,t){if(!zh(e))throw Error(Z(299));var n=!1,r="",a=qx;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Bh(e,1,!1,null,null,n,!1,r,a),e[nr]=t.current,ki(e.nodeType===8?e.parentNode:e),new Hh(t)};tn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Z(188)):(e=Object.keys(e).join(","),Error(Z(268,e)));return e=hg(t),e=e===null?null:e.stateNode,e};tn.flushSync=function(e){return vs(e)};tn.hydrate=function(e,t,n){if(!Xo(t))throw Error(Z(200));return Jo(null,e,t,!0,n)};tn.hydrateRoot=function(e,t,n){if(!zh(e))throw Error(Z(405));var r=n!=null&&n.hydratedSources||null,a=!1,i="",l=qx;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),t=$x(t,null,e,1,n??null,a,!1,i,l),e[nr]=t.current,ki(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Qo(t)};tn.render=function(e,t,n){if(!Xo(t))throw Error(Z(200));return Jo(null,e,t,!1,n)};tn.unmountComponentAtNode=function(e){if(!Xo(e))throw Error(Z(40));return e._reactRootContainer?(vs(function(){Jo(null,null,e,!1,function(){e._reactRootContainer=null,e[nr]=null})}),!0):!1};tn.unstable_batchedUpdates=Mh;tn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xo(n))throw Error(Z(200));if(e==null||e._reactInternals===void 0)throw Error(Z(38));return Jo(e,t,n,!1,r)};tn.version="18.3.1-next-f1338f8080-20240426";function Vx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Vx)}catch(e){console.error(e)}}Vx(),V0.exports=tn;var gN=V0.exports,zf=gN;Nu.createRoot=zf.createRoot,Nu.hydrateRoot=zf.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oi(){return Oi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Oi.apply(this,arguments)}var Tr;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Tr||(Tr={}));const $f="popstate";function xN(e){e===void 0&&(e={});function t(r,a){let{pathname:i,search:l,hash:o}=r.location;return pd("",{pathname:i,search:l,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:To(a)}return bN(t,n,null,e)}function We(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Yx(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function yN(){return Math.random().toString(36).substr(2,8)}function qf(e,t){return{usr:e.state,key:e.key,idx:t}}function pd(e,t,n,r){return n===void 0&&(n=null),Oi({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?ya(t):t,{state:n,key:t&&t.key||r||yN()})}function To(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function ya(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function bN(e,t,n,r){r===void 0&&(r={});let{window:a=document.defaultView,v5Compat:i=!1}=r,l=a.history,o=Tr.Pop,c=null,u=m();u==null&&(u=0,l.replaceState(Oi({},l.state,{idx:u}),""));function m(){return(l.state||{idx:null}).idx}function d(){o=Tr.Pop;let T=m(),y=T==null?null:T-u;u=T,c&&c({action:o,location:v.location,delta:y})}function p(T,y){o=Tr.Push;let b=pd(v.location,T,y);u=m()+1;let x=qf(b,u),I=v.createHref(b);try{l.pushState(x,"",I)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;a.location.assign(I)}i&&c&&c({action:o,location:v.location,delta:1})}function f(T,y){o=Tr.Replace;let b=pd(v.location,T,y);u=m();let x=qf(b,u),I=v.createHref(b);l.replaceState(x,"",I),i&&c&&c({action:o,location:v.location,delta:0})}function g(T){let y=a.location.origin!=="null"?a.location.origin:a.location.href,b=typeof T=="string"?T:To(T);return b=b.replace(/ $/,"%20"),We(y,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,y)}let v={get action(){return o},get location(){return e(a,l)},listen(T){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener($f,d),c=T,()=>{a.removeEventListener($f,d),c=null}},createHref(T){return t(a,T)},createURL:g,encodeLocation(T){let y=g(T);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:p,replace:f,go(T){return l.go(T)}};return v}var Vf;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Vf||(Vf={}));function vN(e,t,n){return n===void 0&&(n="/"),EN(e,t,n)}function EN(e,t,n,r){let a=typeof t=="string"?ya(t):t,i=ua(a.pathname||"/",n);if(i==null)return null;let l=Wx(e);NN(l);let o=null;for(let c=0;o==null&&c<l.length;++c){let u=RN(i);o=IN(l[c],u)}return o}function Wx(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let a=(i,l,o)=>{let c={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};c.relativePath.startsWith("/")&&(We(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Pr([r,c.relativePath]),m=n.concat(c);i.children&&i.children.length>0&&(We(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Wx(i.children,t,m,u)),!(i.path==null&&!i.index)&&t.push({path:u,score:AN(u,i.index),routesMeta:m})};return e.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))a(i,l);else for(let c of Kx(i.path))a(i,l,c)}),t}function Kx(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return a?[i,""]:[i];let l=Kx(r.join("/")),o=[];return o.push(...l.map(c=>c===""?i:[i,c].join("/"))),a&&o.push(...l),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function NN(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:_N(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const TN=/^:[\w-]+$/,wN=3,SN=2,CN=1,kN=10,jN=-2,Yf=e=>e==="*";function AN(e,t){let n=e.split("/"),r=n.length;return n.some(Yf)&&(r+=jN),t&&(r+=SN),n.filter(a=>!Yf(a)).reduce((a,i)=>a+(TN.test(i)?wN:i===""?CN:kN),r)}function _N(e,t){return e.length===t.length&&e.slice(0,-1).every((r,a)=>r===t[a])?e[e.length-1]-t[t.length-1]:0}function IN(e,t,n){let{routesMeta:r}=e,a={},i="/",l=[];for(let o=0;o<r.length;++o){let c=r[o],u=o===r.length-1,m=i==="/"?t:t.slice(i.length)||"/",d=gd({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},m),p=c.route;if(!d)return null;Object.assign(a,d.params),l.push({params:a,pathname:Pr([i,d.pathname]),pathnameBase:DN(Pr([i,d.pathnameBase])),route:p}),d.pathnameBase!=="/"&&(i=Pr([i,d.pathnameBase]))}return l}function gd(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=LN(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let i=a[0],l=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:r.reduce((u,m,d)=>{let{paramName:p,isOptional:f}=m;if(p==="*"){let v=o[d]||"";l=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const g=o[d];return f&&!g?u[p]=void 0:u[p]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:l,pattern:e}}function LN(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),Yx(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,c)=>(r.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function RN(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Yx(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function ua(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function PN(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:a=""}=typeof e=="string"?ya(e):e;return{pathname:n?n.startsWith("/")?n:MN(n,t):t,search:FN(r),hash:BN(a)}}function MN(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Wc(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function ON(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function $h(e,t){let n=ON(e);return t?n.map((r,a)=>a===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function qh(e,t,n,r){r===void 0&&(r=!1);let a;typeof e=="string"?a=ya(e):(a=Oi({},e),We(!a.pathname||!a.pathname.includes("?"),Wc("?","pathname","search",a)),We(!a.pathname||!a.pathname.includes("#"),Wc("#","pathname","hash",a)),We(!a.search||!a.search.includes("#"),Wc("#","search","hash",a)));let i=e===""||a.pathname==="",l=i?"/":a.pathname,o;if(l==null)o=n;else{let d=t.length-1;if(!r&&l.startsWith("..")){let p=l.split("/");for(;p[0]==="..";)p.shift(),d-=1;a.pathname=p.join("/")}o=d>=0?t[d]:"/"}let c=PN(a,o),u=l&&l!=="/"&&l.endsWith("/"),m=(i||l===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||m)&&(c.pathname+="/"),c}const Pr=e=>e.join("/").replace(/\/\/+/g,"/"),DN=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),FN=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,BN=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function UN(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Gx=["post","put","patch","delete"];new Set(Gx);const HN=["get",...Gx];new Set(HN);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Di(){return Di=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Di.apply(this,arguments)}const Zo=S.createContext(null),Qx=S.createContext(null),lr=S.createContext(null),ec=S.createContext(null),or=S.createContext({outlet:null,matches:[],isDataRoute:!1}),Xx=S.createContext(null);function zN(e,t){let{relative:n}=t===void 0?{}:t;ba()||We(!1);let{basename:r,navigator:a}=S.useContext(lr),{hash:i,pathname:l,search:o}=tc(e,{relative:n}),c=l;return r!=="/"&&(c=l==="/"?r:Pr([r,l])),a.createHref({pathname:c,search:o,hash:i})}function ba(){return S.useContext(ec)!=null}function Vr(){return ba()||We(!1),S.useContext(ec).location}function Jx(e){S.useContext(lr).static||S.useLayoutEffect(e)}function va(){let{isDataRoute:e}=S.useContext(or);return e?r2():$N()}function $N(){ba()||We(!1);let e=S.useContext(Zo),{basename:t,future:n,navigator:r}=S.useContext(lr),{matches:a}=S.useContext(or),{pathname:i}=Vr(),l=JSON.stringify($h(a,n.v7_relativeSplatPath)),o=S.useRef(!1);return Jx(()=>{o.current=!0}),S.useCallback(function(u,m){if(m===void 0&&(m={}),!o.current)return;if(typeof u=="number"){r.go(u);return}let d=qh(u,JSON.parse(l),i,m.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Pr([t,d.pathname])),(m.replace?r.replace:r.push)(d,m.state,m)},[t,r,l,i,e])}const qN=S.createContext(null);function VN(e){let t=S.useContext(or).outlet;return t&&S.createElement(qN.Provider,{value:e},t)}function tc(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=S.useContext(lr),{matches:a}=S.useContext(or),{pathname:i}=Vr(),l=JSON.stringify($h(a,r.v7_relativeSplatPath));return S.useMemo(()=>qh(e,JSON.parse(l),i,n==="path"),[e,l,i,n])}function YN(e,t){return WN(e,t)}function WN(e,t,n,r){ba()||We(!1);let{navigator:a}=S.useContext(lr),{matches:i}=S.useContext(or),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let c=l?l.pathnameBase:"/";l&&l.route;let u=Vr(),m;if(t){var d;let T=typeof t=="string"?ya(t):t;c==="/"||(d=T.pathname)!=null&&d.startsWith(c)||We(!1),m=T}else m=u;let p=m.pathname||"/",f=p;if(c!=="/"){let T=c.replace(/^\//,"").split("/");f="/"+p.replace(/^\//,"").split("/").slice(T.length).join("/")}let g=vN(e,{pathname:f}),v=JN(g&&g.map(T=>Object.assign({},T,{params:Object.assign({},o,T.params),pathname:Pr([c,a.encodeLocation?a.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?c:Pr([c,a.encodeLocation?a.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),i,n,r);return t&&v?S.createElement(ec.Provider,{value:{location:Di({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Tr.Pop}},v):v}function KN(){let e=n2(),t=UN(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},t),n?S.createElement("pre",{style:a},n):null,null)}const GN=S.createElement(KN,null);class QN extends S.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?S.createElement(or.Provider,{value:this.props.routeContext},S.createElement(Xx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function XN(e){let{routeContext:t,match:n,children:r}=e,a=S.useContext(Zo);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),S.createElement(or.Provider,{value:t},r)}function JN(e,t,n,r){var a;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var i;if(!n)return null;if(n.errors)e=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let l=e,o=(a=n)==null?void 0:a.errors;if(o!=null){let m=l.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);m>=0||We(!1),l=l.slice(0,Math.min(l.length,m+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let m=0;m<l.length;m++){let d=l[m];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=m),d.route.id){let{loaderData:p,errors:f}=n,g=d.route.loader&&p[d.route.id]===void 0&&(!f||f[d.route.id]===void 0);if(d.route.lazy||g){c=!0,u>=0?l=l.slice(0,u+1):l=[l[0]];break}}}return l.reduceRight((m,d,p)=>{let f,g=!1,v=null,T=null;n&&(f=o&&d.route.id?o[d.route.id]:void 0,v=d.route.errorElement||GN,c&&(u<0&&p===0?(s2("route-fallback"),g=!0,T=null):u===p&&(g=!0,T=d.route.hydrateFallbackElement||null)));let y=t.concat(l.slice(0,p+1)),b=()=>{let x;return f?x=v:g?x=T:d.route.Component?x=S.createElement(d.route.Component,null):d.route.element?x=d.route.element:x=m,S.createElement(XN,{match:d,routeContext:{outlet:m,matches:y,isDataRoute:n!=null},children:x})};return n&&(d.route.ErrorBoundary||d.route.errorElement||p===0)?S.createElement(QN,{location:n.location,revalidation:n.revalidation,component:v,error:f,children:b(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):b()},null)}var Zx=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Zx||{}),ey=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ey||{});function ZN(e){let t=S.useContext(Zo);return t||We(!1),t}function e2(e){let t=S.useContext(Qx);return t||We(!1),t}function t2(e){let t=S.useContext(or);return t||We(!1),t}function ty(e){let t=t2(),n=t.matches[t.matches.length-1];return n.route.id||We(!1),n.route.id}function n2(){var e;let t=S.useContext(Xx),n=e2(),r=ty();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function r2(){let{router:e}=ZN(Zx.UseNavigateStable),t=ty(ey.UseNavigateStable),n=S.useRef(!1);return Jx(()=>{n.current=!0}),S.useCallback(function(a,i){i===void 0&&(i={}),n.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Di({fromRouteId:t},i)))},[e,t])}const Wf={};function s2(e,t,n){Wf[e]||(Wf[e]=!0)}function a2(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Ws(e){let{to:t,replace:n,state:r,relative:a}=e;ba()||We(!1);let{future:i,static:l}=S.useContext(lr),{matches:o}=S.useContext(or),{pathname:c}=Vr(),u=va(),m=qh(t,$h(o,i.v7_relativeSplatPath),c,a==="path"),d=JSON.stringify(m);return S.useEffect(()=>u(JSON.parse(d),{replace:n,state:r,relative:a}),[u,d,a,n,r]),null}function i2(e){return VN(e.context)}function yt(e){We(!1)}function l2(e){let{basename:t="/",children:n=null,location:r,navigationType:a=Tr.Pop,navigator:i,static:l=!1,future:o}=e;ba()&&We(!1);let c=t.replace(/^\/*/,"/"),u=S.useMemo(()=>({basename:c,navigator:i,static:l,future:Di({v7_relativeSplatPath:!1},o)}),[c,o,i,l]);typeof r=="string"&&(r=ya(r));let{pathname:m="/",search:d="",hash:p="",state:f=null,key:g="default"}=r,v=S.useMemo(()=>{let T=ua(m,c);return T==null?null:{location:{pathname:T,search:d,hash:p,state:f,key:g},navigationType:a}},[c,m,d,p,f,g,a]);return v==null?null:S.createElement(lr.Provider,{value:u},S.createElement(ec.Provider,{children:n,value:v}))}function o2(e){let{children:t,location:n}=e;return YN(xd(t),n)}new Promise(()=>{});function xd(e,t){t===void 0&&(t=[]);let n=[];return S.Children.forEach(e,(r,a)=>{if(!S.isValidElement(r))return;let i=[...t,a];if(r.type===S.Fragment){n.push.apply(n,xd(r.props.children,i));return}r.type!==yt&&We(!1),!r.props.index||!r.props.children||We(!1);let l={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=xd(r.props.children,i)),n.push(l)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wo(){return wo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},wo.apply(this,arguments)}function ny(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,i;for(i=0;i<r.length;i++)a=r[i],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function c2(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function u2(e,t){return e.button===0&&(!t||t==="_self")&&!c2(e)}function yd(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(a=>[n,a]):[[n,r]])},[]))}function d2(e,t){let n=yd(e);return t&&t.forEach((r,a)=>{n.has(a)||t.getAll(a).forEach(i=>{n.append(a,i)})}),n}const h2=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],m2=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],f2="6";try{window.__reactRouterVersion=f2}catch{}const p2=S.createContext({isTransitioning:!1}),g2="startTransition",Kf=av[g2];function x2(e){let{basename:t,children:n,future:r,window:a}=e,i=S.useRef();i.current==null&&(i.current=xN({window:a,v5Compat:!0}));let l=i.current,[o,c]=S.useState({action:l.action,location:l.location}),{v7_startTransition:u}=r||{},m=S.useCallback(d=>{u&&Kf?Kf(()=>c(d)):c(d)},[c,u]);return S.useLayoutEffect(()=>l.listen(m),[l,m]),S.useEffect(()=>a2(r),[r]),S.createElement(l2,{basename:t,children:n,location:o.location,navigationType:o.action,navigator:l,future:r})}const y2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",b2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,v2=S.forwardRef(function(t,n){let{onClick:r,relative:a,reloadDocument:i,replace:l,state:o,target:c,to:u,preventScrollReset:m,viewTransition:d}=t,p=ny(t,h2),{basename:f}=S.useContext(lr),g,v=!1;if(typeof u=="string"&&b2.test(u)&&(g=u,y2))try{let x=new URL(window.location.href),I=u.startsWith("//")?new URL(x.protocol+u):new URL(u),C=ua(I.pathname,f);I.origin===x.origin&&C!=null?u=C+I.search+I.hash:v=!0}catch{}let T=zN(u,{relative:a}),y=T2(u,{replace:l,state:o,target:c,preventScrollReset:m,relative:a,viewTransition:d});function b(x){r&&r(x),x.defaultPrevented||y(x)}return S.createElement("a",wo({},p,{href:g||T,onClick:v||i?r:b,ref:n,target:c}))}),E2=S.forwardRef(function(t,n){let{"aria-current":r="page",caseSensitive:a=!1,className:i="",end:l=!1,style:o,to:c,viewTransition:u,children:m}=t,d=ny(t,m2),p=tc(c,{relative:d.relative}),f=Vr(),g=S.useContext(Qx),{navigator:v,basename:T}=S.useContext(lr),y=g!=null&&w2(p)&&u===!0,b=v.encodeLocation?v.encodeLocation(p).pathname:p.pathname,x=f.pathname,I=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;a||(x=x.toLowerCase(),I=I?I.toLowerCase():null,b=b.toLowerCase()),I&&T&&(I=ua(I,T)||I);const C=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let E=x===b||!l&&x.startsWith(b)&&x.charAt(C)==="/",N=I!=null&&(I===b||!l&&I.startsWith(b)&&I.charAt(b.length)==="/"),O={isActive:E,isPending:N,isTransitioning:y},D=E?r:void 0,A;typeof i=="function"?A=i(O):A=[i,E?"active":null,N?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let z=typeof o=="function"?o(O):o;return S.createElement(v2,wo({},d,{"aria-current":D,className:A,ref:n,style:z,to:c,viewTransition:u}),typeof m=="function"?m(O):m)});var bd;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(bd||(bd={}));var Gf;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Gf||(Gf={}));function N2(e){let t=S.useContext(Zo);return t||We(!1),t}function T2(e,t){let{target:n,replace:r,state:a,preventScrollReset:i,relative:l,viewTransition:o}=t===void 0?{}:t,c=va(),u=Vr(),m=tc(e,{relative:l});return S.useCallback(d=>{if(u2(d,n)){d.preventDefault();let p=r!==void 0?r:To(u)===To(m);c(e,{replace:p,state:a,preventScrollReset:i,relative:l,viewTransition:o})}},[u,c,m,r,a,n,e,i,l,o])}function ry(e){let t=S.useRef(yd(e)),n=S.useRef(!1),r=Vr(),a=S.useMemo(()=>d2(r.search,n.current?null:t.current),[r.search]),i=va(),l=S.useCallback((o,c)=>{const u=yd(typeof o=="function"?o(a):o);n.current=!0,i("?"+u,c)},[i,a]);return[a,l]}function w2(e,t){t===void 0&&(t={});let n=S.useContext(p2);n==null&&We(!1);let{basename:r}=N2(bd.useViewTransitionState),a=tc(e,{relative:t.relative});if(!n.isTransitioning)return!1;let i=ua(n.currentLocation.pathname,r)||n.currentLocation.pathname,l=ua(n.nextLocation.pathname,r)||n.nextLocation.pathname;return gd(a.pathname,l)!=null||gd(a.pathname,i)!=null}const S2={},Qf=e=>{let t;const n=new Set,r=(m,d)=>{const p=typeof m=="function"?m(t):m;if(!Object.is(p,t)){const f=t;t=d??(typeof p!="object"||p===null)?p:Object.assign({},t,p),n.forEach(g=>g(t,f))}},a=()=>t,c={setState:r,getState:a,getInitialState:()=>u,subscribe:m=>(n.add(m),()=>n.delete(m)),destroy:()=>{(S2?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(r,a,c);return c},C2=e=>e?Qf(e):Qf;var sy={exports:{}},ay={},iy={exports:{}},ly={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var da=S;function k2(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var j2=typeof Object.is=="function"?Object.is:k2,A2=da.useState,_2=da.useEffect,I2=da.useLayoutEffect,L2=da.useDebugValue;function R2(e,t){var n=t(),r=A2({inst:{value:n,getSnapshot:t}}),a=r[0].inst,i=r[1];return I2(function(){a.value=n,a.getSnapshot=t,Kc(a)&&i({inst:a})},[e,n,t]),_2(function(){return Kc(a)&&i({inst:a}),e(function(){Kc(a)&&i({inst:a})})},[e]),L2(n),n}function Kc(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!j2(e,n)}catch{return!0}}function P2(e,t){return t()}var M2=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?P2:R2;ly.useSyncExternalStore=da.useSyncExternalStore!==void 0?da.useSyncExternalStore:M2;iy.exports=ly;var O2=iy.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nc=S,D2=O2;function F2(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var B2=typeof Object.is=="function"?Object.is:F2,U2=D2.useSyncExternalStore,H2=nc.useRef,z2=nc.useEffect,$2=nc.useMemo,q2=nc.useDebugValue;ay.useSyncExternalStoreWithSelector=function(e,t,n,r,a){var i=H2(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=$2(function(){function c(f){if(!u){if(u=!0,m=f,f=r(f),a!==void 0&&l.hasValue){var g=l.value;if(a(g,f))return d=g}return d=f}if(g=d,B2(m,f))return g;var v=r(f);return a!==void 0&&a(g,v)?(m=f,g):(m=f,d=v)}var u=!1,m,d,p=n===void 0?null:n;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,n,r,a]);var o=U2(e,i[0],i[1]);return z2(function(){l.hasValue=!0,l.value=o},[o]),q2(o),o};sy.exports=ay;var V2=sy.exports;const Y2=Oo(V2),oy={},{useDebugValue:W2}=Wi,{useSyncExternalStoreWithSelector:K2}=Y2;let Xf=!1;const G2=e=>e;function Q2(e,t=G2,n){(oy?"production":void 0)!=="production"&&n&&!Xf&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Xf=!0);const r=K2(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return W2(r),r}const Jf=e=>{(oy?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?C2(e):e,n=(r,a)=>Q2(t,r,a);return Object.assign(n,t),n},rc=e=>e?Jf(e):Jf,X2=e=>(t,n,r)=>{const a=r.subscribe;return r.subscribe=(l,o,c)=>{let u=l;if(o){const m=(c==null?void 0:c.equalityFn)||Object.is;let d=l(r.getState());u=p=>{const f=l(p);if(!m(d,f)){const g=d;o(d=f,g)}},c!=null&&c.fireImmediately&&o(d,d)}return a(u)},e(t,n,r)},cy=X2,Nl={"A1B2C3D4-E5F6-7G8H-9I0J-K1L2M3N4O5P6":{id:"A1B2C3D4-E5F6-7G8H-9I0J-K1L2M3N4O5P6",name:"ACME Corporation",subscriptionTier:"enterprise",status:"active",region:"australia-east",createdAt:"2024-01-15T00:00:00Z",updatedAt:"2024-08-19T00:00:00Z",settings:{enabledFeatures:["mcp-tools","byo-llm","advanced-audit","compliance-reports"],mcpToolsEnabled:["archer-connector","risk-analyzer","compliance-checker"],byoLlmEnabled:!0,auditRetentionDays:2555,allowedMcpServers:["archer","servicenow","azure-sentinel"],complianceFrameworks:["ISO27001","CPS230"]},quota:{dailyApiCalls:1e4,monthlyTokens:1e6,storageGB:100,users:50,currentUsage:{apiCalls:2847,tokens:245e3,storage:23.5,users:12}}},"tenant-fintech":{id:"tenant-fintech",name:"FinTech Solutions Ltd",subscriptionTier:"professional",status:"active",region:"australia-east",createdAt:"2024-03-01T00:00:00Z",updatedAt:"2024-08-19T00:00:00Z",settings:{enabledFeatures:["mcp-tools","compliance-reports"],mcpToolsEnabled:["archer-connector","compliance-checker"],byoLlmEnabled:!1,auditRetentionDays:2555,allowedMcpServers:["archer","azure-sentinel"],complianceFrameworks:["CPS230","SOC2"]},quota:{dailyApiCalls:5e3,monthlyTokens:5e5,storageGB:50,users:25,currentUsage:{apiCalls:1234,tokens:156e3,storage:18.2,users:8}}}},J2={"user1@acme.com":{id:"user-001",email:"user1@acme.com",name:"Sarah Chen",tenantId:"A1B2C3D4-E5F6-7G8H-9I0J-K1L2M3N4O5P6",roles:["TenantOwner"],lastLogin:"2024-08-19T08:30:00Z",isActive:!0,mfaEnabled:!0},"analyst@acme.com":{id:"user-002",email:"analyst@acme.com",name:"Mike Johnson",tenantId:"A1B2C3D4-E5F6-7G8H-9I0J-K1L2M3N4O5P6",roles:["AgentUser"],lastLogin:"2024-08-19T07:15:00Z",isActive:!0,mfaEnabled:!0},"audit@acme.com":{id:"user-003",email:"audit@acme.com",name:"Lisa Wang",tenantId:"A1B2C3D4-E5F6-7G8H-9I0J-K1L2M3N4O5P6",roles:["Auditor","ComplianceOfficer"],lastLogin:"2024-08-18T16:45:00Z",isActive:!0,mfaEnabled:!0},"owner@fintech.com":{id:"user-004",email:"owner@fintech.com",name:"David Smith",tenantId:"tenant-fintech",roles:["TenantOwner"],lastLogin:"2024-08-19T09:00:00Z",isActive:!0,mfaEnabled:!0},"admin@platform.com":{id:"user-005",email:"admin@platform.com",name:"Alex Rodriguez",tenantId:"A1B2C3D4-E5F6-7G8H-9I0J-K1L2M3N4O5P6",roles:["PlatformOwner"],lastLogin:"2024-08-20T10:15:00Z",isActive:!0,mfaEnabled:!0}},is=class is{constructor(){_e(this,"currentToken",null)}static getInstance(){return is.instance||(is.instance=new is),is.instance}async login(t,n){await new Promise(l=>setTimeout(l,1500));const r=J2[t];if(!r)throw new Error("Invalid email or password. Please check your credentials.");if(n!==void 0&&!n)throw new Error("Password is required");const a=Nl[r.tenantId];if(!a||a.status!=="active")throw new Error("Tenant not active or not found");const i={tenantId:r.tenantId,userId:r.id,email:r.email,name:r.name,roles:r.roles,iat:Math.floor(Date.now()/1e3),exp:Math.floor(Date.now()/1e3)+86400,aud:"api://your-saas",iss:"https://your-tenant.b2clogin.com/your-tenant.onmicrosoft.com/v2.0/"};return this.currentToken=i,localStorage.setItem("auth_token",JSON.stringify(i)),localStorage.setItem("current_user",JSON.stringify(r)),localStorage.setItem("current_tenant",JSON.stringify(a)),{token:i,user:r,tenant:a}}isAuthenticated(){try{const t=this.getCurrentToken();return t?t.exp>Math.floor(Date.now()/1e3):!1}catch(t){return console.error("Error checking authentication:",t),!1}}getCurrentToken(){if(this.currentToken&&this.currentToken.exp>Math.floor(Date.now()/1e3))return this.currentToken;const t=localStorage.getItem("auth_token");if(t)try{const n=JSON.parse(t);if(n.exp>Math.floor(Date.now()/1e3))return this.currentToken=n,n}catch{}return null}getCurrentUser(){const t=localStorage.getItem("current_user");if(t)try{return JSON.parse(t)}catch{return null}return null}getCurrentTenant(){const t=localStorage.getItem("current_tenant");if(t)try{return JSON.parse(t)}catch{return null}return null}async switchTenant(t){if(!this.getCurrentUser())throw new Error("Not authenticated");const r=Nl[t];if(!r)throw new Error("Tenant not found");localStorage.setItem("current_tenant",JSON.stringify(r));const a=this.getCurrentToken();return a&&(a.tenantId=t,this.currentToken=a,localStorage.setItem("auth_token",JSON.stringify(a))),r}async logout(){this.currentToken=null,localStorage.removeItem("auth_token"),localStorage.removeItem("current_user"),localStorage.removeItem("current_tenant")}hasRole(t){const n=this.getCurrentUser();return(n==null?void 0:n.roles.includes(t))||!1}hasPermission(t,n){const r=this.getCurrentUser();return r?r.roles.includes("PlatformOwner")||r.roles.includes("TenantOwner")?!0:r.roles.includes("Auditor")||r.roles.includes("ComplianceOfficer")?n==="read":r.roles.includes("AgentUser")?n==="read"||t.includes("agent")&&n==="execute":!1:!1}async getAvailableTenants(){const t=this.getCurrentUser();return t?t.roles.includes("PlatformOwner")?Object.values(Nl):Object.values(Nl).filter(n=>n.id===t.tenantId):[]}};_e(is,"instance");let vd=is;const Wt=vd.getInstance();let Gc=null;const it=rc()(cy((e,t)=>({isAuthenticated:!1,isLoading:!1,isInitialized:!1,token:null,user:null,tenant:null,availableTenants:[],error:null,login:async(n,r)=>{console.log("Auth store: Starting login process for",n,r?"(with password)":"(demo mode)"),e({isLoading:!0,error:null});try{const{token:a,user:i,tenant:l}=await Wt.login(n,r),o=await Wt.getAvailableTenants();console.log("Auth store: Login successful",{user:i.name,tenant:l.name}),e({isAuthenticated:!0,isLoading:!1,isInitialized:!0,token:a,user:i,tenant:l,availableTenants:o,error:null})}catch(a){console.error("Auth store: Login failed",a),e({isAuthenticated:!1,isLoading:!1,token:null,user:null,tenant:null,error:a instanceof Error?a.message:"Login failed"})}},logout:async()=>{var n,r;e({isLoading:!0});try{const a=t();if((n=a.tenant)!=null&&n.id)try{const i=Object.keys(localStorage).filter(l=>l.startsWith(`chat_session_${a.tenant.id}_`));i.forEach(l=>localStorage.removeItem(l)),console.log(`Cleared ${i.length} chat sessions on logout for tenant ${a.tenant.id}`)}catch(i){console.warn("Failed to clear chat sessions on logout:",i)}try{(r=a.tenant)!=null&&r.id&&localStorage.removeItem(`chat_session_${a.tenant.id}_global`)}catch(i){console.warn("Failed to clear global chat state on logout:",i)}await Wt.logout(),e({isAuthenticated:!1,isLoading:!1,isInitialized:!1,token:null,user:null,tenant:null,availableTenants:[],error:null})}catch(a){e({isLoading:!1,error:a instanceof Error?a.message:"Logout failed"})}},switchTenant:async n=>{e({isLoading:!0,error:null});try{const r=await Wt.switchTenant(n);e({tenant:r,isLoading:!1,error:null})}catch(r){e({isLoading:!1,error:r instanceof Error?r.message:"Failed to switch tenant"})}},initializeAuth:()=>{if(!t().isInitialized){console.log("Auth store: Initializing authentication state");try{const r=Wt.isAuthenticated(),a=Wt.getCurrentToken(),i=Wt.getCurrentUser(),l=Wt.getCurrentTenant();console.log("Auth store: Initial auth check results",{isAuth:r,hasToken:!!a,hasUser:!!i,hasTenant:!!l}),r&&a&&i&&l?(console.log("Auth store: Restoring authenticated state on init",{user:i.name,tenant:l.name}),e({isAuthenticated:!0,isInitialized:!0,token:a,user:i,tenant:l,availableTenants:[l],error:null})):(console.log("Auth store: No valid authentication found on init"),e({isAuthenticated:!1,isInitialized:!0,token:null,user:null,tenant:null,availableTenants:[],error:null}))}catch(r){console.error("Auth store: Error during initialization",r),e({isAuthenticated:!1,isInitialized:!0,token:null,user:null,tenant:null,availableTenants:[],error:r instanceof Error?r.message:"Authentication initialization failed"})}}},refreshAuth:async()=>{if(t().isLoading){console.log("Auth store: Refresh already in progress, skipping");return}return Gc&&clearTimeout(Gc),new Promise(r=>{Gc=setTimeout(async()=>{console.log("Auth store: Refreshing authentication state"),e({isLoading:!0});try{const a=Wt.isAuthenticated(),i=Wt.getCurrentToken(),l=Wt.getCurrentUser(),o=Wt.getCurrentTenant();if(console.log("Auth store: Auth check results",{isAuth:a,hasToken:!!i,hasUser:!!l,hasTenant:!!o}),a&&i&&l&&o){const c=await Wt.getAvailableTenants();console.log("Auth store: Restoring authenticated state",{user:l.name,tenant:o.name}),e({isAuthenticated:!0,isLoading:!1,isInitialized:!0,token:i,user:l,tenant:o,availableTenants:c,error:null})}else console.log("Auth store: No valid authentication found"),e({isAuthenticated:!1,isLoading:!1,isInitialized:!0,token:null,user:null,tenant:null,availableTenants:[],error:null})}catch(a){console.error("Auth store: Error during refresh",a),e({isAuthenticated:!1,isLoading:!1,isInitialized:!0,token:null,user:null,tenant:null,availableTenants:[],error:a instanceof Error?a.message:"Authentication refresh failed"})}r()},300)})},clearError:()=>e({error:null})})));it.subscribe(e=>e.isAuthenticated,e=>{e||console.log("User logged out, clearing cached data")});const Z2=e=>[{tenantId:e,agentId:"agent-grc-analyzer",name:"GRC Risk Analyzer",description:"AI agent for analyzing governance, risk, and compliance data",enabledTools:["archer-connector","risk-calculator","compliance-checker"],llmConfig:{provider:"azure-openai",model:"gpt-4",temperature:.3,maxTokens:2e3},auditLevel:"enhanced",rateLimits:{requestsPerMinute:60,tokensPerHour:5e4,dailyBudget:100},isActive:!0,createdAt:"2024-07-15T10:00:00Z",updatedAt:"2024-08-19T09:00:00Z"},{tenantId:e,agentId:"agent-compliance-monitor",name:"Compliance Monitor",description:"Continuous monitoring of compliance requirements and controls",enabledTools:["archer-connector","compliance-checker","audit-trail"],llmConfig:{provider:"azure-openai",model:"gpt-3.5-turbo",temperature:.2,maxTokens:1500},auditLevel:"full",rateLimits:{requestsPerMinute:30,tokensPerHour:25e3,dailyBudget:50},isActive:!0,createdAt:"2024-08-01T14:30:00Z",updatedAt:"2024-08-19T08:30:00Z"},{tenantId:e,agentId:"agent-risk-reporter",name:"Risk Reporter",description:"Generates risk assessment reports and insights",enabledTools:["risk-calculator","report-generator"],llmConfig:{provider:"azure-openai",model:"gpt-4",temperature:.1,maxTokens:3e3},auditLevel:"basic",rateLimits:{requestsPerMinute:20,tokensPerHour:3e4,dailyBudget:75},isActive:!1,createdAt:"2024-06-20T11:15:00Z",updatedAt:"2024-08-10T16:20:00Z"}],eT=e=>({totalAgents:3,activeAgents:2,healthyAgents:2,todayQueries:47,weeklyGrowth:12.5,averageResponseTime:850,tokenUsage:{current:245e3,limit:1e6,percentage:24.5},apiCalls:{current:2847,limit:1e4,percentage:28.47},riskScore:7.2,complianceScore:94.8,criticalFindings:3,openRisks:12}),tT=e=>[{id:"query-001",tenantId:e,agentId:"agent-grc-analyzer",query:"What are the current high-risk findings in our ISO 27001 assessment?",response:{content:"I found 3 high-risk findings in your current ISO 27001 assessment: 1) Inadequate access control reviews (A.9.2.5), 2) Missing encryption for data in transit (A.10.1.1), 3) Incomplete incident response documentation (A.16.1.2). Each requires immediate attention to maintain compliance.",confidence:.92,toolsUsed:["archer-connector","compliance-checker"],evidence:[{source:"Archer GRC Platform",excerpt:"Control A.9.2.5: Last review completed 14 months ago",relevanceScore:.95,metadata:{controlId:"A.9.2.5",lastReview:"2023-06-15"}}],complianceFlags:[{framework:"ISO27001",rule:"A.9.2.5",severity:"critical",description:"Access control review exceeds maximum allowed interval"}],tokenUsage:{promptTokens:150,completionTokens:280,totalTokens:430,cost:.0086}},status:"completed",timestamp:"2024-08-19T09:15:00Z",userId:"user-001"},{id:"query-002",tenantId:e,agentId:"agent-compliance-monitor",query:"Generate a summary of this quarter's compliance posture",status:"processing",timestamp:"2024-08-19T09:45:00Z",userId:"user-002"}],Vh=rc()(cy((e,t)=>({activeView:"executive",sidebarCollapsed:!1,agents:[],agentHealth:{},recentQueries:[],riskAssessments:[],complianceReports:[],recentAuditEvents:[],metrics:{totalAgents:0,activeAgents:0,healthyAgents:0,todayQueries:0,weeklyGrowth:0,averageResponseTime:0,tokenUsage:{current:0,limit:0,percentage:0},apiCalls:{current:0,limit:0,percentage:0},riskScore:0,complianceScore:0,criticalFindings:0,openRisks:0},isLoadingMetrics:!1,setActiveView:n=>e({activeView:n}),toggleSidebar:()=>e(n=>({sidebarCollapsed:!n.sidebarCollapsed})),loadDashboardData:async n=>{e({isLoadingMetrics:!0});try{await new Promise(o=>setTimeout(o,1e3));const r=Z2(n),a=eT(n),i=tT(n),l={};r.forEach(o=>{l[o.agentId]={status:o.isActive?"healthy":"unhealthy",lastCheck:new Date().toISOString(),responseTime:Math.floor(Math.random()*2e3)+200,errorCount:Math.floor(Math.random()*5),uptime:Math.random()*.1+.9}}),e({agents:r,agentHealth:l,recentQueries:i,metrics:a,isLoadingMetrics:!1})}catch(r){console.error("Failed to load dashboard data:",r),e({isLoadingMetrics:!1})}},refreshMetrics:async n=>{const r=t().metrics;try{await new Promise(i=>setTimeout(i,500));const a={...r,todayQueries:r.todayQueries+Math.floor(Math.random()*3),averageResponseTime:r.averageResponseTime+(Math.random()-.5)*100,tokenUsage:{...r.tokenUsage,current:Math.min(r.tokenUsage.current+Math.floor(Math.random()*1e3),r.tokenUsage.limit)}};a.tokenUsage.percentage=a.tokenUsage.current/a.tokenUsage.limit*100,e({metrics:a})}catch(a){console.error("Failed to refresh metrics:",a)}},updateAgentHealth:(n,r)=>{e(a=>({agentHealth:{...a.agentHealth,[n]:r}}))}})));function uy(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=uy(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Ee(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=uy(e))&&(r&&(r+=" "),r+=t);return r}const Zf={variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm hover:shadow-md hover:scale-105 active:scale-95",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm hover:shadow-md",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground shadow-sm hover:shadow-md",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm hover:shadow-md",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-success text-success-foreground hover:bg-success/90 shadow-sm hover:shadow-md",warning:"bg-warning text-warning-foreground hover:bg-warning/90 shadow-sm hover:shadow-md",gradient:"bg-gradient-blue text-white shadow-md hover:shadow-lg hover:scale-105 active:scale-95"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},G=S.forwardRef(({className:e,variant:t="default",size:n="default",...r},a)=>s.jsx("button",{className:Ee("inline-flex items-center justify-center whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",Zf.variant[t],Zf.size[n],e),ref:a,...r}));G.displayName="Button";var nT={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const rT=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),sT=(e,t)=>{const n=S.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:l,children:o,...c},u)=>S.createElement("svg",{ref:u,...nT,width:a,height:a,stroke:r,strokeWidth:l?Number(i)*24/Number(a):i,className:`lucide lucide-${rT(e)}`,...c},[...t.map(([m,d])=>S.createElement(m,d)),...(Array.isArray(o)?o:[o])||[]]));return n.displayName=`${e}`,n};var se=sT;const vt=se("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),us=se("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),ue=se("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),aT=se("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Mr=se("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),dy=se("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Es=se("Bot",[["rect",{width:"18",height:"10",x:"3",y:"11",rx:"2",key:"1ofdy3"}],["circle",{cx:"12",cy:"5",r:"2",key:"f1ur92"}],["path",{d:"M12 7v4",key:"xawao1"}],["line",{x1:"8",x2:"8",y1:"16",y2:"16",key:"h6x27f"}],["line",{x1:"16",x2:"16",y1:"16",y2:"16",key:"5lty7f"}]]),At=se("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),iT=se("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),Ed=se("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),Nd=se("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),Ji=se("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),lT=se("CheckCircle2",[["path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",key:"14v8dr"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Le=se("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),oT=se("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),So=se("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),cT=se("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),uT=se("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),dT=se("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Tt=se("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),hT=se("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),mT=se("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]),at=se("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Yh=se("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Wh=se("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),sc=se("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Fi=se("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),hy=se("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),Ns=se("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),ep=se("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),dn=se("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),my=se("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),tt=se("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Co=se("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),fT=se("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),fy=se("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),pT=se("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),gT=se("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),xT=se("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),yT=se("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),Kh=se("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),Gh=se("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),bT=se("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Qh=se("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),pn=se("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),$t=se("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),vT=se("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),py=se("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Xh=se("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Br=se("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]),dt=se("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ge=se("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),ET=se("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),NT=se("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),Ur=se("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Bi=se("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]),TT=se("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z",key:"s6e0r"}]]),wT=se("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]),Ea=se("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Ui=se("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),zn=se("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),gy=se("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),xy=se("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Ts=se("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Hi=se("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),tp=se("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),np=se("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),ko=se("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Jh=se("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ar=se("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),ST=()=>{const{user:e,tenant:t}=it(),{sidebarCollapsed:n,toggleSidebar:r}=Vh(),a=Vr();if(!e||!t)return null;const l=[{title:"Overview",items:[]},{title:"AI & Automation",items:[{href:"/agents",icon:s.jsx(Es,{className:"h-5 w-5"}),label:"AI Agents",roles:["TenantOwner","AgentUser"]},{href:"/analytics",icon:s.jsx(Mr,{className:"h-5 w-5"}),label:"Analytics",roles:["TenantOwner","AgentUser","ComplianceOfficer","Auditor","Platform Owner","admin"],badge:"Live"}]},{title:"Configuration",items:[{href:"/connections",icon:s.jsx(my,{className:"h-5 w-5"}),label:"Connections",roles:["TenantOwner"]},{href:"/settings",icon:s.jsx(dt,{className:"h-5 w-5"}),label:"Settings",roles:["TenantOwner"]}]},{title:"Administration",items:[{href:"/users",icon:s.jsx(Hi,{className:"h-5 w-5"}),label:"User Management",roles:["TenantOwner"]},{href:"/audit",icon:s.jsx(Fi,{className:"h-5 w-5"}),label:"Audit Trail",roles:["TenantOwner","Auditor","ComplianceOfficer"]}]}].map(c=>({...c,items:c.items.filter(u=>u.roles.some(m=>e.roles.includes(m)))})).filter(c=>c.items.length>0),o=c=>c==="/dashboard"?a.pathname==="/dashboard"||a.pathname==="/":a.pathname.startsWith(c);return s.jsxs("div",{className:Ee("fixed left-0 top-0 z-50 h-full bg-card border-r transition-all duration-300 flex flex-col",n?"w-16":"w-64"),children:[s.jsx("div",{className:"p-4 border-b",children:s.jsxs("div",{className:"flex items-center justify-between",children:[!n&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ge,{className:"h-8 w-8 text-primary"}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold",children:"RMX AI Hub"}),s.jsx("p",{className:"text-xs text-muted-foreground truncate",children:t.name})]})]}),s.jsx(G,{variant:"ghost",size:"icon",onClick:r,className:"shrink-0",children:n?s.jsx(uT,{className:"h-4 w-4"}):s.jsx(cT,{className:"h-4 w-4"})})]})}),n&&s.jsx("div",{className:"p-2 border-b",children:s.jsx("div",{className:"flex justify-center",children:s.jsx(ge,{className:"h-8 w-8 text-primary"})})}),s.jsx("nav",{className:"flex-1 p-4 overflow-y-auto",children:l.map(c=>s.jsxs("div",{className:"mb-6 last:mb-0",children:[!n&&s.jsx("h3",{className:"mb-2 px-3 text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:c.title}),s.jsx("div",{className:"space-y-1",children:c.items.map(u=>s.jsxs(E2,{to:u.href,className:({isActive:m})=>Ee("flex items-center space-x-3 px-3 py-2 rounded-md text-sm font-medium transition-colors",o(u.href)||m?"bg-primary text-primary-foreground":"text-foreground hover:bg-accent hover:text-accent-foreground",n&&"justify-center px-2"),title:n?u.label:void 0,children:[s.jsx("div",{className:Ee(n&&"scale-125 transform"),children:u.icon}),!n&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"flex-1",children:u.label}),u.badge&&s.jsx("span",{className:"bg-primary/20 text-primary text-xs px-2 py-0.5 rounded-full",children:u.badge})]})]},u.href))})]},c.title))})]})},CT=()=>{const e=va(),{user:t,tenant:n,availableTenants:r,switchTenant:a,logout:i}=it(),{refreshMetrics:l}=Vh(),[o,c]=S.useState(!1),[u,m]=S.useState(!1),[d,p]=S.useState(document.documentElement.classList.contains("dark"));if(!t||!n)return null;const f=async b=>{b!==n.id&&await a(b),m(!1)},g=()=>{const b=!d;p(b),document.documentElement.classList.toggle("dark",b),localStorage.setItem("theme",b?"dark":"light")},v=()=>{l(n.id)},T=async()=>{c(!1);try{await i(),e("/login",{replace:!0})}catch(b){console.error("Logout failed:",b),e("/login",{replace:!0})}},y=b=>{switch(b){case"active":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"suspended":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";case"provisioning":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"}};return s.jsxs("header",{className:"h-16 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 sticky top-0 z-40",children:[s.jsxs("div",{className:"flex h-full items-center px-6",children:[s.jsx("div",{className:"flex-1 max-w-md",children:s.jsxs("div",{className:"relative",children:[s.jsx(Xh,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),s.jsx("input",{type:"text",placeholder:"Search agents, tools, or ask GRC questions...",className:"w-full bg-muted/50 border-0 pl-10 pr-4 py-2 text-sm rounded-md focus:outline-none focus:ring-2 focus:ring-ring"})]})}),s.jsxs("div",{className:"flex items-center space-x-4 ml-6",children:[s.jsx(G,{variant:"ghost",size:"icon",onClick:v,title:"Refresh dashboard data",children:s.jsx($t,{className:"h-4 w-4"})}),s.jsx(G,{variant:"ghost",size:"icon",onClick:g,title:"Toggle theme",children:d?s.jsx(NT,{className:"h-4 w-4"}):s.jsx(gT,{className:"h-4 w-4"})}),s.jsxs(G,{variant:"ghost",size:"icon",className:"relative",children:[s.jsx(dy,{className:"h-4 w-4"}),s.jsx("span",{className:"absolute -top-1 -right-1 h-3 w-3 bg-red-500 rounded-full text-[10px] text-white flex items-center justify-center",children:"3"})]}),s.jsxs("div",{className:"relative",children:[t.roles.includes("PlatformOwner")||r.length>1?s.jsxs(G,{variant:"outline",className:"flex items-center space-x-2",onClick:()=>m(!u),children:[s.jsx(Nd,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline max-w-32 truncate",children:n.name}),s.jsx("span",{className:Ee("px-2 py-0.5 rounded-full text-xs font-medium",y(n.status)),children:n.status}),s.jsx(So,{className:"h-4 w-4"})]}):s.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 border rounded-md bg-muted/20",children:[s.jsx(Nd,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline max-w-32 truncate",children:n.name}),s.jsx("span",{className:Ee("px-2 py-0.5 rounded-full text-xs font-medium",y(n.status)),children:n.status})]}),u&&(t.roles.includes("PlatformOwner")||r.length>1)&&s.jsxs("div",{className:"absolute right-0 top-12 w-72 bg-popover border rounded-md shadow-lg z-50",children:[s.jsxs("div",{className:"p-3 border-b",children:[s.jsx("h3",{className:"font-medium",children:"Switch Tenant"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Select a different tenant environment"})]}),s.jsx("div",{className:"py-2",children:r.map(b=>s.jsxs("button",{className:Ee("w-full px-3 py-2 text-left hover:bg-accent hover:text-accent-foreground flex items-center justify-between",b.id===n.id&&"bg-accent text-accent-foreground"),onClick:()=>f(b.id),children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:b.name}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:[b.subscriptionTier,"  ",b.region]})]}),s.jsx("span",{className:Ee("px-2 py-0.5 rounded-full text-xs font-medium",y(b.status)),children:b.status})]},b.id))})]})]}),s.jsxs("div",{className:"relative",children:[s.jsxs(G,{variant:"ghost",className:"flex items-center space-x-2",onClick:()=>c(!o),children:[s.jsx("div",{className:"h-8 w-8 bg-primary rounded-full flex items-center justify-center text-primary-foreground text-sm font-medium",children:t.name.charAt(0).toUpperCase()}),s.jsxs("div",{className:"hidden sm:block text-left",children:[s.jsx("div",{className:"text-sm font-medium",children:t.name}),s.jsx("div",{className:"text-xs text-muted-foreground",children:t.roles[0]})]}),s.jsx(So,{className:"h-4 w-4"})]}),o&&s.jsxs("div",{className:"absolute right-0 top-12 w-56 bg-popover border rounded-md shadow-lg z-50",children:[s.jsxs("div",{className:"p-3 border-b",children:[s.jsx("div",{className:"font-medium",children:t.name}),s.jsx("div",{className:"text-sm text-muted-foreground",children:t.email}),s.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:t.roles.map(b=>s.jsx("span",{className:"px-2 py-0.5 bg-secondary text-secondary-foreground rounded-full text-xs",children:b},b))})]}),s.jsxs("div",{className:"py-2",children:[s.jsxs("button",{className:"w-full px-3 py-2 text-left hover:bg-accent hover:text-accent-foreground flex items-center space-x-2",children:[s.jsx(dt,{className:"h-4 w-4"}),s.jsx("span",{children:"Settings"})]}),s.jsxs("button",{className:"w-full px-3 py-2 text-left hover:bg-accent hover:text-accent-foreground flex items-center space-x-2 text-destructive hover:text-destructive",onClick:T,children:[s.jsx(fT,{className:"h-4 w-4"}),s.jsx("span",{children:"Sign out"})]})]})]})]})]})]}),(o||u)&&s.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>{c(!1),m(!1)}})]})},kT=()=>{const{isAuthenticated:e,isLoading:t,isInitialized:n,user:r,tenant:a}=it(),{loadDashboardData:i,sidebarCollapsed:l}=Vh();return S.useEffect(()=>{a&&e&&i(a.id)},[a==null?void 0:a.id,e,i]),n?!e||!r||!a?(console.log("DashboardLayout: Redirecting to login - not authenticated"),s.jsx(Ws,{to:"/login",replace:!0})):t?s.jsx("div",{className:"flex h-screen items-center justify-center",children:s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx(tt,{className:"h-8 w-8 animate-spin text-primary"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading dashboard..."})]})}):s.jsxs("div",{className:"flex h-screen bg-background",children:[s.jsx(ST,{}),s.jsxs("div",{className:`flex-1 flex flex-col transition-all duration-300 ${l?"ml-16":"ml-64"}`,children:[s.jsx(CT,{}),s.jsx("main",{className:"flex-1 overflow-y-auto p-6 bg-muted/50",children:s.jsx("div",{className:"mx-auto max-w-7xl",children:s.jsx(i2,{})})})]})]}):s.jsx("div",{className:"flex h-screen items-center justify-center",children:s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsx(tt,{className:"h-8 w-8 animate-spin text-primary"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Initializing..."})]})})},Q=S.forwardRef(({className:e,variant:t="default",...n},r)=>s.jsx("div",{ref:r,className:Ee(t==="clean"&&"card-clean",t==="elevated"&&"card-elevated",t==="gradient"&&"card-gradient",t==="default"&&"card",e),...n}));Q.displayName="Card";const he=S.forwardRef(({className:e,...t},n)=>s.jsx("div",{ref:n,className:Ee("flex flex-col space-y-1.5 p-6",e),...t}));he.displayName="CardHeader";const be=S.forwardRef(({className:e,...t},n)=>s.jsx("h3",{ref:n,className:Ee("text-2xl font-semibold leading-none tracking-tight",e),...t}));be.displayName="CardTitle";const jT=S.forwardRef(({className:e,...t},n)=>s.jsx("p",{ref:n,className:Ee("text-sm text-muted-foreground",e),...t}));jT.displayName="CardDescription";const ne=S.forwardRef(({className:e,...t},n)=>s.jsx("div",{ref:n,className:Ee("p-6 pt-0",e),...t}));ne.displayName="CardContent";const AT=S.forwardRef(({className:e,...t},n)=>s.jsx("div",{ref:n,className:Ee("flex items-center p-6 pt-0",e),...t}));AT.displayName="CardFooter";const _T=()=>{const{login:e,isAuthenticated:t,isLoading:n,error:r,clearError:a}=it(),[i,l]=S.useState(""),[o,c]=S.useState("credentials"),[u,m]=S.useState({email:"",password:""}),d=[{email:"admin@platform.com",name:"Alex Rodriguez",role:"Platform Owner",tenant:"SaaS Platform Admin",description:"Master admin with cross-tenant access and full platform management capabilities"},{email:"user1@acme.com",name:"Sarah Chen",role:"Tenant Owner",tenant:"ACME Corporation",description:"Full administrative access to ACME tenant with all MCP tools enabled"},{email:"analyst@acme.com",name:"Mike Johnson",role:"Agent User",tenant:"ACME Corporation",description:"Operational dashboard access with ability to manage and run AI agents"},{email:"audit@acme.com",name:"Lisa Wang",role:"Auditor & Compliance Officer",tenant:"ACME Corporation",description:"Read-only access to audit trails, compliance reports, and risk assessments"},{email:"owner@fintech.com",name:"David Smith",role:"Tenant Owner",tenant:"FinTech Solutions Ltd",description:"Full access to FinTech tenant with limited MCP tools (no BYO LLM)"}];if(S.useEffect(()=>{a()},[a]),t)return s.jsx(Ws,{to:"/dashboard",replace:!0});const p=async()=>{!u.email||!u.password||(console.log("Attempting credential login with user:",u.email),await e(u.email,u.password))},f=async()=>{i&&(console.log("Attempting demo login with user:",i),await e(i))};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-muted/30",children:s.jsx("div",{className:"w-full max-w-2xl p-6",children:s.jsxs(Q,{children:[s.jsxs(he,{className:"text-center",children:[s.jsx("div",{className:"flex justify-center mb-4",children:s.jsx(ge,{className:"h-12 w-12 text-primary"})}),s.jsx(be,{className:"text-2xl",children:"GRC Multi-Tenant Platform"}),s.jsx("p",{className:"text-muted-foreground",children:"AI-powered Governance, Risk & Compliance dashboard with MCP server integration"})]}),s.jsxs(ne,{className:"space-y-6",children:[s.jsx("div",{className:"bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(ge,{className:"h-4 w-4 text-blue-600 mt-0.5"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("p",{className:"font-medium text-blue-900 dark:text-blue-100",children:"Azure AD B2C Authentication"}),s.jsx("p",{className:"text-blue-700 dark:text-blue-300 mt-1",children:"In production, this would redirect to your Azure B2C tenant for secure authentication with MFA support."})]})]})}),s.jsxs("div",{className:"flex justify-center space-x-1 bg-muted rounded-lg p-1",children:[s.jsx("button",{type:"button",onClick:()=>c("credentials"),className:Ee("px-6 py-2 rounded-md text-sm font-medium transition-colors",o==="credentials"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:"Email & Password"}),s.jsx("button",{type:"button",onClick:()=>c("demo"),className:Ee("px-6 py-2 rounded-md text-sm font-medium transition-colors",o==="demo"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:"Demo Users"})]}),o==="credentials"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium mb-2",children:"Email Address"}),s.jsx("input",{id:"email",type:"email",value:u.email,onChange:g=>m({...u,email:g.target.value}),placeholder:"user1@acme.com",className:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium mb-2",children:"Password"}),s.jsx("input",{id:"password",type:"password",value:u.password,onChange:g=>m({...u,password:g.target.value}),placeholder:"Enter your password",className:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),s.jsxs("div",{className:"text-xs text-muted-foreground bg-muted/50 p-3 rounded-md",children:[s.jsx("p",{className:"font-medium mb-1",children:"For testing, use any of these emails with any password:"}),s.jsx("p",{children:" user1@acme.com (Sarah Chen - Tenant Owner)"}),s.jsx("p",{children:" analyst@acme.com (Mike Johnson - Agent User)"}),s.jsx("p",{children:" audit@acme.com (Lisa Wang - Auditor)"}),s.jsx("p",{children:" admin@platform.com (Alex Rodriguez - Platform Owner)"})]})]}),r&&s.jsxs("div",{className:"bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(us,{className:"h-4 w-4 text-red-600"}),s.jsx("p",{className:"text-red-900 dark:text-red-100 font-medium",children:"Authentication Error"})]}),s.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1 text-sm",children:r})]}),o==="demo"&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Select Demo User"}),s.jsx("div",{className:"space-y-3",children:d.map(g=>s.jsx("div",{className:Ee("p-4 border rounded-lg cursor-pointer transition-colors",i===g.email?"border-primary bg-primary/5":"hover:bg-muted/50"),onClick:()=>l(g.email),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"h-10 w-10 bg-primary rounded-full flex items-center justify-center text-primary-foreground font-semibold",children:g.name.charAt(0)}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium",children:g.name}),s.jsx("p",{className:"text-sm text-muted-foreground",children:g.email})]})]}),s.jsxs("div",{className:"mt-3",children:[s.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[s.jsx("span",{className:"px-2 py-1 bg-secondary text-secondary-foreground rounded",children:g.role}),s.jsx("span",{className:"text-muted-foreground",children:g.tenant})]}),s.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:g.description})]})]}),s.jsx("div",{className:"ml-4",children:s.jsx("div",{className:Ee("w-4 h-4 rounded-full border-2 transition-colors",i===g.email?"border-primary bg-primary":"border-muted-foreground"),children:i===g.email&&s.jsx("div",{className:"w-2 h-2 bg-primary-foreground rounded-full m-0.5"})})})]})},g.email))})]}),s.jsx(G,{onClick:o==="credentials"?p:f,disabled:o==="credentials"&&(!u.email||!u.password)||o==="demo"&&!i||n,className:"w-full",size:"lg",children:n?s.jsxs(s.Fragment,{children:[s.jsx(tt,{className:"h-4 w-4 mr-2 animate-spin"}),"Authenticating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ge,{className:"h-4 w-4 mr-2"}),"Sign in with Azure AD B2C"]})}),s.jsxs("div",{className:"text-center text-sm text-muted-foreground space-y-2",children:[s.jsx("p",{children:"This demo showcases a multi-tenant SaaS platform with:"}),s.jsxs("ul",{className:"text-xs space-y-1",children:[s.jsx("li",{children:" Tenant-isolated AI agents with configurable MCP tools"}),s.jsx("li",{children:" Role-based access control (Platform Owner, Tenant Owner, Agent User, Auditor)"}),s.jsx("li",{children:" Azure AD B2C integration with tenant context and cross-tenant management"}),s.jsx("li",{children:" Platform-compliant audit logging and compliance reporting"}),s.jsx("li",{children:" Real-time GRC data visualization and risk assessment"})]})]})]})]})})})},IT={variant:{default:"bg-background text-foreground border-border",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive bg-destructive/5",warning:"border-yellow-200 text-yellow-800 dark:border-yellow-900/50 dark:text-yellow-200 bg-yellow-50 dark:bg-yellow-900/10 [&>svg]:text-yellow-600 dark:[&>svg]:text-yellow-400",success:"border-green-200 text-green-800 dark:border-green-900/50 dark:text-green-200 bg-green-50 dark:bg-green-900/10 [&>svg]:text-green-600 dark:[&>svg]:text-green-400",info:"border-blue-200 text-blue-800 dark:border-blue-900/50 dark:text-blue-200 bg-blue-50 dark:bg-blue-900/10 [&>svg]:text-blue-600 dark:[&>svg]:text-blue-400"}},LT={default:dn,destructive:ko,warning:us,success:Le,info:dn},Ie=S.forwardRef(({className:e,variant:t="default",title:n,children:r,dismissible:a,onDismiss:i,...l},o)=>{const c=LT[t];return s.jsxs("div",{ref:o,role:"alert",className:Ee("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg]:h-4 [&>svg]:w-4",IT.variant[t],e),...l,children:[s.jsx(c,{className:"h-4 w-4"}),a&&i&&s.jsxs("button",{onClick:i,className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",children:[s.jsx(Jh,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]}),s.jsxs("div",{className:a?"pr-8":"",children:[n&&s.jsx("h5",{className:"mb-1 font-medium leading-none tracking-tight",children:n}),s.jsx("div",{className:"text-sm [&_p]:leading-relaxed",children:r})]})]})});Ie.displayName="Alert";class RT{constructor(){_e(this,"baseUrl","/api/v1")}async testConnection(){try{console.log(" [Backend Agents] Testing database connection...");const t=await fetch(`${this.baseUrl}/simple-agents`);if(!t.ok)return console.warn(" [Backend Agents] Connection test failed:",t.status),!1;const n=await t.json();return console.log(" [Backend Agents] Database connection successful"),n.success||!0}catch(t){return console.error(" [Backend Agents] Database connection failed:",t),!1}}async getAgents(){try{console.log(" [Backend Agents] Loading agents from database...");const t=await fetch(`${this.baseUrl}/simple-agents`);if(!t.ok)throw new Error(`Failed to load agents: ${t.status}`);const n=await t.json();if(!n.success)throw new Error(n.error||"Failed to load agents");return console.log(` [Backend Agents] Loaded ${n.data.agents.length} agents from database`),n.data.agents}catch(t){throw console.error(" [Backend Agents] Failed to load agents:",t),t}}async createAgent(t){try{console.log(" [Backend Agents] Creating agent:",t.name);const n=await fetch(`${this.baseUrl}/simple-agents/create`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`Failed to create agent: ${n.status}`);const r=await n.json();if(!r.success)throw new Error(r.error||"Failed to create agent");return console.log(" [Backend Agents] Created agent in database"),r.data}catch(n){throw console.error(" [Backend Agents] Failed to create agent:",n),n}}async updateAgent(t,n){try{console.log(" [Backend Agents] Updating agent:",t,"with updates:",n),console.log(" [Backend Agents] Request URL will be:",`${this.baseUrl}/simple-agents/${t}`);const r=await fetch(`${this.baseUrl}/simple-agents/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error(`Failed to update agent: ${r.status}`);const a=await r.json();if(!a.success)throw new Error(a.error||"Failed to update agent");return console.log(" [Backend Agents] Updated agent in database"),a.data}catch(r){throw console.error(" [Backend Agents] Failed to update agent:",r),r}}async deleteAgent(t){try{console.log(" [Backend Agents] Deleting agent:",t);const n=await fetch(`${this.baseUrl}/simple-agents/${t}`,{method:"DELETE"});if(!n.ok)throw new Error(`Failed to delete agent: ${n.status}`);const r=await n.json();if(!r.success)throw new Error(r.error||"Failed to delete agent");return console.log(" [Backend Agents] Deleted agent from database"),!0}catch(n){throw console.error(" [Backend Agents] Failed to delete agent:",n),n}}async getEnabledAgents(){return(await this.getAgents()).filter(n=>n.isEnabled!==!1)}async getAgent(t){return(await this.getAgents()).find(r=>r.id===t)||null}async getAgentWithContext(t){try{console.log(` [Backend Agents] Loading agent context for agent: ${t}`);const n=await this.getAgent(t);if(!n)return console.error(` [Backend Agents] Agent not found: ${t}`),null;console.log(" [Backend Agents] Agent loaded:",{id:n.id,name:n.name,llmConfigId:n.llmConfigId});let r=null;if(n.llmConfigId)try{console.log(` [Backend Agents] Loading LLM config: ${n.llmConfigId}`);const i=await fetch(`${this.baseUrl}/simple-llm-configs`);if(i.ok){const l=await i.json();if(l.success&&l.data.llm_configs){const o=l.data.llm_configs.find(c=>c.config_id===n.llmConfigId);o?(r={provider:o.provider,model:o.model,apiKey:o.api_key,endpoint:o.endpoint,temperature:o.temperature,maxTokens:o.max_tokens,responseFormat:o.response_format,isEnabled:o.is_enabled===1,id:o.config_id,name:o.name},console.log(" [Backend Agents] Found LLM config:",{id:r.id,name:r.name,provider:r.provider,endpoint:r.endpoint})):console.warn(` [Backend Agents] LLM config not found for ID: ${n.llmConfigId}`)}}}catch(i){console.error(" [Backend Agents] Error loading LLM config:",i)}let a=[];if(n.enabledMcpServers&&n.enabledMcpServers.length>0)try{console.log(" [Backend Agents] Loading MCP configs for servers:",n.enabledMcpServers);const i=await fetch(`${this.baseUrl}/simple-mcp-configs`);if(i.ok){const l=await i.json();l.success&&l.data.mcp_servers&&(a=l.data.mcp_servers.filter(o=>n.enabledMcpServers.includes(o.id)&&o.is_enabled),console.log(` [Backend Agents] Found ${a.length} enabled MCP servers:`,a.map(o=>o.name)))}}catch(i){console.error(" [Backend Agents] Error loading MCP servers:",i)}else console.log(` [Backend Agents] No enabled MCP servers for agent: ${n.name}`);return r||(console.warn(` [Backend Agents] Using fallback LLM config for agent: ${n.name}`),r={id:"fallback",name:"Fallback OpenAI",provider:"openai",model:"gpt-4",endpoint:"https://api.openai.com",isEnabled:!0,temperature:.7,maxTokens:2e3}),console.log(" [Backend Agents] Agent context loaded successfully:",{agentName:n.name,llmConfig:r?{id:r.id,name:r.name,provider:r.provider}:"None",mcpServerCount:a.length}),{agent:n,mcpServers:a,llmConfig:r}}catch(n){return console.error(` [Backend Agents] Error loading agent context for ${t}:`,n),null}}async recordUsage(t,n){try{console.log(` [Backend Agents] Recording usage for agent ${t}:`,n||"basic usage")}catch(r){console.error(" [Backend Agents] Failed to record usage:",r)}}}const wr=e=>(console.log(` [Backend Agents] Initialized with database backend (tenant: ${e})`),new RT);class PT{constructor(t){_e(this,"tenantId");this.tenantId=t}getAgentMetrics(t){const n=this.loadAllMetrics();return n[t]||(n[t]=this.generateSampleMetrics(t),this.saveAllMetrics(n)),n[t]}getAllAgentMetrics(){return this.loadAllMetrics()}recordExecution(t,n){const r=this.loadAllMetrics(),a=r[t]||this.generateSampleMetrics(t),i={id:`exec-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,...n};a.executionHistory.push(i),a.executionHistory.length>100&&(a.executionHistory=a.executionHistory.slice(-100)),this.recalculateMetrics(a),r[t]=a,this.saveAllMetrics(r)}generateSampleMetrics(t){const n={"risk-specialist":{baseSuccessRate:87,avgExecutions:234,avgTime:3.2,tools:["get_risk_summary","forecast_risk_trajectory","detect_anomalies","analyze_grc_data"]},"compliance-auditor":{baseSuccessRate:92,avgExecutions:156,avgTime:2.8,tools:["analyze_grc_data","detect_anomalies"]},"grc-analyst":{baseSuccessRate:89,avgExecutions:198,avgTime:2.1,tools:["analyze_grc_data","generate_insights"]},"executive-advisor":{baseSuccessRate:94,avgExecutions:89,avgTime:4.5,tools:["analyze_grc_data","generate_insights"]}},r=Object.keys(n).find(c=>t.toLowerCase().includes(c.replace("-",""))),a=r?n[r]:n["grc-analyst"],i=[],l=new Date;for(let c=0;c<a.avgExecutions;c++){const u=Math.random()*30,m=new Date(l.getTime()-u*24*60*60*1e3),d=Math.random()<a.baseSuccessRate/100,p=a.avgTime+(Math.random()-.5)*2;i.push({id:`exec-${c}-${t}`,timestamp:m.toISOString(),success:d,executionTime:Math.max(.1,p),toolsUsed:this.sampleTools(a.tools),errorMessage:d?void 0:this.generateErrorMessage()})}return i.sort((c,u)=>new Date(c.timestamp).getTime()-new Date(u.timestamp).getTime()),{agentId:t,successRate:a.baseSuccessRate,totalExecutions:a.avgExecutions,averageExecutionTime:a.avgTime,lastExecution:i.length>0?i[i.length-1].timestamp:void 0,executionHistory:i,toolsUsed:a.tools}}sampleTools(t){const n=Math.floor(Math.random()*t.length)+1;return[...t].sort(()=>.5-Math.random()).slice(0,n)}generateErrorMessage(){const t=["Tool execution timeout","MCP server connection failed","Invalid parameters provided","Data source temporarily unavailable","Rate limit exceeded","Authentication failed","Network connectivity issue"];return t[Math.floor(Math.random()*t.length)]}recalculateMetrics(t){var o;const{executionHistory:n}=t;if(n.length===0)return;const r=n.filter(c=>c.success);t.successRate=Math.round(r.length/n.length*100),t.totalExecutions=n.length;const a=n.reduce((c,u)=>c+u.executionTime,0);t.averageExecutionTime=Math.round(a/n.length*10)/10,t.lastExecution=(o=n[n.length-1])==null?void 0:o.timestamp;const l=n.slice(-20).flatMap(c=>c.toolsUsed);t.toolsUsed=[...new Set(l)]}getPlatformStats(){const t=this.loadAllMetrics(),n=Object.values(t);if(n.length===0)return{totalAgents:0,activeAgents:0,totalExecutions:0,averageSuccessRate:0};const r=n.reduce((o,c)=>o+c.totalExecutions,0),a=n.reduce((o,c)=>o+c.successRate,0),i=new Date(Date.now()-24*60*60*1e3),l=n.filter(o=>o.lastExecution&&new Date(o.lastExecution)>i).length;return{totalAgents:n.length,activeAgents:l,totalExecutions:r,averageSuccessRate:Math.round(a/n.length*10)/10}}simulateActivity(t){const n=["get_risk_summary","analyze_grc_data","detect_anomalies","generate_insights"],r=Math.random()>.1,a=1+Math.random()*4;this.recordExecution(t,{timestamp:new Date().toISOString(),success:r,executionTime:a,toolsUsed:this.sampleTools(n),errorMessage:r?void 0:this.generateErrorMessage()})}loadAllMetrics(){const t=`agent_metrics_${this.tenantId}`,n=localStorage.getItem(t);return n?JSON.parse(n):{}}saveAllMetrics(t){const n=`agent_metrics_${this.tenantId}`;localStorage.setItem(n,JSON.stringify(t))}}const Zh=e=>new PT(e),MT=({tenantId:e})=>{const[t,n]=S.useState({totalAgents:0,activeAgents:0,totalExecutions:0,averageSuccessRate:0}),[r,a]=S.useState(!0);S.useEffect(()=>{const o=async()=>{try{const m=Zh(e).getPlatformStats();n(m)}catch(u){console.error("Error loading platform stats:",u)}finally{a(!1)}};o();const c=setInterval(o,3e5);return()=>clearInterval(c)},[e]);const i=o=>o>=1e3?Math.floor(o/1e3)+"k+":o.toString(),l=[{title:"Total Agents",value:r?"-":t.totalAgents,icon:Es,color:"text-blue-600",bgColor:"bg-blue-50"},{title:"Active Agents",value:r?"-":t.activeAgents,icon:vt,color:"text-green-600",bgColor:"bg-green-50"},{title:"Total Executions",value:r?"-":i(t.totalExecutions),icon:zn,color:"text-purple-600",bgColor:"bg-purple-50"},{title:"Success Rate",value:r?"-":`${t.averageSuccessRate}%`,icon:Le,color:"text-emerald-600",bgColor:"bg-emerald-50"}];return s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:l.map(o=>{const c=o.icon;return s.jsx(Q,{className:"hover:shadow-md transition-shadow",children:s.jsx(ne,{className:"p-4",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:`p-2 rounded-lg ${o.bgColor}`,children:s.jsx(c,{className:`h-5 w-5 ${o.color}`})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.value}),s.jsx("p",{className:"text-sm text-gray-500",children:o.title})]})]})})},o.title)})})},J=S.forwardRef(({className:e,variant:t="default",...n},r)=>s.jsx("div",{ref:r,className:Ee("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{"border-transparent bg-primary text-primary-foreground hover:bg-primary/80":t==="default","border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80":t==="secondary","border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80":t==="destructive","text-foreground":t==="outline"},e),...n}));J.displayName="Badge";const OT=e=>{switch(e){case"good":return lT;case"medium":return ue;case"critical":return ko;case"pending":return Tt;default:return Tt}},DT=e=>{switch(e){case"good":return"Good";case"medium":return"Medium";case"critical":return"Critical";case"pending":return"Pending";default:return"Unknown"}},FT=(e,t)=>{if(t==="outline")switch(e){case"good":return"border-status-good text-status-good bg-status-good/10";case"medium":return"border-status-medium text-status-medium bg-status-medium/10";case"critical":return"border-status-critical text-status-critical bg-status-critical/10";case"pending":return"border-status-pending text-status-pending bg-status-pending/10";default:return"border-muted-foreground text-muted-foreground bg-muted/10"}switch(e){case"good":return"status-good";case"medium":return"status-medium";case"critical":return"status-critical";case"pending":return"status-pending";default:return"bg-muted-foreground text-white"}},BT=e=>{switch(e){case"sm":return"px-2 py-0.5 text-xs";case"lg":return"px-4 py-2 text-base";default:return"px-3 py-1 text-sm"}},UT=e=>{switch(e){case"sm":return"h-3 w-3";case"lg":return"h-5 w-5";default:return"h-4 w-4"}},yy=S.forwardRef(({className:e,status:t,label:n,showIcon:r=!0,size:a="md",variant:i="default",...l},o)=>{const c=OT(t),u=n||DT(t);return s.jsxs("span",{ref:o,className:Ee("inline-flex items-center space-x-1 rounded-full font-medium",BT(a),FT(t,i),i==="outline"&&"border",e),...l,children:[r&&s.jsx(c,{className:UT(a)}),s.jsx("span",{children:u})]})});yy.displayName="StatusBadge";const HT=e=>{switch(e){case"good":return"progress-good";case"medium":return"progress-medium";case"critical":return"progress-critical";default:return"bg-primary"}},zT=e=>{switch(e){case"sm":return"h-1";case"lg":return"h-4";default:return"h-2"}},by=S.forwardRef(({className:e,value:t,status:n,showLabel:r=!1,size:a="md",animated:i=!0,...l},o)=>{const c=Math.min(100,Math.max(0,t));return s.jsxs("div",{ref:o,className:Ee("space-y-2",e),...l,children:[r&&s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:"Progress"}),s.jsxs("span",{className:"font-medium",children:[c,"%"]})]}),s.jsx("div",{className:Ee("progress-bar",zT(a)),children:s.jsx("div",{className:Ee("progress-bar-fill",HT(n),i&&"transition-all duration-500 ease-out"),style:{width:`${c}%`}})})]})});by.displayName="ProgressBar";class $T{constructor(){_e(this,"tenantId",null);_e(this,"baseUrl","/api/v1")}setTenantContext(t){this.tenantId=t,console.log(` [Backend MCP Configs] Set tenant context: ${t}`)}async initialize(){console.log(" [Backend MCP Configs] Initialized - using database backend")}async getAllMcpConfigs(){if(!this.tenantId)throw new Error("Tenant context not set. Call setTenantContext() first.");try{console.log(" [Backend MCP Configs] Loading configurations from database...");const t=await fetch(`${this.baseUrl}/simple-mcp-configs`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Failed to load MCP configurations: ${t.status}`);const n=await t.json();if(!n.success)throw new Error(n.error||"Failed to load MCP configurations");return console.log(` [Backend MCP Configs] Loaded ${n.data.mcp_servers.length} configurations from database`),n.data.mcp_servers}catch(t){throw console.error(" [Backend MCP Configs] Failed to load configurations:",t),t}}async getRegistryServers(){try{console.log(" [Backend MCP Configs] Loading registry servers...");const t=await fetch(`${this.baseUrl}/simple-mcp-configs/registry`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Failed to load MCP registry: ${t.status}`);const n=await t.json();if(!n.success)throw new Error(n.error||"Failed to load MCP registry");return console.log(` [Backend MCP Configs] Loaded ${n.data.registry_servers.length} registry servers`),n.data.registry_servers}catch(t){throw console.error(" [Backend MCP Configs] Failed to load registry servers:",t),t}}async enableMcpServer(t){if(!this.tenantId)throw new Error("Tenant context not set. Call setTenantContext() first.");try{console.log(" [Backend MCP Configs] Enabling MCP server:",t.server_id);const n=await fetch(`${this.baseUrl}/simple-mcp-configs/enable`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`Failed to enable MCP server: ${n.status}`);const r=await n.json();if(!r.success)throw new Error(r.error||"Failed to enable MCP server");return console.log(" [Backend MCP Configs] MCP server enabled successfully"),r.data}catch(n){throw console.error(" [Backend MCP Configs] Failed to enable MCP server:",n),n}}async updateMcpConfig(t,n){if(!this.tenantId)throw new Error("Tenant context not set. Call setTenantContext() first.");try{console.log(" [Backend MCP Configs] Updating configuration:",t);const r={};n.is_enabled!==void 0&&(r.is_enabled=n.is_enabled),n.custom_name!==void 0&&(r.custom_name=n.custom_name),n.configuration_values!==void 0&&(r.configuration_values=n.configuration_values),n.allowed_tools!==void 0&&(r.allowed_tools=n.allowed_tools);const a=await fetch(`${this.baseUrl}/simple-mcp-configs/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!a.ok)throw new Error(`Failed to update MCP configuration: ${a.status}`);const i=await a.json();if(!i.success)throw new Error(i.error||"Failed to update MCP configuration");return console.log(" [Backend MCP Configs] Configuration updated successfully"),i.data}catch(r){throw console.error(" [Backend MCP Configs] Failed to update configuration:",r),r}}async deleteMcpConfig(t){if(!this.tenantId)throw new Error("Tenant context not set. Call setTenantContext() first.");try{console.log(" [Backend MCP Configs] Deleting configuration:",t);const n=await fetch(`${this.baseUrl}/simple-mcp-configs/${t}`,{method:"DELETE"});if(!n.ok)throw new Error(`Failed to delete MCP configuration: ${n.status}`);const r=await n.json();if(!r.success)throw new Error(r.error||"Failed to delete MCP configuration");console.log(" [Backend MCP Configs] Configuration deleted successfully")}catch(n){throw console.error(" [Backend MCP Configs] Failed to delete configuration:",n),n}}async testDatabase(){try{console.log(" [Backend MCP Configs] Testing database connectivity...");const t=await fetch(`${this.baseUrl}/simple-mcp-configs/test-database`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Database test failed: ${t.status}`);const n=await t.json();if(!n.success)throw new Error(n.error||"Database test failed");return console.log(" [Backend MCP Configs] Database test successful"),n.data}catch(t){throw console.error(" [Backend MCP Configs] Database test failed:",t),t}}}const Hr=new $T,qT=()=>Hr.getAllMcpConfigs(),VT=(e,t)=>Hr.updateMcpConfig(e,t),YT=({agent:e,tenantId:t,onToggle:n,onConfigure:r,onChat:a})=>{const[i,l]=S.useState(null),[o,c]=S.useState(!0),[u,m]=S.useState([]),d={risk:zn,compliance:ge,control:dt,executive:Hi,recommendation:At},p=v=>{const T=[v.name||"",v.description||"",v.persona||"",v.useCase||""].filter(Boolean).join(" ").toLowerCase();return T.includes("risk")?"risk":T.includes("compliance")?"compliance":T.includes("control")?"control":T.includes("executive")?"executive":"recommendation"};S.useEffect(()=>{const v=async()=>{try{c(!0);const b=Zh(t).getAgentMetrics(e.id);l(b);const x=e.enabledMcpServers||[];if(x.length>0)try{Hr.setTenantContext(t);const C=(await Hr.getAllMcpConfigs()).filter(E=>x.includes(E.server_id)&&E.is_enabled).map(E=>({id:E.server_id,name:E.display_name||E.custom_name||E.server_name,isEnabled:E.is_enabled}));m(C),console.log(" [AgentCard] Loaded MCP servers from database:",C)}catch(I){console.error(" [AgentCard] Failed to load MCP servers from database:",I);const C=x.map(E=>({id:E,name:E==="archer-grc"?"Archer GRC Server":E==="filesystem"?"File System":E.replace(/^mcp-/,"").replace(/-/g," "),isEnabled:!0}));m(C)}else m([])}catch(y){console.error("Error loading agent data:",y)}finally{c(!1)}};v();const T=setInterval(v,3e5);return()=>clearInterval(T)},[e.id,t]);const f=v=>{if(!v)return"Never";const T=new Date,y=new Date(v),b=T.getTime()-y.getTime(),x=Math.floor(b/6e4),I=Math.floor(b/36e5),C=Math.floor(b/864e5);return x<1?"Just now":x<60?`${x} minutes ago`:I<24?`${I} hours ago`:C<7?`${C} days ago`:y.toLocaleDateString()},g=d[p(e)];return s.jsx(Q,{variant:"clean",className:"hover:card-elevated transition-all duration-200",children:s.jsxs(ne,{className:"p-6",children:[s.jsx("div",{className:"flex items-start justify-between mb-4",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:`p-3 rounded-xl ${e.isEnabled?"bg-primary/10":"bg-muted"}`,children:s.jsx(g,{className:`h-6 w-6 ${e.isEnabled?"text-primary":"text-muted-foreground"}`})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-foreground",children:e.name}),s.jsx(yy,{status:e.isEnabled?"good":"pending",label:e.isEnabled?"Active":"Inactive",size:"sm"})]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:e.description})]})]})}),s.jsxs("div",{className:"mb-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Specialization"}),s.jsx("p",{className:"text-sm text-gray-800",children:e.persona})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Available Tools"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:o?s.jsx(J,{variant:"secondary",className:"text-xs",children:"Loading tools..."}):u.length>0?u.map(v=>s.jsx(J,{variant:"secondary",className:"text-xs",children:v.name},v.id)):s.jsx(J,{variant:"outline",className:"text-xs text-gray-500",children:"No MCP servers enabled"})})]}),!o&&i&&s.jsxs("div",{className:"border-t pt-4 mb-4 space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-lg font-semibold text-foreground",children:[i.successRate,"%"]}),s.jsx("div",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"Success Rate"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-lg font-semibold text-foreground",children:i.totalExecutions}),s.jsx("div",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"Executions"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-lg font-semibold text-foreground",children:[i.averageExecutionTime,"s"]}),s.jsx("div",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"Avg Time"})]})]}),s.jsx(by,{value:i.successRate,status:i.successRate>=90?"good":i.successRate>=70?"medium":"critical",showLabel:!1,size:"sm"})]}),o&&s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center border-t pt-4 mb-4",children:[s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-6 bg-gray-200 rounded mb-1"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Success Rate"})]}),s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-6 bg-gray-200 rounded mb-1"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Executions"})]}),s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-6 bg-gray-200 rounded mb-1"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Avg Time"})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-muted-foreground flex items-center space-x-1",children:[s.jsx(Tt,{className:"h-3 w-3"}),s.jsxs("span",{children:["Last execution: ",f(i==null?void 0:i.lastExecution)]})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(G,{variant:"outline",size:"sm",onClick:()=>{console.log("[AgentCard] Toggle clicked - agent.id:",e.id,"agent:",e),n(e.id,!e.isEnabled)},className:"text-xs",children:e.isEnabled?s.jsxs(s.Fragment,{children:[s.jsx(Kh,{className:"h-3 w-3 mr-1"}),"Pause"]}):s.jsxs(s.Fragment,{children:[s.jsx(Qh,{className:"h-3 w-3 mr-1"}),"Activate"]})}),a&&s.jsxs(G,{variant:"outline",size:"sm",onClick:()=>a(e),disabled:!e.isEnabled,className:"text-xs",title:e.isEnabled?`Chat with ${e.name}`:"Enable agent to chat",children:[s.jsx(pT,{className:"h-3 w-3 mr-1"}),"Chat"]}),s.jsxs(G,{variant:"outline",size:"sm",onClick:()=>r(e),className:"text-xs",children:[s.jsx(dt,{className:"h-3 w-3 mr-1"}),"Configure"]})]})]})]})})},rp=[{id:"grc-analyst",name:"GRC Analyst",description:"Comprehensive governance, risk, and compliance analysis specialist",persona:"Professional, analytical, detail-oriented GRC expert with deep regulatory knowledge",systemPrompt:`You are a senior GRC (Governance, Risk, and Compliance) analyst with extensive experience in regulatory frameworks, risk assessment, and compliance monitoring. 

# YOUR APPROACH TO ANALYSIS

When analyzing GRC data, you produce comprehensive, professional reports that match the quality of leading enterprise GRC platforms. Your responses should provide executive-level insights while maintaining technical accuracy.

# RESPONSE STRUCTURE GUIDELINES

## For Risk Analysis Queries:
1. **Executive Summary**
   - Total risks identified with breakdown by severity
   - Key statistics (% critical, % high, trend indicators)
   - Business impact assessment
   - Top 3 immediate concerns

2. **Risk Categorization**
   - Group risks by category (Operational, Financial, Compliance, Strategic, Reputational)
   - Use visual indicators:  Critical,  High,  Medium,  Low
   - Show risk count and percentage for each category

3. **Detailed Risk Analysis**
   - For each significant risk:
     * Risk ID and Title
     * Current Risk Score (Likelihood  Impact)
     * Risk Owner and Business Unit
     * Current Control Effectiveness
     * Mitigation Status and Timeline
     * Residual Risk Assessment

4. **Risk Distribution Analysis**
   - Business Unit Risk Distribution table
   - Risk Age Analysis (new vs. aging risks)
   - Risk Velocity indicators
   - Control Coverage gaps

5. **Actionable Recommendations**
   - Prioritized action items with timelines
   - Resource requirements
   - Quick wins vs. strategic initiatives
   - Risk acceptance recommendations where appropriate

6. **Risk Maturity Assessment**
   - Current maturity level by domain
   - Benchmarking against industry standards
   - Maturity improvement roadmap

## For Compliance Queries:
1. **Compliance Dashboard**
   - Overall compliance score
   - Framework coverage (ISO27001, SOX, GDPR, etc.)
   - Non-compliance areas highlighted
   - Audit readiness status

2. **Control Assessment**
   - Control effectiveness ratings
   - Failed controls with business impact
   - Compensating controls analysis
   - Control testing schedule

3. **Regulatory Updates**
   - Recent regulatory changes impact
   - Upcoming compliance deadlines
   - Required documentation status

## For Executive Reporting:
1. **Strategic Risk Overview**
   - Board-level risk appetite alignment
   - Strategic objective impact analysis
   - Peer comparison and benchmarking

2. **Key Risk Indicators (KRIs)**
   - Trending KRIs with thresholds
   - Predictive risk analytics
   - Early warning indicators

3. **Investment Recommendations**
   - Risk mitigation ROI analysis
   - Technology investment priorities
   - Resource allocation optimization

# DATA PRESENTATION STANDARDS

- Use tables for structured data with clear headers
- Include percentages and trends () for context
- Provide both current state and historical comparison
- Use formatting to highlight critical information
- Include confidence levels for predictions
- Add data quality indicators where relevant

# PROFESSIONAL COMMUNICATION

- Lead with business impact, not technical details
- Quantify risks in monetary terms when possible
- Provide context using industry benchmarks
- Include both technical and executive summaries
- Use clear, professional language without jargon
- Support findings with specific data points
- Acknowledge data limitations transparently

# IMPORTANT REMINDERS

- Always use actual data from MCP tools, never placeholders
- If data is limited, acknowledge it and provide what's available
- Tailor depth of analysis to query complexity
- For simple queries, provide concise but complete answers
- For complex queries, deliver comprehensive analysis reports
- Include metadata (data freshness, coverage, quality indicators)

# DATA LISTING REQUIREMENTS

**CRITICAL**: When listing applications, records, or any data collections:
- **ALWAYS show ALL available items** - never truncate or limit to first 10, 20, or any subset
- **NEVER use phrases like** "showing first X results", "top X items", or "sample of X"
- **COMPLETE LISTINGS REQUIRED**: If the tool returns 141 applications, show all 141 applications
- **For large datasets**: Use structured formatting (tables, numbered lists) but include every item
- **Include questionnaires**: Applications listings must include both applications AND questionnaires
- **If data is extensive**: Use clear grouping and categorization but maintain completeness
- **Verify completeness**: Always cross-reference your output count with the tool's reported total`,avatar:"",color:"#2563eb"},{id:"risk-specialist",name:"Risk Specialist",description:"Focused on risk identification, assessment, and mitigation strategies",persona:"Strategic risk expert focused on identifying, quantifying, and mitigating organizational risks",systemPrompt:`You are a specialized risk management professional with expertise in enterprise risk assessment and mitigation strategies.

# YOUR SPECIALIZED RISK ANALYSIS FRAMEWORK

## Core Competencies:
- Quantitative risk modeling and Monte Carlo simulations
- Threat intelligence and emerging risk identification
- Risk correlation and concentration analysis
- Scenario planning and stress testing
- Risk appetite framework development

## Risk Analysis Methodology:

### 1. RISK IDENTIFICATION & PROFILING
**For each risk, provide:**
- **Risk ID**: Unique identifier
- **Risk Statement**: Clear description of the risk event
- **Risk Category**: 
  *  Strategic Risk
  *  Financial Risk
  *  Operational Risk
  *  Compliance Risk
  *  Technology/Cyber Risk
  *  Reputational Risk
- **Risk Source**: Internal/External/Both
- **Risk Velocity**: How quickly risk impacts manifest (Slow/Medium/Fast)

### 2. QUANTITATIVE RISK ASSESSMENT
**Provide detailed metrics:**

**Risk Scoring Matrix:**
- Inherent Risk Score: [L  I]
- Likelihood: [1-5] (X% probability)
- Impact: [1-5] ($X financial impact)
- Control Effectiveness: [%]
- Residual Risk Score: [Adjusted]
- Risk Tolerance Threshold: [Value]
- Current Status: [Within/Exceeds]

### 3. RISK INTERDEPENDENCY ANALYSIS
- **Risk Correlations**: Identify related risks
- **Cascade Effects**: Potential domino impacts
- **Concentration Areas**: Risk clustering by business unit/process
- **Systemic Risks**: Enterprise-wide vulnerabilities

### 4. CONTROL ENVIRONMENT ASSESSMENT
**For each control:**
- Control ID and Description
- Control Type: Preventive/Detective/Corrective
- Control Effectiveness Rating: 
  *  Effective (>90%)
  *  Partially Effective (60-90%)
  *  Ineffective (<60%)
- Testing Frequency and Last Test Date
- Control Gaps and Remediation Plans

### 5. RISK MITIGATION STRATEGIES
**Structured approach:**
1. **Immediate Actions** (0-30 days)
   - Quick wins and critical patches
   - Emergency response procedures
   - Temporary compensating controls

2. **Short-term Initiatives** (1-3 months)
   - Process improvements
   - Control enhancements
   - Training and awareness programs

3. **Strategic Programs** (3-12 months)
   - System implementations
   - Organizational changes
   - Policy and framework updates

### 6. RISK MONITORING FRAMEWORK
**Key Risk Indicators (KRIs):**

**KRI Dashboard:**
- KRI Name | Current | Threshold | Trend
- [Name] | [Value] | [Limit] | []

### 7. SCENARIO ANALYSIS
**For high-impact risks:**
- **Best Case**: Optimistic scenario (10% probability)
- **Most Likely**: Expected scenario (70% probability)
- **Worst Case**: Pessimistic scenario (20% probability)
- **Black Swan**: Extreme tail risk scenario

### 8. RISK REPORTING STRUCTURE
**Executive Risk Summary:**
- Top 5 Risks by Residual Score
- Risk Appetite Utilization: [X%]
- Risk Trend: [Improving/Stable/Deteriorating]
- Required Management Actions
- Board Escalation Items

## DATA VISUALIZATION STANDARDS
- Use heat maps for risk matrices
- Include trend lines for risk scores over time
- Show risk distribution across business units
- Provide risk appetite consumption gauges
- Display control effectiveness ratings

## COMMUNICATION PRINCIPLES
- Quantify risks in business terms (revenue impact, operational disruption)
- Provide probabilistic assessments with confidence intervals
- Link risks to strategic objectives
- Include industry-specific risk benchmarks
- Highlight emerging risks and future trends
- Recommend risk-adjusted decision criteria`,avatar:"",color:"#dc2626"},{id:"compliance-auditor",name:"Compliance Auditor",description:"Regulatory compliance expert specializing in audit and assessment",persona:"Meticulous compliance professional with deep regulatory framework knowledge",systemPrompt:`You are a senior compliance auditor with expertise in multiple regulatory frameworks including ISO27001, CPS230, GDPR, HIPAA, and SOX.

# COMPREHENSIVE COMPLIANCE ANALYSIS FRAMEWORK

## Your Regulatory Expertise:
- **ISO Standards**: 27001/27002 (Information Security), 22301 (Business Continuity), 31000 (Risk Management)
- **Financial**: SOX, Basel III, Dodd-Frank, MiFID II
- **Privacy**: GDPR, CCPA, PIPEDA, LGPD
- **Healthcare**: HIPAA, HITECH, FDA 21 CFR Part 11
- **Industry**: PCI DSS, NIST, CIS Controls, COBIT

## COMPLIANCE ASSESSMENT METHODOLOGY

### 1. REGULATORY LANDSCAPE ANALYSIS
**Provide comprehensive framework coverage:**

**Compliance Framework Status:**

| Framework | Coverage | Score | Maturity    |
|-----------|----------|-------|-------------|
| ISO 27001 | 87%      | 4.2/5 | Managed     |
| SOX       | 92%      | 4.5/5 | Optimized   |
| GDPR      | 78%      | 3.8/5 | Defined     |
| CPS230    | 65%      | 3.2/5 | Developing  |

### 2. CONTROL TESTING & VALIDATION
**For each control assessment:**

**Control Information:**
- Control ID & Reference (e.g., ISO 27001 A.12.1.1)
- Control Objective & Description
- Control Owner & Implementation Date
- Testing Methodology Applied

**Testing Results:**

**Control Effectiveness Assessment:**
- Design Effectiveness: [Pass/Fail]
- Operating Effectiveness: [Pass/Fail]
- Sample Size Tested: [N]
- Exceptions Found: [X]
- Error Rate: [%]
- Conclusion: [Status]

### 3. COMPLIANCE GAP ANALYSIS
**Structured gap identification:**

**Critical Gaps** 
- Requirement: [Specific clause/section]
- Current State: [What exists]
- Required State: [What's needed]
- Business Impact: [High/Medium/Low]
- Remediation Effort: [Hours/Days/Weeks]
- Priority: [P1/P2/P3]

**Gap Categorization:**
-  Documentation Gaps
-  Technical Implementation Gaps
-  Process & Procedural Gaps
-  Training & Awareness Gaps
-  Monitoring & Measurement Gaps

### 4. AUDIT EVIDENCE MATRIX

**Evidence Collection Status:**

| Requirement | Evidence Type | Status | Quality |
|-------------|---------------|--------|---------|
| [Req ID]    | Documentation |      | Good    |
| [Req ID]    | Screenshots   |      | Partial |
| [Req ID]    | Logs          |      | Missing |

### 5. REMEDIATION ROADMAP
**Phased implementation plan:**

**Phase 1: Critical Remediation** (0-30 days)
- Address regulatory violations
- Implement compensating controls
- Document temporary measures
- Estimated Cost: $[X]
- Resources Required: [Y] FTEs

**Phase 2: High Priority** (30-90 days)
- Close major control gaps
- Update policies and procedures
- Conduct targeted training
- Estimated Cost: $[X]
- Resources Required: [Y] FTEs

**Phase 3: Optimization** (90-180 days)
- Enhance control automation
- Implement continuous monitoring
- Achieve target maturity level
- Estimated Cost: $[X]
- Resources Required: [Y] FTEs

### 6. COMPLIANCE METRICS & KPIs
**Key Performance Indicators:**
- Overall Compliance Score: [%]
- Controls Passed: [X/Y] ([%])
- Open Audit Findings: [N]
- Average Remediation Time: [Days]
- Repeat Findings Rate: [%]
- Audit Cycle Coverage: [%]

### 7. REGULATORY CHANGE MANAGEMENT
**Upcoming requirements:**
- Regulation: [Name]
- Effective Date: [Date]
- Impact Assessment: [High/Medium/Low]
- Preparation Status: [On Track/At Risk/Behind]
- Required Actions: [List]

### 8. AUDIT READINESS ASSESSMENT

**Audit Readiness Scorecard:**

| Component          | Score | Status |
|--------------------|-------|--------|
| Documentation      | 85%   |      |
| Evidence           | 72%   |      |
| Control Testing    | 90%   |      |
| Management Review  | 68%   |      |
| Corrective Actions | 88%   |      |

## REPORTING STANDARDS
- Include regulatory references for all findings
- Provide clear pass/fail determinations
- Map findings to business risk
- Include benchmarking against industry standards
- Provide cost-benefit analysis for remediation
- Include timeline with regulatory deadlines
- Add precedent and enforcement action context

## COMMUNICATION APPROACH
- Use regulatory language accurately
- Translate compliance requirements to business impact
- Provide clear, actionable recommendations
- Include risk of non-compliance (fines, sanctions)
- Highlight positive compliance achievements
- Maintain objective, evidence-based tone`,avatar:"",color:"#059669"},{id:"executive-advisor",name:"Executive Advisor",description:"Strategic GRC advisor providing executive-level insights and recommendations",persona:"Senior executive consultant translating complex GRC data into strategic business insights",systemPrompt:`You are a senior executive advisor specializing in translating complex GRC data into strategic business insights for C-level executives and board members.

# EXECUTIVE-LEVEL GRC INTELLIGENCE FRAMEWORK

## Your Strategic Advisory Role:
- Board and C-Suite GRC advisory
- Strategic risk appetite calibration
- Regulatory strategy formulation
- Crisis management and response
- M&A risk due diligence
- ESG and sustainability governance

## EXECUTIVE REPORTING STRUCTURE

### 1. EXECUTIVE DASHBOARD
**One-page strategic overview:**

**EXECUTIVE GRC DASHBOARD:**
- Overall Risk Score: 7.2/10 
- Compliance Health: 89% 
- Control Effectiveness: 82% 
- Incidents (MTD): 3 Critical
- Audit Findings: 12 Open
- Risk Appetite Usage: 68% 

**Strategic Risk Heat Map:**

Risk Matrix (Impact vs Likelihood):
- High Likelihood: [2] Low Impact, [5] Medium Impact, [8] High Impact, [3] Critical Impact
- Medium Likelihood: [4] Low Impact, [7] Medium Impact, [6] High Impact, [1] Critical Impact  
- Low Likelihood: [9] Low Impact, [11] Medium Impact, [10] High Impact, [0] Critical Impact

### 2. STRATEGIC RISK NARRATIVE

**Top 5 Strategic Risks:**

For each risk, provide:
1. **Risk Title & Business Context**
   - Strategic objective impact
   - Competitive implications
   - Stakeholder concerns

2. **Financial Quantification**
   - Potential loss range: $[X]M - $[Y]M
   - Probability-weighted impact: $[Z]M
   - Cost of mitigation: $[A]M
   - Risk-adjusted ROI: [%]

3. **Strategic Options**
   - Accept: Business rationale
   - Mitigate: Investment required
   - Transfer: Insurance/hedging options
   - Avoid: Strategic pivot needed

### 3. BOARD-LEVEL INSIGHTS

**Governance Effectiveness:**

**Board Risk Oversight Metrics:**
- Risk Committee Meetings: 12/12 
- Risk Appetite Breaches: 2 
- Management Actions Overdue: 3 
- Independent Assurance: Level 2 

**Peer Benchmarking:**
- Industry Risk Maturity: Top Quartile/Average/Bottom
- Regulatory Compliance: Above/At/Below Industry
- Incident Rate: X% better/worse than peers
- Investment in GRC: $X per $1M revenue (Industry: $Y)

### 4. STRATEGIC RECOMMENDATIONS

**Immediate Board Actions Required:**
1. **[Decision Title]**
   - Context: [Business situation]
   - Options: [A, B, C with trade-offs]
   - Recommendation: [Preferred option]
   - Timeline: [Decision deadline]
   - Impact: [Strategic consequences]

**Investment Priorities Matrix:**

**High Impact / Low Cost (DO NOW):**
 Initiative 1 ($X, Y months)
 Initiative 2 ($X, Y months)

**High Impact / High Cost (PLAN):**
 Initiative 3 ($X, Y months)
 Initiative 4 ($X, Y months)

### 5. REGULATORY & COMPLIANCE OUTLOOK

**Regulatory Horizon Scanning:**
- **6 Months**: [Upcoming requirements]
- **12 Months**: [Preparation needed]
- **24 Months**: [Strategic planning]

**Compliance Investment Analysis:**
- Current Spend: $[X]M annually
- Required Investment: $[Y]M
- Penalty Avoidance: $[Z]M
- Reputational Value Protection: [Qualitative]

### 6. CRISIS READINESS ASSESSMENT

**Scenario Response Capability:**
- Cyber Incident: [Ready/Partial/Not Ready]
- Regulatory Breach: [Ready/Partial/Not Ready]
- Operational Failure: [Ready/Partial/Not Ready]
- Reputational Crisis: [Ready/Partial/Not Ready]

### 7. STRATEGIC VALUE CREATION

**GRC as Competitive Advantage:**
- Trust Premium: [Customer confidence metrics]
- Operational Excellence: [Efficiency gains]
- Market Access: [Regulatory clearances]
- Cost of Capital: [Risk-adjusted rates]
- M&A Readiness: [Due diligence preparedness]

### 8. EXECUTIVE DECISION SUPPORT

**Risk-Adjusted Decision Framework:**
For major decisions, provide:
- Risk-adjusted NPV
- Scenario analysis (Best/Expected/Worst)
- Strategic option valuation
- Stakeholder impact assessment
- Reversibility and exit strategies

## COMMUNICATION PRINCIPLES

**For Board Presentations:**
- Lead with business impact, not GRC details
- Use financial metrics and business KPIs
- Provide clear recommendations with options
- Include competitive context
- Focus on strategic enablement, not just protection
- Time-box detailed discussions

**For C-Suite Briefings:**
- Connect to strategic objectives
- Quantify in business terms
- Provide actionable intelligence
- Include early warning indicators
- Suggest strategic opportunities
- Maintain solution orientation

## VISUAL COMMUNICATION STANDARDS
- Use executive dashboards sparingly
- Include trend indicators ()
- Apply traffic light systems ()
- Provide one-page summaries
- Use charts over tables where possible
- Include confidence levels for projections`,avatar:"",color:"#7c3aed"}],WT={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_BASE_URL:"https://grc-backend-simple.calmmeadow-5080198e.australiasoutheast.azurecontainerapps.io/api/v1"},KT=()=>{var i;const t="production",n="https://grc-backend-simple.calmmeadow-5080198e.australiasoutheast.azurecontainerapps.io/api/v1",r=(i=window==null?void 0:window.location)==null?void 0:i.hostname;if(console.log(" Environment Detection:",{isDev:!1,mode:t,baseUrl:n,hostname:r,"import.meta.env":WT}),(r==null?void 0:r.includes("azurestaticapps.net"))||(r==null?void 0:r.includes("z8.web.core.windows.net"))||(r==null?void 0:r.includes("pages.dev"))){const l=n;return console.log(" Cloud hosting detected - using Cloudflare Worker:",l),l}return console.log(" Using configured API URL from VITE_API_BASE_URL:",n),n},Sn=e=>{const t=KT(),n=e.startsWith("/")?e.slice(1):e;return`${t}/${n}`};class GT{get baseUrl(){return Sn("").replace(/\/$/,"")}async getAllLlmConfigs(){var t;try{const r=await(await fetch(Sn("simple-llm-configs"))).json();if(!r.success)throw new Error(r.error||"Failed to fetch LLM configurations");const a=((t=r.data)==null?void 0:t.llm_configs)||[];console.log(" Raw API Response - llm_configs:",a),a.forEach((l,o)=>{console.log(`  Raw Config ${o}:`,{config_id:l.config_id,id:l.id,name:l.name})});const i=a.map(l=>this.transformDatabaseRecord(l));return console.log(" Transformed Configs:"),i.forEach((l,o)=>{console.log(`  Transformed ${o}:`,{id:l.id,name:l.name,idType:typeof l.id})}),i}catch(n){return console.error("Error fetching LLM configurations:",n),[]}}async createLlmConfig(t){const r=await(await fetch(Sn("simple-llm-configs"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.id,name:t.name,description:t.description,provider:t.provider,model:t.model,endpoint:t.endpoint,api_key:t.apiKey,custom_headers:t.customHeaders?JSON.stringify(t.customHeaders):null,max_tokens:t.maxTokens,temperature:t.temperature,rate_limit:t.rateLimit,is_enabled:t.isEnabled?1:0})})).json();if(!r.success)throw new Error(r.error||"Failed to create LLM configuration");return this.transformDatabaseRecord(r.data.llm_config)}async updateLlmConfig(t,n){const r={};n.name!==void 0&&(r.name=n.name),n.description!==void 0&&(r.description=n.description),n.provider!==void 0&&(r.provider=n.provider),n.model!==void 0&&(r.model=n.model),n.endpoint!==void 0&&(r.endpoint=n.endpoint),n.apiKey!==void 0&&(r.api_key=n.apiKey),n.customHeaders!==void 0&&(r.custom_headers=n.customHeaders?JSON.stringify(n.customHeaders):null),n.maxTokens!==void 0&&(r.max_tokens=n.maxTokens),n.temperature!==void 0&&(r.temperature=n.temperature),n.rateLimit!==void 0&&(r.rate_limit=n.rateLimit),n.isEnabled!==void 0&&(r.is_enabled=n.isEnabled?1:0);const i=await(await fetch(Sn(`simple-llm-configs/${t}`),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json();if(!i.success)throw new Error(i.error||"Failed to update LLM configuration");console.log(" Update Response:",i);const l=i.data.llm_config||i.data.config||i.data;if(console.log(" Record to Transform:",l),!l)throw new Error("No LLM configuration data returned from update");return this.transformDatabaseRecord(l)}async deleteLlmConfig(t){const r=await(await fetch(Sn(`simple-llm-configs/${t}`),{method:"DELETE"})).json();if(!r.success)throw new Error(r.error||"Failed to delete LLM configuration")}async toggleLlmConfig(t,n){return this.updateLlmConfig(t,{isEnabled:n})}transformDatabaseRecord(t){return{id:t.config_id||t.id,name:t.name||"Unknown",description:t.description||"",provider:t.provider||"unknown",model:t.model||"unknown",endpoint:t.endpoint||t.base_url||"",apiKey:t.api_key||"",customHeaders:t.custom_headers?JSON.parse(t.custom_headers):void 0,maxTokens:t.max_tokens||4e3,temperature:t.temperature||.7,rateLimit:t.rate_limit,status:t.is_enabled?"connected":"disconnected",isEnabled:!!t.is_enabled,createdAt:t.created_at,lastTested:t.updated_at,errorMessage:void 0}}}const Rs=new GT,QT=({open:e,onClose:t,agent:n,isEditing:r=!1,tenantId:a,onSave:i})=>{const{tenant:l}=it(),[o,c]=S.useState("general"),[u,m]=S.useState(!1),[d,p]=S.useState(null),[f,g]=S.useState({name:"",description:"",persona:"",systemPrompt:"",llmConfigId:"",enabledMcpServers:[],capabilities:[],useCase:"",avatar:"",color:"#2563eb",isEnabled:!0}),[v,T]=S.useState([]),[y,b]=S.useState([]),[x,I]=S.useState(null),[C,E]=S.useState(null);S.useEffect(()=>{if(!a||!e)return;if((async()=>{try{const H=await Rs.getAllLlmConfigs();T(H)}catch(H){console.error("Error loading LLM configurations:",H)}})(),(async()=>{try{Hr.setTenantContext(a);const Y=(await Hr.getAllMcpConfigs()).map(P=>({id:P.server_id,name:P.display_name||P.custom_name||P.server_name,description:P.description,isEnabled:P.is_enabled,category:P.category,server_type:P.server_type,available_tools:P.available_tools||[],tenant_server_id:P.tenant_server_id}));b(Y),console.log(" [AgentConfigModal] Loaded MCP servers from database:",Y)}catch(H){console.error(" [AgentConfigModal] Failed to load MCP servers from database:",H),b([])}})(),r&&n){const Y=Zh(a).getAgentMetrics(n.id);E(Y)}},[a,e,r,n]),S.useEffect(()=>{n&&r?g({name:n.name,description:n.description,persona:n.persona||"",systemPrompt:n.systemPrompt,llmConfigId:n.llmConfigId||"",enabledMcpServers:n.enabledMcpServers||[],capabilities:n.capabilities||[],useCase:n.useCase||"",avatar:n.avatar||"",color:n.color||"#2563eb",isEnabled:n.isEnabled}):(g({name:"",description:"",persona:"",systemPrompt:"",llmConfigId:"",enabledMcpServers:[],capabilities:[],useCase:"",avatar:"",color:"#2563eb",isEnabled:!0}),I(null))},[n,r,e]);const N=M=>{const R=rp.find(H=>H.id===M);R&&(I(M),g({...f,name:R.name,description:R.description,persona:R.persona,systemPrompt:R.systemPrompt,avatar:R.avatar,color:R.color}))},O=M=>{g(R=>{const H=R.enabledMcpServers||[];return{...R,enabledMcpServers:H.includes(M)?H.filter(Y=>Y!==M):[...H,M]}})},D=async()=>{if(!f.name.trim()){p({type:"error",text:"Agent name is required"});return}if(!f.llmConfigId){p({type:"error",text:"LLM configuration is required"});return}if((f.enabledMcpServers||[]).length===0){p({type:"error",text:"At least one MCP server must be enabled"});return}try{m(!0),p(null);const M=wr(a);r&&n?(await M.updateAgent(n.id,f),p({type:"success",text:"Agent updated successfully"})):(await M.createAgent(f),p({type:"success",text:"Agent created successfully"})),setTimeout(()=>{i(),t()},1e3)}catch(M){console.error("Error saving agent:",M),p({type:"error",text:"Failed to save agent. Please try again."})}finally{m(!1)}},A=async()=>{if(!(!n||!r)&&confirm(`Are you sure you want to delete the agent "${n.name}"? This action cannot be undone.`))try{m(!0),await wr(a).deleteAgent(n.id),p({type:"success",text:"Agent deleted successfully"}),setTimeout(()=>{i(),t()},1e3)}catch(M){console.error("Error deleting agent:",M),p({type:"error",text:"Failed to delete agent. Please try again."})}finally{m(!1)}},z=[{id:"general",label:"General",icon:Es},{id:"persona",label:"Persona",icon:Ts},{id:"integrations",label:"Integrations",icon:at},{id:"performance",label:"Performance",icon:vt}];return e?s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[s.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(Es,{className:"h-5 w-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold",children:r?`Configure ${n==null?void 0:n.name}`:"Create AI Agent"}),s.jsx("p",{className:"text-sm text-gray-600",children:r?"Modify agent settings and capabilities":"Set up a new AI agent with custom configuration"})]})]}),s.jsx(G,{variant:"ghost",onClick:t,className:"p-2",children:s.jsx(Jh,{className:"h-4 w-4"})})]}),s.jsx("div",{className:"border-b bg-gray-50",children:s.jsx("div",{className:"flex space-x-0 px-6",children:z.map(M=>{const R=M.icon;return s.jsx("button",{onClick:()=>c(M.id),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${o===M.id?"border-blue-500 text-blue-600 bg-white":"border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(R,{className:"h-4 w-4"}),s.jsx("span",{children:M.label})]})},M.id)})})}),s.jsxs("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:[d&&s.jsxs(Ie,{className:`mb-4 ${d.type==="success"?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[d.type==="success"?s.jsx(Le,{className:"h-4 w-4 text-green-600"}):s.jsx(us,{className:"h-4 w-4 text-red-600"}),s.jsx("div",{className:"ml-2",children:s.jsx("p",{className:`text-sm ${d.type==="success"?"text-green-800":"text-red-800"}`,children:d.text})})]}),o==="general"&&s.jsxs("div",{className:"space-y-6",children:[!r&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx(ET,{className:"h-5 w-5 text-yellow-500"}),s.jsx("h3",{className:"text-lg font-medium",children:"Start with a Preset"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:rp.map(M=>s.jsxs("div",{className:`p-4 border rounded-lg cursor-pointer transition-all ${x===M.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>N(M.id),children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[s.jsx("span",{className:"text-2xl",children:M.avatar}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium",children:M.name}),s.jsx("p",{className:"text-sm text-gray-600",children:M.description})]}),x===M.id&&s.jsx(Le,{className:"h-5 w-5 text-blue-500"})]}),s.jsx("div",{className:"flex flex-wrap gap-1",children:s.jsxs(J,{variant:"outline",className:"text-xs",children:[M.avatar," ",M.name]})})]},M.id))})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium mb-4",children:"Basic Information"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Agent Name *"}),s.jsx("input",{type:"text",value:f.name,onChange:M=>g({...f,name:M.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Risk Analysis Specialist"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Avatar"}),s.jsx("div",{className:"flex space-x-2",children:["","","","","","","",""].map(M=>s.jsx("button",{type:"button",onClick:()=>g({...f,avatar:M}),className:`p-2 border rounded-md text-xl hover:bg-gray-50 ${f.avatar===M?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:M},M))})]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),s.jsx("textarea",{value:f.description,onChange:M=>g({...f,description:M.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Brief description of what this agent specializes in..."})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Use Case"}),s.jsx("input",{type:"text",value:f.useCase,onChange:M=>g({...f,useCase:M.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., comprehensive-grc-analysis, risk-management"})]})]})]}),o==="persona"&&s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium mb-4",children:"Agent Persona & Behavior"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Persona Description"}),s.jsx("textarea",{value:f.persona,onChange:M=>g({...f,persona:M.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe the agent's personality and expertise (e.g., Professional, analytical, detail-oriented GRC expert with deep regulatory knowledge)"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"System Prompt"}),s.jsx("textarea",{value:f.systemPrompt,onChange:M=>g({...f,systemPrompt:M.target.value}),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Detailed instructions for how the agent should behave, its role, and response structure..."})]})]})]})}),o==="integrations"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium mb-4",children:"LLM Configuration"}),v.length>0?s.jsxs("select",{value:f.llmConfigId,onChange:M=>g({...f,llmConfigId:M.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Select LLM Configuration..."}),v.map(M=>s.jsxs("option",{value:M.id,children:[M.name," (",M.provider," - ",M.model,")"]},M.id))]}):s.jsxs(Ie,{className:"bg-yellow-50 border-yellow-200",children:[s.jsx(us,{className:"h-4 w-4 text-yellow-600"}),s.jsx("div",{className:"ml-2",children:s.jsx("p",{className:"text-sm text-yellow-800",children:"No LLM configurations available. Please configure at least one LLM in Settings first."})})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium mb-4",children:"MCP Server Access"}),y.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:y.map(M=>s.jsx("div",{className:`p-3 border rounded-lg cursor-pointer transition-all ${(f.enabledMcpServers||[]).includes(M.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>O(M.id),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium",children:M.name}),s.jsx("p",{className:"text-sm text-gray-600",children:M.description})]}),(f.enabledMcpServers||[]).includes(M.id)&&s.jsx(Le,{className:"h-5 w-5 text-blue-500"})]})},M.id))}):s.jsxs(Ie,{className:"bg-yellow-50 border-yellow-200",children:[s.jsx(us,{className:"h-4 w-4 text-yellow-600"}),s.jsx("div",{className:"ml-2",children:s.jsx("p",{className:"text-sm text-yellow-800",children:"No MCP servers available. Please configure at least one MCP server in Settings first."})})]})]})]}),o==="performance"&&s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium mb-4",children:"Performance Metrics"}),r&&C?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg text-center",children:[s.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[C.successRate,"%"]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Success Rate"})]}),s.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900",children:C.totalExecutions}),s.jsx("div",{className:"text-sm text-gray-600",children:"Total Executions"})]}),s.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg text-center",children:[s.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[C.averageExecutionTime,"s"]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Avg Execution Time"})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium mb-3",children:"Recent Activity"}),s.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:C.executionHistory.slice(-10).reverse().map(M=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[M.success?s.jsx(Le,{className:"h-4 w-4 text-green-500"}):s.jsx(us,{className:"h-4 w-4 text-red-500"}),s.jsx("span",{className:"text-sm",children:M.success?"Success":"Failed"})]}),s.jsx("div",{className:"text-xs text-gray-500",children:new Date(M.timestamp).toLocaleString()})]},M.id))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium mb-3",children:"Frequently Used Tools"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:C.toolsUsed.map((M,R)=>s.jsx(J,{variant:"outline",className:"text-xs",children:M.replace(/_/g," ")},`agent-tools-${M}-${R}`))})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(vt,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h4",{className:"font-medium text-gray-600 mb-2",children:"No Performance Data"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Performance metrics will be available after the agent has been used."})]})]})})]}),s.jsxs("div",{className:"sticky bottom-0 bg-white border-t px-6 py-4 flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center space-x-3",children:r&&s.jsxs(G,{variant:"outline",onClick:A,disabled:u,className:"text-red-600 border-red-200 hover:bg-red-50",children:[s.jsx(Ea,{className:"h-4 w-4 mr-2"}),"Delete Agent"]})}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx(G,{variant:"outline",onClick:t,disabled:u,children:"Cancel"}),s.jsx(G,{onClick:D,disabled:u,children:u?s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx($t,{className:"h-4 w-4 animate-spin"}),s.jsx("span",{children:"Saving..."})]}):s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(py,{className:"h-4 w-4"}),s.jsx("span",{children:r?"Update Agent":"Create Agent"})]})})]})]})]})}):null},XT=()=>{console.log("[AgentsPage]  COMPONENT RENDER - Debug keystroke issue");const e=it(E=>E.tenant),t=va();console.log("[AgentsPage]  Tenant object reference check:",e==null?void 0:e.id,typeof e,!!e);const[n,r]=S.useState([]),[a,i]=S.useState(!0),[l,o]=S.useState(new Date),[c,u]=S.useState(!1),[m,d]=S.useState(null),[p,f]=S.useState(!1);S.useEffect(()=>{e!=null&&e.id&&g()},[e==null?void 0:e.id]);const g=async()=>{if(e!=null&&e.id)try{i(!0);const N=await wr(e.id).getAgents();r(N),o(new Date)}catch(E){console.error("Error loading AI agents:",E)}finally{i(!1)}},v=async(E,N)=>{if(console.log("[AgentsPage] handleToggleAgent called with agentId:",E,"enabled:",N),!!(e!=null&&e.id))try{const O=wr(e.id);console.log("[AgentsPage] Calling updateAgent with agentId:",E),await O.updateAgent(E,{isEnabled:N}),await g()}catch(O){console.error("Error toggling AI agent:",O)}},T=E=>{d(E),u(!0)},y=()=>{d(null),f(!0)},b=E=>{console.log(`[AgentsPage]  CHAT BUTTON CLICKED for agent: ${E.name} (${E.id})`),console.log("[AgentsPage] Navigating to chat page with agent:",E.id),t(`/chat?agent=${E.id}`)},x=()=>{u(!1),f(!1),d(null)},I=()=>{g()},C=()=>{g()};return a&&n.length===0?s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex justify-between items-start",children:s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"AI Agents"}),s.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage and monitor your intelligent GRC analysis agents"})]})}),s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"AI Agents"}),s.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage and monitor your intelligent GRC analysis agents"})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsxs(G,{variant:"outline",onClick:C,disabled:a,className:"flex items-center space-x-2",children:[s.jsx($t,{className:`h-4 w-4 ${a?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]}),s.jsxs(G,{onClick:y,children:[s.jsx(pn,{className:"h-4 w-4 mr-2"}),"Create Agent"]})]})]}),(e==null?void 0:e.id)&&s.jsx(MT,{tenantId:e.id}),n.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Es,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"font-medium text-muted-foreground mb-2",children:"No AI Agents Available"}),s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"AI agents will be automatically created when you configure LLM settings and MCP servers."}),s.jsxs(Ie,{className:"max-w-lg mx-auto",children:[s.jsx(ge,{className:"h-4 w-4"}),s.jsx("div",{className:"ml-2",children:s.jsx("p",{className:"text-sm",children:"Configure LLM settings and MCP servers in Settings to enable AI agents."})})]})]}):s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:n.map(E=>s.jsx(YT,{agent:E,tenantId:(e==null?void 0:e.id)||"",onToggle:v,onConfigure:T,onChat:b},E.id))}),n.length>0&&s.jsxs(Ie,{className:"bg-green-50 border-green-200",children:[s.jsx(ge,{className:"h-4 w-4 text-green-600"}),s.jsxs("div",{className:"ml-2",children:[s.jsx("h4",{className:"font-medium text-green-800",children:"System Protection"}),s.jsxs("p",{className:"text-sm text-green-700 mt-1",children:["Circuit Breaker Status: ",s.jsx("span",{className:"font-medium",children:"CLOSED (Normal Operation)"}),s.jsx("br",{}),"Protects against infinite loops and cascading failures"]})]})]}),s.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["Last updated: ",l.toLocaleTimeString(),"  Auto-refresh every 30 seconds for active agents"]}),s.jsx(QT,{open:c||p,onClose:x,agent:m,isEditing:!!m,tenantId:(e==null?void 0:e.id)||"",onSave:I})]})},JT=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Audit Trail"}),s.jsx("p",{className:"text-muted-foreground mt-2",children:"View detailed audit logs and compliance evidence"})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsx(be,{children:"Audit Log Management"})}),s.jsxs(ne,{children:[s.jsx("p",{className:"text-muted-foreground",children:"Audit trail interface will be available here. This would include:"}),s.jsxs("ul",{className:"mt-2 text-sm text-muted-foreground space-y-1",children:[s.jsx("li",{children:" Search and filter audit events"}),s.jsx("li",{children:" Export audit logs for compliance"}),s.jsx("li",{children:" View detailed event information"}),s.jsx("li",{children:" Track user activities and system changes"}),s.jsx("li",{children:" Generate audit reports"})]})]})]})]}),pe=S.forwardRef(({className:e,type:t="text",error:n,...r},a)=>s.jsx("input",{type:t,className:Ee("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-colors",n&&"border-destructive focus-visible:ring-destructive",e),ref:a,...r}));pe.displayName="Input";function Td(e){"@babel/helpers - typeof";return Td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Td(e)}function In(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function Et(e){In(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||Td(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}var ZT={};function ew(){return ZT}function sp(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function zl(e,t){In(2,arguments);var n=Et(e),r=Et(t),a=n.getTime()-r.getTime();return a<0?-1:a>0?1:a}function tw(e,t){In(2,arguments);var n=Et(e),r=Et(t),a=n.getFullYear()-r.getFullYear(),i=n.getMonth()-r.getMonth();return a*12+i}function nw(e,t){return In(2,arguments),Et(e).getTime()-Et(t).getTime()}var rw={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(t){return t<0?Math.ceil(t):Math.floor(t)}},sw="trunc";function aw(e){return rw[sw]}function iw(e){In(1,arguments);var t=Et(e);return t.setHours(23,59,59,999),t}function lw(e){In(1,arguments);var t=Et(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function ow(e){In(1,arguments);var t=Et(e);return iw(t).getTime()===lw(t).getTime()}function cw(e,t){In(2,arguments);var n=Et(e),r=Et(t),a=zl(n,r),i=Math.abs(tw(n,r)),l;if(i<1)l=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-a*i);var o=zl(n,r)===-a;ow(Et(e))&&i===1&&zl(e,r)===1&&(o=!1),l=a*(i-Number(o))}return l===0?0:l}function uw(e,t,n){In(2,arguments);var r=nw(e,t)/1e3;return aw()(r)}var dw={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},hw=function(t,n,r){var a,i=dw[t];return typeof i=="string"?a=i:n===1?a=i.one:a=i.other.replace("{{count}}",n.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+a:a+" ago":a};function Qc(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.width?String(t.width):e.defaultWidth,r=e.formats[n]||e.formats[e.defaultWidth];return r}}var mw={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},fw={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},pw={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},gw={date:Qc({formats:mw,defaultWidth:"full"}),time:Qc({formats:fw,defaultWidth:"full"}),dateTime:Qc({formats:pw,defaultWidth:"full"})},xw={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},yw=function(t,n,r,a){return xw[t]};function Ua(e){return function(t,n){var r=n!=null&&n.context?String(n.context):"standalone",a;if(r==="formatting"&&e.formattingValues){var i=e.defaultFormattingWidth||e.defaultWidth,l=n!=null&&n.width?String(n.width):i;a=e.formattingValues[l]||e.formattingValues[i]}else{var o=e.defaultWidth,c=n!=null&&n.width?String(n.width):e.defaultWidth;a=e.values[c]||e.values[o]}var u=e.argumentCallback?e.argumentCallback(t):t;return a[u]}}var bw={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},vw={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Ew={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Nw={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Tw={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},ww={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Sw=function(t,n){var r=Number(t),a=r%100;if(a>20||a<10)switch(a%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Cw={ordinalNumber:Sw,era:Ua({values:bw,defaultWidth:"wide"}),quarter:Ua({values:vw,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:Ua({values:Ew,defaultWidth:"wide"}),day:Ua({values:Nw,defaultWidth:"wide"}),dayPeriod:Ua({values:Tw,defaultWidth:"wide",formattingValues:ww,defaultFormattingWidth:"wide"})};function Ha(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;var l=i[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(o)?jw(o,function(d){return d.test(l)}):kw(o,function(d){return d.test(l)}),u;u=e.valueCallback?e.valueCallback(c):c,u=n.valueCallback?n.valueCallback(u):u;var m=t.slice(l.length);return{value:u,rest:m}}}function kw(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(e[n]))return n}function jw(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n}function Aw(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.match(e.matchPattern);if(!r)return null;var a=r[0],i=t.match(e.parsePattern);if(!i)return null;var l=e.valueCallback?e.valueCallback(i[0]):i[0];l=n.valueCallback?n.valueCallback(l):l;var o=t.slice(a.length);return{value:l,rest:o}}}var _w=/^(\d+)(th|st|nd|rd)?/i,Iw=/\d+/i,Lw={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Rw={any:[/^b/i,/^(a|c)/i]},Pw={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Mw={any:[/1/i,/2/i,/3/i,/4/i]},Ow={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Dw={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Fw={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Bw={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Uw={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Hw={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},zw={ordinalNumber:Aw({matchPattern:_w,parsePattern:Iw,valueCallback:function(t){return parseInt(t,10)}}),era:Ha({matchPatterns:Lw,defaultMatchWidth:"wide",parsePatterns:Rw,defaultParseWidth:"any"}),quarter:Ha({matchPatterns:Pw,defaultMatchWidth:"wide",parsePatterns:Mw,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:Ha({matchPatterns:Ow,defaultMatchWidth:"wide",parsePatterns:Dw,defaultParseWidth:"any"}),day:Ha({matchPatterns:Fw,defaultMatchWidth:"wide",parsePatterns:Bw,defaultParseWidth:"any"}),dayPeriod:Ha({matchPatterns:Uw,defaultMatchWidth:"any",parsePatterns:Hw,defaultParseWidth:"any"})},$w={code:"en-US",formatDistance:hw,formatLong:gw,formatRelative:yw,localize:Cw,match:zw,options:{weekStartsOn:0,firstWeekContainsDate:1}};function vy(e,t){if(e==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function qw(e){return vy({},e)}var ap=1440,Vw=2520,Xc=43200,Yw=86400;function Ww(e,t,n){var r,a;In(2,arguments);var i=ew(),l=(r=(a=n==null?void 0:n.locale)!==null&&a!==void 0?a:i.locale)!==null&&r!==void 0?r:$w;if(!l.formatDistance)throw new RangeError("locale must contain formatDistance property");var o=zl(e,t);if(isNaN(o))throw new RangeError("Invalid time value");var c=vy(qw(n),{addSuffix:!!(n!=null&&n.addSuffix),comparison:o}),u,m;o>0?(u=Et(t),m=Et(e)):(u=Et(e),m=Et(t));var d=uw(m,u),p=(sp(m)-sp(u))/1e3,f=Math.round((d-p)/60),g;if(f<2)return n!=null&&n.includeSeconds?d<5?l.formatDistance("lessThanXSeconds",5,c):d<10?l.formatDistance("lessThanXSeconds",10,c):d<20?l.formatDistance("lessThanXSeconds",20,c):d<40?l.formatDistance("halfAMinute",0,c):d<60?l.formatDistance("lessThanXMinutes",1,c):l.formatDistance("xMinutes",1,c):f===0?l.formatDistance("lessThanXMinutes",1,c):l.formatDistance("xMinutes",f,c);if(f<45)return l.formatDistance("xMinutes",f,c);if(f<90)return l.formatDistance("aboutXHours",1,c);if(f<ap){var v=Math.round(f/60);return l.formatDistance("aboutXHours",v,c)}else{if(f<Vw)return l.formatDistance("xDays",1,c);if(f<Xc){var T=Math.round(f/ap);return l.formatDistance("xDays",T,c)}else if(f<Yw)return g=Math.round(f/Xc),l.formatDistance("aboutXMonths",g,c)}if(g=cw(m,u),g<12){var y=Math.round(f/Xc);return l.formatDistance("xMonths",y,c)}else{var b=g%12,x=Math.floor(g/12);return b<3?l.formatDistance("aboutXYears",x,c):b<9?l.formatDistance("overXYears",x,c):l.formatDistance("almostXYears",x+1,c)}}function jo(e,t){return In(1,arguments),Ww(e,Date.now(),t)}const Kw=({users:e,onUserSelect:t,onEditProfile:n,onManageRoles:r})=>{const a=l=>{switch(l){case"TenantOwner":return"default";case"AgentUser":return"secondary";case"Auditor":return"outline";case"ComplianceOfficer":return"outline";default:return"secondary"}},i=l=>{switch(l){case"TenantOwner":return"Tenant Owner";case"AgentUser":return"Agent User";case"ComplianceOfficer":return"Compliance Officer";default:return l}};return e.length===0?s.jsx(Q,{children:s.jsxs(ne,{className:"p-12 text-center",children:[s.jsx(Ts,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No users found"}),s.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search criteria or filters."})]})}):s.jsx(Q,{children:s.jsx(ne,{className:"p-0",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50/50",children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left p-4 font-semibold text-gray-900 text-sm",children:"User"}),s.jsx("th",{className:"text-left p-4 font-semibold text-gray-900 text-sm",children:"Roles"}),s.jsx("th",{className:"text-left p-4 font-semibold text-gray-900 text-sm",children:"Department"}),s.jsx("th",{className:"text-left p-4 font-semibold text-gray-900 text-sm",children:"Status"}),s.jsx("th",{className:"text-left p-4 font-semibold text-gray-900 text-sm",children:"Last Login"}),s.jsx("th",{className:"text-left p-4 font-semibold text-gray-900 text-sm",children:"Security"}),s.jsx("th",{className:"text-center p-4 font-semibold text-gray-900 text-sm",children:"Actions"})]})}),s.jsx("tbody",{children:e.map(l=>{var o,c,u;return s.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50/80 transition-all duration-200 cursor-pointer group",onClick:()=>t(l),children:[s.jsx("td",{className:"p-4",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"h-12 w-12 rounded-full bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center shadow-sm",children:(o=l.profile)!=null&&o.avatar?s.jsx("img",{src:l.profile.avatar,alt:l.name,className:"h-12 w-12 rounded-full object-cover"}):s.jsx(Ts,{className:"h-6 w-6 text-blue-600"})}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("div",{className:"font-semibold text-gray-900 truncate",children:l.name}),s.jsxs("div",{className:"text-sm text-gray-600 flex items-center",children:[s.jsx(fy,{className:"h-3 w-3 mr-1 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:l.email})]}),((c=l.profile)==null?void 0:c.jobTitle)&&s.jsx("div",{className:"text-xs text-gray-500 truncate",children:l.profile.jobTitle})]})]})}),s.jsx("td",{className:"p-4",children:s.jsx("div",{className:"flex flex-wrap gap-1",children:l.roles.map(m=>s.jsx(J,{variant:a(m),className:"text-xs",children:i(m)},m))})}),s.jsx("td",{className:"p-4",children:s.jsx("div",{className:"text-sm",children:((u=l.profile)==null?void 0:u.department)||"Not specified"})}),s.jsx("td",{className:"p-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:`h-3 w-3 rounded-full ${l.isActive?"bg-green-500":"bg-red-500"}`}),s.jsx(J,{variant:l.isActive?"default":"secondary",className:`text-xs font-medium ${l.isActive?"bg-green-100 text-green-800 border-green-200":"bg-gray-100 text-gray-800 border-gray-200"}`,children:l.isActive?"Active":"Inactive"})]})}),s.jsx("td",{className:"p-4",children:s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center text-sm text-gray-700",children:[s.jsx(Tt,{className:"h-4 w-4 mr-2 text-gray-400"}),l.lastLogin?jo(new Date(l.lastLogin),{addSuffix:!0}):"Never logged in"]}),l.lastActiveAt&&s.jsxs("div",{className:"text-xs text-gray-500 ml-6",children:["Active: ",jo(new Date(l.lastActiveAt),{addSuffix:!0})]})]})}),s.jsx("td",{className:"p-4",children:s.jsx("div",{className:"flex items-center space-x-2",children:l.mfaEnabled?s.jsxs(J,{className:"bg-green-100 text-green-800 border-green-200 text-xs font-medium",children:[s.jsx(Co,{className:"h-3 w-3 mr-1"}),"MFA Enabled"]}):s.jsxs(J,{className:"bg-yellow-100 text-yellow-800 border-yellow-200 text-xs font-medium",children:[s.jsx(gy,{className:"h-3 w-3 mr-1"}),"MFA Required"]})})}),s.jsx("td",{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx(G,{variant:"ghost",size:"sm",onClick:m=>{m.stopPropagation(),n(l)},className:"h-10 w-10 p-0 hover:bg-blue-50 hover:text-blue-600 transition-all duration-200 rounded-lg",title:"Edit Profile",children:s.jsx(Gh,{className:"h-5 w-5 text-blue-500"})}),s.jsx(G,{variant:"ghost",size:"sm",onClick:m=>{m.stopPropagation(),r(l)},className:"h-10 w-10 p-0 hover:bg-green-50 hover:text-green-600 transition-all duration-200 rounded-lg",title:"Manage Roles",children:s.jsx(ge,{className:"h-5 w-5 text-green-500"})}),s.jsx(G,{variant:"ghost",size:"sm",onClick:m=>{m.stopPropagation()},className:"h-10 w-10 p-0 hover:bg-gray-50 hover:text-gray-600 transition-all duration-200 rounded-lg",title:"More Options",children:s.jsx(xT,{className:"h-5 w-5 text-gray-500"})})]})})]},l.id)})})]})})})})},Ey=S.createContext(void 0);function Yr({open:e,onOpenChange:t,children:n}){const[r,a]=S.useState(!1),i=e??r,l=t??a;return S.useEffect(()=>{const o=c=>{c.key==="Escape"&&i&&l(!1)};return i&&(document.addEventListener("keydown",o),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",o),document.body.style.overflow="unset"}},[i,l]),s.jsx(Ey.Provider,{value:{open:i,onOpenChange:l},children:n})}function Wr({children:e,className:t="",showClose:n=!0}){const r=S.useContext(Ey);if(!r)throw new Error("DialogContent must be used within a Dialog");const{open:a,onOpenChange:i}=r;return a?s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>i(!1)}),s.jsxs("div",{className:`
          relative bg-white rounded-lg shadow-xl border border-gray-200 
          w-full max-w-lg mx-4 sm:mx-6 md:mx-8 lg:mx-12 xl:mx-auto max-h-[95vh] 
          animate-in fade-in-0 zoom-in-95 slide-in-from-bottom-2
          ${t}
        `,onClick:l=>l.stopPropagation(),children:[n&&s.jsx("button",{className:"absolute right-4 sm:right-6 lg:right-8 top-4 sm:top-6 p-1 rounded-sm opacity-70 hover:opacity-100 transition-opacity z-10",onClick:()=>i(!1),children:s.jsx(Jh,{className:"h-4 w-4"})}),e]})]}):null}function Kr({children:e,className:t=""}){return s.jsx("div",{className:`px-4 sm:px-6 lg:px-8 py-4 sm:py-6 border-b border-gray-200 ${t}`,children:e})}function Gr({children:e,className:t=""}){return s.jsx("h2",{className:`text-lg font-semibold text-gray-900 ${t}`,children:e})}function Ny({children:e,className:t=""}){return s.jsx("p",{className:`text-sm text-gray-600 mt-1 ${t}`,children:e})}function em({children:e,className:t=""}){return s.jsx("div",{className:`px-4 sm:px-6 lg:px-8 py-4 sm:py-6 ${t}`,children:e})}function Qr({children:e,className:t=""}){return s.jsx("div",{className:`px-4 sm:px-6 lg:px-8 py-4 sm:py-6 border-t border-gray-200 bg-white ${t}`,children:e})}const de=S.forwardRef(({className:e,children:t,required:n,...r},a)=>s.jsxs("label",{ref:a,className:Ee("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...r,children:[t,n&&s.jsx("span",{className:"text-destructive ml-1",children:"*"})]}));de.displayName="Label";const Gw=({open:e,onOpenChange:t,user:n,onUserUpdated:r})=>{var p,f;const[a,i]=S.useState(!1),[l,o]=S.useState(!1),[c,u]=S.useState({name:n.name,email:n.email,firstName:n.profile.firstName,lastName:n.profile.lastName,phoneNumber:n.profile.phoneNumber||"",department:n.profile.department||"",jobTitle:n.profile.jobTitle||""}),m=async()=>{o(!0);try{await new Promise(v=>setTimeout(v,1e3));const g={...n,name:c.name,email:c.email,profile:{...n.profile,firstName:c.firstName,lastName:c.lastName,phoneNumber:c.phoneNumber,department:c.department,jobTitle:c.jobTitle},updatedAt:new Date().toISOString()};r(g),i(!1)}catch(g){console.error("Failed to update user:",g)}finally{o(!1)}},d=()=>{u({name:n.name,email:n.email,firstName:n.profile.firstName,lastName:n.profile.lastName,phoneNumber:n.profile.phoneNumber||"",department:n.profile.department||"",jobTitle:n.profile.jobTitle||""}),i(!1)};return s.jsx(Yr,{open:e,onOpenChange:t,children:s.jsxs(Wr,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[s.jsx(Kr,{children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-6",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"h-16 w-16 rounded-full bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center shadow-sm",children:(p=n.profile)!=null&&p.avatar?s.jsx("img",{src:n.profile.avatar,alt:n.name,className:"h-16 w-16 rounded-full object-cover"}):s.jsx(Ts,{className:"h-8 w-8 text-blue-600"})}),s.jsxs("div",{className:"space-y-1",children:[s.jsx(Gr,{className:"text-2xl font-bold text-gray-900",children:n.name}),s.jsx("p",{className:"text-gray-600 font-medium",children:n.email}),((f=n.profile)==null?void 0:f.jobTitle)&&s.jsx("p",{className:"text-sm text-gray-500",children:n.profile.jobTitle})]})]}),s.jsx("div",{className:"flex flex-wrap items-center gap-2",children:n.roles.map(g=>s.jsx(J,{variant:"secondary",className:"text-xs font-medium px-3 py-1",children:g.replace(/([A-Z])/g," $1").trim()},g))})]})}),s.jsx(em,{className:"py-0",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsx("div",{className:"lg:col-span-2 space-y-6",children:s.jsxs(Q,{className:"shadow-sm border-gray-200",children:[s.jsx(he,{className:"pb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(be,{className:"flex items-center space-x-3 text-lg font-semibold text-gray-900",children:[s.jsx(Ts,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{children:"Profile Information"})]}),!a&&s.jsxs(G,{variant:"outline",size:"sm",onClick:()=>i(!0),className:"hover:bg-blue-50 hover:text-blue-700 hover:border-blue-300 transition-all duration-200",children:[s.jsx(dt,{className:"h-4 w-4 mr-2"}),"Edit Profile"]})]})}),s.jsxs(ne,{className:"space-y-6",children:[a?s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"firstName",className:"text-sm font-medium text-gray-700",children:"First Name"}),s.jsx(pe,{id:"firstName",value:c.firstName,onChange:g=>u(v=>({...v,firstName:g.target.value})),className:"focus:ring-2 focus:ring-blue-500 focus:border-blue-500 border-gray-300"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"lastName",className:"text-sm font-medium text-gray-700",children:"Last Name"}),s.jsx(pe,{id:"lastName",value:c.lastName,onChange:g=>u(v=>({...v,lastName:g.target.value})),className:"focus:ring-2 focus:ring-blue-500 focus:border-blue-500 border-gray-300"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"email",className:"text-sm font-medium text-gray-700",children:"Email Address"}),s.jsx(pe,{id:"email",type:"email",value:c.email,onChange:g=>u(v=>({...v,email:g.target.value})),className:"focus:ring-2 focus:ring-blue-500 focus:border-blue-500 border-gray-300"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"phoneNumber",className:"text-sm font-medium text-gray-700",children:"Phone Number"}),s.jsx(pe,{id:"phoneNumber",value:c.phoneNumber,onChange:g=>u(v=>({...v,phoneNumber:g.target.value})),className:"focus:ring-2 focus:ring-blue-500 focus:border-blue-500 border-gray-300",placeholder:"(555) 123-4567"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"department",className:"text-sm font-medium text-gray-700",children:"Department"}),s.jsx(pe,{id:"department",value:c.department,onChange:g=>u(v=>({...v,department:g.target.value})),className:"focus:ring-2 focus:ring-blue-500 focus:border-blue-500 border-gray-300",placeholder:"IT, HR, Finance, etc."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"jobTitle",className:"text-sm font-medium text-gray-700",children:"Job Title"}),s.jsx(pe,{id:"jobTitle",value:c.jobTitle,onChange:g=>u(v=>({...v,jobTitle:g.target.value})),className:"focus:ring-2 focus:ring-blue-500 focus:border-blue-500 border-gray-300",placeholder:"Senior Developer, Manager, etc."})]})]}):s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"flex items-start space-x-4 p-4 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(fy,{className:"h-5 w-5 text-blue-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900 mb-1",children:"Email Address"}),s.jsx("p",{className:"text-sm text-gray-700",children:n.email})]})]}),n.profile.phoneNumber&&s.jsxs("div",{className:"flex items-start space-x-4 p-4 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:s.jsx(bT,{className:"h-5 w-5 text-green-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900 mb-1",children:"Phone Number"}),s.jsx("p",{className:"text-sm text-gray-700",children:n.profile.phoneNumber})]})]}),n.profile.department&&s.jsxs("div",{className:"flex items-start space-x-4 p-4 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:s.jsx(Nd,{className:"h-5 w-5 text-purple-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900 mb-1",children:"Department"}),s.jsx("p",{className:"text-sm text-gray-700",children:n.profile.department})]})]}),n.profile.jobTitle&&s.jsxs("div",{className:"flex items-start space-x-4 p-4 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:s.jsx(iT,{className:"h-5 w-5 text-orange-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900 mb-1",children:"Job Title"}),s.jsx("p",{className:"text-sm text-gray-700",children:n.profile.jobTitle})]})]})]})}),a&&s.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[s.jsx(G,{variant:"outline",onClick:d,disabled:l,className:"px-6 hover:bg-gray-50",children:"Cancel"}),s.jsx(G,{onClick:m,disabled:l,className:"px-6 bg-blue-600 hover:bg-blue-700 text-white",children:l?"Saving...":"Save Changes"})]})]})]})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs(Q,{className:"shadow-sm border-gray-200",children:[s.jsx(he,{className:"pb-4",children:s.jsxs(be,{className:"flex items-center space-x-3 text-lg font-semibold text-gray-900",children:[s.jsx(ge,{className:"h-5 w-5 text-green-600"}),s.jsx("span",{children:"Account Status"})]})}),s.jsxs(ne,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Account Status"}),s.jsx(J,{variant:n.isActive?"default":"destructive",className:"px-3 py-1 text-xs font-medium",children:n.isActive?"Active":"Inactive"})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Multi-Factor Authentication"}),s.jsx(J,{variant:n.mfaEnabled?"default":"outline",className:`px-3 py-1 text-xs font-medium ${n.mfaEnabled?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200"}`,children:n.mfaEnabled?"Enabled":"Not Enabled"})]}),s.jsxs("div",{className:"space-y-4 pt-2 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:s.jsx(Tt,{className:"h-4 w-4 text-gray-600"})}),s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Activity Timeline"})]}),s.jsxs("div",{className:"text-sm space-y-3 ml-4",children:[s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-gray-600",children:"Account Created"}),s.jsx("span",{className:"font-medium text-gray-900",children:new Date(n.createdAt).toLocaleDateString()})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[s.jsx("span",{className:"text-gray-600",children:"Last Login"}),s.jsx("span",{className:"font-medium text-gray-900",children:n.lastLogin?jo(new Date(n.lastLogin),{addSuffix:!0}):"Never"})]}),n.lastActiveAt&&s.jsxs("div",{className:"flex justify-between items-center py-2",children:[s.jsx("span",{className:"text-gray-600",children:"Last Activity"}),s.jsx("span",{className:"font-medium text-gray-900",children:jo(new Date(n.lastActiveAt),{addSuffix:!0})})]})]})]})]})]}),s.jsxs(Q,{className:"shadow-sm border-gray-200",children:[s.jsx(he,{className:"pb-4",children:s.jsxs(be,{className:"flex items-center space-x-3 text-lg font-semibold text-gray-900",children:[s.jsx(ge,{className:"h-5 w-5 text-indigo-600"}),s.jsx("span",{children:"Roles & Permissions"})]})}),s.jsx(ne,{children:s.jsx("div",{className:"space-y-4",children:n.roles.map((g,v)=>s.jsxs("div",{className:"flex items-center space-x-4 p-3 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:`p-2 rounded-lg ${v%4===0?"bg-blue-100":v%4===1?"bg-green-100":v%4===2?"bg-purple-100":"bg-orange-100"}`,children:s.jsx(ge,{className:`h-4 w-4 ${v%4===0?"text-blue-600":v%4===1?"text-green-600":v%4===2?"text-purple-600":"text-orange-600"}`})}),s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:g.replace(/([A-Z])/g," $1").trim()})]},g))})})]})]})]})}),s.jsx(Qr,{children:s.jsx(G,{variant:"outline",onClick:()=>t(!1),className:"px-6 hover:bg-gray-100 border-gray-300",children:"Close"})})]})})},Qw=({open:e,onOpenChange:t,onInviteSent:n})=>{const[r,a]=S.useState({email:"",name:"",role:"AgentUser",department:"",jobTitle:"",message:""}),[i,l]=S.useState(!1),o=async u=>{u.preventDefault(),l(!0);try{await new Promise(d=>setTimeout(d,1e3));const m={id:`inv_${Date.now()}`,email:r.email,role:r.role,invitedBy:"current-user-id",invitedAt:new Date().toISOString(),expiresAt:new Date(Date.now()+7*24*60*60*1e3).toISOString(),status:"pending",message:r.message||void 0};n(m),t(!1),a({email:"",name:"",role:"AgentUser",department:"",jobTitle:"",message:""})}catch(m){console.error("Failed to send invitation:",m)}finally{l(!1)}},c=[{value:"AgentUser",label:"Agent User"},{value:"Auditor",label:"Auditor"},{value:"ComplianceOfficer",label:"Compliance Officer"},{value:"TenantOwner",label:"Tenant Owner"}];return s.jsx(Yr,{open:e,onOpenChange:t,children:s.jsxs(Wr,{className:"max-w-2xl",children:[s.jsxs(Kr,{children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(xy,{className:"h-5 w-5 text-primary"}),s.jsx(Gr,{children:"Invite New User"})]}),s.jsx(Ny,{children:"Send an invitation to add a new user to your tenant."})]}),s.jsx(em,{children:s.jsxs("form",{onSubmit:o,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx(de,{htmlFor:"email",className:"text-sm font-medium text-gray-700",children:"Email Address"}),s.jsx(pe,{id:"email",type:"email",value:r.email,onChange:u=>a(m=>({...m,email:u.target.value})),placeholder:"user@example.com",className:"mt-2",required:!0})]}),s.jsxs("div",{children:[s.jsx(de,{htmlFor:"name",className:"text-sm font-medium text-gray-700",children:"Full Name"}),s.jsx(pe,{id:"name",value:r.name,onChange:u=>a(m=>({...m,name:u.target.value})),placeholder:"John Smith",className:"mt-2",required:!0})]}),s.jsxs("div",{children:[s.jsx(de,{htmlFor:"role",className:"text-sm font-medium text-gray-700",children:"Role"}),s.jsx("select",{id:"role",value:r.role,onChange:u=>a(m=>({...m,role:u.target.value})),className:"mt-2 w-full px-3 py-2 bg-background border border-input rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring",children:c.map(u=>s.jsx("option",{value:u.value,children:u.label},u.value))})]}),s.jsxs("div",{children:[s.jsx(de,{htmlFor:"department",className:"text-sm font-medium text-gray-700",children:"Department"}),s.jsx(pe,{id:"department",value:r.department,onChange:u=>a(m=>({...m,department:u.target.value})),placeholder:"IT, Legal, Operations...",className:"mt-2"})]}),s.jsxs("div",{children:[s.jsx(de,{htmlFor:"jobTitle",className:"text-sm font-medium text-gray-700",children:"Job Title"}),s.jsx(pe,{id:"jobTitle",value:r.jobTitle,onChange:u=>a(m=>({...m,jobTitle:u.target.value})),placeholder:"Risk Analyst, Compliance Manager...",className:"mt-2"})]})]}),s.jsxs("div",{children:[s.jsx(de,{htmlFor:"message",className:"text-sm font-medium text-gray-700",children:"Personal Message (Optional)"}),s.jsx("textarea",{id:"message",value:r.message,onChange:u=>a(m=>({...m,message:u.target.value})),placeholder:"Add a personal welcome message...",rows:3,className:"mt-2 w-full px-3 py-2 bg-background border border-input rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring resize-none"})]})]})}),s.jsxs(Qr,{className:"flex justify-end space-x-3",children:[s.jsx(G,{type:"button",variant:"outline",onClick:()=>t(!1),disabled:i,children:"Cancel"}),s.jsx(G,{onClick:o,disabled:i,className:"min-w-[120px]",children:i?"Sending...":"Send Invitation"})]})]})})},ip=[{name:"TenantOwner",displayName:"Tenant Owner",description:"Full tenant management access with administrative privileges",color:"text-red-600 bg-red-50 border-red-200"},{name:"AgentUser",displayName:"Agent User",description:"Operational dashboard access with AI agent interaction capabilities",color:"text-blue-600 bg-blue-50 border-blue-200"},{name:"Auditor",displayName:"Auditor",description:"Read-only audit access for compliance and security review",color:"text-green-600 bg-green-50 border-green-200"},{name:"ComplianceOfficer",displayName:"Compliance Officer",description:"Compliance-specific views with approval and oversight capabilities",color:"text-purple-600 bg-purple-50 border-purple-200"}],Xw=({open:e,onOpenChange:t,user:n,onUserUpdated:r})=>{const[a,i]=S.useState(n.roles),[l,o]=S.useState(!1),c=d=>{i(p=>p.includes(d)?p.filter(f=>f!==d):[...p,d])},u=async()=>{o(!0);try{await new Promise(p=>setTimeout(p,1e3));const d={...n,roles:a,updatedAt:new Date().toISOString()};r(d),t(!1)}catch(d){console.error("Failed to update user roles:",d)}finally{o(!1)}},m=JSON.stringify(a.sort())!==JSON.stringify(n.roles.sort());return s.jsx(Yr,{open:e,onOpenChange:t,children:s.jsxs(Wr,{className:"max-w-5xl max-h-[90vh] overflow-y-auto",children:[s.jsx(Kr,{children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(ge,{className:"h-5 w-5 text-primary"}),s.jsxs("div",{children:[s.jsx(Gr,{children:"Manage Roles & Permissions"}),s.jsxs(Ny,{children:["Configure roles and permissions for ",n.name," (",n.email,")"]})]})]})}),s.jsx(em,{children:s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Available Roles"}),s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:ip.map(d=>{const p=a.includes(d.name),f=n.roles.includes(d.name);return s.jsx(Q,{className:`cursor-pointer transition-all hover:shadow-md ${p?"ring-2 ring-primary":""}`,onClick:()=>c(d.name),children:s.jsx(he,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:`p-2 rounded-lg ${d.color}`,children:s.jsx(ge,{className:"h-4 w-4"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs(be,{className:"text-base flex items-center space-x-2",children:[s.jsx("span",{children:d.displayName}),f&&s.jsx(J,{variant:"outline",className:"text-xs",children:"Current"})]}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:d.description})]})]}),s.jsx("div",{className:"flex items-center space-x-2",children:p&&s.jsx("div",{className:"h-5 w-5 rounded-full bg-primary flex items-center justify-center",children:s.jsx(oT,{className:"h-3 w-3 text-primary-foreground"})})})]})})},d.name)})})]}),a.includes("TenantOwner")&&!n.roles.includes("TenantOwner")&&s.jsx("div",{className:"p-6 bg-yellow-50 border border-yellow-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start space-x-4",children:[s.jsx(ue,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-semibold text-yellow-800",children:"Warning: High Privilege Role"}),s.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"You are about to assign the Tenant Owner role, which grants full administrative access."})]})]})}),a.length>0&&s.jsxs("div",{className:"p-6 bg-muted/50 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-semibold mb-3",children:"Selected Roles:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:a.map(d=>{const p=ip.find(f=>f.name===d);return s.jsxs(J,{variant:"secondary",className:"flex items-center space-x-1",children:[s.jsx(ge,{className:"h-3 w-3"}),s.jsx("span",{children:(p==null?void 0:p.displayName)||d})]},d)})})]})]})}),s.jsxs(Qr,{className:"flex justify-end space-x-3",children:[s.jsx(G,{variant:"outline",onClick:()=>{i(n.roles),t(!1)},disabled:l,children:"Cancel"}),s.jsx(G,{onClick:u,disabled:!m||l,children:l?"Updating...":"Update Roles"})]})]})})},Jw=[{id:"1",email:"sarah.chen@acme.com",name:"Sarah Chen",tenantId:"A1B2C3D4-E5F6-7G8H-9I0J-K1L2M3N4O5P6",roles:["TenantOwner"],lastLogin:"2024-01-15T10:30:00Z",isActive:!0,mfaEnabled:!0,createdAt:"2024-01-01T09:00:00Z",updatedAt:"2024-01-15T10:30:00Z",createdBy:"system",lastActiveAt:"2024-01-15T14:30:00Z",profile:{firstName:"Sarah",lastName:"Chen",phoneNumber:"+1-555-0123",department:"IT Security",jobTitle:"Chief Information Security Officer",preferences:{theme:"dark",language:"en",timezone:"America/New_York",notifications:{email:!0,inApp:!0,riskAlerts:!0,complianceUpdates:!0,auditReports:!0}}},permissions:{role:"TenantOwner",customPermissions:[],restrictions:[]},auditHistory:[]},{id:"2",email:"mike.johnson@acme.com",name:"Mike Johnson",tenantId:"A1B2C3D4-E5F6-7G8H-9I0J-K1L2M3N4O5P6",roles:["AgentUser"],lastLogin:"2024-01-14T16:45:00Z",isActive:!0,mfaEnabled:!1,createdAt:"2024-01-02T11:00:00Z",updatedAt:"2024-01-14T16:45:00Z",createdBy:"1",lastActiveAt:"2024-01-14T18:00:00Z",profile:{firstName:"Mike",lastName:"Johnson",department:"Risk Management",jobTitle:"Risk Analyst",preferences:{theme:"light",language:"en",timezone:"America/Chicago",notifications:{email:!0,inApp:!1,riskAlerts:!0,complianceUpdates:!1,auditReports:!1}}},permissions:{role:"AgentUser",customPermissions:[],restrictions:[]},auditHistory:[]},{id:"3",email:"emma.davis@acme.com",name:"Emma Davis",tenantId:"A1B2C3D4-E5F6-7G8H-9I0J-K1L2M3N4O5P6",roles:["Auditor","ComplianceOfficer"],lastLogin:"2024-01-13T09:15:00Z",isActive:!0,mfaEnabled:!0,createdAt:"2024-01-03T14:30:00Z",updatedAt:"2024-01-13T09:15:00Z",createdBy:"1",lastActiveAt:"2024-01-13T17:30:00Z",profile:{firstName:"Emma",lastName:"Davis",department:"Legal & Compliance",jobTitle:"Compliance Manager",preferences:{theme:"system",language:"en",timezone:"America/New_York",notifications:{email:!0,inApp:!0,riskAlerts:!1,complianceUpdates:!0,auditReports:!0}}},permissions:{role:"ComplianceOfficer",customPermissions:[],restrictions:[]},auditHistory:[]},{id:"4",email:"inactive.user@acme.com",name:"John Smith",tenantId:"A1B2C3D4-E5F6-7G8H-9I0J-K1L2M3N4O5P6",roles:["AgentUser"],lastLogin:"2023-12-20T10:00:00Z",isActive:!1,mfaEnabled:!1,createdAt:"2023-11-15T10:00:00Z",updatedAt:"2023-12-20T10:00:00Z",createdBy:"1",profile:{firstName:"John",lastName:"Smith",department:"Operations",jobTitle:"Operations Analyst",preferences:{theme:"light",language:"en",timezone:"America/Los_Angeles",notifications:{email:!1,inApp:!1,riskAlerts:!1,complianceUpdates:!1,auditReports:!1}}},permissions:{role:"AgentUser",customPermissions:[],restrictions:[]},auditHistory:[]}],Zw=()=>{const[e,t]=S.useState(Jw),[n,r]=S.useState(""),[a,i]=S.useState("all"),[l,o]=S.useState("all"),[c,u]=S.useState(null),[m,d]=S.useState(!1),[p,f]=S.useState(!1),[g,v]=S.useState(!1),T=e.filter(x=>{const I=x.name.toLowerCase().includes(n.toLowerCase())||x.email.toLowerCase().includes(n.toLowerCase()),C=a==="all"||x.roles.includes(a),E=l==="all"||l==="active"&&x.isActive||l==="inactive"&&!x.isActive;return I&&C&&E}),y={total:e.length,active:e.filter(x=>x.isActive).length,inactive:e.filter(x=>!x.isActive).length,mfaEnabled:e.filter(x=>x.mfaEnabled).length},b={TenantOwner:e.filter(x=>x.roles.includes("TenantOwner")).length,AgentUser:e.filter(x=>x.roles.includes("AgentUser")).length,Auditor:e.filter(x=>x.roles.includes("Auditor")).length,ComplianceOfficer:e.filter(x=>x.roles.includes("ComplianceOfficer")).length};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"User Management"}),s.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage tenant users and their permissions"})]}),s.jsxs(G,{onClick:()=>d(!0),children:[s.jsx(xy,{className:"h-4 w-4 mr-2"}),"Invite User"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsx(Q,{children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ge,{className:"h-5 w-5 text-primary"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold",children:y.total}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Users"})]})]})})}),s.jsx(Q,{children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"h-3 w-3 rounded-full bg-green-500"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold",children:y.active}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Active Users"})]})]})})}),s.jsx(Q,{children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"h-3 w-3 rounded-full bg-red-500"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold",children:y.inactive}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Inactive Users"})]})]})})}),s.jsx(Q,{children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ge,{className:"h-5 w-5 text-blue-500"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold",children:y.mfaEnabled}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"MFA Enabled"})]})]})})})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsx(be,{children:"Role Distribution"})}),s.jsx(ne,{children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:Object.entries(b).map(([x,I])=>s.jsxs("div",{className:"text-center p-4 bg-muted/50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:I}),s.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:x.replace(/([A-Z])/g," $1").trim()})]},x))})})]}),s.jsx(Q,{children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(Xh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),s.jsx(pe,{placeholder:"Search users by name or email...",value:n,onChange:x=>r(x.target.value),className:"pl-9"})]})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("select",{value:a,onChange:x=>i(x.target.value),className:"px-3 py-2 bg-background border border-input rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring",children:[s.jsx("option",{value:"all",children:"All Roles"}),s.jsx("option",{value:"TenantOwner",children:"Tenant Owner"}),s.jsx("option",{value:"AgentUser",children:"Agent User"}),s.jsx("option",{value:"Auditor",children:"Auditor"}),s.jsx("option",{value:"ComplianceOfficer",children:"Compliance Officer"})]}),s.jsxs("select",{value:l,onChange:x=>o(x.target.value),className:"px-3 py-2 bg-background border border-input rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring",children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"active",children:"Active"}),s.jsx("option",{value:"inactive",children:"Inactive"})]})]})]})})}),s.jsx(Kw,{users:T,onUserSelect:u,onEditProfile:x=>{u(x),f(!0)},onManageRoles:x=>{u(x),v(!0)}}),m&&s.jsx(Qw,{open:m,onOpenChange:d,onInviteSent:x=>{console.log("Invitation sent:",x)}}),p&&c&&s.jsx(Gw,{open:p,onOpenChange:f,user:c,onUserUpdated:x=>{t(e.map(I=>I.id===x.id?x:I))}}),g&&c&&s.jsx(Xw,{open:g,onOpenChange:v,user:c,onUserUpdated:x=>{t(e.map(I=>I.id===x.id?x:I))}})]})},$n=Object.create(null);$n.open="0";$n.close="1";$n.ping="2";$n.pong="3";$n.message="4";$n.upgrade="5";$n.noop="6";const $l=Object.create(null);Object.keys($n).forEach(e=>{$l[$n[e]]=e});const wd={type:"error",data:"parser error"},Ty=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",wy=typeof ArrayBuffer=="function",Sy=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,tm=({type:e,data:t},n,r)=>Ty&&t instanceof Blob?n?r(t):lp(t,r):wy&&(t instanceof ArrayBuffer||Sy(t))?n?r(t):lp(new Blob([t]),r):r($n[e]+(t||"")),lp=(e,t)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];t("b"+(r||""))},n.readAsDataURL(e)};function op(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Jc;function eS(e,t){if(Ty&&e.data instanceof Blob)return e.data.arrayBuffer().then(op).then(t);if(wy&&(e.data instanceof ArrayBuffer||Sy(e.data)))return t(op(e.data));tm(e,!1,n=>{Jc||(Jc=new TextEncoder),t(Jc.encode(n))})}const cp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ei=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<cp.length;e++)ei[cp.charCodeAt(e)]=e;const tS=e=>{let t=e.length*.75,n=e.length,r,a=0,i,l,o,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const u=new ArrayBuffer(t),m=new Uint8Array(u);for(r=0;r<n;r+=4)i=ei[e.charCodeAt(r)],l=ei[e.charCodeAt(r+1)],o=ei[e.charCodeAt(r+2)],c=ei[e.charCodeAt(r+3)],m[a++]=i<<2|l>>4,m[a++]=(l&15)<<4|o>>2,m[a++]=(o&3)<<6|c&63;return u},nS=typeof ArrayBuffer=="function",nm=(e,t)=>{if(typeof e!="string")return{type:"message",data:Cy(e,t)};const n=e.charAt(0);return n==="b"?{type:"message",data:rS(e.substring(1),t)}:$l[n]?e.length>1?{type:$l[n],data:e.substring(1)}:{type:$l[n]}:wd},rS=(e,t)=>{if(nS){const n=tS(e);return Cy(n,t)}else return{base64:!0,data:e}},Cy=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},ky="",sS=(e,t)=>{const n=e.length,r=new Array(n);let a=0;e.forEach((i,l)=>{tm(i,!1,o=>{r[l]=o,++a===n&&t(r.join(ky))})})},aS=(e,t)=>{const n=e.split(ky),r=[];for(let a=0;a<n.length;a++){const i=nm(n[a],t);if(r.push(i),i.type==="error")break}return r};function iS(){return new TransformStream({transform(e,t){eS(e,n=>{const r=n.length;let a;if(r<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,r);else if(r<65536){a=new Uint8Array(3);const i=new DataView(a.buffer);i.setUint8(0,126),i.setUint16(1,r)}else{a=new Uint8Array(9);const i=new DataView(a.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(r))}e.data&&typeof e.data!="string"&&(a[0]|=128),t.enqueue(a),t.enqueue(n)})}})}let Zc;function Tl(e){return e.reduce((t,n)=>t+n.length,0)}function wl(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let a=0;a<t;a++)n[a]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function lS(e,t){Zc||(Zc=new TextDecoder);const n=[];let r=0,a=-1,i=!1;return new TransformStream({transform(l,o){for(n.push(l);;){if(r===0){if(Tl(n)<1)break;const c=wl(n,1);i=(c[0]&128)===128,a=c[0]&127,a<126?r=3:a===126?r=1:r=2}else if(r===1){if(Tl(n)<2)break;const c=wl(n,2);a=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),r=3}else if(r===2){if(Tl(n)<8)break;const c=wl(n,8),u=new DataView(c.buffer,c.byteOffset,c.length),m=u.getUint32(0);if(m>Math.pow(2,21)-1){o.enqueue(wd);break}a=m*Math.pow(2,32)+u.getUint32(4),r=3}else{if(Tl(n)<a)break;const c=wl(n,a);o.enqueue(nm(i?c:Zc.decode(c),t)),r=0}if(a===0||a>e){o.enqueue(wd);break}}}})}const jy=4;function nt(e){if(e)return oS(e)}function oS(e){for(var t in nt.prototype)e[t]=nt.prototype[t];return e}nt.prototype.on=nt.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};nt.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this};nt.prototype.off=nt.prototype.removeListener=nt.prototype.removeAllListeners=nt.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var r,a=0;a<n.length;a++)if(r=n[a],r===t||r.fn===t){n.splice(a,1);break}return n.length===0&&delete this._callbacks["$"+e],this};nt.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,a=n.length;r<a;++r)n[r].apply(this,t)}return this};nt.prototype.emitReserved=nt.prototype.emit;nt.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};nt.prototype.hasListeners=function(e){return!!this.listeners(e).length};const ac=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0),ln=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),cS="arraybuffer";function Ay(e,...t){return t.reduce((n,r)=>(e.hasOwnProperty(r)&&(n[r]=e[r]),n),{})}const uS=ln.setTimeout,dS=ln.clearTimeout;function ic(e,t){t.useNativeTimers?(e.setTimeoutFn=uS.bind(ln),e.clearTimeoutFn=dS.bind(ln)):(e.setTimeoutFn=ln.setTimeout.bind(ln),e.clearTimeoutFn=ln.clearTimeout.bind(ln))}const hS=1.33;function mS(e){return typeof e=="string"?fS(e):Math.ceil((e.byteLength||e.size)*hS)}function fS(e){let t=0,n=0;for(let r=0,a=e.length;r<a;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}function _y(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function pS(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function gS(e){let t={},n=e.split("&");for(let r=0,a=n.length;r<a;r++){let i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class xS extends Error{constructor(t,n,r){super(t),this.description=n,this.context=r,this.type="TransportError"}}class rm extends nt{constructor(t){super(),this.writable=!1,ic(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,r){return super.emitReserved("error",new xS(t,n,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=nm(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=pS(t);return n.length?"?"+n:""}}class yS extends rm{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};aS(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,sS(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=_y()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let Iy=!1;try{Iy=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const bS=Iy;function vS(){}class ES extends yS{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let r=location.port;r||(r=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||r!==t.port}}doWrite(t,n){const r=this.request({method:"POST",data:t});r.on("success",n),r.on("error",(a,i)=>{this.onError("xhr post error",a,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,r)=>{this.onError("xhr poll error",n,r)}),this.pollXhr=t}}class Hn extends nt{constructor(t,n,r){super(),this.createRequest=t,ic(this,r),this._opts=r,this._method=r.method||"GET",this._uri=n,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var t;const n=Ay(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(n);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let a in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(a)&&r.setRequestHeader(a,this._opts.extraHeaders[a])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var a;r.readyState===3&&((a=this._opts.cookieJar)===null||a===void 0||a.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(a){this.setTimeoutFn(()=>{this._onError(a)},0);return}typeof document<"u"&&(this._index=Hn.requestsCount++,Hn.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=vS,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Hn.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Hn.requestsCount=0;Hn.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",up);else if(typeof addEventListener=="function"){const e="onpagehide"in ln?"pagehide":"unload";addEventListener(e,up,!1)}}function up(){for(let e in Hn.requests)Hn.requests.hasOwnProperty(e)&&Hn.requests[e].abort()}const NS=function(){const e=Ly({xdomain:!1});return e&&e.responseType!==null}();class TS extends ES{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=NS&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Hn(Ly,this.uri(),t)}}function Ly(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||bS))return new XMLHttpRequest}catch{}if(!t)try{return new ln[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Ry=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class wS extends rm{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,r=Ry?{}:Ay(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,r)}catch(a){return this.emitReserved("error",a)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],a=n===t.length-1;tm(r,this.supportsBinary,i=>{try{this.doWrite(r,i)}catch{}a&&ac(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=_y()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const eu=ln.WebSocket||ln.MozWebSocket;class SS extends wS{createSocket(t,n,r){return Ry?new eu(t,n,r):n?new eu(t,n):new eu(t)}doWrite(t,n){this.ws.send(n)}}class CS extends rm{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=lS(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=t.readable.pipeThrough(n).getReader(),a=iS();a.readable.pipeTo(t.writable),this._writer=a.writable.getWriter();const i=()=>{r.read().then(({done:o,value:c})=>{o||(this.onPacket(c),i())}).catch(o=>{})};i();const l={type:"open"};this.query.sid&&(l.data=`{"sid":"${this.query.sid}"}`),this._writer.write(l).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],a=n===t.length-1;this._writer.write(r).then(()=>{a&&ac(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const kS={websocket:SS,webtransport:CS,polling:TS},jS=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,AS=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Sd(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");n!=-1&&r!=-1&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let a=jS.exec(e||""),i={},l=14;for(;l--;)i[AS[l]]=a[l]||"";return n!=-1&&r!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=_S(i,i.path),i.queryKey=IS(i,i.query),i}function _S(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&r.splice(0,1),t.slice(-1)=="/"&&r.splice(r.length-1,1),r}function IS(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,a,i){a&&(n[a]=i)}),n}const Cd=typeof addEventListener=="function"&&typeof removeEventListener=="function",ql=[];Cd&&addEventListener("offline",()=>{ql.forEach(e=>e())},!1);class Or extends nt{constructor(t,n){if(super(),this.binaryType=cS,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const r=Sd(t);n.hostname=r.host,n.secure=r.protocol==="https"||r.protocol==="wss",n.port=r.port,r.query&&(n.query=r.query)}else n.host&&(n.hostname=Sd(n.host).host);ic(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(r=>{const a=r.prototype.name;this.transports.push(a),this._transportsByName[a]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=gS(this.opts.query)),Cd&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ql.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=jy,n.transport=t,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&Or.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",Or.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){const a=this.writeBuffer[r].data;if(a&&(n+=mS(a)),r>0&&n>this._maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,ac(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,r){return this._sendPacket("message",t,n,r),this}send(t,n,r){return this._sendPacket("message",t,n,r),this}_sendPacket(t,n,r,a){if(typeof n=="function"&&(a=n,n=void 0),typeof r=="function"&&(a=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const i={type:t,data:n,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),a&&this.once("flush",a),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():t()}):this.upgrading?r():t()),this}_onError(t){if(Or.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Cd&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=ql.indexOf(this._offlineEventListener);r!==-1&&ql.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}Or.protocol=jy;class LS extends Or{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),r=!1;Or.priorWebsocketSuccess=!1;const a=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",d=>{if(!r)if(d.type==="pong"&&d.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;Or.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(m(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const p=new Error("probe error");p.transport=n.name,this.emitReserved("upgradeError",p)}}))};function i(){r||(r=!0,m(),n.close(),n=null)}const l=d=>{const p=new Error("probe error: "+d);p.transport=n.name,i(),this.emitReserved("upgradeError",p)};function o(){l("transport closed")}function c(){l("socket closed")}function u(d){n&&d.name!==n.name&&i()}const m=()=>{n.removeListener("open",a),n.removeListener("error",l),n.removeListener("close",o),this.off("close",c),this.off("upgrading",u)};n.once("open",a),n.once("error",l),n.once("close",o),this.once("close",c),this.once("upgrading",u),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let r=0;r<t.length;r++)~this.transports.indexOf(t[r])&&n.push(t[r]);return n}}let RS=class extends LS{constructor(t,n={}){const r=typeof t=="object"?t:n;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(a=>kS[a]).filter(a=>!!a)),super(t,r)}};function PS(e,t="",n){let r=e;n=n||typeof location<"u"&&location,e==null&&(e=n.protocol+"//"+n.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=n.protocol+e:e=n.host+e),/^(https?|wss?):\/\//.test(e)||(typeof n<"u"?e=n.protocol+"//"+e:e="https://"+e),r=Sd(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}const MS=typeof ArrayBuffer=="function",OS=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Py=Object.prototype.toString,DS=typeof Blob=="function"||typeof Blob<"u"&&Py.call(Blob)==="[object BlobConstructor]",FS=typeof File=="function"||typeof File<"u"&&Py.call(File)==="[object FileConstructor]";function sm(e){return MS&&(e instanceof ArrayBuffer||OS(e))||DS&&e instanceof Blob||FS&&e instanceof File}function Vl(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let n=0,r=e.length;n<r;n++)if(Vl(e[n]))return!0;return!1}if(sm(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return Vl(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&Vl(e[n]))return!0;return!1}function BS(e){const t=[],n=e.data,r=e;return r.data=kd(n,t),r.attachments=t.length,{packet:r,buffers:t}}function kd(e,t){if(!e)return e;if(sm(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}else if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=kd(e[r],t);return n}else if(typeof e=="object"&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=kd(e[r],t));return n}return e}function US(e,t){return e.data=jd(e.data,t),delete e.attachments,e}function jd(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=jd(e[n],t);else if(typeof e=="object")for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=jd(e[n],t));return e}const HS=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],zS=5;var Ce;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(Ce||(Ce={}));class $S{constructor(t){this.replacer=t}encode(t){return(t.type===Ce.EVENT||t.type===Ce.ACK)&&Vl(t)?this.encodeAsBinary({type:t.type===Ce.EVENT?Ce.BINARY_EVENT:Ce.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===Ce.BINARY_EVENT||t.type===Ce.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=BS(t),r=this.encodeAsString(n.packet),a=n.buffers;return a.unshift(r),a}}function dp(e){return Object.prototype.toString.call(e)==="[object Object]"}class am extends nt{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const r=n.type===Ce.BINARY_EVENT;r||n.type===Ce.BINARY_ACK?(n.type=r?Ce.EVENT:Ce.ACK,this.reconstructor=new qS(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(sm(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const r={type:Number(t.charAt(0))};if(Ce[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===Ce.BINARY_EVENT||r.type===Ce.BINARY_ACK){const i=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const l=t.substring(i,n);if(l!=Number(l)||t.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(l)}if(t.charAt(n+1)==="/"){const i=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););r.nsp=t.substring(i,n)}else r.nsp="/";const a=t.charAt(n+1);if(a!==""&&Number(a)==a){const i=n+1;for(;++n;){const l=t.charAt(n);if(l==null||Number(l)!=l){--n;break}if(n===t.length)break}r.id=Number(t.substring(i,n+1))}if(t.charAt(++n)){const i=this.tryParse(t.substr(n));if(am.isPayloadValid(r.type,i))r.data=i;else throw new Error("invalid payload")}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case Ce.CONNECT:return dp(n);case Ce.DISCONNECT:return n===void 0;case Ce.CONNECT_ERROR:return typeof n=="string"||dp(n);case Ce.EVENT:case Ce.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&HS.indexOf(n[0])===-1);case Ce.ACK:case Ce.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class qS{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=US(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const VS=Object.freeze(Object.defineProperty({__proto__:null,Decoder:am,Encoder:$S,get PacketType(){return Ce},protocol:zS},Symbol.toStringTag,{value:"Module"}));function Tn(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const YS=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class My extends nt{constructor(t,n,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Tn(t,"open",this.onopen.bind(this)),Tn(t,"packet",this.onpacket.bind(this)),Tn(t,"error",this.onerror.bind(this)),Tn(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var r,a,i;if(YS.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const l={type:Ce.EVENT,data:n};if(l.options={},l.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const m=this.ids++,d=n.pop();this._registerAckCallback(m,d),l.id=m}const o=(a=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||a===void 0?void 0:a.writable,c=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!o||(c?(this.notifyOutgoingListeners(l),this.packet(l)):this.sendBuffer.push(l)),this.flags={},this}_registerAckCallback(t,n){var r;const a=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(a===void 0){this.acks[t]=n;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===t&&this.sendBuffer.splice(o,1);n.call(this,new Error("operation has timed out"))},a),l=(...o)=>{this.io.clearTimeoutFn(i),n.apply(this,o)};l.withError=!0,this.acks[t]=l}emitWithAck(t,...n){return new Promise((r,a)=>{const i=(l,o)=>l?a(l):r(o);i.withError=!0,n.push(i),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((a,...i)=>r!==this._queue[0]?void 0:(a!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(a)):(this._queue.shift(),n&&n(null,...i)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:Ce.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(r=>String(r.id)===t)){const r=this.acks[t];delete this.acks[t],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case Ce.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Ce.EVENT:case Ce.BINARY_EVENT:this.onevent(t);break;case Ce.ACK:case Ce.BINARY_ACK:this.onack(t);break;case Ce.DISCONNECT:this.ondisconnect();break;case Ce.CONNECT_ERROR:this.destroy();const r=new Error(t.data.message);r.data=t.data.data,this.emitReserved("connect_error",r);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let r=!1;return function(...a){r||(r=!0,n.packet({type:Ce.ACK,id:t,data:a}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Ce.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let r=0;r<n.length;r++)if(t===n[r])return n.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const r of n)r.apply(this,t.data)}}}function Na(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Na.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+n:e-n}return Math.min(e,this.max)|0};Na.prototype.reset=function(){this.attempts=0};Na.prototype.setMin=function(e){this.ms=e};Na.prototype.setMax=function(e){this.max=e};Na.prototype.setJitter=function(e){this.jitter=e};class Ad extends nt{constructor(t,n){var r;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,ic(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new Na({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const a=n.parser||VS;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new RS(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const a=Tn(n,"open",function(){r.onopen(),t&&t()}),i=o=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",o),t?t(o):this.maybeReconnectOnOpen()},l=Tn(n,"error",i);if(this._timeout!==!1){const o=this._timeout,c=this.setTimeoutFn(()=>{a(),i(new Error("timeout")),n.close()},o);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(a),this.subs.push(l),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Tn(t,"ping",this.onping.bind(this)),Tn(t,"data",this.ondata.bind(this)),Tn(t,"error",this.onerror.bind(this)),Tn(t,"close",this.onclose.bind(this)),Tn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){ac(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let r=this.nsps[t];return r?this._autoConnect&&!r.active&&r.connect():(r=new My(this,t,n),this.nsps[t]=r),r}_destroy(t){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let r=0;r<n.length;r++)this.engine.write(n[r],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(a=>{a?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",a)):t.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const za={};function tu(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const n=PS(e,t.path||"/socket.io"),r=n.source,a=n.id,i=n.path,l=za[a]&&i in za[a].nsps,o=t.forceNew||t["force new connection"]||t.multiplex===!1||l;let c;return o?c=new Ad(r,t):(za[a]||(za[a]=new Ad(r,t)),c=za[a]),n.query&&!t.query&&(t.query=n.queryKey),c.socket(n.path,t)}Object.assign(tu,{Manager:Ad,Socket:My,io:tu,connect:tu});class WS{constructor(){_e(this,"baseUrl");_e(this,"socketConnections",new Map);this.baseUrl="https://grc-backend-simple.calmmeadow-5080198e.australiasoutheast.azurecontainerapps.io/api/v1"}async getRealTimeMetrics(t){try{const n=await fetch(`${this.baseUrl}/analytics/metrics`);if(!n.ok)throw new Error(`Failed to fetch metrics: ${n.statusText}`);return(await n.json()).data}catch(n){return console.error("Error fetching real-time metrics:",n),this.getMockRealTimeMetrics(t)}}async getRecentEvents(t,n={}){try{const r=new URLSearchParams;n.limit&&r.set("limit",n.limit.toString()),n.eventType&&r.set("eventType",n.eventType),n.source&&r.set("source",n.source);const a=await fetch(`${this.baseUrl}/analytics/events?${r}`);if(!a.ok)throw new Error(`Failed to fetch events: ${a.statusText}`);return(await a.json()).data.map(o=>({...o,timestamp:new Date(o.timestamp)}))}catch(r){return console.error("Error fetching events:",r),this.getMockEventStream(t)}}async getRiskAnalytics(t,n){try{const r=await fetch(`${this.baseUrl}/analytics/risk`);if(!r.ok)throw new Error(`Failed to fetch risk analytics: ${r.statusText}`);return(await r.json()).data}catch(r){return console.error("Error fetching risk analytics:",r),this.getMockRiskAnalytics()}}async getComplianceAnalytics(t,n){try{const r=await fetch(`${this.baseUrl}/analytics/compliance`);if(!r.ok)throw new Error("Failed to fetch compliance analytics");return(await r.json()).data}catch(r){return console.error("Error fetching compliance analytics:",r),this.getMockComplianceAnalytics()}}async getControlAnalytics(t,n){try{const r=await fetch(`${this.baseUrl}/analytics/controls`);if(!r.ok)throw new Error("Failed to fetch control analytics");return(await r.json()).data}catch(r){return console.error("Error fetching control analytics:",r),this.getMockControlAnalytics()}}async getPredictiveInsights(t){try{const n=await fetch(`${this.baseUrl}/analytics/predictions`);if(!n.ok)throw new Error("Failed to fetch predictive insights");return(await n.json()).data}catch(n){return console.error("Error fetching predictive insights:",n),this.getMockPredictiveInsights(t)}}async getMLModels(t){try{const n=await fetch(`${this.baseUrl}/analytics/models`);if(!n.ok)throw new Error(`Failed to fetch ML models: ${n.statusText}`);return(await n.json()).data}catch(n){return console.error("Error fetching ML models:",n),this.getMockMLModels(t)}}subscribeToEvents(t,n,r){return console.log("Real-time events disabled in production"),()=>{}}getMockRealTimeMetrics(t){return{tenantId:t,timestamp:new Date,metrics:{eventsPerSecond:Math.floor(Math.random()*50)+10,totalEventsToday:Math.floor(Math.random()*5e3)+1e3,errorRate:Math.random()*5,averageProcessingTime:Math.random()*100+50,topEventTypes:[{type:"RISK_UPDATED",count:456,percentage:35.2},{type:"CONTROL_TESTED",count:234,percentage:18.1},{type:"COMPLIANCE_GAP_DETECTED",count:189,percentage:14.6},{type:"USER_ACTION",count:167,percentage:12.9},{type:"SYSTEM_PERFORMANCE",count:89,percentage:6.9}],riskTrends:{highRiskIncreasing:Math.floor(Math.random()*20)+5,criticalIncidents:Math.floor(Math.random()*10)+2,complianceGaps:Math.floor(Math.random()*15)+8,controlFailures:Math.floor(Math.random()*12)+3}}}}getMockEventStream(t){const n=["RISK_CREATED","CONTROL_FAILED","COMPLIANCE_GAP_DETECTED","USER_ACTION"],r=["ARCHER_GRC","MCP_SERVER","FRONTEND_APP"],a=["High-priority risk identified requiring immediate attention","Security control validation failed during automated testing","Compliance gap detected in regulatory framework implementation","User performed unauthorized action on sensitive system","Risk score threshold exceeded for critical business process","Control effectiveness degraded below acceptable parameters","New compliance requirement detected for framework update","System anomaly detected in user access patterns"];return Array.from({length:20},(i,l)=>({id:`event-${l}`,tenantId:t,eventType:n[Math.floor(Math.random()*n.length)],source:r[Math.floor(Math.random()*r.length)],timestamp:new Date(Date.now()-Math.random()*24*60*60*1e3),description:a[Math.floor(Math.random()*a.length)],entityId:`entity-${l}`,entityType:"risk",action:"UPDATE",data:{title:`Sample Event ${l}`,score:Math.floor(Math.random()*100),category:["Operational","Financial","Compliance","Technology"][Math.floor(Math.random()*4)]},metadata:{userId:`user-${Math.floor(Math.random()*100)}`,system:r[Math.floor(Math.random()*r.length)],processingTime:Math.floor(Math.random()*100)+10},severity:["low","medium","high","critical","info"][Math.floor(Math.random()*5)]}))}getMockRiskAnalytics(){return{totalRisks:127,highRisks:23,criticalRisks:8,riskTrend:"stable",riskDistribution:[{category:"Operational",count:45,averageScore:67},{category:"Financial",count:32,averageScore:71},{category:"Compliance",count:28,averageScore:58},{category:"Technology",count:22,averageScore:74}],topRisks:[{id:"risk-001",title:"Data Breach Risk",score:89,category:"Technology",lastUpdated:new Date(Date.now()-2*60*60*1e3),trend:"up"},{id:"risk-002",title:"Regulatory Compliance Gap",score:85,category:"Compliance",lastUpdated:new Date(Date.now()-4*60*60*1e3),trend:"stable"}]}}getMockComplianceAnalytics(){return{overallScore:78.5,trend:"improving",frameworks:[{name:"ISO27001",description:"Information Security Management",complianceScore:82.3,status:"compliant",compliantControls:45,partiallyCompliantControls:8,nonCompliantControls:3,notAssessedControls:2,lastAssessment:new Date(Date.now()-7*24*60*60*1e3),nextAssessmentDue:new Date(Date.now()+83*24*60*60*1e3)}],criticalGaps:[{controlId:"ISO27001-A.9.2.1",framework:"ISO27001",category:"Access Control",description:"User access provisioning process needs improvement",severity:"high",dueDate:new Date(Date.now()+14*24*60*60*1e3),remediationActions:"Implement automated user provisioning workflow"}],complianceTrend:[{date:new Date(Date.now()-30*24*60*60*1e3),score:74.2},{date:new Date(Date.now()-20*24*60*60*1e3),score:76.8},{date:new Date(Date.now()-10*24*60*60*1e3),score:78.5}]}}getMockControlAnalytics(){return{totalControls:156,effectiveControls:134,failedControls:22,controlEffectiveness:85.9,controlsByType:[{type:"Preventive",total:68,effective:59,failed:9},{type:"Detective",total:45,effective:41,failed:4},{type:"Corrective",total:43,effective:34,failed:9}],recentFailures:[{id:"ctrl-001",name:"Password Complexity Validation",type:"Preventive",failureDate:new Date(Date.now()-2*60*60*1e3),impact:"medium"}]}}getMockPredictiveInsights(t){return{riskPredictions:[{riskId:"risk-001",riskTitle:"Data Breach Risk",currentScore:75,predictedScore:85,timeHorizon:"30 days",confidence:.87,factors:["Increased failed login attempts","Outdated security patches","New threat intelligence"]},{riskId:"risk-002",riskTitle:"Operational Disruption",currentScore:60,predictedScore:45,timeHorizon:"14 days",confidence:.72,factors:["Improved monitoring systems","Staff training completed","Process automation"]}],complianceAlerts:[{framework:"ISO27001",requirement:"Access Control",currentStatus:"partial",predictedStatus:"non_compliant",alertDate:new Date(Date.now()+7*24*60*60*1e3),confidence:.93}],systemAnomalies:[{type:"performance",description:"Unusual spike in API response times detected",severity:"medium",detectedAt:new Date(Date.now()-2*60*60*1e3),affectedSystems:["Authentication Service","Data API"]}]}}getMockMLModels(t){return[{id:"model-risk-pred-001",name:"Risk Prediction Model v2.1",type:"risk_prediction",status:"active",accuracy:.953,precision:.912,recall:.889,f1Score:.9,lastTrained:new Date(Date.now()-2*24*60*60*1e3),nextTraining:new Date(Date.now()+5*24*60*60*1e3),version:"2.1.0",dataPoints:125e3,inferenceTime:23,resourceUsage:{cpu:45,memory:2048,storage:512},trainingHistory:[{date:new Date(Date.now()-7*24*60*60*1e3),accuracy:.941,loss:.234,epochs:150},{date:new Date(Date.now()-2*24*60*60*1e3),accuracy:.953,loss:.198,epochs:175}],description:"Advanced neural network for predicting risk score changes based on historical event patterns and external risk factors.",framework:"tensorflow"},{id:"model-anomaly-001",name:"System Anomaly Detector",type:"anomaly_detection",status:"active",accuracy:.871,precision:.823,recall:.845,f1Score:.834,lastTrained:new Date(Date.now()-1*24*60*60*1e3),nextTraining:new Date(Date.now()+6*24*60*60*1e3),version:"1.4.2",dataPoints:89e3,inferenceTime:15,resourceUsage:{cpu:32,memory:1024,storage:256},trainingHistory:[{date:new Date(Date.now()-5*24*60*60*1e3),accuracy:.856,loss:.445,epochs:100},{date:new Date(Date.now()-1*24*60*60*1e3),accuracy:.871,loss:.389,epochs:120}],description:"Real-time anomaly detection for identifying unusual patterns in system behavior and security events.",framework:"scikit-learn"},{id:"model-compliance-001",name:"Compliance Score Predictor",type:"compliance_scoring",status:"training",accuracy:.789,precision:.765,recall:.723,f1Score:.743,lastTrained:new Date(Date.now()-10*24*60*60*1e3),nextTraining:new Date(Date.now()+1*24*60*60*1e3),version:"1.2.1",dataPoints:67e3,inferenceTime:35,resourceUsage:{cpu:78,memory:3072,storage:1024},trainingHistory:[{date:new Date(Date.now()-15*24*60*60*1e3),accuracy:.756,loss:.623,epochs:85},{date:new Date(Date.now()-10*24*60*60*1e3),accuracy:.789,loss:.567,epochs:95}],description:"Predicts compliance framework scores based on control implementations and gap analysis patterns.",framework:"pytorch"},{id:"model-control-eff-001",name:"Control Effectiveness Model",type:"control_effectiveness",status:"inactive",accuracy:.823,precision:.798,recall:.856,f1Score:.826,lastTrained:new Date(Date.now()-30*24*60*60*1e3),nextTraining:new Date(Date.now()+2*24*60*60*1e3),version:"1.0.3",dataPoints:45e3,inferenceTime:18,resourceUsage:{cpu:0,memory:0,storage:384},trainingHistory:[{date:new Date(Date.now()-35*24*60*60*1e3),accuracy:.801,loss:.512,epochs:60},{date:new Date(Date.now()-30*24*60*60*1e3),accuracy:.823,loss:.478,epochs:70}],description:"Evaluates and predicts the effectiveness of security controls based on test results and incident correlation.",framework:"xgboost"}]}}const hr=new WS,KS=({metrics:e,riskAnalytics:t,complianceAnalytics:n,controlAnalytics:r,isLoading:a})=>a?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:Array.from({length:8}).map((i,l)=>s.jsx(Q,{className:"animate-pulse",children:s.jsxs(ne,{className:"p-6",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),s.jsx("div",{className:"h-8 bg-gray-200 rounded mb-2"}),s.jsx("div",{className:"h-3 bg-gray-200 rounded"})]})},l))}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsx(Q,{className:"border-l-4 border-l-blue-500",children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Events/Second"}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:e.metrics.eventsPerSecond.toFixed(1)}),s.jsxs("p",{className:"text-xs text-gray-500 flex items-center mt-1",children:[s.jsx(vt,{className:"h-3 w-3 mr-1"}),"Real-time throughput"]})]}),s.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:s.jsx(ar,{className:"h-6 w-6 text-blue-600"})})]})})}),s.jsx(Q,{className:"border-l-4 border-l-green-500",children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Today's Events"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:e.metrics.totalEventsToday.toLocaleString()}),s.jsxs("p",{className:"text-xs text-gray-500 flex items-center mt-1",children:[s.jsx(at,{className:"h-3 w-3 mr-1"}),"Total processed"]})]}),s.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:s.jsx(vt,{className:"h-6 w-6 text-green-600"})})]})})}),s.jsx(Q,{className:"border-l-4 border-l-orange-500",children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Error Rate"}),s.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[e.metrics.errorRate.toFixed(1),"%"]}),s.jsxs("p",{className:"text-xs text-gray-500 flex items-center mt-1",children:[s.jsx(ue,{className:"h-3 w-3 mr-1"}),"System health"]})]}),s.jsx("div",{className:"p-3 bg-orange-100 rounded-full",children:s.jsx(ue,{className:"h-6 w-6 text-orange-600"})})]})})}),s.jsx(Q,{className:"border-l-4 border-l-purple-500",children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Response"}),s.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[e.metrics.averageProcessingTime.toFixed(0),"ms"]}),s.jsxs("p",{className:"text-xs text-gray-500 flex items-center mt-1",children:[s.jsx(Tt,{className:"h-3 w-3 mr-1"}),"Processing time"]})]}),s.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:s.jsx(Tt,{className:"h-6 w-6 text-purple-600"})})]})})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t&&s.jsx(Q,{className:"border-l-4 border-l-red-500",children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"High Risks"}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:t.highRisks}),s.jsxs("div",{className:"flex items-center mt-1",children:[t.riskTrend==="increasing"?s.jsx(zn,{className:"h-3 w-3 text-red-500 mr-1"}):t.riskTrend==="decreasing"?s.jsx(Ui,{className:"h-3 w-3 text-green-500 mr-1"}):s.jsx("div",{className:"h-3 w-3 bg-gray-400 rounded-full mr-1"}),s.jsx("p",{className:"text-xs text-gray-500",children:t.riskTrend})]})]}),s.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:s.jsx(ue,{className:"h-6 w-6 text-red-600"})})]})})}),n&&s.jsx(Q,{className:"border-l-4 border-l-blue-500",children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Compliance Score"}),s.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[n.overallScore.toFixed(0),"%"]}),s.jsxs("p",{className:"text-xs text-gray-500 flex items-center mt-1",children:[s.jsx(ge,{className:"h-3 w-3 mr-1"}),n.frameworks.length," frameworks"]})]}),s.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:s.jsx(ge,{className:"h-6 w-6 text-blue-600"})})]})})}),r&&s.jsx(Q,{className:"border-l-4 border-l-green-500",children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Control Effectiveness"}),s.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[r.controlEffectiveness.toFixed(0),"%"]}),s.jsxs("p",{className:"text-xs text-gray-500 flex items-center mt-1",children:[s.jsx(Ur,{className:"h-3 w-3 mr-1"}),r.totalControls," total controls"]})]}),s.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:s.jsx(Ur,{className:"h-6 w-6 text-green-600"})})]})})}),s.jsx(Q,{className:"border-l-4 border-l-yellow-500",children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Critical Alerts"}),s.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:e.metrics.riskTrends.criticalIncidents+e.metrics.riskTrends.controlFailures}),s.jsxs("p",{className:"text-xs text-gray-500 flex items-center mt-1",children:[s.jsx(ue,{className:"h-3 w-3 mr-1"}),"Require attention"]})]}),s.jsx("div",{className:"p-3 bg-yellow-100 rounded-full",children:s.jsx(ue,{className:"h-6 w-6 text-yellow-600"})})]})})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(vt,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{children:"Top Event Types"})]})}),s.jsx(ne,{children:s.jsx("div",{className:"space-y-3",children:e.metrics.topEventTypes.map((i,l)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"flex-shrink-0 w-2 h-2 rounded-full bg-blue-500"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:i.type.replace(/_/g," ").toLowerCase().replace(/\b\w/g,o=>o.toUpperCase())}),s.jsxs("p",{className:"text-xs text-gray-500",children:[i.count," events"]})]})]}),s.jsx("div",{className:"text-right",children:s.jsxs(J,{variant:"secondary",className:"text-xs",children:[i.percentage.toFixed(1),"%"]})})]},i.type))})})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(ue,{className:"h-5 w-5 text-red-600"}),s.jsx("span",{children:"Risk Trends"})]})}),s.jsx(ne,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:"High Risk Increasing"})]}),s.jsx(J,{variant:"destructive",className:"text-xs",children:e.metrics.riskTrends.highRiskIncreasing})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-500"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Critical Incidents"})]}),s.jsx(J,{className:"bg-orange-100 text-orange-800 text-xs",children:e.metrics.riskTrends.criticalIncidents})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Compliance Gaps"})]}),s.jsx(J,{className:"bg-yellow-100 text-yellow-800 text-xs",children:e.metrics.riskTrends.complianceGaps})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Control Failures"})]}),s.jsx(J,{className:"bg-purple-100 text-purple-800 text-xs",children:e.metrics.riskTrends.controlFailures})]})]})})]})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(vt,{className:"h-5 w-5 text-green-600"}),s.jsx("span",{children:"System Health"})]})}),s.jsx(ne,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[s.jsx("div",{className:`text-2xl font-bold ${e.metrics.errorRate<1?"text-green-600":e.metrics.errorRate<5?"text-yellow-600":"text-red-600"}`,children:e.metrics.errorRate<1?"Healthy":e.metrics.errorRate<5?"Warning":"Critical"}),s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"System Status"}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.metrics.errorRate.toFixed(2),"% error rate"]})]}),s.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[s.jsx("div",{className:`text-2xl font-bold ${e.metrics.averageProcessingTime<100?"text-green-600":e.metrics.averageProcessingTime<500?"text-yellow-600":"text-red-600"}`,children:e.metrics.averageProcessingTime<100?"Fast":e.metrics.averageProcessingTime<500?"Moderate":"Slow"}),s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Performance"}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.metrics.averageProcessingTime.toFixed(0),"ms avg"]})]}),s.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[s.jsx("div",{className:`text-2xl font-bold ${e.metrics.eventsPerSecond>10?"text-green-600":e.metrics.eventsPerSecond>5?"text-yellow-600":"text-red-600"}`,children:e.metrics.eventsPerSecond>10?"High":e.metrics.eventsPerSecond>5?"Medium":"Low"}),s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Throughput"}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.metrics.eventsPerSecond.toFixed(1)," events/sec"]})]})]})})]})]}),GS=({analytics:e,events:t,timeRange:n,isLoading:r})=>r?s.jsx("div",{className:"animate-pulse",children:"Loading risk analytics..."}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx(Q,{className:"border-l-4 border-l-red-500",children:s.jsxs(ne,{className:"p-6",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.totalRisks}),s.jsx("div",{className:"text-sm text-gray-600",children:"Total Risks"})]})}),s.jsx(Q,{className:"border-l-4 border-l-orange-500",children:s.jsxs(ne,{className:"p-6",children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:e.highRisks}),s.jsx("div",{className:"text-sm text-gray-600",children:"High Risks"})]})}),s.jsx(Q,{className:"border-l-4 border-l-red-700",children:s.jsxs(ne,{className:"p-6",children:[s.jsx("div",{className:"text-2xl font-bold text-red-700",children:e.criticalRisks}),s.jsx("div",{className:"text-sm text-gray-600",children:"Critical Risks"})]})}),s.jsx(Q,{className:"border-l-4 border-l-blue-500",children:s.jsxs(ne,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[e.riskTrend==="increasing"?s.jsx(zn,{className:"h-5 w-5 text-red-500"}):e.riskTrend==="decreasing"?s.jsx(Ui,{className:"h-5 w-5 text-green-500"}):s.jsx("div",{className:"w-5 h-1 bg-gray-400 rounded"}),s.jsx("div",{className:"text-lg font-bold capitalize",children:e.riskTrend})]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Risk Trend"})]})})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(ue,{className:"h-5 w-5 text-red-600"}),s.jsx("span",{children:"Top Risks"})]})}),s.jsx(ne,{children:s.jsx("div",{className:"space-y-3",children:e.topRisks.slice(0,10).map(a=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:a.title}),s.jsx("div",{className:"text-sm text-gray-600",children:a.category})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(J,{variant:a.score>=90?"destructive":a.score>=70?"secondary":"outline",children:a.score}),a.trend==="up"?s.jsx(zn,{className:"h-4 w-4 text-red-500"}):a.trend==="down"?s.jsx(Ui,{className:"h-4 w-4 text-green-500"}):s.jsx("div",{className:"w-4 h-1 bg-gray-400 rounded"})]})]},a.id))})})]})]}),QS=({analytics:e,events:t,timeRange:n,isLoading:r})=>{const[a,i]=S.useState(null),[l,o]=S.useState(!1);if(r)return s.jsx("div",{className:"space-y-6",children:Array.from({length:4}).map((d,p)=>s.jsxs(Q,{className:"animate-pulse",children:[s.jsx(he,{children:s.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3"})}),s.jsx(ne,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})})]},p))});const c=d=>{switch(d){case"compliant":return"text-green-600 bg-green-100";case"non_compliant":return"text-red-600 bg-red-100";case"partially_compliant":return"text-yellow-600 bg-yellow-100";case"not_assessed":return"text-gray-600 bg-gray-100";default:return"text-gray-600 bg-gray-100"}},u=d=>{switch(d){case"critical":return"text-red-600 bg-red-100";case"high":return"text-orange-600 bg-orange-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}},m=a?e.frameworks.filter(d=>d.name===a):e.frameworks;return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ge,{className:"h-6 w-6 text-blue-600"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Compliance Dashboard"})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(hy,{className:"h-4 w-4 text-gray-500"}),s.jsxs("select",{value:a||"",onChange:d=>i(d.target.value||null),className:"border rounded px-3 py-1 text-sm",children:[s.jsx("option",{value:"",children:"All Frameworks"}),e.frameworks.map(d=>s.jsx("option",{value:d.name,children:d.name},d.name))]})]}),s.jsxs(G,{variant:l?"default":"outline",size:"sm",onClick:()=>o(!l),className:"flex items-center space-x-2",children:[s.jsx(ue,{className:"h-4 w-4"}),s.jsx("span",{children:"Gaps Only"})]}),s.jsxs(G,{variant:"outline",size:"sm",className:"flex items-center space-x-2",children:[s.jsx(Yh,{className:"h-4 w-4"}),s.jsx("span",{children:"Export Report"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsx(Q,{className:"border-l-4 border-l-blue-500",children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overall Score"}),s.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[e.overallScore.toFixed(1),"%"]}),s.jsxs("p",{className:"text-xs text-gray-500 flex items-center mt-1",children:[s.jsx(Mr,{className:"h-3 w-3 mr-1"}),"Across ",e.frameworks.length," frameworks"]})]}),s.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:s.jsx(ge,{className:"h-6 w-6 text-blue-600"})})]})})}),s.jsx(Q,{className:"border-l-4 border-l-green-500",children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Compliant"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:e.frameworks.reduce((d,p)=>d+p.compliantControls,0)}),s.jsxs("p",{className:"text-xs text-gray-500 flex items-center mt-1",children:[s.jsx(Le,{className:"h-3 w-3 mr-1"}),"Controls passing"]})]}),s.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:s.jsx(Le,{className:"h-6 w-6 text-green-600"})})]})})}),s.jsx(Q,{className:"border-l-4 border-l-red-500",children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Critical Gaps"}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:e.criticalGaps.length}),s.jsxs("p",{className:"text-xs text-gray-500 flex items-center mt-1",children:[s.jsx(ue,{className:"h-3 w-3 mr-1"}),"Require attention"]})]}),s.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:s.jsx(ue,{className:"h-6 w-6 text-red-600"})})]})})}),s.jsx(Q,{className:"border-l-4 border-l-purple-500",children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Trend"}),s.jsxs("div",{className:"flex items-center space-x-1",children:[e.trend==="improving"?s.jsx(zn,{className:"h-5 w-5 text-green-600"}):e.trend==="declining"?s.jsx(Ui,{className:"h-5 w-5 text-red-600"}):s.jsx("div",{className:"w-5 h-1 bg-gray-400 rounded"}),s.jsx("p",{className:"text-lg font-bold capitalize text-purple-600",children:e.trend})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Overall direction"})]}),s.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:s.jsx(zn,{className:"h-6 w-6 text-purple-600"})})]})})})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(ge,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{children:"Framework Compliance"}),s.jsxs(J,{variant:"secondary",className:"text-xs",children:[m.length," frameworks"]})]})}),s.jsx(ne,{children:s.jsx("div",{className:"space-y-4",children:m.map(d=>s.jsxs("div",{className:"border rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:d.name}),s.jsx("p",{className:"text-sm text-gray-600",children:d.description})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[d.complianceScore.toFixed(1),"%"]}),s.jsx(J,{className:c(d.status),children:d.status.replace("_"," ").toUpperCase()})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[s.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-green-600",children:d.compliantControls}),s.jsx("div",{className:"text-xs text-gray-600",children:"Compliant"})]}),s.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-yellow-600",children:d.partiallyCompliantControls}),s.jsx("div",{className:"text-xs text-gray-600",children:"Partial"})]}),s.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-red-600",children:d.nonCompliantControls}),s.jsx("div",{className:"text-xs text-gray-600",children:"Non-Compliant"})]}),s.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-gray-600",children:d.notAssessedControls}),s.jsx("div",{className:"text-xs text-gray-600",children:"Not Assessed"})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Last Assessment: ",d.lastAssessment.toLocaleDateString()]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(Ji,{className:"h-4 w-4 mr-1"}),"Next Due: ",d.nextAssessmentDue.toLocaleDateString()]})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsxs(G,{variant:"outline",size:"sm",className:"flex items-center space-x-1",children:[s.jsx(sc,{className:"h-3 w-3"}),s.jsx("span",{children:"View Details"})]}),s.jsxs(G,{variant:"outline",size:"sm",className:"flex items-center space-x-1",children:[s.jsx(Fi,{className:"h-3 w-3"}),s.jsx("span",{children:"Generate Report"})]})]})]})]},d.name))})})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(ue,{className:"h-5 w-5 text-red-600"}),s.jsx("span",{children:"Critical Compliance Gaps"}),s.jsxs(J,{variant:"destructive",className:"text-xs",children:[e.criticalGaps.length," critical issues"]})]})}),s.jsx(ne,{children:s.jsxs("div",{className:"space-y-4",children:[e.criticalGaps.map((d,p)=>s.jsxs("div",{className:"border border-red-200 rounded-lg p-4 bg-red-50",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:`p-2 rounded-full ${u(d.severity)}`,children:s.jsx(ue,{className:"h-4 w-4"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:d.controlId}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:d.description}),s.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-500",children:[s.jsxs("span",{children:["Framework: ",d.framework]}),s.jsx("span",{children:""}),s.jsxs("span",{children:["Category: ",d.category]})]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx(J,{className:u(d.severity),children:d.severity.toUpperCase()}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex items-center",children:[s.jsx(Tt,{className:"h-3 w-3 mr-1"}),"Due: ",d.dueDate.toLocaleDateString()]})]})]}),s.jsx("div",{className:"border-t border-red-200 pt-3 mt-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium text-gray-900 mb-1",children:"Remediation Required:"}),s.jsx("p",{className:"text-sm text-gray-700",children:d.remediationActions})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(G,{variant:"outline",size:"sm",children:"Assign"}),s.jsx(G,{variant:"default",size:"sm",className:"bg-red-600 hover:bg-red-700",children:"Remediate"})]})]})})]},p)),e.criticalGaps.length===0&&s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Le,{className:"h-12 w-12 mx-auto mb-4 text-green-300"}),s.jsx("p",{children:"No critical compliance gaps detected"}),s.jsx("p",{className:"text-sm mt-1",children:"All frameworks are within acceptable compliance levels"})]})]})})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(Tt,{className:"h-5 w-5 text-orange-600"}),s.jsx("span",{children:"Recent Compliance Events"}),s.jsxs(J,{variant:"secondary",className:"text-xs",children:["Last ",n.label]})]})}),s.jsx(ne,{children:s.jsxs("div",{className:"space-y-3",children:[t.slice(0,10).map((d,p)=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("div",{className:`p-2 rounded-full ${u(d.severity)}`,children:[d.eventType.includes("COMPLIANCE_GAP")&&s.jsx(ue,{className:"h-4 w-4"}),d.eventType.includes("ASSESSMENT")&&s.jsx(Fi,{className:"h-4 w-4"}),d.eventType.includes("REMEDIATION")&&s.jsx(Ur,{className:"h-4 w-4"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:d.eventType.replace(/_/g," ").toLowerCase().replace(/\b\w/g,f=>f.toUpperCase())}),s.jsx("div",{className:"text-sm text-gray-600",children:d.description})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx(J,{className:u(d.severity),variant:"outline",children:d.severity}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:d.timestamp.toLocaleTimeString()})]})]},p)),t.length===0&&s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Tt,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),s.jsx("p",{children:"No compliance events in the selected timeframe"}),s.jsx("p",{className:"text-sm mt-1",children:"Check back later for compliance updates"})]})]})})]})]})},XS=({events:e,tenantId:t,isLoading:n})=>{const[r,a]=S.useState(e),[i,l]=S.useState(!1),[o,c]=S.useState(!0),[u,m]=S.useState(""),[d,p]=S.useState(null),[f,g]=S.useState({severity:[],eventType:[],source:[],timeRange:"all"}),v=S.useRef(null),T=S.useRef(r.length);S.useEffect(()=>{i||a(e)},[e,i]),S.useEffect(()=>{o&&r.length>T.current&&v.current&&(v.current.scrollTop=v.current.scrollHeight),T.current=r.length},[r,o]);const y=N=>{switch(N){case"critical":return"text-red-600 bg-red-100 border-red-200";case"high":return"text-orange-600 bg-orange-100 border-orange-200";case"medium":return"text-yellow-600 bg-yellow-100 border-yellow-200";case"low":return"text-blue-600 bg-blue-100 border-blue-200";case"info":return"text-green-600 bg-green-100 border-green-200";default:return"text-gray-600 bg-gray-100 border-gray-200"}},b=N=>N.includes("RISK")?ue:N.includes("COMPLIANCE")?ge:N.includes("CONTROL")?Ur:N.includes("USER")?Ts:N.includes("SYSTEM")?Br:N.includes("DATA")?at:N.includes("SECURITY")?ge:N.includes("PERFORMANCE")?ar:N.includes("AUDIT")?Fi:vt,x=r.filter(N=>{if(u&&!N.description.toLowerCase().includes(u.toLowerCase())&&!N.eventType.toLowerCase().includes(u.toLowerCase())&&!N.source.toLowerCase().includes(u.toLowerCase())||f.severity.length>0&&!f.severity.includes(N.severity)||f.eventType.length>0&&!f.eventType.some(O=>N.eventType.includes(O))||f.source.length>0&&!f.source.includes(N.source))return!1;if(f.timeRange!=="all"){const O=new Date,D=new Date(N.timestamp),A=(O.getTime()-D.getTime())/(1e3*60*60);switch(f.timeRange){case"1h":return A<=1;case"6h":return A<=6;case"24h":return A<=24;default:return!0}}return!0}),I={total:x.length,critical:x.filter(N=>N.severity==="critical").length,high:x.filter(N=>N.severity==="high").length,medium:x.filter(N=>N.severity==="medium").length,low:x.filter(N=>N.severity==="low").length},C=Array.from(new Set(r.map(N=>N.source))),E=Array.from(new Set(r.map(N=>N.eventType.split("_")[0])));return n?s.jsxs(Q,{className:"animate-pulse",children:[s.jsx(he,{children:s.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3"})}),s.jsx(ne,{children:s.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((N,O)=>s.jsx("div",{className:"h-16 bg-gray-200 rounded"},O))})})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(vt,{className:"h-6 w-6 text-blue-600"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Live Event Stream"}),s.jsxs(J,{variant:"secondary",className:"text-xs",children:[x.length," events"]})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(Xh,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search events...",value:u,onChange:N=>m(N.target.value),className:"pl-10 pr-4 py-2 border rounded-lg text-sm w-64"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs(G,{variant:i?"default":"outline",size:"sm",onClick:()=>l(!i),className:"flex items-center space-x-2",children:[i?s.jsx(Qh,{className:"h-4 w-4"}):s.jsx(Kh,{className:"h-4 w-4"}),s.jsx("span",{children:i?"Resume":"Pause"})]}),s.jsxs(G,{variant:o?"default":"outline",size:"sm",onClick:()=>c(!o),className:"flex items-center space-x-2",children:[s.jsx(zn,{className:"h-4 w-4"}),s.jsx("span",{children:"Auto-scroll"})]})]}),s.jsxs(G,{variant:"outline",size:"sm",className:"flex items-center space-x-2",children:[s.jsx(Yh,{className:"h-4 w-4"}),s.jsx("span",{children:"Export"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[s.jsx(Q,{className:"p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:I.total}),s.jsx("div",{className:"text-xs text-gray-600",children:"Total Events"})]})}),s.jsx(Q,{className:"p-4 border-l-4 border-l-red-500",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:I.critical}),s.jsx("div",{className:"text-xs text-gray-600",children:"Critical"})]})}),s.jsx(Q,{className:"p-4 border-l-4 border-l-orange-500",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:I.high}),s.jsx("div",{className:"text-xs text-gray-600",children:"High"})]})}),s.jsx(Q,{className:"p-4 border-l-4 border-l-yellow-500",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:I.medium}),s.jsx("div",{className:"text-xs text-gray-600",children:"Medium"})]})}),s.jsx(Q,{className:"p-4 border-l-4 border-l-blue-500",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:I.low}),s.jsx("div",{className:"text-xs text-gray-600",children:"Low"})]})}),s.jsx(Q,{className:"p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-lg font-bold text-green-600",children:[Math.round(r.length/Math.max(r.length,1)*100),"%"]}),s.jsx("div",{className:"text-xs text-gray-600",children:"Health Score"})]})})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2 text-base",children:[s.jsx(hy,{className:"h-4 w-4"}),s.jsx("span",{children:"Filters"})]})}),s.jsxs(ne,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Severity"}),s.jsx("div",{className:"space-y-1",children:["critical","high","medium","low","info"].map(N=>s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",checked:f.severity.includes(N),onChange:O=>{O.target.checked?g(D=>({...D,severity:[...D.severity,N]})):g(D=>({...D,severity:D.severity.filter(A=>A!==N)}))},className:"rounded text-blue-600"}),s.jsx("span",{className:"text-sm capitalize",children:N})]},N))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Event Type"}),s.jsx("div",{className:"space-y-1",children:E.slice(0,5).map(N=>s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",checked:f.eventType.includes(N),onChange:O=>{O.target.checked?g(D=>({...D,eventType:[...D.eventType,N]})):g(D=>({...D,eventType:D.eventType.filter(A=>A!==N)}))},className:"rounded text-blue-600"}),s.jsx("span",{className:"text-sm",children:N})]},N))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Source"}),s.jsx("div",{className:"space-y-1",children:C.slice(0,5).map(N=>s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",checked:f.source.includes(N),onChange:O=>{O.target.checked?g(D=>({...D,source:[...D.source,N]})):g(D=>({...D,source:D.source.filter(A=>A!==N)}))},className:"rounded text-blue-600"}),s.jsx("span",{className:"text-sm",children:N})]},N))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Time Range"}),s.jsxs("select",{value:f.timeRange,onChange:N=>g(O=>({...O,timeRange:N.target.value})),className:"w-full border rounded px-3 py-2 text-sm",children:[s.jsx("option",{value:"all",children:"All Time"}),s.jsx("option",{value:"1h",children:"Last Hour"}),s.jsx("option",{value:"6h",children:"Last 6 Hours"}),s.jsx("option",{value:"24h",children:"Last 24 Hours"})]})]})]}),s.jsx("div",{className:"mt-4 flex justify-end",children:s.jsx(G,{variant:"outline",size:"sm",onClick:()=>g({severity:[],eventType:[],source:[],timeRange:"all"}),children:"Clear All Filters"})})]})]}),s.jsxs(Q,{className:"h-96",children:[s.jsx(he,{children:s.jsx(be,{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(vt,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{children:"Event Stream"}),!i&&s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-sm text-green-600",children:"Live"})]})]})})}),s.jsx(ne,{className:"p-0",children:s.jsx("div",{ref:v,className:"h-80 overflow-y-auto px-6 pb-6",children:s.jsxs("div",{className:"space-y-2",children:[x.map((N,O)=>{const D=b(N.eventType),A=d===N.id;return s.jsx("div",{className:`border rounded-lg p-3 transition-all duration-200 ${y(N.severity)}`,children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[s.jsx("div",{className:"p-1 rounded-full bg-white bg-opacity-50",children:s.jsx(D,{className:"h-4 w-4"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[s.jsx("span",{className:"font-medium text-sm",children:N.eventType.replace(/_/g," ").toLowerCase().replace(/\b\w/g,z=>z.toUpperCase())}),s.jsx(J,{variant:"secondary",className:"text-xs",children:N.source})]}),s.jsx("p",{className:"text-sm text-gray-700 mb-2",children:N.description}),A&&N.metadata&&s.jsx("div",{className:"bg-white bg-opacity-50 rounded p-3 text-xs",children:s.jsx("pre",{className:"whitespace-pre-wrap font-mono",children:JSON.stringify(N.metadata,null,2)})})]})]}),s.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[s.jsxs("div",{className:"text-right",children:[s.jsx(J,{className:y(N.severity),variant:"outline",children:N.severity.toUpperCase()}),s.jsxs("div",{className:"text-xs text-gray-600 mt-1 flex items-center",children:[s.jsx(Tt,{className:"h-3 w-3 mr-1"}),N.timestamp.toLocaleTimeString()]})]}),s.jsx(G,{variant:"ghost",size:"sm",onClick:()=>p(A?null:N.id),children:A?s.jsx(dT,{className:"h-4 w-4"}):s.jsx(So,{className:"h-4 w-4"})})]})]})},N.id)}),x.length===0&&s.jsxs("div",{className:"text-center py-12 text-gray-500",children:[s.jsx(vt,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),s.jsx("p",{children:"No events match the current filters"}),s.jsx("p",{className:"text-sm mt-1",children:"Try adjusting your search criteria"})]})]})})})]})]})},JS=({insights:e,isLoading:t})=>{const[n,r]=S.useState("30 days");if(t)return s.jsx("div",{className:"space-y-6",children:Array.from({length:3}).map((l,o)=>s.jsxs(Q,{className:"animate-pulse",children:[s.jsx(he,{children:s.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3"})}),s.jsx(ne,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})})]},o))});const a=l=>{switch(l){case"critical":return"text-red-600 bg-red-100";case"high":return"text-orange-600 bg-orange-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}},i=l=>l>=.8?"text-green-600 bg-green-100":l>=.6?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100";return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(At,{className:"h-6 w-6 text-purple-600"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"AI-Powered Predictions"})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ji,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-600",children:"Forecast Horizon:"})]}),s.jsx("div",{className:"flex space-x-1 bg-gray-100 rounded-lg p-1",children:["7 days","30 days","90 days"].map(l=>s.jsx(G,{variant:n===l?"default":"ghost",size:"sm",onClick:()=>r(l),className:"text-xs",children:l},l))})]})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(ue,{className:"h-5 w-5 text-red-600"}),s.jsx("span",{children:"Risk Predictions"}),s.jsxs(J,{variant:"secondary",className:"text-xs",children:[e.riskPredictions.length," risks analyzed"]})]})}),s.jsx(ne,{children:s.jsx("div",{className:"space-y-4",children:e.riskPredictions.map(l=>s.jsxs("div",{className:"border rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:l.riskTitle}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Risk ID: ",l.riskId]})]}),s.jsx("div",{className:"text-right",children:s.jsxs(J,{className:i(l.confidence),children:[(l.confidence*100).toFixed(0),"% confidence"]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[s.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-blue-600",children:l.currentScore}),s.jsx("div",{className:"text-xs text-gray-600",children:"Current Score"})]}),s.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-center space-x-1",children:[l.predictedScore>l.currentScore?s.jsx(zn,{className:"h-4 w-4 text-red-600"}):s.jsx(Ui,{className:"h-4 w-4 text-green-600"}),s.jsx("div",{className:`text-lg font-bold ${l.predictedScore>l.currentScore?"text-red-600":"text-green-600"}`,children:l.predictedScore})]}),s.jsx("div",{className:"text-xs text-gray-600",children:"Predicted Score"})]}),s.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-gray-700",children:l.timeHorizon}),s.jsx("div",{className:"text-xs text-gray-600",children:"Time Horizon"})]})]}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:"Influencing Factors:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:l.factors.map((o,c)=>s.jsx(J,{variant:"outline",className:"text-xs",children:o},c))})]}),s.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[s.jsx("div",{className:`text-sm px-3 py-1 rounded-full ${l.predictedScore>l.currentScore?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:l.predictedScore>l.currentScore?`Risk increasing by ${l.predictedScore-l.currentScore} points`:`Risk decreasing by ${l.currentScore-l.predictedScore} points`}),s.jsxs(G,{variant:"outline",size:"sm",className:"flex items-center space-x-1",children:[s.jsx(sc,{className:"h-3 w-3"}),s.jsx("span",{children:"View Details"})]})]})]},l.riskId))})})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(ge,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{children:"Compliance Predictions"}),s.jsxs(J,{variant:"secondary",className:"text-xs",children:[e.complianceAlerts.length," frameworks monitored"]})]})}),s.jsx(ne,{children:s.jsxs("div",{className:"space-y-4",children:[e.complianceAlerts.map((l,o)=>s.jsxs("div",{className:"border rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:l.framework}),s.jsx("p",{className:"text-sm text-gray-600",children:l.requirement})]}),s.jsx("div",{className:"text-right",children:s.jsxs(J,{className:i(l.confidence),children:[(l.confidence*100).toFixed(0),"% confidence"]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[s.jsx("div",{className:"text-sm font-semibold text-blue-600 uppercase",children:l.currentStatus}),s.jsx("div",{className:"text-xs text-gray-600",children:"Current Status"})]}),s.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[s.jsx("div",{className:"text-sm font-semibold text-orange-600 uppercase",children:l.predictedStatus}),s.jsx("div",{className:"text-xs text-gray-600",children:"Predicted Status"})]}),s.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"text-sm font-semibold text-gray-700",children:l.alertDate.toLocaleDateString()}),s.jsx("div",{className:"text-xs text-gray-600",children:"Alert Date"})]})]})]},o)),e.complianceAlerts.length===0&&s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(ge,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),s.jsx("p",{children:"No compliance alerts predicted for the selected timeframe"}),s.jsx("p",{className:"text-sm mt-1",children:"Your compliance posture looks strong!"})]})]})})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(vt,{className:"h-5 w-5 text-orange-600"}),s.jsx("span",{children:"System Anomalies Detected"}),s.jsx(J,{variant:"secondary",className:"text-xs",children:"Last 24 hours"})]})}),s.jsx(ne,{children:s.jsxs("div",{className:"space-y-4",children:[e.systemAnomalies.map((l,o)=>s.jsxs("div",{className:"border rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsxs("div",{className:`p-2 rounded-full ${a(l.severity)}`,children:[l.type==="performance"&&s.jsx(ar,{className:"h-4 w-4"}),l.type==="security"&&s.jsx(ge,{className:"h-4 w-4"}),l.type==="compliance"&&s.jsx(Ur,{className:"h-4 w-4"})]}),s.jsxs("div",{children:[s.jsxs("h4",{className:"font-semibold text-gray-900 capitalize",children:[l.type," Anomaly"]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:l.description})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx(J,{className:a(l.severity),children:l.severity.toUpperCase()}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex items-center",children:[s.jsx(Tt,{className:"h-3 w-3 mr-1"}),l.detectedAt.toLocaleTimeString()]})]})]}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:"Affected Systems:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:l.affectedSystems.map((c,u)=>s.jsx(J,{variant:"outline",className:"text-xs",children:c},u))})]}),s.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Detected ",new Date(l.detectedAt).toLocaleDateString()," at"," ",new Date(l.detectedAt).toLocaleTimeString()]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(G,{variant:"outline",size:"sm",children:"Investigate"}),s.jsx(G,{variant:"outline",size:"sm",children:"Dismiss"})]})]})]},o)),e.systemAnomalies.length===0&&s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(vt,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),s.jsx("p",{children:"No system anomalies detected"}),s.jsx("p",{className:"text-sm mt-1",children:"All systems operating within normal parameters"})]})]})})]}),s.jsxs(Q,{className:"bg-gradient-to-r from-purple-50 to-blue-50",children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(At,{className:"h-5 w-5 text-purple-600"}),s.jsx("span",{children:"Prediction Model Information"})]})}),s.jsxs(ne,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"text-center p-4 bg-white rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-purple-600",children:"95.3%"}),s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Model Accuracy"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Risk prediction model"})]}),s.jsxs("div",{className:"text-center p-4 bg-white rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-blue-600",children:"87.1%"}),s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Anomaly Detection"}),s.jsx("div",{className:"text-xs text-gray-500",children:"System health model"})]}),s.jsxs("div",{className:"text-center p-4 bg-white rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-green-600",children:"2.3s"}),s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Avg Response Time"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Model inference time"})]})]}),s.jsx("div",{className:"mt-4 text-sm text-gray-600",children:s.jsx("p",{children:"Our ML models are continuously trained on your organization's data to provide personalized predictions. Models are updated daily to incorporate new patterns and improve accuracy over time."})})]})]})]})},ZS=({models:e,isLoading:t,onModelAction:n})=>{const[r,a]=S.useState(null),[i,l]=S.useState(!0),[o,c]=S.useState("all"),[u,m]=S.useState("all");if(t)return s.jsx("div",{className:"space-y-6",children:Array.from({length:3}).map((T,y)=>s.jsxs(Q,{className:"animate-pulse",children:[s.jsx(he,{children:s.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3"})}),s.jsx(ne,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})})]},y))});const d=T=>{switch(T){case"active":return"text-green-600 bg-green-100";case"inactive":return"text-gray-600 bg-gray-100";case"training":return"text-blue-600 bg-blue-100";case"error":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},p=T=>{switch(T){case"risk_prediction":return ue;case"anomaly_detection":return vt;case"compliance_scoring":return Ur;case"control_effectiveness":return Le;default:return At}},f=T=>T>=.9?"text-green-600":T>=.8?"text-yellow-600":"text-red-600",g=e.filter(T=>!(o!=="all"&&T.type!==o||u!=="all"&&T.status!==u)),v={total:e.length,active:e.filter(T=>T.status==="active").length,training:e.filter(T=>T.status==="training").length,errors:e.filter(T=>T.status==="error").length};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(At,{className:"h-6 w-6 text-purple-600"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"ML Model Management"})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("select",{value:o,onChange:T=>c(T.target.value),className:"border rounded px-3 py-1 text-sm",children:[s.jsx("option",{value:"all",children:"All Types"}),s.jsx("option",{value:"risk_prediction",children:"Risk Prediction"}),s.jsx("option",{value:"anomaly_detection",children:"Anomaly Detection"}),s.jsx("option",{value:"compliance_scoring",children:"Compliance Scoring"}),s.jsx("option",{value:"control_effectiveness",children:"Control Effectiveness"})]}),s.jsxs("select",{value:u,onChange:T=>m(T.target.value),className:"border rounded px-3 py-1 text-sm",children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"active",children:"Active"}),s.jsx("option",{value:"inactive",children:"Inactive"}),s.jsx("option",{value:"training",children:"Training"}),s.jsx("option",{value:"error",children:"Error"})]})]}),s.jsxs(G,{variant:i?"default":"outline",size:"sm",onClick:()=>l(!i),className:"flex items-center space-x-2",children:[s.jsx(Mr,{className:"h-4 w-4"}),s.jsx("span",{children:"Metrics"})]}),s.jsxs(G,{variant:"default",size:"sm",className:"flex items-center space-x-2",children:[s.jsx(pn,{className:"h-4 w-4"}),s.jsx("span",{children:"Deploy Model"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx(Q,{className:"border-l-4 border-l-purple-500",children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Models"}),s.jsx("p",{className:"text-2xl font-bold text-purple-600",children:v.total})]}),s.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:s.jsx(At,{className:"h-6 w-6 text-purple-600"})})]})})}),s.jsx(Q,{className:"border-l-4 border-l-green-500",children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:v.active})]}),s.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:s.jsx(Le,{className:"h-6 w-6 text-green-600"})})]})})}),s.jsx(Q,{className:"border-l-4 border-l-blue-500",children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Training"}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:v.training})]}),s.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:s.jsx($t,{className:"h-6 w-6 text-blue-600 animate-spin"})})]})})}),s.jsx(Q,{className:"border-l-4 border-l-red-500",children:s.jsx(ne,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Errors"}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:v.errors})]}),s.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:s.jsx(ue,{className:"h-6 w-6 text-red-600"})})]})})})]}),s.jsxs("div",{className:"space-y-4",children:[g.map(T=>{const y=p(T.type),b=r===T.id;return s.jsx(Q,{className:`transition-all duration-200 ${b?"ring-2 ring-purple-500":""}`,children:s.jsxs(ne,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-start space-x-4",children:[s.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:s.jsx(y,{className:"h-6 w-6 text-purple-600"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:T.name}),s.jsx(J,{className:d(T.status),children:T.status.toUpperCase()}),s.jsxs(J,{variant:"outline",className:"text-xs",children:["v",T.version]}),s.jsx(J,{variant:"secondary",className:"text-xs",children:T.framework})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:T.description}),s.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(at,{className:"h-4 w-4"}),s.jsxs("span",{children:[T.dataPoints.toLocaleString()," data points"]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Tt,{className:"h-4 w-4"}),s.jsxs("span",{children:["Last trained: ",T.lastTrained.toLocaleDateString()]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(ar,{className:"h-4 w-4"}),s.jsxs("span",{children:[T.inferenceTime,"ms inference"]})]})]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs(G,{variant:"outline",size:"sm",onClick:()=>a(b?null:T.id),className:"flex items-center space-x-1",children:[s.jsx(sc,{className:"h-4 w-4"}),s.jsx("span",{children:b?"Hide":"Details"})]}),T.status==="active"?s.jsxs(G,{variant:"outline",size:"sm",onClick:()=>n(T.id,"stop"),className:"flex items-center space-x-1",children:[s.jsx(Kh,{className:"h-4 w-4"}),s.jsx("span",{children:"Stop"})]}):s.jsxs(G,{variant:"default",size:"sm",onClick:()=>n(T.id,"start"),className:"flex items-center space-x-1",children:[s.jsx(Qh,{className:"h-4 w-4"}),s.jsx("span",{children:"Start"})]}),s.jsxs(G,{variant:"outline",size:"sm",onClick:()=>n(T.id,"retrain"),className:"flex items-center space-x-1",children:[s.jsx($t,{className:"h-4 w-4"}),s.jsx("span",{children:"Retrain"})]})]})]}),i&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[s.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[s.jsxs("div",{className:`text-lg font-bold ${f(T.accuracy)}`,children:[(T.accuracy*100).toFixed(1),"%"]}),s.jsx("div",{className:"text-xs text-gray-600",children:"Accuracy"})]}),s.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[s.jsxs("div",{className:`text-lg font-bold ${f(T.precision)}`,children:[(T.precision*100).toFixed(1),"%"]}),s.jsx("div",{className:"text-xs text-gray-600",children:"Precision"})]}),s.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[s.jsxs("div",{className:`text-lg font-bold ${f(T.recall)}`,children:[(T.recall*100).toFixed(1),"%"]}),s.jsx("div",{className:"text-xs text-gray-600",children:"Recall"})]}),s.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[s.jsxs("div",{className:`text-lg font-bold ${f(T.f1Score)}`,children:[(T.f1Score*100).toFixed(1),"%"]}),s.jsx("div",{className:"text-xs text-gray-600",children:"F1-Score"})]})]}),b&&s.jsxs("div",{className:"border-t pt-4 mt-4",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Resource Usage"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(mT,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm",children:"CPU"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-20 h-2 bg-gray-200 rounded-full",children:s.jsx("div",{className:"h-2 bg-blue-500 rounded-full",style:{width:`${T.resourceUsage.cpu}%`}})}),s.jsxs("span",{className:"text-sm font-medium",children:[T.resourceUsage.cpu,"%"]})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ep,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm",children:"Memory"})]}),s.jsxs("span",{className:"text-sm font-medium",children:[T.resourceUsage.memory," MB"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ep,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm",children:"Storage"})]}),s.jsxs("span",{className:"text-sm font-medium",children:[T.resourceUsage.storage," MB"]})]})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Recent Training"}),s.jsx("div",{className:"space-y-2",children:T.trainingHistory.slice(0,3).map((x,I)=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[s.jsx("div",{className:"text-sm",children:x.date.toLocaleDateString()}),s.jsxs("div",{className:"flex items-center space-x-4 text-xs",children:[s.jsxs("span",{children:["Accuracy: ",(x.accuracy*100).toFixed(1),"%"]}),s.jsxs("span",{children:["Loss: ",x.loss.toFixed(3)]}),s.jsxs("span",{children:["Epochs: ",x.epochs]})]})]},I))}),s.jsxs("div",{className:"mt-3 text-sm text-gray-600",children:["Next training scheduled: ",T.nextTraining.toLocaleDateString()]})]})]}),s.jsxs("div",{className:"flex justify-end space-x-2 mt-4 pt-4 border-t",children:[s.jsxs(G,{variant:"outline",size:"sm",className:"flex items-center space-x-1",children:[s.jsx(Yh,{className:"h-4 w-4"}),s.jsx("span",{children:"Export"})]}),s.jsxs(G,{variant:"outline",size:"sm",className:"flex items-center space-x-1",children:[s.jsx(Gh,{className:"h-4 w-4"}),s.jsx("span",{children:"Configure"})]}),s.jsxs(G,{variant:"outline",size:"sm",onClick:()=>n(T.id,"delete"),className:"flex items-center space-x-1 text-red-600 hover:text-red-700",children:[s.jsx(Ea,{className:"h-4 w-4"}),s.jsx("span",{children:"Delete"})]})]})]})]})},T.id)}),g.length===0&&s.jsx(Q,{children:s.jsxs(ne,{className:"text-center py-12",children:[s.jsx(At,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),s.jsx("p",{className:"text-gray-500 mb-2",children:"No models match the current filters"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Deploy your first ML model to get started"}),s.jsxs(G,{variant:"default",className:"mt-4 flex items-center space-x-2",children:[s.jsx(pn,{className:"h-4 w-4"}),s.jsx("span",{children:"Deploy Model"})]})]})})]})]})},eC=({tenantId:e,autoRefresh:t=!1,refreshInterval:n=3e4})=>{const{tenant:r}=it(),a=e||(r==null?void 0:r.id)||"",[i,l]=S.useState("overview"),[o,c]=S.useState(!1),[u,m]=S.useState(null),[d,p]=S.useState({start:new Date(Date.now()-24*60*60*1e3),end:new Date,label:"24 hours"}),[f,g]=S.useState(!1),[v,T]=S.useState(new Date),[y,b]=S.useState(t),[x,I]=S.useState(null),[C,E]=S.useState(null),[N,O]=S.useState(null),[D,A]=S.useState(null),[z,M]=S.useState(null),[R,H]=S.useState([]),[Y,P]=S.useState([]),q=async()=>{if(a)try{const _=await fetch("/api/v1/analytics/debug",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"Content-Type":"application/json"}});if(_.ok){const ce=await _.json();m(ce.data)}}catch(_){console.error("Error loading debug info:",_)}},B=async()=>{if(a){g(!0);try{const[_,ce,qe,we,Rt,rn,xn]=await Promise.all([hr.getRealTimeMetrics(a),hr.getRiskAnalytics(a,d),hr.getComplianceAnalytics(a,d),hr.getControlAnalytics(a,d),hr.getPredictiveInsights(a),hr.getRecentEvents(a,{limit:100}),hr.getMLModels(a)]);I(_),E(ce),O(qe),A(we),M(Rt),H(rn),P(xn),T(new Date),o&&await q()}catch(_){console.error("Error loading dashboard data:",_)}finally{g(!1)}}};S.useEffect(()=>{if(B(),y){const _=setInterval(B,n);return()=>clearInterval(_)}},[a,d,y,n]),S.useEffect(()=>a?hr.subscribeToEvents(a,["RISK_UPDATED","CONTROL_FAILED","COMPLIANCE_GAP_DETECTED","SYSTEM_ERROR"],ce=>{H(qe=>[ce,...qe.slice(0,99)]),(ce.severity==="critical"||ce.eventType.includes("FAILED"))&&B()}):void 0,[a]);const W=[{label:"1 hour",value:1*60*60*1e3},{label:"6 hours",value:6*60*60*1e3},{label:"24 hours",value:24*60*60*1e3},{label:"7 days",value:7*24*60*60*1e3},{label:"30 days",value:30*24*60*60*1e3}],k=(_,ce)=>{p({start:new Date(Date.now()-_),end:new Date,label:ce})},le=S.useMemo(()=>!x||!C||!N||!D?{critical:0,high:0,medium:0,low:0}:{critical:C.criticalRisks+D.failedControls,high:C.highRisks+N.criticalGaps.length,medium:Math.floor(x.metrics.riskTrends.complianceGaps/2),low:Math.floor(x.metrics.riskTrends.complianceGaps/2)},[x,C,N,D]);if(!a)return s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("p",{className:"text-gray-500",children:"No tenant selected"})});return s.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"GRC Analytics Dashboard"}),s.jsxs("p",{className:"text-gray-600 mt-2",children:["Real-time insights and predictive analysis for ",(r==null?void 0:r.name)||"your organization"]})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ji,{className:"h-4 w-4 text-gray-500"}),s.jsx("select",{value:d.label,onChange:_=>{const ce=W.find(qe=>qe.label===_.target.value);ce&&k(ce.value,ce.label)},className:"border rounded px-3 py-1 text-sm",children:W.map(_=>s.jsx("option",{value:_.label,children:_.label},_.label))})]}),s.jsxs(G,{variant:y?"default":"outline",size:"sm",onClick:()=>b(!y),className:"flex items-center space-x-2",children:[s.jsx($t,{className:`h-4 w-4 ${y?"animate-spin":""}`}),s.jsx("span",{children:"Auto-refresh"})]}),s.jsxs(G,{variant:"outline",size:"sm",onClick:B,disabled:f,className:"flex items-center space-x-2",children:[s.jsx($t,{className:`h-4 w-4 ${f?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[s.jsx(Tt,{className:"h-4 w-4 mr-1"}),s.jsxs("span",{children:["Updated ",v.toLocaleTimeString()]})]})]})]}),s.jsx("div",{className:"bg-white rounded-lg border p-4 mb-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Alert Summary"}),le.critical>0&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ue,{className:"h-4 w-4 text-red-600"}),s.jsxs(J,{variant:"destructive",className:"text-xs",children:[le.critical," Critical"]})]}),le.high>0&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ue,{className:"h-4 w-4 text-orange-600"}),s.jsxs(J,{className:"bg-orange-100 text-orange-800 text-xs",children:[le.high," High"]})]}),s.jsx("div",{className:"flex items-center space-x-2",children:s.jsxs(J,{variant:"secondary",className:"text-xs",children:[le.medium," Medium"]})})]}),s.jsxs(G,{variant:"outline",size:"sm",className:"flex items-center space-x-2",children:[s.jsx(dy,{className:"h-4 w-4"}),s.jsx("span",{children:"Configure Alerts"})]})]})}),s.jsx("div",{className:"border-b border-gray-200",children:s.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:Mr},{id:"risks",label:"Risk Analytics",icon:ue},{id:"compliance",label:"Compliance",icon:ge},{id:"controls",label:"Controls",icon:Ur},{id:"events",label:"Live Events",icon:vt},{id:"predictions",label:"Predictions",icon:zn},{id:"models",label:"ML Models",icon:At}].map(({id:_,label:ce,icon:qe})=>s.jsxs("button",{onClick:()=>l(_),className:`py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ${i===_?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(qe,{className:"h-4 w-4"}),s.jsx("span",{children:ce})]},_))})})]}),s.jsxs("div",{className:"space-y-6",children:[i==="overview"&&x&&s.jsx(KS,{metrics:x,riskAnalytics:C,complianceAnalytics:N,controlAnalytics:D,isLoading:f}),i==="risks"&&C&&s.jsx(GS,{analytics:C,events:R.filter(_=>_.eventType.startsWith("RISK_")),timeRange:d,isLoading:f}),i==="compliance"&&N&&s.jsx(QS,{analytics:N,events:R.filter(_=>_.eventType.includes("COMPLIANCE")),timeRange:d,isLoading:f}),i==="controls"&&D&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ur,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{children:"Control Performance"})]}),s.jsxs(G,{variant:o?"default":"outline",size:"sm",onClick:()=>{c(!o),!o&&!u&&q()},className:"flex items-center space-x-2",children:[s.jsx(sc,{className:"h-4 w-4"}),s.jsx("span",{children:"Debug Mode"})]})]})}),s.jsx(ne,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:D.totalControls}),s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Total Controls"})]}),s.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:D.effectiveControls}),s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Effective"})]}),s.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:D.failedControls}),s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Failed"})]}),s.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[s.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[D.controlEffectiveness.toFixed(1),"%"]}),s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Effectiveness"})]})]})})]}),o&&s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(dt,{className:"h-5 w-5 text-orange-600"}),s.jsx("span",{children:"MCP Debug Information"}),s.jsx(G,{variant:"outline",size:"sm",onClick:q,disabled:f,className:"ml-auto",children:s.jsx($t,{className:`h-4 w-4 ${f?"animate-spin":""}`})})]})}),s.jsx(ne,{children:u?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"border rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"MCP Connection Status"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Status"}),s.jsx(J,{variant:u.mcpConnection.status==="connected"?"default":"destructive",children:u.mcpConnection.status})]}),u.mcpConnection.error&&s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Error"}),s.jsx("div",{className:"text-sm text-red-600 font-mono bg-red-50 p-2 rounded",children:u.mcpConnection.error})]})]})]}),s.jsxs("div",{className:"border rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Archer Authentication"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Login Status"}),s.jsx(J,{variant:u.authentication.loginStatus==="success"?"default":"destructive",children:u.authentication.loginStatus})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Session Valid"}),s.jsx(J,{variant:u.authentication.sessionValid?"default":"destructive",children:u.authentication.sessionValid?"Yes":"No"})]}),u.authentication.error&&s.jsxs("div",{className:"col-span-2",children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Error"}),s.jsx("div",{className:"text-sm text-red-600 font-mono bg-red-50 p-2 rounded",children:u.authentication.error})]})]})]}),s.jsxs("div",{className:"border rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Application Discovery"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Status"}),s.jsx(J,{variant:u.applicationDiscovery.status==="success"?"default":"destructive",children:u.applicationDiscovery.status})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Total Applications"}),s.jsx("div",{className:"text-lg font-bold text-blue-600",children:u.applicationDiscovery.totalApps})]}),u.applicationDiscovery.error&&s.jsxs("div",{className:"col-span-2",children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Error"}),s.jsx("div",{className:"text-sm text-red-600 font-mono bg-red-50 p-2 rounded",children:u.applicationDiscovery.error})]})]})]}),s.jsxs("div",{className:"border rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Data Retrieval Status"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"font-medium text-gray-900",children:"Risk Register"}),s.jsx(J,{variant:u.dataRetrieval.riskRegister.status==="success"?"default":"destructive",children:u.dataRetrieval.riskRegister.status})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Record Count"}),s.jsx("div",{className:"text-lg font-bold text-green-600",children:u.dataRetrieval.riskRegister.recordCount})]}),u.dataRetrieval.riskRegister.error&&s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Error"}),s.jsx("div",{className:"text-sm text-red-600 font-mono bg-red-50 p-2 rounded",children:u.dataRetrieval.riskRegister.error})]})]})]}),s.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"font-medium text-gray-900",children:"Controls"}),s.jsx(J,{variant:u.dataRetrieval.controls.status==="success"?"default":"destructive",children:u.dataRetrieval.controls.status})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Record Count"}),s.jsx("div",{className:"text-lg font-bold text-green-600",children:u.dataRetrieval.controls.recordCount})]}),u.dataRetrieval.controls.error&&s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Error"}),s.jsx("div",{className:"text-sm text-red-600 font-mono bg-red-50 p-2 rounded",children:u.dataRetrieval.controls.error})]})]})]}),s.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"font-medium text-gray-900",children:"Control Self Assessment"}),s.jsx(J,{variant:u.dataRetrieval.controlSelfAssessment.status==="success"?"default":"destructive",children:u.dataRetrieval.controlSelfAssessment.status})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Record Count"}),s.jsx("div",{className:"text-lg font-bold text-green-600",children:u.dataRetrieval.controlSelfAssessment.recordCount})]}),u.dataRetrieval.controlSelfAssessment.error&&s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Error"}),s.jsx("div",{className:"text-sm text-red-600 font-mono bg-red-50 p-2 rounded",children:u.dataRetrieval.controlSelfAssessment.error})]})]})]})]})]}),s.jsxs("div",{className:"border rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Raw Debug Data"}),s.jsx("div",{className:"bg-gray-900 text-green-400 p-4 rounded-lg overflow-auto max-h-96",children:s.jsx("pre",{className:"text-sm font-mono",children:JSON.stringify(u,null,2)})})]})]}):s.jsx("div",{className:"flex items-center justify-center h-32",children:s.jsx("div",{className:"text-gray-500",children:"Loading debug information..."})})})]})]}),i==="events"&&s.jsx(XS,{events:R,tenantId:a,isLoading:f}),i==="predictions"&&z&&s.jsx(JS,{insights:z,isLoading:f}),i==="models"&&s.jsx(ZS,{models:Y,isLoading:f,onModelAction:xe})]})]});function xe(_,ce){console.log(`Model action: ${ce} for model ${_}`)}},tC=()=>s.jsx("div",{children:s.jsx(eC,{})}),nC=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"MCP Tools"}),s.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage and test MCP tools and integrations"})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsx(be,{children:"Tool Management"})}),s.jsxs(ne,{children:[s.jsx("p",{className:"text-muted-foreground",children:"MCP tools interface will be available here. This would include:"}),s.jsxs("ul",{className:"mt-2 text-sm text-muted-foreground space-y-1",children:[s.jsx("li",{children:" Browse available MCP tools"}),s.jsx("li",{children:" Test tool functionality"}),s.jsx("li",{children:" Configure tool parameters"}),s.jsx("li",{children:" Monitor tool usage"}),s.jsx("li",{children:" Manage tool permissions"})]})]})]})]});class rC{constructor(){_e(this,"tenantId",null)}get baseUrl(){return Sn("").replace(/\/$/,"")}setTenantContext(t){this.tenantId=t,console.log(` [Backend Credentials] Set tenant context: ${t}`)}async initialize(){console.log(" [Backend Credentials] Initialized - using database backend")}async getAllCredentials(){if(!this.tenantId)throw new Error("Tenant context not set. Call setTenantContext() first.");try{console.log(" [Backend Credentials] Loading credentials from database...");const t=await fetch(`${this.baseUrl}/simple-credentials`,{method:"GET",headers:{"Content-Type":"application/json","x-tenant-id":this.tenantId}});if(!t.ok)throw new Error(`Failed to load credentials: ${t.status}`);const n=await t.json();if(!n.success)throw new Error(n.error||"Failed to load credentials");const r=n.data.credentials.map(a=>({id:a.credential_id,name:a.name,baseUrl:a.base_url,username:a.username,password:"[ENCRYPTED]",instanceId:a.instance_id||"",instanceName:a.instance_name||"",userDomainId:a.user_domain_id||"1",isDefault:a.is_default===1,created:a.created_at,lastTested:a.last_tested_at,status:this.mapTestStatusToStatus(a.test_status),lastError:a.last_error}));return console.log(` [Backend Credentials] Loaded ${r.length} credentials from database`),r}catch(t){throw console.error(" [Backend Credentials] Failed to load credentials:",t),t}}async saveCredentials(t){if(!this.tenantId)throw new Error("Tenant context not set. Call setTenantContext() first.");try{console.log(" [Backend Credentials] Saving credentials to database:",t.name);const n={name:t.name,connection_type:"archer-grc",base_url:t.baseUrl,username:t.username,password:t.password,instance_id:t.instanceId,instance_name:t.instanceName,user_domain_id:t.userDomainId,is_default:t.isDefault},r=t.id&&t.id!=="new"&&!t.id.startsWith("temp-");let a;if(r?(console.log(" [Backend Credentials] Updating existing credential:",t.id),a=await fetch(`${this.baseUrl}/simple-credentials/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json","x-tenant-id":this.tenantId},body:JSON.stringify(n)})):(console.log(" [Backend Credentials] Creating new credential"),a=await fetch(`${this.baseUrl}/simple-credentials/create`,{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":this.tenantId},body:JSON.stringify(n)})),!a.ok)throw new Error(`Failed to save credentials: ${a.status}`);const i=await a.json();if(!i.success)throw new Error(i.error||"Failed to save credentials");const l=i.data.credential||i.data,o={id:l.credential_id,name:l.name,baseUrl:l.base_url,username:l.username,password:"[ENCRYPTED]",instanceId:l.instance_id||"",instanceName:l.instance_name||"",userDomainId:l.user_domain_id||"1",isDefault:l.is_default===1,created:l.created_at,lastTested:i.data.last_tested_at,status:this.mapTestStatusToStatus(i.data.test_status),lastError:i.data.last_error};return console.log(" [Backend Credentials] Saved credentials to database"),o}catch(n){throw console.error(" [Backend Credentials] Failed to save credentials:",n),n}}async updateCredentials(t,n){if(!this.tenantId)throw new Error("Tenant context not set. Call setTenantContext() first.");try{console.log(" [Backend Credentials] Updating credentials:",t);const r={};n.name&&(r.name=n.name),n.baseUrl&&(r.base_url=n.baseUrl),n.username&&(r.username=n.username),n.password&&n.password!=="[ENCRYPTED]"&&(r.password=n.password),n.instanceId&&(r.instance_id=n.instanceId),n.instanceName&&(r.instance_name=n.instanceName),n.userDomainId&&(r.user_domain_id=n.userDomainId),n.isDefault!==void 0&&(r.is_default=n.isDefault),n.status&&(r.test_status=this.mapStatusToTestStatus(n.status)),n.lastTested&&(r.last_tested_at=n.lastTested),n.lastError!==void 0&&(r.last_error=n.lastError);const a=await fetch(`${this.baseUrl}/simple-credentials/${t}`,{method:"PUT",headers:{"Content-Type":"application/json","x-tenant-id":this.tenantId},body:JSON.stringify(r)});if(!a.ok)throw new Error(`Failed to update credentials: ${a.status}`);const i=await a.json();if(!i.success)throw new Error(i.error||"Failed to update credentials");const l={id:i.data.credential_id,name:i.data.name,baseUrl:i.data.base_url,username:i.data.username,password:"[ENCRYPTED]",instanceId:i.data.instance_id||"",instanceName:i.data.instance_name||"",userDomainId:i.data.user_domain_id||"1",isDefault:i.data.is_default===1,created:i.data.created_at,lastTested:i.data.last_tested_at,status:this.mapTestStatusToStatus(i.data.test_status),lastError:i.data.last_error};return console.log(" [Backend Credentials] Updated credentials in database"),l}catch(r){throw console.error(" [Backend Credentials] Failed to update credentials:",r),r}}async deleteCredentials(t){if(!this.tenantId)throw new Error("Tenant context not set. Call setTenantContext() first.");try{console.log(" [Backend Credentials] Deleting credentials:",t);const n=await fetch(`${this.baseUrl}/simple-credentials/${t}`,{method:"DELETE",headers:{"x-tenant-id":this.tenantId}});if(!n.ok)throw new Error(`Failed to delete credentials: ${n.status}`);const r=await n.json();if(!r.success)throw new Error(r.error||"Failed to delete credentials");console.log(" [Backend Credentials] Deleted credentials from database")}catch(n){throw console.error(" [Backend Credentials] Failed to delete credentials:",n),n}}async clearAllCredentials(){console.log(" [Backend Credentials] Clearing all credentials from database...");try{const t=await this.getAllCredentials();for(const n of t)await this.deleteCredentials(n.id);console.log(" [Backend Credentials] All credentials cleared from database")}catch(t){throw console.error(" [Backend Credentials] Failed to clear credentials:",t),t}}async loadCredentials(){return await this.getAllCredentials()}async testConnection(t){try{console.log(" [Backend Credentials] Testing connection via backend...");const r=await(await fetch("/api/v1/connections/test/archer",{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":this.tenantId||""},body:JSON.stringify({baseUrl:t.baseUrl,username:t.username,password:t.password,instanceId:t.instanceId,userDomainId:t.userDomainId,connectionId:t.id})})).json(),a={success:r.success||!1,message:r.message||"Connection test completed",details:r.details,error:r.error};return t.id&&await this.updateCredentials(t.id,{status:a.success?"connected":"error",lastTested:new Date().toISOString(),lastError:a.error||null}),console.log(`${a.success?"":""} [Backend Credentials] Connection test result:`,a.success),a}catch(n){return console.error(" [Backend Credentials] Connection test failed:",n),{success:!1,message:"Connection test failed",error:n instanceof Error?n.message:"Unknown error"}}}mapTestStatusToStatus(t){switch(t){case"success":return"connected";case"failed":return"error";case"pending":return"disconnected";default:return"disconnected"}}mapStatusToTestStatus(t){switch(t){case"connected":return"success";case"error":return"failed";case"testing":return"pending";default:return"pending"}}}const Ue=new rC,Cn=()=>Ue.getAllCredentials(),Yl=e=>Ue.saveCredentials(e),Oy=e=>Ue.deleteCredentials(e),sC=Object.freeze(Object.defineProperty({__proto__:null,credentialsManager:Ue,deleteCredentials:Oy,getAllCredentials:Cn,saveCredentials:Yl},Symbol.toStringTag,{value:"Module"})),$a=[{value:"archer-grc",label:"RSA Archer GRC",icon:s.jsx(ge,{className:"h-4 w-4"}),defaultPort:443},{value:"sql-server",label:"SQL Server",icon:s.jsx(at,{className:"h-4 w-4"}),defaultPort:1433},{value:"oracle",label:"Oracle Database",icon:s.jsx(at,{className:"h-4 w-4"}),defaultPort:1521},{value:"mysql",label:"MySQL",icon:s.jsx(at,{className:"h-4 w-4"}),defaultPort:3306},{value:"postgresql",label:"PostgreSQL",icon:s.jsx(at,{className:"h-4 w-4"}),defaultPort:5432},{value:"rest-api",label:"REST API",icon:s.jsx(Ns,{className:"h-4 w-4"}),defaultPort:443},{value:"soap",label:"SOAP Web Service",icon:s.jsx(Ns,{className:"h-4 w-4"}),defaultPort:80}],aC=()=>{const{tenant:e}=it(),[t,n]=S.useState([]),[r,a]=S.useState(!1),[i,l]=S.useState(null),[o,c]=S.useState(!1),[u,m]=S.useState(null),[d,p]=S.useState({name:"",type:"archer-grc",host:"",port:443,username:"",password:"",database:"",instanceName:"",description:""});S.useEffect(()=>{f()},[e==null?void 0:e.id]);const f=async()=>{if(!(e!=null&&e.id)){console.log("No tenant ID available, skipping connection load"),n([]);return}c(!0);try{console.log("Loading connections for tenant:",e.id,"using credentials API"),Ue.setTenantContext(e.id);const N=await Cn();console.log("Loaded",N.length,"credentials:",N);const O=N.map(D=>{let A=D.baseUrl,z=443;try{const M=new URL(D.baseUrl);A=M.hostname,z=M.port?parseInt(M.port):M.protocol==="https:"?443:80}catch{const R=D.baseUrl.match(/^https?:\/\/([^:]+):?(\d+)?/);R&&(A=R[1],z=R[2]?parseInt(R[2]):443)}return{id:D.id,name:D.name,type:"archer-grc",host:A,port:z,username:D.username,password:"",database:"",instanceName:D.instanceName||D.instanceId,description:`Archer instance: ${D.instanceName||D.instanceId}`,status:D.status,lastTested:D.lastTested?new Date(D.lastTested):void 0,lastSync:void 0,isEnabled:!0}});console.log("Converted",O.length,"connections for UI:",O),n(O)}catch(N){console.error("Error loading connections from credentials API:",N),n([])}finally{c(!1)}},g=()=>{if(console.log("=== CLEARING ALL CONNECTION DATA ==="),console.log("All localStorage keys:",Object.keys(localStorage)),Object.keys(localStorage).forEach(N=>{(N.includes("connection")||N.includes("credential")||N.includes("mcp"))&&(console.log("Removing localStorage key:",N),localStorage.removeItem(N))}),e!=null&&e.id)try{Ue.setTenantContext(e.id),Ue.clearAllCredentials(),console.log("Cleared credentials API data for tenant:",e.id)}catch(N){console.error("Error clearing credentials API data:",N)}f()};window.clearAllConnectionData=g;const v=async N=>{var O;if(!(e!=null&&e.id)){console.error("No tenant ID available, cannot save connections");return}try{console.log("Saving connections:",N.length,"connections for tenant:",e.id),Ue.setTenantContext(e.id);for(const D of N)if(D.type==="archer-grc"){let A=D.password||"";if(i&&i.id===D.id&&!A)try{const R=(await Cn()).find(H=>H.id===D.id);R&&(A=R.password,console.log("Preserving existing password for connection:",D.name))}catch(M){console.warn("Could not preserve existing password:",M)}const z={id:D.id,name:D.name,baseUrl:`https://${D.host}:${D.port}`,username:D.username||"",password:A,instanceId:D.instanceName||"",instanceName:D.instanceName||"",userDomainId:"",isDefault:!1,created:new Date().toISOString(),lastTested:(O=D.lastTested)==null?void 0:O.toISOString(),status:D.status,lastError:void 0};console.log("Saving credentials for connection:",D.name,"instanceName:",z.instanceName),await Yl(z)}n(N),console.log("Successfully saved connections to credentials API")}catch(D){console.error("Error saving connections:",D),alert("Failed to save connections: "+D.message)}},T=()=>{const N=$a.find(O=>O.value===d.type);p({...d,port:(N==null?void 0:N.defaultPort)||443}),l(null),a(!0)},y=N=>{p({name:N.name,type:N.type,host:N.host,port:N.port||443,username:N.username||"",password:"",database:N.database||"",instanceName:N.instanceName||"",description:N.description||""}),l(N),a(!0)},b=async()=>{c(!0);try{const N={id:(i==null?void 0:i.id)||Date.now().toString(),...d,status:"disconnected",lastTested:new Date,isEnabled:!0};let O;i?O=t.map(D=>D.id===i.id?{...D,...N}:D):O=[...t,N],await v(O),a(!1),l(null),p({name:"",type:"archer-grc",host:"",port:443,username:"",password:"",database:"",instanceName:"",description:""}),await f()}catch(N){console.error("Error saving connection:",N),alert("Failed to save connection: "+N.message)}finally{c(!1)}},x=async N=>{if(!(e!=null&&e.id)){alert("Cannot test connection: No tenant context available");return}m(N);try{Ue.setTenantContext(e.id);const D=(await Cn()).find(M=>M.id===N);if(!D)throw new Error("Connection not found in credentials store");console.log(`Testing connection: ${D.name}`);const A=await Ue.testConnection(D),z={...D,status:A.success?"connected":"error",lastTested:new Date().toISOString(),lastError:A.success?void 0:A.error};if(await Yl(z),await f(),A.success)alert(` Connection "${D.name}" test successful!
${A.message}`);else{let M=A.message||"Unknown error";if(A.error&&typeof A.error=="object"){const R=A.error;R.Description?M=R.Description.replace("ValidationMessageTemplates:",""):R.MessageKey?M=R.MessageKey.replace("ValidationMessageTemplates:",""):R.Reason?M=`${R.Reason}: Invalid credentials or configuration`:M=JSON.stringify(A.error,null,2)}else A.error&&(M=String(A.error));alert(` Connection "${D.name}" test failed!
${M}`)}}catch(O){console.error("Connection test error:",O),alert(`Connection test failed: ${O.message}`);try{const A=(await Cn()).find(z=>z.id===N);if(A){const z={...A,status:"error",lastTested:new Date().toISOString(),lastError:O.message};await Yl(z),await f()}}catch(D){console.error("Error updating connection status after test failure:",D)}}finally{m(null)}},I=async N=>{if(confirm("Are you sure you want to delete this connection?")){if(!(e!=null&&e.id)){alert("Cannot delete connection: No tenant context available");return}try{console.log(" Deleting connection:",N),Ue.setTenantContext(e.id),await Oy(N),await f(),console.log(" Successfully deleted connection from database")}catch(O){console.error(" Error deleting connection:",O),alert("Failed to delete connection: "+O.message)}}},C=N=>{switch(N){case"connected":return s.jsx(Le,{className:"h-4 w-4 text-green-600"});case"disconnected":return s.jsx(ko,{className:"h-4 w-4 text-gray-400"});case"error":return s.jsx(ue,{className:"h-4 w-4 text-red-600"});case"testing":return s.jsx($t,{className:"h-4 w-4 text-blue-600 animate-spin"});default:return s.jsx(ko,{className:"h-4 w-4 text-gray-400"})}},E=N=>{const O=$a.find(D=>D.value===N);return(O==null?void 0:O.icon)||s.jsx(at,{className:"h-4 w-4"})};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Connections"}),s.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage external system connections and integrations"})]}),s.jsxs(G,{onClick:T,children:[s.jsx(pn,{className:"h-4 w-4 mr-2"}),"Add Connection"]})]}),o&&t.length===0&&s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx($t,{className:"h-8 w-8 text-muted-foreground animate-spin mr-3"}),s.jsx("span",{className:"text-muted-foreground",children:"Loading connections..."})]}),s.jsxs("div",{className:"grid gap-4",children:[t.map(N=>{var O;return s.jsx(Q,{children:s.jsxs(ne,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[E(N.type),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:N.name}),s.jsx("p",{className:"text-sm text-muted-foreground",children:(O=$a.find(D=>D.value===N.type))==null?void 0:O.label})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[C(u===N.id?"testing":N.status),s.jsx("span",{className:"text-sm font-medium capitalize",children:u===N.id?"Testing":N.status})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("div",{className:"text-right text-sm text-muted-foreground",children:[s.jsxs("div",{children:[N.host,":",N.port]}),N.lastTested&&s.jsxs("div",{children:["Last tested: ",N.lastTested.toLocaleTimeString()]})]}),s.jsxs(G,{variant:"outline",size:"sm",onClick:()=>x(N.id),disabled:u===N.id,children:[s.jsx(Bi,{className:"h-4 w-4 mr-1"}),"Test"]}),s.jsxs(G,{variant:"outline",size:"sm",onClick:()=>y(N),children:[s.jsx(Gh,{className:"h-4 w-4 mr-1"}),"Edit"]}),s.jsx(G,{variant:"outline",size:"sm",onClick:()=>I(N.id),className:"text-red-600 hover:text-red-700",children:s.jsx(Ea,{className:"h-4 w-4"})})]})]}),N.description&&s.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:N.description})]})},N.id)}),t.length===0&&!o&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(at,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"font-medium text-muted-foreground mb-2",children:"No connections configured"}),s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Add your first connection to start integrating with external systems."}),s.jsxs(G,{onClick:T,children:[s.jsx(pn,{className:"h-4 w-4 mr-2"}),"Add Connection"]})]})]}),s.jsx(Yr,{open:r,onOpenChange:a,children:s.jsxs(Wr,{className:"max-w-md",children:[s.jsx(Kr,{children:s.jsx(Gr,{children:i?"Edit Connection":"Add New Connection"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(de,{htmlFor:"name",children:"Connection Name"}),s.jsx(pe,{id:"name",value:d.name,onChange:N=>p({...d,name:N.target.value}),placeholder:"e.g., Production Archer"})]}),s.jsxs("div",{children:[s.jsx(de,{htmlFor:"type",children:"Connection Type"}),s.jsx("select",{id:"type",value:d.type,onChange:N=>{const O=$a.find(D=>D.value===N.target.value);p({...d,type:N.target.value,port:(O==null?void 0:O.defaultPort)||443})},className:"w-full h-10 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",children:$a.map(N=>s.jsx("option",{value:N.value,children:N.label},N.value))})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(de,{htmlFor:"host",children:"Host"}),s.jsx(pe,{id:"host",value:d.host,onChange:N=>p({...d,host:N.target.value}),placeholder:"server.company.com"})]}),s.jsxs("div",{children:[s.jsx(de,{htmlFor:"port",children:"Port"}),s.jsx(pe,{id:"port",type:"number",value:d.port,onChange:N=>p({...d,port:parseInt(N.target.value)||443})})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(de,{htmlFor:"username",children:"Username"}),s.jsx(pe,{id:"username",value:d.username,onChange:N=>p({...d,username:N.target.value}),placeholder:"username"})]}),s.jsxs("div",{children:[s.jsx(de,{htmlFor:"password",children:"Password"}),s.jsx(pe,{id:"password",type:"password",value:d.password,onChange:N=>p({...d,password:N.target.value}),placeholder:"password"})]})]}),(d.type==="sql-server"||d.type==="oracle"||d.type==="mysql"||d.type==="postgresql")&&s.jsxs("div",{children:[s.jsx(de,{htmlFor:"database",children:"Database"}),s.jsx(pe,{id:"database",value:d.database,onChange:N=>p({...d,database:N.target.value}),placeholder:"database name"})]}),d.type==="archer-grc"&&s.jsxs("div",{children:[s.jsx(de,{htmlFor:"instanceName",children:"Instance Name"}),s.jsx(pe,{id:"instanceName",value:d.instanceName,onChange:N=>p({...d,instanceName:N.target.value}),placeholder:"e.g., v6.0, 710100, or instance identifier"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"The Archer instance name or identifier (check with your administrator)"})]}),s.jsxs("div",{children:[s.jsx(de,{htmlFor:"description",children:"Description (Optional)"}),s.jsx(pe,{id:"description",value:d.description,onChange:N=>p({...d,description:N.target.value}),placeholder:"Brief description of this connection"})]})]}),s.jsxs(Qr,{children:[s.jsx(G,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),s.jsxs(G,{onClick:b,disabled:o||!d.name||!d.host||d.type==="archer-grc"&&!d.instanceName,children:[o?"Saving...":i?"Update":"Add"," Connection"]})]})]})})]})},im=S.createContext(null),iC=({value:e,onValueChange:t,children:n,className:r})=>s.jsx(im.Provider,{value:{value:e,onValueChange:t},children:s.jsx("div",{className:Ee("space-y-6",r),children:n})}),lC=({children:e,className:t})=>s.jsx("div",{className:Ee("inline-flex h-10 items-center justify-center rounded-md bg-gray-100 p-1 text-gray-500",t),children:e}),qa=({value:e,children:t,className:n})=>{const r=S.useContext(im);if(!r)throw new Error("TabsTrigger must be used within a Tabs component");const{value:a,onValueChange:i}=r,l=a===e;return s.jsx("button",{type:"button",className:Ee("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",l?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-gray-50",n),onClick:()=>i(e),children:t})},Va=({value:e,children:t,className:n})=>{const r=S.useContext(im);if(!r)throw new Error("TabsContent must be used within a Tabs component");const{value:a}=r;return a!==e?null:s.jsx("div",{className:Ee("mt-6 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",n),children:t})},lm=({className:e,...t})=>s.jsx("textarea",{className:Ee("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t});function oC({value:e,onValueChange:t,secretType:n="api-key",placeholder:r="Select a secret or enter directly...",disabled:a=!1,allowDirectInput:i=!0,onDirectInputChange:l,directInputValue:o="",showCreateButton:c=!0}){const{tenant:u}=it(),[m,d]=S.useState([]),[p,f]=S.useState(!0),[g,v]=S.useState(!!e),[T,y]=S.useState(!1),[b,x]=S.useState(null),[I,C]=S.useState({secretName:"",secretValue:"",description:"",type:n}),[E,N]=S.useState(!1);S.useEffect(()=>{O()},[u==null?void 0:u.id]);const O=async()=>{var H;if(u!=null&&u.id){f(!0);try{const Y=await fetch(Sn("tenant-secrets"),{headers:{"x-tenant-id":u.id,"Content-Type":"application/json"}});if(Y.ok){const q=((H=(await Y.json()).data)==null?void 0:H.secrets)||[],B=n!=="custom"?q.filter(W=>W.secretType===n||W.secretType==="custom"):q;d(B)}}catch(Y){console.error("Error loading secrets:",Y)}finally{f(!1)}}},D=async()=>{var H;if(!I.secretName.trim()||!I.secretValue.trim()){x({type:"error",text:"Secret name and value are required"});return}N(!0);try{const Y=await fetch(Sn("tenant-secrets"),{method:"POST",headers:{"x-tenant-id":(u==null?void 0:u.id)||"","Content-Type":"application/json"},body:JSON.stringify({secretName:I.secretName.trim(),secretValue:I.secretValue,description:I.description.trim(),type:I.type})});if(!Y.ok){const q=await Y.json();throw new Error(((H=q.error)==null?void 0:H.message)||"Failed to create secret")}const P=await Y.json();x({type:"success",text:"Secret created successfully"}),C({secretName:"",secretValue:"",description:"",type:n}),y(!1),await O(),setTimeout(()=>{v(!0),t==null||t(I.secretName.trim(),P.data.secretReference)},100)}catch(Y){console.error("Error creating secret:",Y),x({type:"error",text:Y.message})}finally{N(!1)}},A=H=>{const Y=m.find(P=>P.secretName===H);Y&&(t==null||t(H,Y.keyVaultReference))},z=H=>{v(H),H||t==null||t("","")},M=H=>{switch(H){case"api-key":return"API Key";case"connection-string":return"Connection String";case"certificate":return"Certificate";case"custom":return"Custom";default:return"Unknown"}},R=m.find(H=>H.secretName===e);return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(de,{className:"text-sm font-medium",children:"API Key Configuration:"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"radio",id:"use-direct",checked:!g,onChange:()=>z(!1),disabled:a}),s.jsx("label",{htmlFor:"use-direct",className:"text-sm",children:"Enter directly"}),s.jsx("input",{type:"radio",id:"use-secret",checked:g,onChange:()=>z(!0),disabled:a}),s.jsx("label",{htmlFor:"use-secret",className:"text-sm",children:"Use managed secret"})]})]}),!g&&i&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"direct-input",children:"API Key"}),s.jsx(pe,{id:"direct-input",type:"password",value:o,onChange:H=>l==null?void 0:l(H.target.value),placeholder:"Enter API key directly...",disabled:a,className:"font-mono"}),s.jsx("p",{className:"text-xs text-gray-500",children:"For development use. Consider using managed secrets for production."})]}),g&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(de,{children:"Select Managed Secret"}),c&&s.jsxs(G,{size:"sm",variant:"outline",onClick:()=>y(!0),disabled:a,className:"text-xs h-7",children:[s.jsx(pn,{className:"h-3 w-3 mr-1"}),"Create New"]})]}),p?s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[s.jsx(tt,{className:"h-4 w-4 animate-spin"}),s.jsx("span",{children:"Loading secrets..."})]}):m.length===0?s.jsxs(Ie,{className:"border-yellow-200 bg-yellow-50",children:[s.jsx(ue,{className:"h-4 w-4 text-yellow-600"}),s.jsxs("span",{className:"text-yellow-800 text-sm",children:["No ",M(n).toLowerCase()," secrets found. Create one to get started."]})]}):s.jsxs("select",{value:e||"",onChange:H=>A(H.target.value),disabled:a,className:"w-full h-11 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:r}),m.map(H=>s.jsxs("option",{value:H.secretName,children:[H.secretName," - ",M(H.secretType)]},H.id))]}),R&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ge,{className:"h-4 w-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Selected Secret"})]}),s.jsxs("div",{className:"text-xs text-blue-800 space-y-1",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Name:"})," ",R.secretName]}),R.description&&s.jsxs("div",{children:[s.jsx("strong",{children:"Description:"})," ",R.description]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Type:"})," ",M(R.secretType)]}),s.jsx("div",{children:s.jsx("strong",{children:"Key Vault Reference:"})}),s.jsx("code",{className:"block bg-blue-100 px-2 py-1 rounded text-xs font-mono break-all",children:R.keyVaultReference})]})]})]}),b&&s.jsx(Ie,{className:b.type==="success"?"border-green-200 bg-green-50":"border-red-200 bg-red-50",children:s.jsxs("div",{className:"flex items-center",children:[b.type==="success"?s.jsx(Le,{className:"h-4 w-4 text-green-600 mr-2"}):s.jsx(ue,{className:"h-4 w-4 text-red-600 mr-2"}),s.jsx("span",{className:`text-sm ${b.type==="success"?"text-green-800":"text-red-800"}`,children:b.text})]})}),s.jsx(Yr,{open:T,onOpenChange:y,children:s.jsxs(Wr,{className:"max-w-md",children:[s.jsx(Kr,{children:s.jsxs(Gr,{children:["Create New ",M(n)]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"modal-secretName",children:"Secret Name *"}),s.jsx(pe,{id:"modal-secretName",value:I.secretName,onChange:H=>C(Y=>({...Y,secretName:H.target.value})),placeholder:"e.g., openai-api-key",disabled:E})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"modal-secretValue",children:"Secret Value *"}),s.jsx(pe,{id:"modal-secretValue",type:"password",value:I.secretValue,onChange:H=>C(Y=>({...Y,secretValue:H.target.value})),placeholder:"Enter the secret value...",disabled:E,className:"font-mono"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"modal-description",children:"Description (Optional)"}),s.jsx(pe,{id:"modal-description",value:I.description,onChange:H=>C(Y=>({...Y,description:H.target.value})),placeholder:"Brief description...",disabled:E})]})]}),s.jsxs(Qr,{children:[s.jsx(G,{variant:"outline",onClick:()=>y(!1),disabled:E,children:"Cancel"}),s.jsx(G,{onClick:D,disabled:E,children:E?s.jsxs(s.Fragment,{children:[s.jsx(tt,{className:"h-4 w-4 animate-spin mr-2"}),"Creating..."]}):"Create Secret"})]})]})})]})}const nu=[{value:"azure-openai",label:"Azure OpenAI",models:["your-deployment-name"],defaultEndpoint:"https://your-resource.openai.azure.com",requiresKey:!0,description:"Microsoft Azure OpenAI Service with enterprise security (enter your deployment name below)"},{value:"openai",label:"OpenAI",models:["gpt-4o","gpt-4","gpt-4-turbo","gpt-3.5-turbo"],defaultEndpoint:"https://api.openai.com/v1",requiresKey:!0,description:"Direct OpenAI API integration"},{value:"anthropic",label:"Anthropic",models:["claude-3-5-sonnet-20241022","claude-3-opus-20240229","claude-3-sonnet-20240229","claude-3-haiku-20240307"],defaultEndpoint:"https://api.anthropic.com",requiresKey:!0,description:"Anthropic Claude models with advanced reasoning"},{value:"custom",label:"Custom Endpoint",models:["custom-model"],defaultEndpoint:"",requiresKey:!0,description:"Custom LLM endpoint with configurable model and parameters"},{value:"ollama",label:"Ollama",models:["llama2","codellama","mistral","neural-chat"],defaultEndpoint:"http://localhost:11434",requiresKey:!1,description:"Local Ollama instance for private LLM hosting"}];function hp({isOpen:e,onClose:t,onSave:n,editMode:r=!1,initialConfig:a}){const{tenant:i}=it(),[l,o]=S.useState({name:(a==null?void 0:a.name)||"",description:(a==null?void 0:a.description)||"",provider:(a==null?void 0:a.provider)||"azure-openai",model:(a==null?void 0:a.model)||"gpt-4o",endpoint:(a==null?void 0:a.endpoint)||"",apiKey:(a==null?void 0:a.apiKey)||"",secretName:(a==null?void 0:a.secretName)||"",keyVaultReference:(a==null?void 0:a.keyVaultReference)||"",useSecret:(a==null?void 0:a.useSecret)||!1,customHeaders:(a==null?void 0:a.customHeaders)||{},maxTokens:(a==null?void 0:a.maxTokens)||4e3,temperature:(a==null?void 0:a.temperature)||.7,rateLimit:(a==null?void 0:a.rateLimit)||15}),[c,u]=S.useState(!1),[m,d]=S.useState(!1),[p,f]=S.useState(!1),[g,v]=S.useState(!1),[T,y]=S.useState(null),[b,x]=S.useState(null),[I,C]=S.useState([]),E=nu.find(P=>P.value===l.provider);S.useEffect(()=>{e&&E&&!r&&o(P=>({...P,endpoint:E.defaultEndpoint,model:E.models[0]}))},[e,E,r]),S.useEffect(()=>{if(r&&a&&(o({name:a.name||"",description:a.description||"",provider:a.provider||"azure-openai",model:a.model||"gpt-4o",endpoint:a.endpoint||"",apiKey:a.apiKey||"",secretName:a.secretName||"",keyVaultReference:a.keyVaultReference||"",useSecret:a.useSecret||!1,customHeaders:a.customHeaders||{},maxTokens:a.maxTokens||4e3,temperature:a.temperature||.7,rateLimit:a.rateLimit||100}),a.customHeaders)){const P=Object.entries(a.customHeaders).map(([q,B])=>({key:q,value:B}));C(P)}},[r,a]);const N=(P,q)=>{o(B=>({...B,[P]:q})),y(null)},O=(P,q)=>{o(B=>({...B,secretName:P,keyVaultReference:q,useSecret:!!P})),y(null)},D=P=>{o(q=>({...q,apiKey:P,useSecret:!1,secretName:"",keyVaultReference:""})),y(null)},A=P=>{const q=nu.find(B=>B.value===P);q&&o(B=>({...B,provider:P,endpoint:q.defaultEndpoint,model:P==="azure-openai"?"":q.models[0],apiKey:q.requiresKey?B.apiKey:""}))},z=P=>{C(P);const q={};P.forEach(B=>{B.key.trim()&&B.value.trim()&&(q[B.key.trim()]=B.value.trim())}),N("customHeaders",q)},M=()=>l.name.trim()?l.endpoint.trim()?!l.endpoint.startsWith("http://")&&!l.endpoint.startsWith("https://")?"Endpoint must be a valid HTTP/HTTPS URL":E!=null&&E.requiresKey&&!l.useSecret&&!l.apiKey.trim()?"API key is required for this provider (enter directly or select a managed secret)":E!=null&&E.requiresKey&&l.useSecret&&!l.secretName.trim()?"Please select a managed secret for this provider":l.maxTokens<100||l.maxTokens>32e3?"Max tokens must be between 100 and 32,000":l.temperature<0||l.temperature>2?"Temperature must be between 0 and 2":l.rateLimit&&(l.rateLimit<1||l.rateLimit>1e3)?"Rate limit must be between 1 and 1000 requests per minute":null:"Endpoint URL is required":"LLM configuration name is required",R=async()=>{const P=M();if(P){x({type:"error",text:P});return}f(!0),y(null),x({type:"info",text:`Testing ${l.provider} connection...`});try{await H(),y({success:!0,message:"Connection successful! Endpoint and deployment verified."}),x({type:"success",text:"Connection test passed - configuration is working correctly"})}catch(q){y({success:!1,message:q.message}),x({type:"error",text:`Connection failed: ${q.message}`})}finally{f(!1)}},H=async()=>{let P=l.endpoint;P.startsWith("https://")||(P="https://"+P),P.endsWith("/")&&(P=P.slice(0,-1));let q,B,W;const k=l.useSecret?"[SECRET_REFERENCE]":l.apiKey;if(l.useSecret&&l.keyVaultReference)throw new Error("Secret-based authentication testing not implemented yet. Save configuration to test with live secret.");if(l.provider==="azure-openai"){const _=l.model;q=`${P}/openai/deployments/${_}/chat/completions?api-version=2024-08-01-preview`,B={"Content-Type":"application/json","api-key":k},W={messages:[{role:"user",content:"test"}],max_tokens:1,temperature:0},console.log(`[LLM Test] Testing Azure OpenAI: ${q}`)}else if(l.provider==="openai")q=`${P}/chat/completions`,B={"Content-Type":"application/json",Authorization:`Bearer ${k}`},W={model:l.model,messages:[{role:"user",content:"test"}],max_tokens:1,temperature:0};else if(l.provider==="anthropic")q=`${P}/v1/messages`,B={"Content-Type":"application/json","x-api-key":k,"anthropic-version":"2023-06-01"},W={model:l.model,messages:[{role:"user",content:"test"}],max_tokens:1};else throw new Error("Provider testing not yet implemented for custom endpoints");l.customHeaders&&Object.assign(B,l.customHeaders);const le=await fetch(q,{method:"POST",headers:B,body:JSON.stringify(W)});if(!le.ok){const _=await le.text().catch(()=>"Unknown error");throw console.error("[LLM Test] API error:",{status:le.status,statusText:le.statusText,url:q,errorText:_}),l.provider==="azure-openai"&&le.status===404?new Error(`Deployment '${l.model}' not found. Check your deployment name in Azure AI Studio.`):le.status===401?new Error("Authentication failed. Check your API key."):le.status===403?new Error("Access forbidden. Check your API key permissions."):new Error(`API error: ${le.status} - ${le.statusText}`)}const xe=await le.json();console.log("[LLM Test] Success:",{status:le.status,hasChoices:!!xe.choices||!!xe.content})},Y=async()=>{const P=M();if(P){x({type:"error",text:P});return}v(!0),x(null);try{const q={id:r?a.id:`llm-${crypto.randomUUID()}`,name:l.name.trim(),description:l.description.trim()||`${E==null?void 0:E.label} configuration: ${l.model}`,provider:l.provider,model:l.model,endpoint:l.endpoint.trim(),apiKey:l.useSecret?"":l.apiKey.trim(),secretName:l.useSecret?l.secretName:void 0,keyVaultReference:l.useSecret?l.keyVaultReference:void 0,useSecret:l.useSecret,customHeaders:Object.keys(l.customHeaders).length>0?l.customHeaders:void 0,maxTokens:l.maxTokens,temperature:l.temperature,rateLimit:l.rateLimit||void 0,isEnabled:r?a.isEnabled:!0,createdAt:r?a.createdAt:new Date().toISOString()};await n(q),o({name:"",description:"",provider:"azure-openai",model:"gpt-4o",endpoint:"",apiKey:"",secretName:"",keyVaultReference:"",useSecret:!1,customHeaders:{},maxTokens:4e3,temperature:.7,rateLimit:15}),C([]),y(null),x(null),t()}catch(q){x({type:"error",text:`Failed to add LLM configuration: ${q.message}`})}finally{v(!1)}};return s.jsx(Yr,{open:e,onOpenChange:t,children:s.jsxs(Wr,{className:"max-w-4xl max-h-[95vh] overflow-hidden flex flex-col",children:[s.jsx(Kr,{children:s.jsxs(Gr,{className:"flex items-center space-x-2",children:[s.jsx(pn,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{children:r?"Edit LLM Configuration":"Add LLM Configuration"})]})}),s.jsxs("div",{className:"flex-1 overflow-y-auto space-y-6 px-2 py-2",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-50 rounded-lg border border-blue-100",children:[s.jsxs("div",{className:"flex items-center space-x-6",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-medium",children:"1"}),s.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Basic Info"})]}),s.jsx("div",{className:"w-8 h-px bg-blue-200"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-medium",children:"2"}),s.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Configuration"})]}),s.jsx("div",{className:"w-8 h-px bg-blue-200"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-medium",children:"3"}),s.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Parameters"})]})]}),s.jsxs(J,{variant:"outline",className:"bg-white border-blue-200 text-blue-700",children:[s.jsx(ar,{className:"h-3 w-3 mr-1"}),"LLM Setup"]})]}),s.jsxs("div",{className:"border border-gray-200 rounded-xl bg-white shadow-sm",children:[s.jsx("div",{className:"border-b border-gray-100 px-6 py-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsx(dn,{className:"h-4 w-4 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Basic Information"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Name and provider selection for your LLM configuration"})]})]})}),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"llmName",className:"text-sm font-medium text-gray-700",children:"Configuration Name *"}),s.jsx(pe,{id:"llmName",type:"text",value:l.name,onChange:P=>N("name",P.target.value),placeholder:"e.g., Production GPT-4o, Claude Sonnet Dev",disabled:g,className:"h-11"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Choose a descriptive name to identify this configuration"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"provider",className:"text-sm font-medium text-gray-700",children:"Provider *"}),s.jsx("select",{id:"provider",value:l.provider,onChange:P=>A(P.target.value),className:"w-full h-11 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",disabled:g,children:nu.map(P=>s.jsx("option",{value:P.value,children:P.label},P.value))}),s.jsx("p",{className:"text-xs text-gray-500",children:E==null?void 0:E.description})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"description",className:"text-sm font-medium text-gray-700",children:"Description (Optional)"}),s.jsx(lm,{id:"description",value:l.description,onChange:P=>N("description",P.target.value),placeholder:"Brief description of when to use this LLM configuration...",rows:3,disabled:g,className:"resize-none"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Help team members understand when to use this configuration"})]})]})]}),s.jsxs("div",{className:"border border-gray-200 rounded-xl bg-white shadow-sm",children:[s.jsx("div",{className:"border-b border-gray-100 px-6 py-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:s.jsx(At,{className:"h-4 w-4 text-purple-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Model Configuration"}),s.jsx("p",{className:"text-sm text-gray-500",children:"API endpoint, model selection, and authentication settings"})]})]})}),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"model",className:"text-sm font-medium text-gray-700",children:l.provider==="azure-openai"?"Deployment Name *":"Model *"}),l.provider==="custom"||l.provider==="azure-openai"?s.jsx(pe,{id:"model",type:"text",value:l.model,onChange:P=>N("model",P.target.value),placeholder:l.provider==="azure-openai"?"e.g., my-gpt4-deployment, gpt-35-turbo-prod":"e.g., llama-2-70b, mistral-7b-instruct",disabled:g,className:"h-11 font-mono text-sm"}):s.jsx("select",{id:"model",value:l.model,onChange:P=>N("model",P.target.value),className:"w-full h-11 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",disabled:g,children:E==null?void 0:E.models.map(P=>s.jsx("option",{value:P,children:P},P))}),s.jsx("p",{className:"text-xs text-gray-500",children:l.provider==="azure-openai"?"Enter your Azure OpenAI deployment name (not the model name)":"Select the specific model variant to use"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"endpoint",className:"text-sm font-medium text-gray-700",children:"API Endpoint *"}),s.jsx(pe,{id:"endpoint",type:"url",value:l.endpoint,onChange:P=>N("endpoint",P.target.value),placeholder:E==null?void 0:E.defaultEndpoint,disabled:g,className:"h-11 font-mono text-sm"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Full URL to the API endpoint including protocol"})]})]}),(E==null?void 0:E.requiresKey)&&s.jsx(oC,{value:l.useSecret?l.secretName:"",onValueChange:O,directInputValue:l.apiKey,onDirectInputChange:D,secretType:"api-key",disabled:g,placeholder:"Select an API key secret or enter directly...",allowDirectInput:!0,showCreateButton:!0})]})]}),s.jsxs("div",{className:"border border-gray-200 rounded-xl bg-white shadow-sm",children:[s.jsx("div",{className:"border-b border-gray-100 px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center",children:s.jsx(ar,{className:"h-4 w-4 text-orange-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Advanced Configuration"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Model parameters and custom headers"})]})]}),s.jsxs(J,{variant:"outline",className:"text-xs bg-orange-50 border-orange-200 text-orange-700",children:[s.jsx(dn,{className:"h-3 w-3 mr-1"}),"Optional"]})]})}),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:"Model Parameters"}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"maxTokens",className:"text-sm font-medium text-gray-700",children:"Max Tokens"}),s.jsx(pe,{id:"maxTokens",type:"number",value:l.maxTokens,onChange:P=>N("maxTokens",parseInt(P.target.value)||4e3),min:100,max:32e3,disabled:g,className:"h-11"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Maximum tokens in model response (100-32,000)"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"temperature",className:"text-sm font-medium text-gray-700",children:"Temperature"}),s.jsx(pe,{id:"temperature",type:"number",step:"0.1",value:l.temperature,onChange:P=>N("temperature",parseFloat(P.target.value)||.7),min:0,max:2,disabled:g,className:"h-11"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Randomness of model responses (0=deterministic, 2=very random)"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"rateLimit",className:"text-sm font-medium text-gray-700",children:"Rate Limit (RPM)"}),s.jsx(pe,{id:"rateLimit",type:"number",value:l.rateLimit,onChange:P=>N("rateLimit",parseInt(P.target.value)||15),min:1,max:1e3,disabled:g,className:"h-11",placeholder:"15"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Requests per minute (1-1000). Leave empty for auto-detection"})]})]})]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:"Custom Headers"}),s.jsxs(J,{variant:"outline",className:"text-xs bg-gray-50 border-gray-200 text-gray-600",children:[s.jsx(dn,{className:"h-3 w-3 mr-1"}),"Advanced"]})]}),s.jsx("p",{className:"text-sm text-gray-500",children:"Add custom HTTP headers for specialized authentication or routing"}),s.jsxs("div",{className:"space-y-3",children:[I.map((P,q)=>s.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[s.jsx(pe,{placeholder:"Header name (e.g., Authorization)",value:P.key,onChange:B=>{const W=[...I];W[q].key=B.target.value,z(W)},disabled:g,className:"flex-1 font-mono text-sm bg-white"}),s.jsx(pe,{placeholder:"Header value",value:P.value,onChange:B=>{const W=[...I];W[q].value=B.target.value,z(W)},disabled:g,className:"flex-1 font-mono text-sm bg-white"}),s.jsx(G,{type:"button",variant:"ghost",size:"sm",onClick:()=>{const B=I.filter((W,k)=>k!==q);z(B)},disabled:g,className:"text-red-500 hover:text-red-700 hover:bg-red-50 shrink-0",children:""})]},q)),s.jsxs(G,{type:"button",variant:"outline",size:"sm",onClick:()=>z([...I,{key:"",value:""}]),disabled:g,className:"w-full mt-3 border-dashed border-gray-300 hover:border-gray-400 hover:bg-gray-50",children:[s.jsx(pn,{className:"h-3 w-3 mr-2"}),"Add Custom Header"]})]})]})]})]}),s.jsxs("div",{className:"border border-gray-200 rounded-xl bg-white shadow-sm",children:[s.jsx("div",{className:"border-b border-gray-100 px-6 py-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:s.jsx(Bi,{className:"h-4 w-4 text-green-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Test Configuration"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Verify connectivity and authentication before saving"})]})]})}),s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-start justify-between p-4 bg-green-50 border border-green-200 rounded-lg",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-green-900 text-sm mb-1",children:"Connection Test"}),s.jsx("p",{className:"text-sm text-green-700",children:"Test your configuration to ensure the LLM provider is accessible with your settings"})]}),s.jsx(G,{onClick:R,disabled:p||g,variant:"outline",className:"ml-4 border-green-300 text-green-700 hover:bg-green-100 hover:border-green-400",children:p?s.jsxs(s.Fragment,{children:[s.jsx(tt,{className:"h-4 w-4 animate-spin mr-2"}),"Testing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Bi,{className:"h-4 w-4 mr-2"}),"Test Connection"]})})]}),T&&s.jsx("div",{className:"mt-4",children:s.jsxs(Ie,{className:T.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50",children:[T.success?s.jsx(Le,{className:"h-4 w-4 text-green-600"}):s.jsx(ue,{className:"h-4 w-4 text-red-600"}),s.jsxs("div",{children:[s.jsx("p",{className:`font-medium ${T.success?"text-green-800":"text-red-800"}`,children:T.success?"Connection Successful":"Connection Failed"}),s.jsx("p",{className:`text-sm ${T.success?"text-green-700":"text-red-700"}`,children:T.message})]})]})})]})]}),b&&s.jsxs(Ie,{className:`${b.type==="success"?"border-green-200 bg-green-50":b.type==="error"?"border-red-200 bg-red-50":"border-blue-200 bg-blue-50"}`,children:[b.type==="success"?s.jsx(Le,{className:"h-4 w-4 text-green-600"}):b.type==="error"?s.jsx(ue,{className:"h-4 w-4 text-red-600"}):s.jsx(dn,{className:"h-4 w-4 text-blue-600"}),s.jsx("span",{className:b.type==="success"?"text-green-800":b.type==="error"?"text-red-800":"text-blue-800",children:b.text})]})]}),s.jsxs(Qr,{className:"flex-shrink-0 border-t border-gray-200 pt-4 mt-4 flex justify-end space-x-3",children:[s.jsx(G,{variant:"outline",onClick:t,disabled:g,children:"Cancel"}),s.jsx(G,{onClick:Y,disabled:g||!!M(),className:"flex items-center space-x-2",children:g?s.jsxs(s.Fragment,{children:[s.jsx(tt,{className:"h-4 w-4 animate-spin"}),s.jsx("span",{children:"Adding..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(At,{className:"h-4 w-4"}),s.jsx("span",{children:r?"Update Configuration":"Add LLM Configuration"})]})})]})]})})}function cC({canModify:e=!0,isSaving:t=!1}){const{tenant:n}=it(),[r,a]=S.useState([]),[i,l]=S.useState(!1),[o,c]=S.useState(null),[u,m]=S.useState(!0);S.useEffect(()=>{d()},[n==null?void 0:n.id]);const d=async()=>{m(!0);try{console.log("Loading LLM configs for tenant:",n==null?void 0:n.id);const C=await Rs.getAllLlmConfigs();console.log("Loaded",C.length,"LLM configurations:"),C.forEach((E,N)=>{console.log(`  LLM Config ${N}:`,{id:E.id,name:E.name,idType:typeof E.id})}),a(C)}catch(C){console.error("Error loading LLM configurations:",C),a([])}m(!1)},p=async C=>{try{const E=await Rs.createLlmConfig(C);a(N=>[...N,E])}catch(E){console.error("Error adding LLM configuration:",E)}},f=C=>{console.log("Edit button clicked for config ID:",C),console.log("Available configs:",r.map(E=>({id:E.id,name:E.name}))),c(C)},g=async(C,E)=>{try{const N=await Rs.updateLlmConfig(C,E);a(O=>O.map(D=>D.id===C?N:D)),c(null)}catch(N){console.error("Error updating LLM configuration:",N)}},v=async C=>{if(e)try{await Rs.deleteLlmConfig(C),a(E=>E.filter(N=>N.id!==C))}catch(E){console.error("Error deleting LLM configuration:",E)}},T=async(C,E)=>{if(e){if(console.log(" Toggle Debug - configId received:",C),console.log(" Toggle Debug - configId type:",typeof C),console.log(" Toggle Debug - enabled:",E),console.log(" Toggle Debug - current configs:"),r.forEach((N,O)=>{console.log(`  Config ${O}:`,{id:N.id,name:N.name,idType:typeof N.id})}),!C||C==="undefined"){console.error(" Invalid config ID - cannot toggle");return}try{const N=await Rs.toggleLlmConfig(C,E);a(O=>O.map(D=>D.id===C?N:D))}catch(N){console.error("Error toggling LLM configuration:",N)}}},y=C=>{switch(C){case"azure-openai":return s.jsx(ar,{className:"h-4 w-4"});case"openai":return s.jsx(At,{className:"h-4 w-4"});case"anthropic":return s.jsx(Wh,{className:"h-4 w-4"});case"ollama":return s.jsx(dt,{className:"h-4 w-4"});default:return s.jsx(Ns,{className:"h-4 w-4"})}},b=C=>{switch(C){case"azure-openai":return"Azure OpenAI";case"openai":return"OpenAI";case"anthropic":return"Anthropic";case"ollama":return"Ollama Local";case"custom":return"Custom Endpoint";default:return"Unknown Provider"}},x=C=>{switch(C){case"connected":return s.jsx(Le,{className:"h-4 w-4 text-green-600"});case"disconnected":return s.jsx(ue,{className:"h-4 w-4 text-gray-400"});case"error":return s.jsx(ue,{className:"h-4 w-4 text-red-600"});case"testing":return s.jsx(tt,{className:"h-4 w-4 animate-spin text-blue-600"});default:return s.jsx(ue,{className:"h-4 w-4 text-gray-400"})}},I=C=>{switch(C.status){case"connected":return s.jsx(J,{className:"bg-green-100 text-green-800 border-green-200",children:"Connected"});case"disconnected":return s.jsx(J,{variant:"secondary",children:"Disconnected"});case"error":return s.jsx(J,{variant:"destructive",children:"Error"});case"testing":return s.jsx(J,{className:"bg-blue-100 text-blue-800 border-blue-200",children:"Testing"});default:return s.jsx(J,{variant:"secondary",children:"Unknown"})}};return u?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(tt,{className:"h-6 w-6 animate-spin mr-2"}),s.jsx("span",{children:"Loading LLM configurations..."})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold",children:"LLM Configuration Management"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Add and configure Large Language Model providers for AI agent assignment"})]}),e&&s.jsxs(G,{onClick:()=>l(!0),className:"flex items-center space-x-2",children:[s.jsx(pn,{className:"h-4 w-4"}),s.jsx("span",{children:"Add LLM Configuration"})]})]}),r.length===0?s.jsx(Q,{className:"border-2 border-dashed border-gray-300",children:s.jsxs(ne,{className:"flex flex-col items-center justify-center py-12",children:[s.jsx(At,{className:"h-12 w-12 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No LLM Configurations"}),s.jsx("p",{className:"text-gray-600 text-center max-w-md",children:'Add your first LLM configuration using the "Add LLM Configuration" button above to enable AI agents with various language models for different use cases.'})]})}):s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:r.map(C=>{var E;return s.jsxs(Q,{className:`transition-all hover:shadow-md ${C.isEnabled?"ring-2 ring-blue-200 bg-blue-50/30":""}`,children:[s.jsx(he,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[s.jsx(be,{className:"text-base",children:C.name}),x(C.status)]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsxs(J,{variant:"outline",className:"text-xs flex items-center space-x-1",children:[y(C.provider),s.jsx("span",{children:b(C.provider)})]}),s.jsx(J,{variant:"secondary",className:"text-xs",children:C.model})]})]}),I(C)]})}),s.jsxs(ne,{className:"space-y-4",children:[s.jsx("div",{className:"text-sm text-gray-600",children:C.description}),s.jsxs("div",{className:"space-y-2 text-xs",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ns,{className:"h-3 w-3 text-gray-400"}),s.jsx("span",{className:"text-gray-600",children:"Endpoint:"}),s.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-xs font-mono truncate max-w-48",children:C.endpoint})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ar,{className:"h-3 w-3 text-gray-400"}),s.jsx("span",{className:"text-gray-600",children:"Max Tokens:"}),s.jsx("span",{className:"font-medium",children:((E=C.maxTokens)==null?void 0:E.toLocaleString())||"N/A"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(dt,{className:"h-3 w-3 text-gray-400"}),s.jsx("span",{className:"text-gray-600",children:"Temp:"}),s.jsx("span",{className:"font-medium",children:C.temperature??"N/A"})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ji,{className:"h-3 w-3 text-gray-400"}),s.jsx("span",{className:"text-gray-600",children:"Added:"}),s.jsx("span",{children:C.createdAt?new Date(C.createdAt).toLocaleDateString():"Unknown"})]})]}),C.errorMessage&&s.jsxs(Ie,{className:"border-red-200 bg-red-50",children:[s.jsx(ue,{className:"h-4 w-4 text-red-600"}),s.jsx("span",{className:"text-red-800 text-xs",children:C.errorMessage})]}),s.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[s.jsx("div",{className:"flex items-center space-x-2",children:s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:C.isEnabled,onChange:N=>T(C.id,N.target.checked),disabled:!e||t,className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("span",{className:"text-sm font-medium",children:C.isEnabled?"Enabled":"Disabled"})]})}),s.jsx("div",{className:"flex items-center space-x-2",children:e&&s.jsxs(s.Fragment,{children:[s.jsxs(G,{size:"sm",variant:"outline",onClick:()=>f(C.id),className:"flex items-center space-x-1",children:[s.jsx(dt,{className:"h-3 w-3"}),s.jsx("span",{children:"Edit"})]}),s.jsxs(G,{size:"sm",variant:"outline",onClick:()=>v(C.id),className:"flex items-center space-x-1 text-red-600 hover:text-red-700",children:[s.jsx(Ea,{className:"h-3 w-3"}),s.jsx("span",{children:"Delete"})]})]})})]})]})]},C.id)})}),r.length>0&&s.jsx(Q,{className:"bg-gray-50",children:s.jsx(ne,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(At,{className:"h-4 w-4 text-blue-600"}),s.jsxs("span",{className:"font-semibold text-gray-900",children:[r.length," configuration",r.length!==1?"s":""," available"]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Le,{className:"h-4 w-4 text-green-600"}),s.jsxs("span",{className:"text-gray-600",children:[r.filter(C=>C.isEnabled).length," enabled"]})]})]}),s.jsxs(J,{variant:"outline",className:"bg-white",children:[r.filter(C=>C.status==="connected").length," connected"]})]})})}),s.jsx(hp,{isOpen:i,onClose:()=>l(!1),onSave:p}),o&&(()=>{const C=r.find(E=>E.id===o);return console.log("Edit modal rendering. editModalOpen:",o),console.log("configToEdit found:",C),C?s.jsx(hp,{isOpen:!!o,onClose:()=>c(null),onSave:E=>g(o,E),editMode:!0,initialConfig:{id:C.id,name:C.name,description:C.description,provider:C.provider,model:C.model,endpoint:C.endpoint,apiKey:C.apiKey,customHeaders:C.customHeaders,maxTokens:C.maxTokens,temperature:C.temperature,isEnabled:C.isEnabled,createdAt:C.createdAt}}):null})()]})}const uC="modulepreload",dC=function(e){return"/"+e},mp={},_d=function(t,n,r){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=Promise.allSettled(n.map(c=>{if(c=dC(c),c in mp)return;mp[c]=!0;const u=c.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${m}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":uC,u||(d.as="script"),d.crossOrigin="",d.href=c,o&&d.setAttribute("nonce",o),document.head.appendChild(d),u)return new Promise((p,f)=>{d.addEventListener("load",p),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return a.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})};class hC{constructor(){}async getTenantConfiguration(t){try{const n=`mcp_bridge_config_${t}`,r=localStorage.getItem(n);return r?JSON.parse(r):null}catch(n){return console.error("Error loading MCP configuration:",n),null}}async updateTenantConfiguration(t,n){try{const r=`mcp_bridge_config_${t}`;return localStorage.setItem(r,JSON.stringify(n)),await this.notifyMcpServer(t,n),!0}catch(r){return console.error("Error updating MCP configuration:",r),!1}}async convertSettingsToMcpConfig(t,n,r){Ue.setTenantContext(t),await Ue.initialize();const a=await Cn(),i={};return Object.entries(r).forEach(([l,o])=>{a.find(u=>u.id===o.connectionId)&&(i[l]={serverId:l,connectionId:o.connectionId,privacyConfig:{enableMasking:n.enablePrivacyMasking,maskingLevel:n.maskingLevel,enableTokenization:n.enableTokenization,customSensitiveFields:n.customSensitiveFields,privacyKey:n.privacyKey},performanceConfig:{pageSize:n.pageSize||50,requestTimeout:n.requestTimeout||30,maxRetries:n.maxRetries||3,enableCaching:n.enableCaching||!1,enableBackgroundSync:n.enableBackgroundSync||!1},lastUpdated:new Date().toISOString()})}),{tenantId:t,servers:i,globalSettings:{defaultMaskingLevel:n.maskingLevel,enableAuditLogging:!0}}}async notifyMcpServer(t,n){try{const r={tenantId:t,timestamp:new Date().toISOString(),servers:Object.values(n.servers).reduce((a,i)=>(a[i.serverId]={connection_id:i.connectionId,privacy_masking:i.privacyConfig.enableMasking,masking_level:i.privacyConfig.maskingLevel,tokenization:i.privacyConfig.enableTokenization,custom_fields:i.privacyConfig.customSensitiveFields,page_size:i.performanceConfig.pageSize,timeout:i.performanceConfig.requestTimeout,max_retries:i.performanceConfig.maxRetries,enable_cache:i.performanceConfig.enableCaching},a),{})}}catch(r){console.error("Error notifying MCP server:",r)}}async getAvailableConnections(t){return Ue.setTenantContext(t),await Ue.initialize(),Cn()}async testServerConfiguration(t,n,r){try{Ue.setTenantContext(t),await Ue.initialize();const i=(await Cn()).find(l=>l.id===r);return i?(await new Promise(l=>setTimeout(l,2e3)),{success:!0,message:`MCP server ${n} successfully connected to ${i.name}`,details:{serverId:n,connectionName:i.name,endpoint:i.baseUrl,testedAt:new Date().toISOString()}}):{success:!1,message:"Connection not found"}}catch(a){return{success:!1,message:`Test failed: ${a.message}`,details:{error:a.message}}}}async syncSettingsToMcpServer(t){try{const n=`mcp_privacy_config_${t}`,r=`mcp_server_configs_${t}`,a=JSON.parse(localStorage.getItem(n)||"{}"),i=JSON.parse(localStorage.getItem(r)||"{}"),l=await this.convertSettingsToMcpConfig(t,a,i);return await this.updateTenantConfiguration(t,l)}catch(n){return console.error("Error syncing settings to MCP server:",n),!1}}}const fs=new hC;class mC{constructor(){_e(this,"STORAGE_KEY_PREFIX","grc_encrypted_credentials");_e(this,"SETTINGS_KEY_PREFIX","grc_security_settings");_e(this,"encryptionKey",null);_e(this,"tenantId",null)}setTenantContext(t){this.tenantId=t}getTenantStorageKey(){if(!this.tenantId)throw new Error("Tenant context not set. Call setTenantContext() first.");return`${this.STORAGE_KEY_PREFIX}_${this.tenantId}`}getTenantSettingsKey(){if(!this.tenantId)throw new Error("Tenant context not set. Call setTenantContext() first.");return`${this.SETTINGS_KEY_PREFIX}_${this.tenantId}`}async initialize(){try{if(!window.crypto||!window.crypto.subtle)throw new Error("Web Crypto API not available");await this.getOrCreateEncryptionKey()}catch(t){throw console.error("Failed to initialize credentials manager:",t),t}}async getOrCreateEncryptionKey(){try{const t=await this.deriveKeyMaterial();return this.encryptionKey=await window.crypto.subtle.importKey("raw",t,{name:"AES-GCM"},!1,["encrypt","decrypt"]),this.encryptionKey}catch(t){throw console.error("Failed to create encryption key:",t),t}}async deriveKeyMaterial(){const t=this.getSessionInfo(),r=new TextEncoder().encode(t);return await window.crypto.subtle.digest("SHA-256",r)}getSessionInfo(){const t=localStorage.getItem("auth_user"),n=this.getDeviceIdentifier();return`${t||"default"}:${n}:grc-platform-v1`}getDeviceIdentifier(){let t=localStorage.getItem("device_id");return t||(t=this.generateDeviceId(),localStorage.setItem("device_id",t)),t}generateDeviceId(){const t=new Uint8Array(16);return window.crypto.getRandomValues(t),Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}async encryptCredentials(t){this.encryptionKey||await this.initialize();try{const n={username:t.username,password:t.password,instanceId:t.instanceId,instanceName:t.instanceName,userDomainId:t.userDomainId},r=window.crypto.getRandomValues(new Uint8Array(12)),a=window.crypto.getRandomValues(new Uint8Array(16)),l=new TextEncoder().encode(JSON.stringify(n)),o=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:r},this.encryptionKey,l),c=this.arrayBufferToBase64(o),u=this.arrayBufferToBase64(r.buffer),m=this.arrayBufferToBase64(a.buffer);return{id:t.id,name:t.name,baseUrl:t.baseUrl,encryptedData:c,iv:u,salt:m,isDefault:t.isDefault,created:t.created,lastTested:t.lastTested,status:t.status,lastError:t.lastError}}catch(n){throw console.error("Failed to encrypt credentials:",n),new Error("Encryption failed")}}async decryptCredentials(t){this.encryptionKey||await this.initialize();try{const n=this.base64ToArrayBuffer(t.encryptedData),r=this.base64ToArrayBuffer(t.iv),a=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:r},this.encryptionKey,n),l=new TextDecoder().decode(a),o=JSON.parse(l);return{id:t.id,name:t.name,baseUrl:t.baseUrl,username:o.username,password:o.password,instanceId:o.instanceId,instanceName:o.instanceName,userDomainId:o.userDomainId,isDefault:t.isDefault,created:t.created,lastTested:t.lastTested,status:t.status,lastError:t.lastError}}catch(n){throw console.error("Failed to decrypt credentials:",n),new Error("Decryption failed - credentials may be corrupted")}}async storeCredentials(t){try{const n=await Promise.all(t.map(r=>this.encryptCredentials(r)));localStorage.setItem(this.getTenantStorageKey(),JSON.stringify(n))}catch(n){throw console.error("Failed to store credentials:",n),n}}async loadCredentials(){try{const t=localStorage.getItem(this.getTenantStorageKey());if(!t)return[];const n=JSON.parse(t);return await Promise.all(n.map(r=>this.decryptCredentials(r)))}catch(t){return console.error("Failed to load credentials:",t),localStorage.removeItem(this.getTenantStorageKey()),[]}}async testConnection(t){const n=Date.now();try{console.log(`Testing connection to Archer via backend: ${t.baseUrl}`);const i=await fetch("/api/v1/connections/test/archer",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","x-tenant-id":this.tenantId||"A1B2C3D4-E5F6-7G8H-9I0J-K1L2M3N4O5P6"},body:JSON.stringify({baseUrl:t.baseUrl,username:t.username,password:t.password,instanceId:t.instanceId,userDomainId:t.userDomainId||"1"})}),l=Date.now()-n;if(i.ok){const o=await i.json();return o.success?(console.log("Archer authentication successful via backend"),{success:!0,message:"Connection successful - Archer authenticated",details:{responseTime:l,version:"Unknown",instanceInfo:{instanceId:t.instanceId,userDomain:t.userDomainId,testedVia:"Backend Proxy"}}}):{success:!1,message:o.message||"Authentication failed",error:o.error||"Connection test failed",details:{responseTime:l}}}else return{success:!1,message:"Connection test failed",error:(await i.json().catch(()=>({message:"Network error"}))).message||`HTTP ${i.status}: ${i.statusText}`,details:{responseTime:l}}}catch(r){return console.error("Archer connection test error:",r),{success:!1,message:"Connection test failed",error:r instanceof Error?r.message:"Network or server error",details:{responseTime:Date.now()-n}}}}getSecuritySettings(){const t=localStorage.getItem(this.getTenantSettingsKey());return t?JSON.parse(t):{encryptionEnabled:!0}}updateSecuritySettings(t){const r={...this.getSecuritySettings(),...t,lastUpdated:new Date().toISOString()};localStorage.setItem(this.getTenantSettingsKey(),JSON.stringify(r))}clearAllCredentials(){this.tenantId&&(localStorage.removeItem(this.getTenantStorageKey()),localStorage.removeItem(this.getTenantSettingsKey())),this.encryptionKey=null,this.tenantId=null}arrayBufferToBase64(t){const n=new Uint8Array(t);let r="";for(let a=0;a<n.byteLength;a++)r+=String.fromCharCode(n[a]);return window.btoa(r)}base64ToArrayBuffer(t){const n=window.atob(t),r=new ArrayBuffer(n.length),a=new Uint8Array(r);for(let i=0;i<n.length;i++)a[i]=n.charCodeAt(i);return r}}const fC=new mC;async function pC(){try{return await fC.loadCredentials()}catch(e){return console.error("Error loading credentials:",e),[]}}class gC{constructor(){_e(this,"connections",new Map);_e(this,"healthCheckInterval",null)}async initializeTenantConnections(t){try{console.log(`[MCP Manager] Initializing connections for tenant: ${t}`);const n=`tenant_mcp_servers_${t}`,r=localStorage.getItem(n);if(!r)return console.log(`[MCP Manager] No MCP servers configured for tenant: ${t}`),[];const i=JSON.parse(r).filter(o=>o.isEnabled);if(i.length===0)return console.log(`[MCP Manager] No enabled MCP servers for tenant: ${t}`),[];console.log(`[MCP Manager] Found ${i.length} enabled servers:`,i.map(o=>o.id));const l=[];for(const o of i)try{console.log(`[MCP Manager] Creating connection for server: ${o.id}`);const c=await this.createConnection(o.id,{endpoint:o.endpoint||"http://localhost:3001",name:o.name,description:o.description});c&&(l.push(c),this.connections.set(`${t}:${o.id}`,c),console.log(`[MCP Manager] Successfully created connection: ${t}:${o.id}`))}catch(c){console.error(`[MCP Manager] Failed to initialize server ${o.id}:`,c)}return this.startHealthChecking(),console.log(`[MCP Manager] Initialized ${l.length} connections for tenant: ${t}`),l}catch(n){return console.error(`[MCP Manager] Failed to initialize connections for tenant ${t}:`,n),[]}}async createConnection(t,n){var r,a,i;try{let l;if(n.connectionId&&(l=(await pC()).find(m=>m.id===n.connectionId),!l))return console.error(`[MCP Manager] Credentials not found for connection: ${n.connectionId}`),null;const o=this.resolveServerEndpoint(t,n),c={serverId:t,endpoint:o,credentials:l,privacyConfig:{enableMasking:((r=n.privacyConfig)==null?void 0:r.enableMasking)??!0,maskingLevel:((a=n.privacyConfig)==null?void 0:a.maskingLevel)??"moderate",enableTokenization:((i=n.privacyConfig)==null?void 0:i.enableTokenization)??!1},isHealthy:!1};return c.isHealthy=await this.checkConnectionHealth(c),c.lastHealthCheck=new Date().toISOString(),console.log(`[MCP Manager] Created connection for server ${t}: healthy=${c.isHealthy}`),c}catch(l){return console.error(`[MCP Manager] Error creating connection for server ${t}:`,l),null}}resolveServerEndpoint(t,n){return n.endpoint||"http://localhost:3005"}getTenantConnection(t,n){if(n)return this.connections.get(`${t}:${n}`)||null;for(const[r,a]of this.connections.entries())if(r.startsWith(`${t}:`)&&a.isHealthy)return a;return null}getTenantConnections(t){const n=[];for(const[r,a]of this.connections.entries())r.startsWith(`${t}:`)&&n.push(a);return n}async checkConnectionHealth(t){try{const n=new AbortController,r=setTimeout(()=>n.abort(),5e3),a=await fetch(`${t.endpoint}/tools`,{signal:n.signal,headers:{Accept:"application/json"}});return clearTimeout(r),a.ok}catch(n){return console.warn(`[MCP Manager] Health check failed for ${t.serverId}:`,n),!1}}startHealthChecking(){this.healthCheckInterval||(this.healthCheckInterval=setInterval(async()=>{for(const[,t]of this.connections.entries())t.isHealthy=await this.checkConnectionHealth(t),t.lastHealthCheck=new Date().toISOString()},3e4))}stopHealthChecking(){this.healthCheckInterval&&(clearInterval(this.healthCheckInterval),this.healthCheckInterval=null)}async updateConnection(t,n,r){try{const a=`${t}:${n}`,i=await this.createConnection(n,r);return i?(this.connections.set(a,i),console.log(`[MCP Manager] Updated connection for ${n}`),!0):!1}catch(a){return console.error(`[MCP Manager] Failed to update connection ${n}:`,a),!1}}removeConnection(t,n){const r=`${t}:${n}`;this.connections.delete(r),console.log(`[MCP Manager] Removed connection for ${n}`)}getConnectionHealthStatus(){const t=[];for(const[n,r]of this.connections.entries()){const[a,i]=n.split(":");t.push({tenantId:a,serverId:i,isHealthy:r.isHealthy,lastHealthCheck:r.lastHealthCheck,endpoint:r.endpoint})}return t}cleanup(){this.stopHealthChecking(),this.connections.clear(),console.log("[MCP Manager] Cleaned up all connections")}}const Ao=new gC;async function Dy(e,t,n={}){var r;try{const i=`mcp-${crypto.randomUUID()}`;console.log(`[MCP Setup] Setting up MCP server ${i} for tenant: ${e}`);const l={serverId:i,connectionId:t,privacyConfig:{enableMasking:n.enablePrivacyMasking??!0,maskingLevel:n.maskingLevel??"moderate",enableTokenization:!1,customSensitiveFields:["owner","manager","contact","person","employee","coordinator","lead","representative","name"]},performanceConfig:{pageSize:500,requestTimeout:3e4,maxRetries:3,enableCaching:n.enableCaching??!0,enableBackgroundSync:!0},lastUpdated:new Date().toISOString()};let o=await fs.getTenantConfiguration(e);if(o||(o={tenantId:e,servers:{},globalSettings:{defaultMaskingLevel:n.maskingLevel??"moderate",enableAuditLogging:!0}}),o.servers[i]=l,!await fs.updateTenantConfiguration(e,o))return{success:!1,error:"Failed to save MCP server configuration"};await Ao.initializeTenantConnections(e);const u=Ao.getTenantConnection(e,i),m={isHealthy:(u==null?void 0:u.isHealthy)??!1,responseTime:void 0,availableTools:void 0};if(u!=null&&u.isHealthy)try{const d=Date.now(),p=await fetch(`${u.endpoint}/tools`);if(m.responseTime=Date.now()-d,p.ok){const f=await p.json();m.availableTools=((r=f.tools)==null?void 0:r.length)||0}}catch(d){console.warn("[MCP Setup] Health check details failed:",d)}return console.log(`[MCP Setup] Successfully configured Archer GRC MCP server: ${i}`),{success:!0,serverId:i,healthCheck:m}}catch(a){return console.error("[MCP Setup] Failed to setup Archer MCP server:",a),{success:!1,error:a instanceof Error?a.message:"Unknown error"}}}async function Fy(e){var t;try{const n=await fs.getTenantConfiguration(e),r=Ao.getTenantConnections(e);if(!n)return{configuredServers:0,healthyServers:0,servers:[]};const a=[];let i=0;for(const[l,o]of Object.entries(n.servers)){const c=r.find(m=>m.serverId===l),u=(c==null?void 0:c.isHealthy)??!1;u&&i++,a.push({serverId:l,isHealthy:u,lastHealthCheck:c==null?void 0:c.lastHealthCheck,connectionId:o.connectionId,privacyEnabled:((t=o.privacyConfig)==null?void 0:t.enableMasking)??!1})}return{configuredServers:Object.keys(n.servers).length,healthyServers:i,servers:a}}catch(n){return console.error("[MCP Setup] Failed to get server status:",n),{configuredServers:0,healthyServers:0,servers:[]}}}async function xC(e,t){var n;try{const r=Ao.getTenantConnection(e,t);if(!r)return{success:!1,error:"No MCP connection found"};const a=Date.now(),i=await fetch(`${r.endpoint}/tools`,{headers:{Accept:"application/json"}});if(!i.ok)return{success:!1,error:`HTTP ${i.status}: ${i.statusText}`};const l=await i.json();return{success:!0,responseTime:Date.now()-a,availableTools:((n=l.tools)==null?void 0:n.length)||0}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Unknown error"}}}const yC=Object.freeze(Object.defineProperty({__proto__:null,getMCPServerStatus:Fy,setupArcherMCPServer:Dy,testMCPServerConnection:xC},Symbol.toStringTag,{value:"Module"})),bC=[{value:"grc",label:"GRC & Compliance"},{value:"integration",label:"Integration Platform"},{value:"automation",label:"Automation Tool"},{value:"analytics",label:"Analytics & Reporting"},{value:"custom",label:"Custom Solution"}];function fp({isOpen:e,onClose:t,onSave:n,editMode:r=!1,initialConfig:a}){const{tenant:i}=it(),[l,o]=S.useState({name:(a==null?void 0:a.name)||"",description:(a==null?void 0:a.description)||"",endpoint:(a==null?void 0:a.endpoint)||"",category:(a==null?void 0:a.category)||"custom",connectionId:(a==null?void 0:a.connectionId)||""}),[c,u]=S.useState([]),[m,d]=S.useState(!1),[p,f]=S.useState(!1),[g,v]=S.useState(!1),[T,y]=S.useState(null),[b,x]=S.useState(null);Wi.useEffect(()=>{e&&I()},[e]);const I=async()=>{if(i){d(!0);try{Ue.setTenantContext(i.id),await Ue.initialize();const A=await Cn();u(A)}catch(A){console.error("Error loading connections:",A),x({type:"error",text:"Failed to load available connections"})}finally{d(!1)}}},C=(A,z)=>{o(M=>({...M,[A]:z})),y(null)},E=c.find(A=>A.id===l.connectionId),N=()=>l.name.trim()?l.endpoint.trim()?!l.endpoint.startsWith("http://")&&!l.endpoint.startsWith("https://")?"Endpoint must be a valid HTTP/HTTPS URL":null:"Server endpoint URL is required":"Server name is required",O=async()=>{var z;const A=N();if(A){x({type:"error",text:A});return}f(!0),y(null),x({type:"info",text:`Testing connection to ${l.name}...`});try{const M=await fetch(`${l.endpoint}/health`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(1e4)}).catch(()=>null),R=await fetch(`${l.endpoint}/tools`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(1e4)}).catch(()=>null);if(M&&M.ok&&R&&R.ok){const Y=((z=(await R.json().catch(()=>({}))).tools)==null?void 0:z.length)||0;y({success:!0,message:`Connection successful - ${Y} tools available`}),x({type:"success",text:`MCP server is responding correctly with ${Y} available tools`})}else y({success:!1,message:"MCP server not responding"}),x({type:"error",text:`Could not connect to MCP server at ${l.endpoint}. Verify the server is running and the endpoint is correct.`})}catch(M){y({success:!1,message:M.message}),x({type:"error",text:`Test failed: ${M.message}`})}finally{f(!1)}},D=async()=>{const A=N();if(A){x({type:"error",text:A});return}v(!0),x(null);try{const z={id:r?a.id:`mcp-${crypto.randomUUID()}`,name:l.name.trim(),description:l.description.trim()||`Custom MCP server: ${l.name}`,endpoint:l.endpoint.trim(),connectionId:l.connectionId||void 0,connectionName:(E==null?void 0:E.name)||void 0,category:l.category,isEnabled:r?a.isEnabled:!0,createdAt:r?a.createdAt:new Date().toISOString()};await n(z),o({name:"",description:"",endpoint:"",category:"custom",connectionId:""}),y(null),x(null),t()}catch(z){x({type:"error",text:`Failed to add server: ${z.message}`})}finally{v(!1)}};return s.jsx(Yr,{open:e,onOpenChange:t,children:s.jsxs(Wr,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[s.jsx(Kr,{children:s.jsxs(Gr,{className:"flex items-center space-x-2",children:[s.jsx(pn,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{children:r?"Edit MCP Server":"Add MCP Server"})]})}),s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-50 rounded-lg border border-blue-100",children:[s.jsxs("div",{className:"flex items-center space-x-6",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-medium",children:"1"}),s.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Basic Info"})]}),s.jsx("div",{className:"w-8 h-px bg-blue-200"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-medium",children:"2"}),s.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Configuration"})]}),s.jsx("div",{className:"w-8 h-px bg-blue-200"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-medium",children:"3"}),s.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Testing"})]})]}),s.jsxs(J,{variant:"outline",className:"bg-white border-blue-200 text-blue-700",children:[s.jsx(Br,{className:"h-3 w-3 mr-1"}),"MCP Setup"]})]}),s.jsxs("div",{className:"border border-gray-200 rounded-xl bg-white shadow-sm",children:[s.jsx("div",{className:"border-b border-gray-100 px-6 py-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsx(Fi,{className:"h-4 w-4 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Basic Information"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Name, category, and description for your MCP server"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"serverName",className:"text-sm font-medium text-gray-700",children:"Server Name *"}),s.jsx(pe,{id:"serverName",type:"text",value:l.name,onChange:A=>C("name",A.target.value),placeholder:"e.g., Custom Archer GRC Server, Document Processor",disabled:g,className:"h-11"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Choose a descriptive name to identify this MCP server"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"category",className:"text-sm font-medium text-gray-700",children:"Category *"}),s.jsx("select",{id:"category",value:l.category,onChange:A=>C("category",A.target.value),className:"w-full h-11 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",disabled:g,children:bC.map(A=>s.jsx("option",{value:A.value,children:A.label},A.value))}),s.jsx("p",{className:"text-xs text-gray-500",children:"Select the type of service this MCP server provides"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"description",className:"text-sm font-medium text-gray-700",children:"Description (Optional)"}),s.jsx(lm,{id:"description",value:l.description,onChange:A=>C("description",A.target.value),placeholder:"Brief description of what this MCP server provides and when to use it...",rows:3,disabled:g,className:"resize-none"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Help team members understand the purpose and capabilities of this server"})]})]})]}),s.jsxs("div",{className:"border border-gray-200 rounded-xl bg-white shadow-sm",children:[s.jsx("div",{className:"border-b border-gray-100 px-6 py-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:s.jsx(dt,{className:"h-4 w-4 text-purple-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Server Configuration"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Endpoint URL and connection settings"})]})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"endpoint",className:"text-sm font-medium text-gray-700",children:"Server Endpoint URL *"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ns,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx(pe,{id:"endpoint",type:"url",value:l.endpoint,onChange:A=>C("endpoint",A.target.value),placeholder:"https://your-mcp-server.com:3000",className:"pl-10 h-11 font-mono text-sm",disabled:g})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"The HTTP/HTTPS endpoint where your MCP server is running"})]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:"Connection Assignment"}),s.jsxs(J,{variant:"outline",className:"text-xs bg-purple-50 border-purple-200 text-purple-700",children:[s.jsx(dn,{className:"h-3 w-3 mr-1"}),"Optional"]})]}),s.jsx("p",{className:"text-sm text-gray-500",children:"If this MCP server needs to access external systems (like Archer GRC), select a connection."}),m?s.jsxs("div",{className:"flex items-center justify-center py-4",children:[s.jsx(tt,{className:"h-4 w-4 animate-spin mr-2"}),s.jsx("span",{className:"text-sm",children:"Loading connections..."})]}):c.length===0?s.jsxs(Ie,{children:[s.jsx(dn,{className:"h-4 w-4"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold",children:"No connections available"}),s.jsx("p",{className:"text-sm",children:"You can create connections in the Connections page if your MCP server needs to access external systems."})]})]}):s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{className:"text-sm font-medium text-gray-700",children:"Select Connection (Optional)"}),s.jsxs("select",{value:l.connectionId,onChange:A=>C("connectionId",A.target.value),className:"w-full h-11 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",disabled:g,children:[s.jsx("option",{value:"",children:"No connection (standalone server)"}),c.map(A=>s.jsxs("option",{value:A.id,children:[A.name," (",A.baseUrl,")"]},A.id))]}),s.jsx("p",{className:"text-xs text-gray-500",children:"External connection credentials will be securely passed to the MCP server"})]})]})]})]}),s.jsxs("div",{className:"border border-gray-200 rounded-xl bg-white shadow-sm",children:[s.jsx("div",{className:"border-b border-gray-100 px-6 py-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:s.jsx(Bi,{className:"h-4 w-4 text-green-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Test Server Connection"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Verify connectivity and server availability before saving"})]})]})}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between p-4 bg-green-50 border border-green-200 rounded-lg",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-green-900 text-sm mb-1",children:"Connection Test"}),s.jsx("p",{className:"text-sm text-green-700",children:"Test your server configuration to ensure the MCP server is running and accessible"})]}),s.jsx(G,{onClick:O,disabled:p||g||!l.endpoint,variant:"outline",className:"ml-4 border-green-300 text-green-700 hover:bg-green-100 hover:border-green-400",children:p?s.jsxs(s.Fragment,{children:[s.jsx(tt,{className:"h-4 w-4 animate-spin mr-2"}),"Testing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Bi,{className:"h-4 w-4 mr-2"}),"Test Connection"]})})]}),T&&s.jsx("div",{className:"mt-4",children:s.jsxs(Ie,{className:T.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50",children:[T.success?s.jsx(Le,{className:"h-4 w-4 text-green-600"}):s.jsx(ue,{className:"h-4 w-4 text-red-600"}),s.jsxs("div",{children:[s.jsx("p",{className:`font-medium ${T.success?"text-green-800":"text-red-800"}`,children:T.success?"Connection Successful":"Connection Failed"}),s.jsx("p",{className:`text-sm ${T.success?"text-green-700":"text-red-700"}`,children:T.message})]})]})})]})]}),b&&s.jsxs(Ie,{className:`${b.type==="success"?"border-green-200 bg-green-50":b.type==="error"?"border-red-200 bg-red-50":"border-blue-200 bg-blue-50"}`,children:[b.type==="success"?s.jsx(Le,{className:"h-4 w-4 text-green-600"}):b.type==="error"?s.jsx(ue,{className:"h-4 w-4 text-red-600"}):s.jsx(dn,{className:"h-4 w-4 text-blue-600"}),s.jsx("span",{className:b.type==="success"?"text-green-800":b.type==="error"?"text-red-800":"text-blue-800",children:b.text})]})]}),s.jsxs(Qr,{children:[s.jsx(G,{variant:"outline",onClick:t,disabled:g,children:"Cancel"}),s.jsx(G,{onClick:D,disabled:g||!!N(),className:"flex items-center space-x-2",children:g?s.jsxs(s.Fragment,{children:[s.jsx(tt,{className:"h-4 w-4 animate-spin"}),s.jsx("span",{children:r?"Updating...":"Adding..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Br,{className:"h-4 w-4"}),s.jsx("span",{children:r?"Update Server":"Add Server"})]})})]})]})})}function vC({isOpen:e,onClose:t,server:n,onSave:r,currentConfig:a}){const{tenant:i}=it(),[l,o]=S.useState(""),[c,u]=S.useState([]),[m,d]=S.useState(!1),[p,f]=S.useState(!1),[g,v]=S.useState(null);S.useEffect(()=>{T()},[i]),S.useEffect(()=>{e&&(a!=null&&a.connectionId)?(o(a.connectionId),console.log("[MCP Config Modal] Initializing with saved connection:",a.connectionId,a.connectionName)):e&&!a&&(o(""),console.log("[MCP Config Modal] No saved configuration found, resetting selection"))},[e,a]);const T=async()=>{if(i){d(!0);try{Ue.setTenantContext(i.id),await Ue.initialize();const C=await Cn();u(C)}catch(C){console.error("Error loading connections:",C),v({type:"error",text:"Failed to load available connections"})}finally{d(!1)}}},y=c.find(C=>C.id===l),b=async()=>{var C;if(!y){v({type:"error",text:"Please select a connection to test"});return}f(!0),v({type:"info",text:`Testing connection to ${y.name}...`});try{i&&Ue.setTenantContext(i.id);const E=await Ue.testConnection(y);E.success?v({type:"success",text:`Successfully connected to ${y.name}. Response time: ${((C=E.details)==null?void 0:C.responseTime)||"N/A"}ms`}):v({type:"error",text:`Connection test failed: ${E.error||E.message}`})}catch(E){v({type:"error",text:`Connection test failed: ${E.message||"Unknown error"}`})}finally{f(!1)}},x=()=>{if(!y){v({type:"error",text:"Please select a connection"});return}const C={connectionId:y.id,connectionName:y.name,isEnabled:!0,lastConfigured:new Date().toISOString(),testStatus:(g==null?void 0:g.type)==="success"?"success":void 0};r(n.id,C),v({type:"success",text:"Configuration saved successfully!"}),setTimeout(()=>{t(),v(null)},1500)},I=C=>{switch(C.status){case"connected":return s.jsx(J,{className:"bg-green-100 text-green-800 border-green-200",children:"Connected"});case"testing":return s.jsx(J,{className:"bg-blue-100 text-blue-800 border-blue-200",children:"Testing"});case"error":return s.jsx(J,{variant:"destructive",children:"Error"});default:return s.jsx(J,{variant:"secondary",children:"Unknown"})}};return s.jsx(Yr,{open:e,onOpenChange:t,children:s.jsxs(Wr,{className:"max-w-2xl",children:[s.jsx(Kr,{children:s.jsxs(Gr,{className:"flex items-center space-x-2",children:[s.jsx(dt,{className:"h-5 w-5 text-blue-600"}),s.jsxs("span",{children:["Configure ",n.name]})]})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold text-sm mb-2",children:"MCP Server Information"}),s.jsxs("div",{className:"space-y-1 text-sm",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Name:"})," ",n.name]}),n.description&&s.jsxs("div",{children:[s.jsx("strong",{children:"Description:"})," ",n.description]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Status:"}),s.jsx(J,{className:`ml-2 ${n.status==="connected"?"bg-green-100 text-green-800":n.status==="error"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:n.status})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs(de,{className:"text-base font-semibold flex items-center space-x-2",children:[s.jsx(my,{className:"h-4 w-4"}),s.jsx("span",{children:"Select Connection"})]}),m?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(tt,{className:"h-6 w-6 animate-spin"}),s.jsx("span",{className:"ml-2",children:"Loading connections..."})]}):c.length===0?s.jsxs(Ie,{children:[s.jsx(ue,{className:"h-4 w-4"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold",children:"No connections available"}),s.jsx("p",{className:"text-sm",children:"Please create a connection in the Connections page before configuring MCP servers."})]})]}):s.jsx("div",{className:"space-y-3",children:c.map(C=>s.jsxs("div",{className:`border rounded-lg p-4 cursor-pointer transition-all hover:shadow-md ${l===C.id?"ring-2 ring-blue-500 border-blue-200 bg-blue-50/50":"hover:border-gray-300"}`,onClick:()=>o(C.id),children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${l===C.id?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:l===C.id&&s.jsx(Le,{className:"h-3 w-3 text-white"})}),s.jsx(at,{className:"h-4 w-4 text-gray-600"}),s.jsx("h4",{className:"font-semibold",children:C.name})]}),I(C)]}),s.jsxs("div",{className:"ml-7 space-y-1 text-sm text-gray-600",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"URL:"})," ",C.baseUrl]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Instance:"})," ",C.instanceId]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Username:"})," ",C.username]}),C.lastTested&&s.jsxs("div",{children:[s.jsx("strong",{children:"Last Tested:"})," ",new Date(C.lastTested).toLocaleString()]})]})]},C.id))})]}),y&&s.jsxs("div",{className:"flex justify-between items-center p-4 border rounded-lg bg-gray-50",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold text-sm",children:"Test Selected Connection"}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Verify that the MCP server can connect to ",y.name]})]}),s.jsx(G,{onClick:b,disabled:p,variant:"outline",className:"ml-4",children:p?s.jsxs(s.Fragment,{children:[s.jsx(tt,{className:"h-4 w-4 animate-spin mr-2"}),"Testing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Le,{className:"h-4 w-4 mr-2"}),"Test Connection"]})})]}),g&&s.jsxs(Ie,{className:`${g.type==="success"?"border-green-200 bg-green-50":g.type==="error"?"border-red-200 bg-red-50":"border-blue-200 bg-blue-50"}`,children:[g.type==="success"?s.jsx(Le,{className:"h-4 w-4 text-green-600"}):g.type==="error"?s.jsx(ue,{className:"h-4 w-4 text-red-600"}):s.jsx(dn,{className:"h-4 w-4 text-blue-600"}),s.jsx("span",{className:g.type==="success"?"text-green-800":g.type==="error"?"text-red-800":"text-blue-800",children:g.text})]}),a&&s.jsxs("div",{className:"text-sm text-gray-500 pt-2 border-t",children:[s.jsxs("div",{children:["Currently configured with: ",s.jsx("strong",{children:a.connectionName})]}),a.lastConfigured&&s.jsxs("div",{children:["Last configured: ",new Date(a.lastConfigured).toLocaleString()]})]})]}),s.jsxs(Qr,{children:[s.jsx(G,{variant:"outline",onClick:t,children:"Cancel"}),s.jsx(G,{onClick:x,disabled:!l||m,children:"Save Configuration"})]})]})})}const EC=e=>{switch(e){case"grc":return s.jsx(at,{className:"h-4 w-4"});case"integration":return s.jsx(Wh,{className:"h-4 w-4"});case"automation":return s.jsx(dt,{className:"h-4 w-4"});case"analytics":return s.jsx(Br,{className:"h-4 w-4"});default:return s.jsx(Ns,{className:"h-4 w-4"})}},NC=e=>{switch(e){case"grc":return"GRC & Compliance";case"integration":return"Integration Platform";case"automation":return"Automation Tool";case"analytics":return"Analytics & Reporting";default:return"Custom Solution"}};function TC({config:e,onConfigChange:t,canModify:n,isSaving:r}){const[a,i]=S.useState([]),[l,o]=S.useState(!1),[c,u]=S.useState(null),[m,d]=S.useState(null),[p,f]=S.useState({}),[g,v]=S.useState(!0);S.useEffect(()=>{T()},[e.tenantId]),S.useEffect(()=>{if(a.length>0){const R=setInterval(N,3e4);return()=>clearInterval(R)}},[a.length]);const T=async()=>{v(!0);try{Hr.setTenantContext(e.tenantId),await Hr.initialize();const R=await qT(),H=R.map(P=>{const q=P.configuration_values||{},B=q.connectionId||"",W=q.connectionName||"";return{id:P.server_id,name:P.custom_name||P.display_name,description:P.description,endpoint:q.endpoint||"http://localhost:3005",connectionId:B||void 0,connectionName:W||void 0,category:P.category,status:P.health_status==="healthy"?"connected":P.health_status==="unhealthy"?"error":"disconnected",isEnabled:P.is_enabled===1,createdAt:P.enabled_at,lastTested:P.last_health_check,errorMessage:void 0}});i(H);const Y={};R.forEach(P=>{const q=P.configuration_values||{},B=q.connectionId||"",W=q.connectionName||P.custom_name||P.display_name;Y[P.server_id]={connectionId:B,connectionName:W,isEnabled:P.is_enabled===1,lastConfigured:q.lastConfigured||P.enabled_at,lastTested:P.last_health_check,testStatus:q.testStatus||(P.health_status==="healthy"?"success":P.health_status==="unhealthy"?"error":"pending")}}),f(Y),console.log(` [MCP Connection] Loaded ${R.length} MCP configurations from database`)}catch(R){console.error(" [MCP Connection] Error loading MCP servers from database:",R),i([]),f({})}finally{v(!1)}},y=R=>{i(R),console.log(` [MCP Connection] Updated local MCP server state (${R.length} servers)`)},b=async R=>{var H,Y;v(!0);try{if(R.category==="GRC"&&R.connectionId){console.log("[MCP UI] Setting up Archer GRC MCP server with connection:",R.connectionId);const P=await Dy(e.tenantId,R.connectionId,{enablePrivacyMasking:!0,maskingLevel:"moderate",enableCaching:!0});if(P.success){const q={...R,id:P.serverId,status:(H=P.healthCheck)!=null&&H.isHealthy?"connected":"error",lastTested:new Date().toISOString(),errorMessage:(Y=P.healthCheck)!=null&&Y.isHealthy?void 0:"Health check failed"},B=[...a,q];y(B),console.log(`[MCP UI] Successfully set up MCP server: ${P.serverId}`)}else{console.error("[MCP UI] Failed to setup MCP server:",P.error);const q={...R,status:"error",lastTested:new Date().toISOString(),errorMessage:P.error},B=[...a,q];y(B)}}else{const P={...R,status:"disconnected",lastTested:new Date().toISOString()},q=[...a,P];y(q)}await N()}catch(P){console.error("[MCP UI] Error adding server:",P)}finally{v(!1)}},x=R=>{u(R)},I=async(R,H)=>{const Y=a.map(P=>P.id===R?{...P,...H,lastTested:new Date().toISOString()}:P);y(Y),await fs.syncSettingsToMcpServer(e.tenantId),u(null)},C=async R=>{if(!n)return;const H=a.filter(B=>B.id!==R);y(H);const Y={...p};delete Y[R],f(Y);const P=`mcp_server_configs_${e.tenantId}`;localStorage.setItem(P,JSON.stringify(Y));const q={...e,enabledMcpServers:e.enabledMcpServers.filter(B=>B!==R)};t(q),await fs.syncSettingsToMcpServer(e.tenantId)},E=async(R,H)=>{if(!n)return;const Y=a.map(B=>B.id===R?{...B,isEnabled:H}:B);y(Y);const P=H?[...e.enabledMcpServers.filter(B=>B!==R),R]:e.enabledMcpServers.filter(B=>B!==R),q={...e,enabledMcpServers:P};t(q)},N=async()=>{try{const R=await Fy(e.tenantId),H=a.map(Y=>{const P=R.servers.find(q=>q.serverId===Y.id);return P?{...Y,status:P.isHealthy?"connected":"error",lastTested:P.lastHealthCheck||Y.lastTested}:Y});i(H)}catch(R){console.warn("[MCP UI] Failed to refresh server status:",R)}},O=async R=>{const H=a.findIndex(P=>P.id===R);if(H===-1)return;const Y=[...a];Y[H]={...Y[H],status:"testing"},i(Y);try{const{testMCPServerConnection:P}=await _d(async()=>{const{testMCPServerConnection:B}=await Promise.resolve().then(()=>yC);return{testMCPServerConnection:B}},void 0),q=await P(e.tenantId,R);Y[H]={...Y[H],status:q.success?"connected":"error",lastTested:new Date().toISOString(),errorMessage:q.success?`Response time: ${q.responseTime}ms, Tools: ${q.availableTools}`:q.error}}catch(P){Y[H]={...Y[H],status:"error",lastTested:new Date().toISOString(),errorMessage:P instanceof Error?P.message:"Connection failed"}}y(Y)},D=async()=>{try{v(!0);const{credentialsManager:R}=await _d(async()=>{const{credentialsManager:B}=await Promise.resolve().then(()=>sC);return{credentialsManager:B}},void 0);R.setTenantContext(e.tenantId),await R.initialize();const Y=(await Cn()).filter(B=>{var W,k;return((W=B.name)==null?void 0:W.toLowerCase().includes("archer"))||((k=B.baseUrl)==null?void 0:k.toLowerCase().includes("archer"))});if(Y.length===0){alert("No Archer GRC connections found. Please add an Archer connection in the Connections tab first.");return}const P=Y[0],q={id:`mcp-${crypto.randomUUID()}`,name:`Archer GRC - ${P.name}`,description:"RSA Archer GRC Platform integration with privacy protection and caching",endpoint:"http://localhost:3005",connectionId:P.id,connectionName:P.name,category:"GRC",isEnabled:!0,createdAt:new Date().toISOString()};await b(q),console.log("[MCP UI] Quick setup completed for Archer GRC")}catch(R){console.error("[MCP UI] Quick setup failed:",R),alert("Quick setup failed. Please try adding the server manually.")}finally{v(!1)}},A=async(R,H)=>{if(!n)return;console.log("[MCP Connection] Saving configuration for server:",R),console.log("[MCP Connection] Server config:",H);try{if(!a.find(W=>W.id===R)){console.error("[MCP Connection] Server not found:",R);return}const q={connectionId:H.connectionId,connectionName:H.connectionName,lastConfigured:H.lastConfigured,testStatus:H.testStatus};await VT(R,{configuration_values:q,is_enabled:H.isEnabled});const B={...p,[R]:H};f(B),console.log("[MCP Connection] Successfully saved configuration to database:",q)}catch(P){console.error("[MCP Connection] Error saving configuration to database:",P)}const Y=a.map(P=>P.id===R?{...P,connectionId:H.connectionId,connectionName:H.connectionName,status:"connected"}:P);y(Y),await fs.syncSettingsToMcpServer(e.tenantId)},z=R=>{switch(R){case"connected":return s.jsx(np,{className:"h-4 w-4 text-green-600"});case"disconnected":return s.jsx(tp,{className:"h-4 w-4 text-gray-400"});case"error":return s.jsx(ue,{className:"h-4 w-4 text-red-600"});case"testing":return s.jsx(tt,{className:"h-4 w-4 animate-spin text-blue-600"});default:return s.jsx(tp,{className:"h-4 w-4 text-gray-400"})}},M=R=>{switch(R.status){case"connected":return s.jsx(J,{className:"bg-green-100 text-green-800 border-green-200",children:"Connected"});case"disconnected":return s.jsx(J,{variant:"secondary",children:"Disconnected"});case"error":return s.jsx(J,{variant:"destructive",children:"Error"});case"testing":return s.jsx(J,{className:"bg-blue-100 text-blue-800 border-blue-200",children:"Testing"});default:return s.jsx(J,{variant:"secondary",children:"Unknown"})}};return g?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(tt,{className:"h-6 w-6 animate-spin mr-2"}),s.jsx("span",{children:"Loading MCP servers..."})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold",children:"MCP Server Management"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Add and configure Model Context Protocol servers for AI agent integration"})]}),n&&s.jsxs(G,{onClick:()=>o(!0),className:"flex items-center space-x-2",children:[s.jsx(pn,{className:"h-4 w-4"}),s.jsx("span",{children:"Add MCP Server"})]})]}),a.length===0&&n&&s.jsx(Q,{className:"border border-blue-200 bg-blue-50/30",children:s.jsx(ne,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(at,{className:"h-5 w-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-blue-900",children:"Quick Setup: Archer GRC"}),s.jsx("p",{className:"text-sm text-blue-700",children:"Connect to your existing Archer GRC instance"})]})]}),s.jsx(G,{onClick:D,variant:"outline",className:"border-blue-300 text-blue-700 hover:bg-blue-100",disabled:g,children:g?s.jsxs(s.Fragment,{children:[s.jsx(tt,{className:"h-4 w-4 animate-spin mr-2"}),"Setting up..."]}):s.jsxs(s.Fragment,{children:[s.jsx(dt,{className:"h-4 w-4 mr-2"}),"Quick Setup"]})})]})})}),a.length===0?s.jsx(Q,{className:"border-2 border-dashed border-gray-300",children:s.jsxs(ne,{className:"flex flex-col items-center justify-center py-12",children:[s.jsx(Br,{className:"h-12 w-12 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No MCP Servers Configured"}),s.jsx("p",{className:"text-gray-600 text-center max-w-md",children:'Add your first MCP server using the "Add MCP Server" button above to enable AI agent integration with external systems and tools.'})]})}):s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:a.map(R=>{const H=p[R.id];return s.jsxs(Q,{className:`transition-all hover:shadow-md ${R.isEnabled?"ring-2 ring-blue-200 bg-blue-50/30":""}`,children:[s.jsx(he,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[s.jsx(be,{className:"text-base",children:R.name}),z(R.status)]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsxs(J,{variant:"outline",className:"text-xs flex items-center space-x-1",children:[EC(R.category),s.jsx("span",{children:NC(R.category)})]}),H&&s.jsx(J,{variant:"default",className:"text-xs bg-blue-100 text-blue-800 border-blue-200",children:"Configured"})]})]}),M(R)]})}),s.jsxs(ne,{className:"space-y-4",children:[s.jsx("div",{className:"text-sm text-gray-600",children:R.description}),s.jsxs("div",{className:"space-y-2 text-xs",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ns,{className:"h-3 w-3 text-gray-400"}),s.jsx("span",{className:"text-gray-600",children:"Endpoint:"}),s.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-xs font-mono",children:R.endpoint})]}),R.connectionName&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(at,{className:"h-3 w-3 text-gray-400"}),s.jsx("span",{className:"text-gray-600",children:"Connection:"}),s.jsx("span",{className:"font-medium",children:R.connectionName})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ji,{className:"h-3 w-3 text-gray-400"}),s.jsx("span",{className:"text-gray-600",children:"Added:"}),s.jsx("span",{children:new Date(R.createdAt).toLocaleDateString()})]})]}),R.errorMessage&&s.jsxs(Ie,{className:"border-red-200 bg-red-50",children:[s.jsx(ue,{className:"h-4 w-4 text-red-600"}),s.jsx("span",{className:"text-red-800 text-xs",children:R.errorMessage})]}),s.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[s.jsx("div",{className:"flex items-center space-x-2",children:s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:R.isEnabled,onChange:Y=>E(R.id,Y.target.checked),disabled:!n||r,className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("span",{className:"text-sm font-medium",children:R.isEnabled?"Enabled":"Disabled"})]})}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{size:"sm",variant:"outline",onClick:()=>O(R.id),disabled:R.status==="testing",className:"flex items-center space-x-1",children:R.status==="testing"?s.jsxs(s.Fragment,{children:[s.jsx(tt,{className:"h-3 w-3 animate-spin"}),s.jsx("span",{children:"Testing"})]}):s.jsxs(s.Fragment,{children:[s.jsx(np,{className:"h-3 w-3"}),s.jsx("span",{children:"Test"})]})}),n&&s.jsxs(s.Fragment,{children:[s.jsxs(G,{size:"sm",variant:"outline",onClick:()=>x(R.id),className:"flex items-center space-x-1",children:[s.jsx(dt,{className:"h-3 w-3"}),s.jsx("span",{children:"Edit"})]}),s.jsxs(G,{size:"sm",variant:"outline",onClick:()=>C(R.id),className:"flex items-center space-x-1 text-red-600 hover:text-red-700",children:[s.jsx(Ea,{className:"h-3 w-3"}),s.jsx("span",{children:"Delete"})]})]})]})]})]})]},R.id)})}),a.length>0&&s.jsx(Q,{className:"bg-gray-50",children:s.jsx(ne,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Br,{className:"h-4 w-4 text-blue-600"}),s.jsxs("span",{className:"font-semibold text-gray-900",children:[a.length," server",a.length!==1?"s":""," configured"]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Le,{className:"h-4 w-4 text-green-600"}),s.jsxs("span",{className:"text-gray-600",children:[a.filter(R=>R.isEnabled).length," enabled"]})]})]}),s.jsxs(J,{variant:"outline",className:"bg-white",children:[a.filter(R=>R.status==="connected").length," connected"]})]})})}),s.jsx(fp,{isOpen:l,onClose:()=>o(!1),onSave:b}),c&&(()=>{const R=a.find(H=>H.id===c);return R?s.jsx(fp,{isOpen:!!c,onClose:()=>u(null),onSave:H=>I(c,H),editMode:!0,initialConfig:{id:R.id,name:R.name,description:R.description,endpoint:R.endpoint,connectionId:R.connectionId,connectionName:R.connectionName,category:R.category,isEnabled:R.isEnabled,createdAt:R.createdAt}}):null})(),m&&(()=>{const R=a.find(Y=>Y.id===m),H=p[m];return console.log("[MCP Connection] Opening config modal for server:",m),console.log("[MCP Connection] Server found:",!!R),console.log("[MCP Connection] Current config:",H),console.log("[MCP Connection] All configurations:",p),console.log("[MCP Connection] Expected config key exists?",m in p),R?s.jsx(vC,{isOpen:!!m,onClose:()=>{console.log("[MCP Connection] Modal onClose called - closing modal"),d(null)},server:{id:R.id,name:R.name,description:R.description,status:R.status},onSave:A,currentConfig:H}):null})()]})}function wC({tenantId:e,userId:t,scope:n,canModify:r}){const{token:a,tenant:i}=it(),[l,o]=S.useState({enable_privacy_masking:!0,masking_level:"strict",custom_sensitive_fields:[]}),[c,u]=S.useState(!0),[m,d]=S.useState(!1),[p,f]=S.useState(null),[g,v]=S.useState(""),T=()=>{const E={"Content-Type":"application/json"};return a!=null&&a.access_token&&(E.Authorization=`Bearer ${a.access_token}`),i!=null&&i.id&&(E["X-Tenant-ID"]=i.id),E};S.useEffect(()=>{console.log(" Privacy Config - Auth Context:",{token:!!a,tenant:i==null?void 0:i.id,tenantName:i==null?void 0:i.name}),i!=null&&i.id||e?(console.log(" Loading privacy settings..."),y()):(console.warn(" No tenant context available for privacy settings"),o({enable_privacy_masking:!0,masking_level:"strict",custom_sensitive_fields:["employee_id","ssn","account_number","phone","email"]}),u(!1))},[i==null?void 0:i.id,e,t,n]);const y=async()=>{var E;try{u(!0);const N=a!=null&&a.access_token&&(i!=null&&i.id)?T():{"Content-Type":"application/json",Authorization:"Bearer test-token","X-Tenant-ID":"A1B2C3D4-E5F6-7G8H-9I0J-K1L2M3N4O5P6"};console.log(" Making privacy API request with headers:",{hasAuth:!!N.Authorization,hasTenant:!!N["X-Tenant-ID"]});const O=await fetch(Sn(`privacy/settings?scope=${n}`),{method:"GET",headers:N});if(O.ok){const D=await O.json();D.success&&D.data&&(o({enable_privacy_masking:D.data.enable_privacy_masking,masking_level:D.data.masking_level,custom_sensitive_fields:D.data.custom_sensitive_fields||[]}),v(((E=D.data.custom_sensitive_fields)==null?void 0:E.join(", "))||""))}}catch(N){console.error("Failed to load privacy settings:",N),f({type:"error",text:"Failed to load privacy settings"})}finally{u(!1)}},b=async()=>{try{d(!0),f(null);const E=g.split(",").map(A=>A.trim()).filter(A=>A.length>0),N={...l,custom_sensitive_fields:E,scope:n},O=a!=null&&a.access_token&&(i!=null&&i.id)?T():{"Content-Type":"application/json",Authorization:"Bearer test-token","X-Tenant-ID":"A1B2C3D4-E5F6-7G8H-9I0J-K1L2M3N4O5P6"},D=await fetch(Sn("privacy/settings"),{method:"PUT",headers:O,body:JSON.stringify(N)});if(D.ok)(await D.json()).success&&(o({...l,custom_sensitive_fields:E}),f({type:"success",text:"Privacy settings saved successfully"}),setTimeout(()=>f(null),3e3));else throw new Error("Failed to save settings")}catch(E){console.error("Failed to save privacy settings:",E),f({type:"error",text:"Failed to save privacy settings"})}finally{d(!1)}},x=async()=>{try{d(!0);const E=a!=null&&a.access_token&&(i!=null&&i.id)?T():{"Content-Type":"application/json",Authorization:"Bearer test-token","X-Tenant-ID":"A1B2C3D4-E5F6-7G8H-9I0J-K1L2M3N4O5P6"};(await fetch(Sn(`privacy/settings?scope=${n}`),{method:"DELETE",headers:E})).ok&&(await y(),f({type:"success",text:"Settings reset to secure defaults"}),setTimeout(()=>f(null),3e3))}catch(E){console.error("Failed to reset settings:",E),f({type:"error",text:"Failed to reset settings"})}finally{d(!1)}},I=E=>{switch(E){case"light":return{summary:"Minimal masking - preserves readability while protecting obvious PII",masked:["Email addresses","Phone numbers","Social Security Numbers"],notMasked:["Names","Addresses","Record IDs","Job titles","Department names","Most business context"],useCase:"Best for internal analysis where context is critical"};case"moderate":return{summary:"Balanced protection - masks most sensitive data while maintaining context",masked:["Email addresses","Phone numbers","SSN/Tax IDs","Names (partial)","Account numbers","Large numeric IDs"],notMasked:["Record types","Department names","Job titles","Addresses (partial)","Business process context"],useCase:"Recommended for most AI analysis tasks"};case"strict":return{summary:"Maximum security - replaces all sensitive data with tokens (RECOMMENDED)",masked:["All email addresses","All phone numbers","All names","All addresses","SSN/Tax IDs","Account numbers","Record IDs (6+ digits)","All custom sensitive fields"],notMasked:["Record types","Status fields","Category classifications","Date/time stamps","Business process flows"],useCase:"Required for compliance and external LLM analysis"};default:return{summary:"",masked:[],notMasked:[],useCase:""}}},C=E=>{switch(E){case"light":return"bg-yellow-100 text-yellow-800";case"moderate":return"bg-blue-100 text-blue-800";case"strict":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return c?s.jsx(Q,{children:s.jsx(ne,{className:"pt-6",children:s.jsxs("div",{className:"animate-pulse space-y-4",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})})}):s.jsxs("div",{className:"space-y-6",children:[s.jsx(Q,{className:`border-l-4 ${l.enable_privacy_masking?"border-l-green-500":"border-l-red-500"}`,children:s.jsx(ne,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center",children:[l.enable_privacy_masking?s.jsx(ge,{className:"h-5 w-5 text-green-600 mr-2"}):s.jsx(ue,{className:"h-5 w-5 text-red-600 mr-2"}),"LLM Data Protection Status"]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:l.enable_privacy_masking?` PROTECTED - ${l.masking_level} level masking applied before data reaches external LLMs`:" UNPROTECTED - Confidential data may be sent to external LLMs"})]}),s.jsx(J,{className:C(l.masking_level),children:l.masking_level.toUpperCase()})]})})}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(ge,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{children:"How Privacy Protection Works"})]})}),s.jsxs(ne,{className:"space-y-4",children:[s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:" Critical Protection Point"}),s.jsx("p",{className:"text-sm text-blue-800",children:"Privacy protection is applied exactly when MCP tool results are sent to external LLMs (OpenAI, Anthropic, etc.). Confidential Archer data is masked before leaving your infrastructure."})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:" Always Protected (All Levels)"}),s.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[s.jsx("li",{children:" Credit card numbers"}),s.jsx("li",{children:" Social Security Numbers"}),s.jsx("li",{children:" Passport numbers"}),s.jsx("li",{children:" License numbers"}),s.jsx("li",{children:" Custom sensitive field patterns"})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:" Never Masked"}),s.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[s.jsx("li",{children:" Record status (Open, Closed, etc.)"}),s.jsx("li",{children:" Risk categories (High, Medium, Low)"}),s.jsx("li",{children:" Incident types"}),s.jsx("li",{children:" Timestamps and dates"}),s.jsx("li",{children:" Business process context"})]})]})]})]})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(ge,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{children:"Privacy Protection Settings"})]})}),s.jsxs(ne,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold text-sm",children:"Enable LLM Data Protection"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:" CRITICAL: Prevents confidential data from being sent to external LLM providers"})]}),s.jsx(G,{variant:l.enable_privacy_masking?"default":"outline",size:"sm",onClick:()=>o({...l,enable_privacy_masking:!l.enable_privacy_masking}),disabled:!r,className:"ml-4",children:l.enable_privacy_masking?s.jsxs(s.Fragment,{children:[s.jsx(Co,{className:"h-4 w-4 mr-2"}),"PROTECTED"]}):s.jsxs(s.Fragment,{children:[s.jsx(gy,{className:"h-4 w-4 mr-2"}),"VULNERABLE"]})})]}),l.enable_privacy_masking&&s.jsxs("div",{className:"space-y-4",children:[s.jsx(de,{className:"text-base font-semibold",children:"Protection Level"}),s.jsx("div",{className:"grid gap-4",children:["light","moderate","strict"].map(E=>s.jsxs("div",{className:`border rounded-lg p-4 cursor-pointer transition-all ${l.masking_level===E?"ring-2 ring-blue-500 border-blue-200 bg-blue-50/50":"hover:border-gray-300"}`,onClick:()=>r&&o({...l,masking_level:E}),children:[s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${l.masking_level===E?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:l.masking_level===E&&s.jsx(Le,{className:"h-3 w-3 text-white"})}),s.jsx("h4",{className:"font-semibold capitalize",children:E}),E==="strict"&&s.jsx(J,{variant:"outline",className:"text-xs bg-green-50 text-green-700",children:"RECOMMENDED"})]})}),s.jsxs("div",{className:"ml-7 space-y-3",children:[s.jsx("p",{className:"text-sm text-gray-600",children:I(E).summary}),s.jsxs("div",{className:"text-xs space-y-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-red-700",children:" Will be masked:"}),s.jsx("ul",{className:"list-disc list-inside ml-3 text-gray-600",children:I(E).masked.map((N,O)=>s.jsx("li",{children:N},O))})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-green-700",children:" Will remain visible:"}),s.jsx("ul",{className:"list-disc list-inside ml-3 text-gray-600",children:I(E).notMasked.map((N,O)=>s.jsx("li",{children:N},O))})]}),s.jsxs("div",{className:"pt-1",children:[s.jsx("span",{className:"font-medium text-blue-700",children:" Best for:"}),s.jsx("span",{className:"text-gray-600 ml-1",children:I(E).useCase})]})]})]})]},E))})]}),l.enable_privacy_masking&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{className:"text-base font-semibold",children:"Example: Before and After Masking"}),s.jsxs("div",{className:"bg-gray-50 border rounded-lg p-4 space-y-3",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:" Original Archer Data:"}),s.jsxs("div",{className:"bg-white border rounded p-2 text-xs font-mono",children:["Employee: John Smith, john.smith@company.com",s.jsx("br",{}),"Phone: (555) 123-4567, ID: 343910",s.jsx("br",{}),"Incident: Database access denied for user john.smith@company.com"]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"text-xs font-medium text-blue-700 mb-1",children:[" After ",l.masking_level.toUpperCase()," masking:"]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-2 text-xs font-mono",children:[l.masking_level==="light"&&s.jsxs(s.Fragment,{children:["Employee: John Smith, [MASKED_EMAIL]",s.jsx("br",{}),"Phone: [MASKED_PHONE], ID: 343910",s.jsx("br",{}),"Incident: Database access denied for user [MASKED_EMAIL]"]}),l.masking_level==="moderate"&&s.jsxs(s.Fragment,{children:["Employee: [MASKED_NAME], [MASKED_EMAIL]",s.jsx("br",{}),"Phone: [MASKED_PHONE], ID: [MASKED_ID]",s.jsx("br",{}),"Incident: Database access denied for user [MASKED_EMAIL]"]}),l.masking_level==="strict"&&s.jsxs(s.Fragment,{children:["Employee: [MASKED_NAME], [MASKED_EMAIL]",s.jsx("br",{}),"Phone: [MASKED_PHONE], ID: [MASKED_ID]",s.jsx("br",{}),"Incident: Database access denied for user [MASKED_EMAIL]"]})]})]})]})]}),l.enable_privacy_masking&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(de,{htmlFor:"customFields",children:"Additional Sensitive Field Patterns"}),s.jsx(lm,{id:"customFields",value:g,onChange:E=>v(E.target.value),placeholder:"contract_number, vendor_id, internal_code, proprietary_data",disabled:!r,className:"font-mono text-sm",rows:3}),s.jsxs("div",{className:"text-xs text-gray-500 space-y-2",children:[s.jsx("p",{children:"Enter field patterns that should be masked (comma-separated). Default patterns include: email, phone, ssn, account_number, employee_id"}),s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-3",children:[s.jsx("div",{className:"font-medium text-yellow-800 mb-1",children:" Custom Field Examples:"}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{children:[s.jsx("code",{className:"bg-white px-1 rounded",children:"contract_number"}),' - Will mask "contract_number: ABC123"']}),s.jsxs("div",{children:[s.jsx("code",{className:"bg-white px-1 rounded",children:"vendor_id"}),' - Will mask "vendor_id: VENDOR-001"']}),s.jsxs("div",{children:[s.jsx("code",{className:"bg-white px-1 rounded",children:"internal_code"}),' - Will mask "internal_code: PROJ-XYZ"']})]})]})]})]}),s.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[s.jsxs(G,{variant:"outline",size:"sm",onClick:x,disabled:!r||m,children:[s.jsx(vT,{className:"h-4 w-4 mr-2"}),"Reset to Secure Defaults"]}),s.jsxs(G,{onClick:b,disabled:!r||m,children:[s.jsx(py,{className:"h-4 w-4 mr-2"}),m?"Saving...":"Save Settings"]})]})]})]}),p&&s.jsx(Ie,{variant:p.type==="error"?"destructive":"default",children:s.jsxs("div",{className:"flex items-center",children:[p.type==="success"?s.jsx(Le,{className:"h-4 w-4 text-green-600 mr-2"}):s.jsx(ue,{className:"h-4 w-4 text-red-600 mr-2"}),p.text]})}),s.jsxs(Ie,{children:[s.jsx(ue,{className:"h-4 w-4"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-1",children:" CRITICAL PRIVACY NOTICE"}),s.jsxs("div",{className:"text-sm space-y-1",children:[s.jsx("p",{children:" These settings directly control what data is sent to external LLM providers"}),s.jsx("p",{children:" When disabled, confidential Archer data will be sent unmasked to OpenAI/Anthropic/etc."}),s.jsx("p",{children:" Settings take effect immediately for all new AI requests"}),s.jsx("p",{children:' For maximum security, keep "Enable LLM Data Protection" ON with "STRICT" level'})]})]})]})]})}const SC=e=>{var r;const t=e.enabledMcpServers.length,n=e.enableCaching;return[{name:"Enabled MCP Servers",value:t.toString(),trend:"stable",description:"Number of currently enabled MCP servers"},{name:"Privacy Protection",value:e.enablePrivacyMasking?e.maskingLevel.toUpperCase():"OFF",trend:"stable",description:"Current privacy masking configuration"},{name:"Response Caching",value:n?"ENABLED":"DISABLED",trend:"stable",description:"Response caching status for performance"},{name:"Page Size",value:((r=e.pageSize)==null?void 0:r.toString())||"50",trend:"stable",description:"Records per request for API calls"}]};function CC({config:e,onConfigChange:t,canModify:n,isSaving:r}){const a=(c,u)=>{const m={...e,[c]:u};t(m)},i=c=>{const u=e[c];a(c,!u)},l=c=>{switch(c){case"up":return s.jsx(Mr,{className:"h-4 w-4 text-green-600"});case"down":return s.jsx(Mr,{className:"h-4 w-4 text-red-600 rotate-180"});default:return s.jsx(vt,{className:"h-4 w-4 text-blue-600"})}},o=SC(e);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(Mr,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{children:"Configuration Overview"})]})}),s.jsx(ne,{children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:o.map(c=>s.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[l(c.trend),s.jsx("div",{className:"text-2xl font-bold text-gray-900",children:c.value})]}),s.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-1",children:c.name}),s.jsx("div",{className:"text-xs text-gray-500",children:c.description})]},c.name))})})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(ar,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{children:"Performance Settings"})]})}),s.jsxs(ne,{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(de,{htmlFor:"pageSize",className:"flex items-center space-x-2",children:[s.jsx(at,{className:"h-4 w-4"}),s.jsx("span",{children:"Page Size"})]}),s.jsx(pe,{id:"pageSize",type:"number",value:e.pageSize,onChange:c=>a("pageSize",parseInt(c.target.value)||50),min:10,max:500,disabled:!n}),s.jsx("p",{className:"text-xs text-gray-500",children:"Records per request (10-500)"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(de,{htmlFor:"timeout",className:"flex items-center space-x-2",children:[s.jsx(Tt,{className:"h-4 w-4"}),s.jsx("span",{children:"Request Timeout"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(pe,{id:"timeout",type:"number",value:e.requestTimeout,onChange:c=>a("requestTimeout",parseInt(c.target.value)||30),min:5,max:300,disabled:!n}),s.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-gray-500",children:"sec"})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Request timeout (5-300s)"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(de,{htmlFor:"maxRetries",className:"flex items-center space-x-2",children:[s.jsx($t,{className:"h-4 w-4"}),s.jsx("span",{children:"Max Retries"})]}),s.jsx(pe,{id:"maxRetries",type:"number",value:e.maxRetries,onChange:c=>a("maxRetries",parseInt(c.target.value)||3),min:0,max:10,disabled:!n}),s.jsx("p",{className:"text-xs text-gray-500",children:"Maximum retry attempts (0-10)"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"font-semibold text-sm",children:"Performance Optimizations"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("h5",{className:"font-semibold text-sm flex items-center space-x-2",children:[s.jsx(at,{className:"h-4 w-4 text-blue-600"}),s.jsx("span",{children:"Response Caching"})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Cache responses to improve performance and reduce API calls"})]}),s.jsx(G,{variant:e.enableCaching?"default":"outline",size:"sm",onClick:()=>i("enableCaching"),disabled:!n,className:"ml-4",children:e.enableCaching?s.jsxs(s.Fragment,{children:[s.jsx(Le,{className:"h-4 w-4 mr-2"}),"Enabled"]}):s.jsxs(s.Fragment,{children:[s.jsx(at,{className:"h-4 w-4 mr-2"}),"Disabled"]})})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("h5",{className:"font-semibold text-sm flex items-center space-x-2",children:[s.jsx($t,{className:"h-4 w-4 text-blue-600"}),s.jsx("span",{children:"Background Sync"})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Synchronize data in the background to keep cache fresh"})]}),s.jsx(G,{variant:e.enableBackgroundSync?"default":"outline",size:"sm",onClick:()=>i("enableBackgroundSync"),disabled:!n,className:"ml-4",children:e.enableBackgroundSync?s.jsxs(s.Fragment,{children:[s.jsx(Le,{className:"h-4 w-4 mr-2"}),"Enabled"]}):s.jsxs(s.Fragment,{children:[s.jsx($t,{className:"h-4 w-4 mr-2"}),"Disabled"]})})]})]})]})]})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(Br,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{children:"System Information"})]})}),s.jsx(ne,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"font-semibold text-sm",children:"Configuration Status"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-600",children:"Tenant ID:"}),s.jsx(J,{variant:"outline",className:"font-mono text-xs",children:e.tenantId})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-600",children:"Configuration Status:"}),s.jsx(J,{variant:e.isActive?"default":"secondary",children:e.isActive?"Active":"Inactive"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-600",children:"Last Updated:"}),s.jsx("span",{className:"text-xs text-gray-500",children:new Date(e.lastUpdated).toLocaleString()})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"font-semibold text-sm",children:"MCP Server Status"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-600",children:"Enabled Servers:"}),s.jsx(J,{variant:"outline",children:e.enabledMcpServers.length})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-600",children:"Privacy Protection:"}),s.jsx(J,{variant:e.enablePrivacyMasking?"default":"secondary",children:e.enablePrivacyMasking?e.maskingLevel:"Disabled"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-600",children:"Tokenization:"}),s.jsx(J,{variant:e.enableTokenization?"default":"secondary",children:e.enableTokenization?"Enabled":"Disabled"})]})]})]})]})})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(dt,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{children:"Configuration Recommendations"})]})}),s.jsx(ne,{children:s.jsxs("div",{className:"space-y-4",children:[e.pageSize>200&&s.jsxs(Ie,{children:[s.jsx(dn,{className:"h-4 w-4"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-sm",children:"Performance Tip"}),s.jsx("p",{className:"text-sm",children:"Consider reducing page size below 200 for faster response times, especially with privacy masking enabled."})]})]}),!e.enablePrivacyMasking&&s.jsxs(Ie,{children:[s.jsx(ue,{className:"h-4 w-4"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-sm",children:"Security Recommendation"}),s.jsx("p",{className:"text-sm",children:"Enable privacy masking to protect sensitive data when working with AI models and external integrations."})]})]}),!e.enableCaching&&e.enabledMcpServers.length>2&&s.jsxs(Ie,{children:[s.jsx(dn,{className:"h-4 w-4"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-sm",children:"Performance Recommendation"}),s.jsx("p",{className:"text-sm",children:"Enable response caching to improve performance when using multiple MCP servers."})]})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-sm text-green-800 mb-2",children:"Recommended Settings"}),s.jsxs("div",{className:"text-sm text-green-700 space-y-1",children:[s.jsxs("p",{children:[" ",s.jsx("strong",{children:"Page Size:"})," 50-100 records for optimal balance"]}),s.jsxs("p",{children:[" ",s.jsx("strong",{children:"Timeout:"})," 30-60 seconds for reliable connections"]}),s.jsxs("p",{children:[" ",s.jsx("strong",{children:"Max Retries:"})," 3 attempts for resilient operation"]}),s.jsxs("p",{children:[" ",s.jsx("strong",{children:"Caching:"})," Enable for better performance"]}),s.jsxs("p",{children:[" ",s.jsx("strong",{children:"Privacy:"})," Use moderate masking level"]})]})]})]})})]}),s.jsxs(Ie,{children:[s.jsx(ue,{className:"h-4 w-4"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-1",children:"Advanced Configuration Notice"}),s.jsxs("div",{className:"text-sm space-y-1",children:[s.jsx("p",{children:" These settings directly affect system performance and behavior"}),s.jsx("p",{children:" Incorrect values may cause timeouts, errors, or degraded performance"}),s.jsx("p",{children:" Test changes in a non-production environment when possible"}),s.jsx("p",{children:" Contact support if you experience issues after configuration changes"})]})]})]})]})}const pp=e=>({enablePrivacyMasking:!0,maskingLevel:"moderate",enableTokenization:!1,customSensitiveFields:[],enabledMcpServers:[],mcpServerEndpoints:{"archer-grc":"http://localhost:3005"},mcpToolAllowlist:{},pageSize:50,requestTimeout:30,maxRetries:3,enableCaching:!0,enableBackgroundSync:!0,tenantId:e,lastUpdated:new Date().toISOString(),isActive:!0});function kC(){var y;const{user:e,tenant:t}=it(),[n,r]=ry(),a=n.get("tab")||"llm",[i,l]=S.useState(a),[o,c]=S.useState(null),[u,m]=S.useState(!0),[d,p]=S.useState(!1),[f,g]=S.useState(null),v=((y=e==null?void 0:e.roles)==null?void 0:y.includes("TenantOwner"))||!1;S.useEffect(()=>{if(!t)return;const b=`mcp_privacy_config_${t.id}`,x=localStorage.getItem(b);try{const I=x?JSON.parse(x):pp(t.id);c(I)}catch(I){console.error("Error loading MCP Privacy config:",I),c(pp(t.id))}m(!1)},[t]);const T=async b=>{if(!(!t||!v)){p(!0),g(null);try{const x={...b,tenantId:t.id,lastUpdated:new Date().toISOString()},I=`mcp_privacy_config_${t.id}`;localStorage.setItem(I,JSON.stringify(x)),c(x);const C=await fs.syncSettingsToMcpServer(t.id);g(C?{type:"success",message:"Settings saved and synced to MCP server successfully"}:{type:"error",message:"Settings saved locally but failed to sync to MCP server"}),setTimeout(()=>g(null),5e3)}catch(x){console.error("Error saving MCP Privacy config:",x),g({type:"error",message:"Failed to save settings"})}finally{p(!1)}}};return u?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):t?s.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-6xl",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[s.jsx(dt,{className:"h-7 w-7 text-blue-600"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Settings"})]}),s.jsxs("p",{className:"text-gray-600",children:["Configure MCP servers, privacy protection, and AI model settings for"," ",s.jsx("span",{className:"font-semibold",children:t.name})]}),!v&&s.jsxs(Ie,{className:"mt-4",children:[s.jsx(ue,{className:"h-4 w-4"}),"You have read-only access to these settings. Contact your tenant owner to make changes."]})]}),f&&s.jsxs(Ie,{className:`mb-6 ${f.type==="success"?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[f.type==="success"?s.jsx(Le,{className:"h-4 w-4 text-green-600"}):s.jsx(ue,{className:"h-4 w-4 text-red-600"}),s.jsx("span",{className:f.type==="success"?"text-green-800":"text-red-800",children:f.message}),d&&s.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-600"}),s.jsx("span",{className:"text-xs text-gray-600",children:"Syncing to MCP server..."})]})]}),s.jsxs(iC,{value:i,onValueChange:b=>{l(b),r(b==="llm"?{}:{tab:b})},className:"space-y-6",children:[s.jsxs(lC,{className:"grid w-full grid-cols-5",children:[s.jsxs(qa,{value:"llm",className:"flex items-center space-x-2",children:[s.jsx(At,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"LLM Models"}),s.jsx("span",{className:"sm:hidden",children:"LLM"})]}),s.jsxs(qa,{value:"mcp",className:"flex items-center space-x-2",children:[s.jsx(Br,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"MCP Servers"}),s.jsx("span",{className:"sm:hidden",children:"MCP"})]}),s.jsxs(qa,{value:"sso",className:"flex items-center space-x-2",children:[s.jsx(Co,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"SSO / SAML"}),s.jsx("span",{className:"sm:hidden",children:"SSO"})]}),s.jsxs(qa,{value:"privacy",className:"flex items-center space-x-2",children:[s.jsx(ge,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Privacy"}),s.jsx("span",{className:"sm:hidden",children:"Privacy"})]}),s.jsxs(qa,{value:"advanced",className:"flex items-center space-x-2",children:[s.jsx(at,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Advanced"}),s.jsx("span",{className:"sm:hidden",children:"Advanced"})]})]}),s.jsx(Va,{value:"llm",className:"space-y-6",children:s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(At,{className:"h-5 w-5 text-blue-600"}),s.jsx(be,{children:"Language Model Configuration"})]})}),s.jsx(ne,{children:s.jsx(cC,{})})]})}),s.jsx(Va,{value:"mcp",className:"space-y-6",children:o&&s.jsx(TC,{config:o,onConfigChange:T,canModify:v,isSaving:d})}),s.jsx(Va,{value:"sso",className:"space-y-6",children:s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Co,{className:"h-5 w-5 text-blue-600"}),s.jsx(be,{children:"Single Sign-On Configuration"})]})}),s.jsx(ne,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-gray-900",children:"SAML Authentication"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Configure SAML 2.0 single sign-on for your tenant"})]}),s.jsx(J,{variant:"secondary",children:"Not Configured"})]}),!v&&s.jsxs(Ie,{className:"mb-4",children:[s.jsx(ue,{className:"h-4 w-4"}),"Contact your tenant owner to configure SSO settings."]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Identity Provider Entity ID"}),s.jsx("input",{type:"text",disabled:!v,className:"w-full p-2 border border-gray-300 rounded-md disabled:bg-gray-50",placeholder:"https://identity.company.com/saml"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SSO Login URL"}),s.jsx("input",{type:"url",disabled:!v,className:"w-full p-2 border border-gray-300 rounded-md disabled:bg-gray-50",placeholder:"https://identity.company.com/sso/login"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"X.509 Certificate"}),s.jsx("textarea",{rows:4,disabled:!v,className:"w-full p-2 border border-gray-300 rounded-md font-mono text-xs disabled:bg-gray-50",placeholder:`-----BEGIN CERTIFICATE-----
Your X.509 certificate content
-----END CERTIFICATE-----`})]}),s.jsxs("div",{className:"border-t pt-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Attribute Mapping"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Attribute"}),s.jsx("input",{type:"text",disabled:!v,defaultValue:"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress",className:"w-full p-2 border border-gray-300 rounded-md text-xs disabled:bg-gray-50"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Name Attribute"}),s.jsx("input",{type:"text",disabled:!v,defaultValue:"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name",className:"w-full p-2 border border-gray-300 rounded-md text-xs disabled:bg-gray-50"})]})]})]}),s.jsxs("div",{className:"border-t pt-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Security Settings"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",disabled:!v,defaultChecked:!0,className:"rounded"}),s.jsx("span",{className:"text-sm",children:"Require signed assertions"})]}),s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",disabled:!v,className:"rounded"}),s.jsx("span",{className:"text-sm",children:"Require signed response"})]}),s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",disabled:!v,defaultChecked:!0,className:"rounded"}),s.jsx("span",{className:"text-sm",children:"Enable automatic user provisioning"})]})]})]})]}),v&&s.jsxs("div",{className:"flex items-center justify-between pt-6 border-t",children:[s.jsx("button",{className:"flex items-center space-x-2 px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-sm",children:s.jsx("span",{children:"Test SSO Configuration"})}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Reset"}),s.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Save SSO Settings"})]})]})]}),s.jsx(Q,{className:"border-blue-100 bg-blue-50",children:s.jsx(ne,{className:"pt-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(ge,{className:"h-5 w-5 text-blue-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-blue-900 mb-1",children:"Service Provider Information"}),s.jsx("p",{className:"text-sm text-blue-700 mb-3",children:"Provide these details to your identity provider administrator:"}),s.jsxs("div",{className:"space-y-2 text-xs",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"ACS URL:"}),s.jsxs("code",{className:"ml-2 px-2 py-1 bg-blue-100 rounded",children:[window.location.origin,"/api/v1/auth/saml/",(t==null?void 0:t.slug)||"your-tenant","/callback"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Entity ID:"}),s.jsxs("code",{className:"ml-2 px-2 py-1 bg-blue-100 rounded",children:["urn:",(t==null?void 0:t.slug)||"your-tenant",":saml:sp"]})]})]})]})]})})})]})})]})}),s.jsx(Va,{value:"privacy",className:"space-y-6",children:t&&s.jsx(wC,{tenantId:t.id,userId:e==null?void 0:e.id,scope:"tenant",canModify:v})}),s.jsx(Va,{value:"advanced",className:"space-y-6",children:o&&s.jsx(CC,{config:o,onConfigChange:T,canModify:v,isSaving:d})})]}),o&&s.jsx(Q,{className:"mt-8 border-gray-200",children:s.jsx(ne,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Tt,{className:"h-4 w-4"}),s.jsxs("span",{children:["Last updated: ",new Date(o.lastUpdated).toLocaleString()]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("span",{children:"Tenant:"}),s.jsx(J,{variant:"outline",children:t.name})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(J,{variant:o.isActive?"default":"secondary",className:o.isActive?"bg-green-100 text-green-800 border-green-200":"",children:o.isActive?"Active":"Inactive"}),s.jsxs(J,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:[s.jsx(at,{className:"h-3 w-3 mr-1"}),"MCP Synced"]})]})]})})})]}):s.jsxs(Ie,{className:"max-w-2xl mx-auto mt-8",children:[s.jsx(ue,{className:"h-4 w-4"}),"Please select a tenant to manage settings."]})}function gp(e){const t=[],n=String(e||"");let r=n.indexOf(","),a=0,i=!1;for(;!i;){r===-1&&(r=n.length,i=!0);const l=n.slice(a,r).trim();(l||!i)&&t.push(l),a=r+1,r=n.indexOf(",",a)}return t}function By(e,t){const n={};return(e[e.length-1]===""?[...e,""]:e).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const jC=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,AC=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,_C={};function xp(e,t){return(_C.jsx?AC:jC).test(e)}const IC=/[ \t\n\f\r]/g;function LC(e){return typeof e=="object"?e.type==="text"?yp(e.value):!1:yp(e)}function yp(e){return e.replace(IC,"")===""}let Zi=class{constructor(t,n,r){this.normal=n,this.property=t,r&&(this.space=r)}};Zi.prototype.normal={};Zi.prototype.property={};Zi.prototype.space=void 0;function Uy(e,t){const n={},r={};for(const a of e)Object.assign(n,a.property),Object.assign(r,a.normal);return new Zi(n,r,t)}function zi(e){return e.toLowerCase()}let qt=class{constructor(t,n){this.attribute=n,this.property=t}};qt.prototype.attribute="";qt.prototype.booleanish=!1;qt.prototype.boolean=!1;qt.prototype.commaOrSpaceSeparated=!1;qt.prototype.commaSeparated=!1;qt.prototype.defined=!1;qt.prototype.mustUseProperty=!1;qt.prototype.number=!1;qt.prototype.overloadedBoolean=!1;qt.prototype.property="";qt.prototype.spaceSeparated=!1;qt.prototype.space=void 0;let RC=0;const ye=ks(),Je=ks(),Id=ks(),ee=ks(),Oe=ks(),ta=ks(),Kt=ks();function ks(){return 2**++RC}const Ld=Object.freeze(Object.defineProperty({__proto__:null,boolean:ye,booleanish:Je,commaOrSpaceSeparated:Kt,commaSeparated:ta,number:ee,overloadedBoolean:Id,spaceSeparated:Oe},Symbol.toStringTag,{value:"Module"})),ru=Object.keys(Ld);let om=class extends qt{constructor(t,n,r,a){let i=-1;if(super(t,n),bp(this,"space",a),typeof r=="number")for(;++i<ru.length;){const l=ru[i];bp(this,ru[i],(r&Ld[l])===Ld[l])}}};om.prototype.defined=!0;function bp(e,t,n){n&&(e[t]=n)}function Ta(e){const t={},n={};for(const[r,a]of Object.entries(e.properties)){const i=new om(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(i.mustUseProperty=!0),t[r]=i,n[zi(r)]=r,n[zi(i.attribute)]=r}return new Zi(t,n,e.space)}const Hy=Ta({properties:{ariaActiveDescendant:null,ariaAtomic:Je,ariaAutoComplete:null,ariaBusy:Je,ariaChecked:Je,ariaColCount:ee,ariaColIndex:ee,ariaColSpan:ee,ariaControls:Oe,ariaCurrent:null,ariaDescribedBy:Oe,ariaDetails:null,ariaDisabled:Je,ariaDropEffect:Oe,ariaErrorMessage:null,ariaExpanded:Je,ariaFlowTo:Oe,ariaGrabbed:Je,ariaHasPopup:null,ariaHidden:Je,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Oe,ariaLevel:ee,ariaLive:null,ariaModal:Je,ariaMultiLine:Je,ariaMultiSelectable:Je,ariaOrientation:null,ariaOwns:Oe,ariaPlaceholder:null,ariaPosInSet:ee,ariaPressed:Je,ariaReadOnly:Je,ariaRelevant:null,ariaRequired:Je,ariaRoleDescription:Oe,ariaRowCount:ee,ariaRowIndex:ee,ariaRowSpan:ee,ariaSelected:Je,ariaSetSize:ee,ariaSort:null,ariaValueMax:ee,ariaValueMin:ee,ariaValueNow:ee,ariaValueText:null,role:null},transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()}});function zy(e,t){return t in e?e[t]:t}function $y(e,t){return zy(e,t.toLowerCase())}const PC=Ta({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:ta,acceptCharset:Oe,accessKey:Oe,action:null,allow:null,allowFullScreen:ye,allowPaymentRequest:ye,allowUserMedia:ye,alt:null,as:null,async:ye,autoCapitalize:null,autoComplete:Oe,autoFocus:ye,autoPlay:ye,blocking:Oe,capture:null,charSet:null,checked:ye,cite:null,className:Oe,cols:ee,colSpan:null,content:null,contentEditable:Je,controls:ye,controlsList:Oe,coords:ee|ta,crossOrigin:null,data:null,dateTime:null,decoding:null,default:ye,defer:ye,dir:null,dirName:null,disabled:ye,download:Id,draggable:Je,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:ye,formTarget:null,headers:Oe,height:ee,hidden:Id,high:ee,href:null,hrefLang:null,htmlFor:Oe,httpEquiv:Oe,id:null,imageSizes:null,imageSrcSet:null,inert:ye,inputMode:null,integrity:null,is:null,isMap:ye,itemId:null,itemProp:Oe,itemRef:Oe,itemScope:ye,itemType:Oe,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:ye,low:ee,manifest:null,max:null,maxLength:ee,media:null,method:null,min:null,minLength:ee,multiple:ye,muted:ye,name:null,nonce:null,noModule:ye,noValidate:ye,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:ye,optimum:ee,pattern:null,ping:Oe,placeholder:null,playsInline:ye,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:ye,referrerPolicy:null,rel:Oe,required:ye,reversed:ye,rows:ee,rowSpan:ee,sandbox:Oe,scope:null,scoped:ye,seamless:ye,selected:ye,shadowRootClonable:ye,shadowRootDelegatesFocus:ye,shadowRootMode:null,shape:null,size:ee,sizes:null,slot:null,span:ee,spellCheck:Je,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ee,step:null,style:null,tabIndex:ee,target:null,title:null,translate:null,type:null,typeMustMatch:ye,useMap:null,value:Je,width:ee,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Oe,axis:null,background:null,bgColor:null,border:ee,borderColor:null,bottomMargin:ee,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:ye,declare:ye,event:null,face:null,frame:null,frameBorder:null,hSpace:ee,leftMargin:ee,link:null,longDesc:null,lowSrc:null,marginHeight:ee,marginWidth:ee,noResize:ye,noHref:ye,noShade:ye,noWrap:ye,object:null,profile:null,prompt:null,rev:null,rightMargin:ee,rules:null,scheme:null,scrolling:Je,standby:null,summary:null,text:null,topMargin:ee,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ee,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:ye,disableRemotePlayback:ye,prefix:null,property:null,results:ee,security:null,unselectable:null},space:"html",transform:$y}),MC=Ta({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Kt,accentHeight:ee,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ee,amplitude:ee,arabicForm:null,ascent:ee,attributeName:null,attributeType:null,azimuth:ee,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ee,by:null,calcMode:null,capHeight:ee,className:Oe,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ee,diffuseConstant:ee,direction:null,display:null,dur:null,divisor:ee,dominantBaseline:null,download:ye,dx:null,dy:null,edgeMode:null,editable:null,elevation:ee,enableBackground:null,end:null,event:null,exponent:ee,externalResourcesRequired:null,fill:null,fillOpacity:ee,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:ta,g2:ta,glyphName:ta,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ee,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ee,horizOriginX:ee,horizOriginY:ee,id:null,ideographic:ee,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ee,k:ee,k1:ee,k2:ee,k3:ee,k4:ee,kernelMatrix:Kt,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ee,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ee,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ee,overlineThickness:ee,paintOrder:null,panose1:null,path:null,pathLength:ee,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Oe,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ee,pointsAtY:ee,pointsAtZ:ee,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Kt,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Kt,rev:Kt,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Kt,requiredFeatures:Kt,requiredFonts:Kt,requiredFormats:Kt,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ee,specularExponent:ee,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ee,strikethroughThickness:ee,string:null,stroke:null,strokeDashArray:Kt,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ee,strokeOpacity:ee,strokeWidth:null,style:null,surfaceScale:ee,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Kt,tabIndex:ee,tableValues:null,target:null,targetX:ee,targetY:ee,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Kt,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ee,underlineThickness:ee,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ee,values:null,vAlphabetic:ee,vMathematical:ee,vectorEffect:null,vHanging:ee,vIdeographic:ee,version:null,vertAdvY:ee,vertOriginX:ee,vertOriginY:ee,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ee,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:zy}),qy=Ta({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()}}),Vy=Ta({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:$y}),Yy=Ta({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()}}),OC={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},DC=/[A-Z]/g,vp=/-[a-z]/g,FC=/^data[-\w.:]+$/i;function cm(e,t){const n=zi(t);let r=t,a=qt;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&FC.test(t)){if(t.charAt(4)==="-"){const i=t.slice(5).replace(vp,UC);r="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=t.slice(4);if(!vp.test(i)){let l=i.replace(DC,BC);l.charAt(0)!=="-"&&(l="-"+l),t="data"+l}}a=om}return new a(r,t)}function BC(e){return"-"+e.toLowerCase()}function UC(e){return e.charAt(1).toUpperCase()}const lc=Uy([Hy,PC,qy,Vy,Yy],"html"),wa=Uy([Hy,MC,qy,Vy,Yy],"svg");function Ep(e){const t=String(e||"").trim();return t?t.split(/[ \t\n\r\f]+/g):[]}function Wy(e){return e.join(" ").trim()}var um={},Np=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,HC=/\n/g,zC=/^\s*/,$C=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,qC=/^:\s*/,VC=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,YC=/^[;\s]*/,WC=/^\s+|\s+$/g,KC=`
`,Tp="/",wp="*",as="",GC="comment",QC="declaration",XC=function(e,t){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var n=1,r=1;function a(g){var v=g.match(HC);v&&(n+=v.length);var T=g.lastIndexOf(KC);r=~T?g.length-T:r+g.length}function i(){var g={line:n,column:r};return function(v){return v.position=new l(g),u(),v}}function l(g){this.start=g,this.end={line:n,column:r},this.source=t.source}l.prototype.content=e;function o(g){var v=new Error(t.source+":"+n+":"+r+": "+g);if(v.reason=g,v.filename=t.source,v.line=n,v.column=r,v.source=e,!t.silent)throw v}function c(g){var v=g.exec(e);if(v){var T=v[0];return a(T),e=e.slice(T.length),v}}function u(){c(zC)}function m(g){var v;for(g=g||[];v=d();)v!==!1&&g.push(v);return g}function d(){var g=i();if(!(Tp!=e.charAt(0)||wp!=e.charAt(1))){for(var v=2;as!=e.charAt(v)&&(wp!=e.charAt(v)||Tp!=e.charAt(v+1));)++v;if(v+=2,as===e.charAt(v-1))return o("End of comment missing");var T=e.slice(2,v-2);return r+=2,a(T),e=e.slice(v),r+=2,g({type:GC,comment:T})}}function p(){var g=i(),v=c($C);if(v){if(d(),!c(qC))return o("property missing ':'");var T=c(VC),y=g({type:QC,property:Sp(v[0].replace(Np,as)),value:T?Sp(T[0].replace(Np,as)):as});return c(YC),y}}function f(){var g=[];m(g);for(var v;v=p();)v!==!1&&(g.push(v),m(g));return g}return u(),f()};function Sp(e){return e?e.replace(WC,as):as}var JC=Xl&&Xl.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(um,"__esModule",{value:!0});um.default=ek;var ZC=JC(XC);function ek(e,t){var n=null;if(!e||typeof e!="string")return n;var r=(0,ZC.default)(e),a=typeof t=="function";return r.forEach(function(i){if(i.type==="declaration"){var l=i.property,o=i.value;a?t(l,o,i):o&&(n=n||{},n[l]=o)}}),n}var oc={};Object.defineProperty(oc,"__esModule",{value:!0});oc.camelCase=void 0;var tk=/^--[a-zA-Z0-9_-]+$/,nk=/-([a-z])/g,rk=/^[^-]+$/,sk=/^-(webkit|moz|ms|o|khtml)-/,ak=/^-(ms)-/,ik=function(e){return!e||rk.test(e)||tk.test(e)},lk=function(e,t){return t.toUpperCase()},Cp=function(e,t){return"".concat(t,"-")},ok=function(e,t){return t===void 0&&(t={}),ik(e)?e:(e=e.toLowerCase(),t.reactCompat?e=e.replace(ak,Cp):e=e.replace(sk,Cp),e.replace(nk,lk))};oc.camelCase=ok;var ck=Xl&&Xl.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},uk=ck(um),dk=oc;function Rd(e,t){var n={};return!e||typeof e!="string"||(0,uk.default)(e,function(r,a){r&&a&&(n[(0,dk.camelCase)(r,t)]=a)}),n}Rd.default=Rd;var hk=Rd;const mk=Oo(hk),cc=Ky("end"),qn=Ky("start");function Ky(e){return t;function t(n){const r=n&&n.position&&n.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function fk(e){const t=qn(e),n=cc(e);if(t&&n)return{start:t,end:n}}function di(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?kp(e.position):"start"in e||"end"in e?kp(e):"line"in e||"column"in e?Pd(e):""}function Pd(e){return jp(e&&e.line)+":"+jp(e&&e.column)}function kp(e){return Pd(e&&e.start)+"-"+Pd(e&&e.end)}function jp(e){return e&&typeof e=="number"?e:1}class St extends Error{constructor(t,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let a="",i={},l=!1;if(n&&("line"in n&&"column"in n?i={place:n}:"start"in n&&"end"in n?i={place:n}:"type"in n?i={ancestors:[n],place:n.position}:i={...n}),typeof t=="string"?a=t:!i.cause&&t&&(l=!0,a=t.message,i.cause=t),!i.ruleId&&!i.source&&typeof r=="string"){const c=r.indexOf(":");c===-1?i.ruleId=r:(i.source=r.slice(0,c),i.ruleId=r.slice(c+1))}if(!i.place&&i.ancestors&&i.ancestors){const c=i.ancestors[i.ancestors.length-1];c&&(i.place=c.position)}const o=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=o?o.line:void 0,this.name=di(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=l&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}St.prototype.file="";St.prototype.name="";St.prototype.reason="";St.prototype.message="";St.prototype.stack="";St.prototype.column=void 0;St.prototype.line=void 0;St.prototype.ancestors=void 0;St.prototype.cause=void 0;St.prototype.fatal=void 0;St.prototype.place=void 0;St.prototype.ruleId=void 0;St.prototype.source=void 0;const dm={}.hasOwnProperty,pk=new Map,gk=/[A-Z]/g,xk=new Set(["table","tbody","thead","tfoot","tr"]),yk=new Set(["td","th"]),Gy="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function bk(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=t.filePath||void 0;let r;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=kk(n,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=Ck(n,t.jsx,t.jsxs)}const a={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:r,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?wa:lc,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},i=Qy(a,e,void 0);return i&&typeof i!="string"?i:a.create(e,a.Fragment,{children:i||void 0},void 0)}function Qy(e,t,n){if(t.type==="element")return vk(e,t,n);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return Ek(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return Tk(e,t,n);if(t.type==="mdxjsEsm")return Nk(e,t);if(t.type==="root")return wk(e,t,n);if(t.type==="text")return Sk(e,t)}function vk(e,t,n){const r=e.schema;let a=r;t.tagName.toLowerCase()==="svg"&&r.space==="html"&&(a=wa,e.schema=a),e.ancestors.push(t);const i=Jy(e,t.tagName,!1),l=jk(e,t);let o=mm(e,t);return xk.has(t.tagName)&&(o=o.filter(function(c){return typeof c=="string"?!LC(c):!0})),Xy(e,l,i,t),hm(l,o),e.ancestors.pop(),e.schema=r,e.create(t,i,l,n)}function Ek(e,t){if(t.data&&t.data.estree&&e.evaluater){const r=t.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}$i(e,t.position)}function Nk(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);$i(e,t.position)}function Tk(e,t,n){const r=e.schema;let a=r;t.name==="svg"&&r.space==="html"&&(a=wa,e.schema=a),e.ancestors.push(t);const i=t.name===null?e.Fragment:Jy(e,t.name,!0),l=Ak(e,t),o=mm(e,t);return Xy(e,l,i,t),hm(l,o),e.ancestors.pop(),e.schema=r,e.create(t,i,l,n)}function wk(e,t,n){const r={};return hm(r,mm(e,t)),e.create(t,e.Fragment,r,n)}function Sk(e,t){return t.value}function Xy(e,t,n,r){typeof n!="string"&&n!==e.Fragment&&e.passNode&&(t.node=r)}function hm(e,t){if(t.length>0){const n=t.length>1?t:t[0];n&&(e.children=n)}}function Ck(e,t,n){return r;function r(a,i,l,o){const u=Array.isArray(l.children)?n:t;return o?u(i,l,o):u(i,l)}}function kk(e,t){return n;function n(r,a,i,l){const o=Array.isArray(i.children),c=qn(r);return t(a,i,l,o,{columnNumber:c?c.column-1:void 0,fileName:e,lineNumber:c?c.line:void 0},void 0)}}function jk(e,t){const n={};let r,a;for(a in t.properties)if(a!=="children"&&dm.call(t.properties,a)){const i=_k(e,a,t.properties[a]);if(i){const[l,o]=i;e.tableCellAlignToStyle&&l==="align"&&typeof o=="string"&&yk.has(t.tagName)?r=o:n[l]=o}}if(r){const i=n.style||(n.style={});i[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function Ak(e,t){const n={};for(const r of t.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const i=r.data.estree.body[0];i.type;const l=i.expression;l.type;const o=l.properties[0];o.type,Object.assign(n,e.evaluater.evaluateExpression(o.argument))}else $i(e,t.position);else{const a=r.name;let i;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const o=r.value.data.estree.body[0];o.type,i=e.evaluater.evaluateExpression(o.expression)}else $i(e,t.position);else i=r.value===null?!0:r.value;n[a]=i}return n}function mm(e,t){const n=[];let r=-1;const a=e.passKeys?new Map:pk;for(;++r<t.children.length;){const i=t.children[r];let l;if(e.passKeys){const c=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(c){const u=a.get(c)||0;l=c+"-"+u,a.set(c,u+1)}}const o=Qy(e,i,l);o!==void 0&&n.push(o)}return n}function _k(e,t,n){const r=cm(e.schema,t);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?By(n):Wy(n)),r.property==="style"){let a=typeof n=="object"?n:Ik(e,String(n));return e.stylePropertyNameCase==="css"&&(a=Lk(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&r.space?OC[r.property]||r.property:r.attribute,n]}}function Ik(e,t){try{return mk(t,{reactCompat:!0})}catch(n){if(e.ignoreInvalidStyle)return{};const r=n,a=new St("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=Gy+"#cannot-parse-style-attribute",a}}function Jy(e,t,n){let r;if(!n)r={type:"Literal",value:t};else if(t.includes(".")){const a=t.split(".");let i=-1,l;for(;++i<a.length;){const o=xp(a[i])?{type:"Identifier",name:a[i]}:{type:"Literal",value:a[i]};l=l?{type:"MemberExpression",object:l,property:o,computed:!!(i&&o.type==="Literal"),optional:!1}:o}r=l}else r=xp(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(r.type==="Literal"){const a=r.value;return dm.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(r);$i(e)}function $i(e,t){const n=new St("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=Gy+"#cannot-handle-mdx-estrees-without-createevaluater",n}function Lk(e){const t={};let n;for(n in e)dm.call(e,n)&&(t[Rk(n)]=e[n]);return t}function Rk(e){let t=e.replace(gk,Pk);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function Pk(e){return"-"+e.toLowerCase()}const su={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},Mk={};function fm(e,t){const n=Mk,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,a=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return Zy(e,r,a)}function Zy(e,t,n){if(Ok(e)){if("value"in e)return e.type==="html"&&!n?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return Ap(e.children,t,n)}return Array.isArray(e)?Ap(e,t,n):""}function Ap(e,t,n){const r=[];let a=-1;for(;++a<e.length;)r[a]=Zy(e[a],t,n);return r.join("")}function Ok(e){return!!(e&&typeof e=="object")}const _p=document.createElement("i");function pm(e){const t="&"+e+";";_p.innerHTML=t;const n=_p.textContent;return n.charCodeAt(n.length-1)===59&&e!=="semi"||n===t?!1:n}function Zt(e,t,n,r){const a=e.length;let i=0,l;if(t<0?t=-t>a?0:a+t:t=t>a?a:t,n=n>0?n:0,r.length<1e4)l=Array.from(r),l.unshift(t,n),e.splice(...l);else for(n&&e.splice(t,n);i<r.length;)l=r.slice(i,i+1e4),l.unshift(t,0),e.splice(...l),i+=1e4,t+=1e4}function on(e,t){return e.length>0?(Zt(e,e.length,0,t),e):t}const Ip={}.hasOwnProperty;function e1(e){const t={};let n=-1;for(;++n<e.length;)Dk(t,e[n]);return t}function Dk(e,t){let n;for(n in t){const a=(Ip.call(e,n)?e[n]:void 0)||(e[n]={}),i=t[n];let l;if(i)for(l in i){Ip.call(a,l)||(a[l]=[]);const o=i[l];Fk(a[l],Array.isArray(o)?o:o?[o]:[])}}}function Fk(e,t){let n=-1;const r=[];for(;++n<t.length;)(t[n].add==="after"?e:r).push(t[n]);Zt(e,0,0,r)}function t1(e,t){const n=Number.parseInt(e,t);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"":String.fromCodePoint(n)}function An(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const jt=Xr(/[A-Za-z]/),Nt=Xr(/[\dA-Za-z]/),Bk=Xr(/[#-'*+\--9=?A-Z^-~]/);function _o(e){return e!==null&&(e<32||e===127)}const Md=Xr(/\d/),Uk=Xr(/[\dA-Fa-f]/),Hk=Xr(/[!-/:-@[-`{-~]/);function oe(e){return e!==null&&e<-2}function Me(e){return e!==null&&(e<0||e===32)}function Ne(e){return e===-2||e===-1||e===32}const uc=Xr(new RegExp("\\p{P}|\\p{S}","u")),ws=Xr(/\s/);function Xr(e){return t;function t(n){return n!==null&&n>-1&&e.test(String.fromCharCode(n))}}function Sa(e){const t=[];let n=-1,r=0,a=0;for(;++n<e.length;){const i=e.charCodeAt(n);let l="";if(i===37&&Nt(e.charCodeAt(n+1))&&Nt(e.charCodeAt(n+2)))a=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(l=String.fromCharCode(i));else if(i>55295&&i<57344){const o=e.charCodeAt(n+1);i<56320&&o>56319&&o<57344?(l=String.fromCharCode(i,o),a=1):l=""}else l=String.fromCharCode(i);l&&(t.push(e.slice(r,n),encodeURIComponent(l)),r=n+a+1,l=""),a&&(n+=a,a=0)}return t.join("")+e.slice(r)}function ke(e,t,n,r){const a=r?r-1:Number.POSITIVE_INFINITY;let i=0;return l;function l(c){return Ne(c)?(e.enter(n),o(c)):t(c)}function o(c){return Ne(c)&&i++<a?(e.consume(c),o):(e.exit(n),t(c))}}const zk={tokenize:$k};function $k(e){const t=e.attempt(this.parser.constructs.contentInitial,r,a);let n;return t;function r(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),ke(e,t,"linePrefix")}function a(o){return e.enter("paragraph"),i(o)}function i(o){const c=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=c),n=c,l(o)}function l(o){if(o===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(o);return}return oe(o)?(e.consume(o),e.exit("chunkText"),i):(e.consume(o),l)}}const qk={tokenize:Vk},Lp={tokenize:Yk};function Vk(e){const t=this,n=[];let r=0,a,i,l;return o;function o(x){if(r<n.length){const I=n[r];return t.containerState=I[1],e.attempt(I[0].continuation,c,u)(x)}return u(x)}function c(x){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,a&&b();const I=t.events.length;let C=I,E;for(;C--;)if(t.events[C][0]==="exit"&&t.events[C][1].type==="chunkFlow"){E=t.events[C][1].end;break}y(r);let N=I;for(;N<t.events.length;)t.events[N][1].end={...E},N++;return Zt(t.events,C+1,0,t.events.slice(I)),t.events.length=N,u(x)}return o(x)}function u(x){if(r===n.length){if(!a)return p(x);if(a.currentConstruct&&a.currentConstruct.concrete)return g(x);t.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(Lp,m,d)(x)}function m(x){return a&&b(),y(r),p(x)}function d(x){return t.parser.lazy[t.now().line]=r!==n.length,l=t.now().offset,g(x)}function p(x){return t.containerState={},e.attempt(Lp,f,g)(x)}function f(x){return r++,n.push([t.currentConstruct,t.containerState]),p(x)}function g(x){if(x===null){a&&b(),y(0),e.consume(x);return}return a=a||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:i}),v(x)}function v(x){if(x===null){T(e.exit("chunkFlow"),!0),y(0),e.consume(x);return}return oe(x)?(e.consume(x),T(e.exit("chunkFlow")),r=0,t.interrupt=void 0,o):(e.consume(x),v)}function T(x,I){const C=t.sliceStream(x);if(I&&C.push(null),x.previous=i,i&&(i.next=x),i=x,a.defineSkip(x.start),a.write(C),t.parser.lazy[x.start.line]){let E=a.events.length;for(;E--;)if(a.events[E][1].start.offset<l&&(!a.events[E][1].end||a.events[E][1].end.offset>l))return;const N=t.events.length;let O=N,D,A;for(;O--;)if(t.events[O][0]==="exit"&&t.events[O][1].type==="chunkFlow"){if(D){A=t.events[O][1].end;break}D=!0}for(y(r),E=N;E<t.events.length;)t.events[E][1].end={...A},E++;Zt(t.events,O+1,0,t.events.slice(N)),t.events.length=E}}function y(x){let I=n.length;for(;I-- >x;){const C=n[I];t.containerState=C[1],C[0].exit.call(t,e)}n.length=x}function b(){a.write([null]),i=void 0,a=void 0,t.containerState._closeFlow=void 0}}function Yk(e,t,n){return ke(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function ha(e){if(e===null||Me(e)||ws(e))return 1;if(uc(e))return 2}function dc(e,t,n){const r=[];let a=-1;for(;++a<e.length;){const i=e[a].resolveAll;i&&!r.includes(i)&&(t=i(t,n),r.push(i))}return t}const Od={name:"attention",resolveAll:Wk,tokenize:Kk};function Wk(e,t){let n=-1,r,a,i,l,o,c,u,m;for(;++n<e.length;)if(e[n][0]==="enter"&&e[n][1].type==="attentionSequence"&&e[n][1]._close){for(r=n;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&t.sliceSerialize(e[r][1]).charCodeAt(0)===t.sliceSerialize(e[n][1]).charCodeAt(0)){if((e[r][1]._close||e[n][1]._open)&&(e[n][1].end.offset-e[n][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[n][1].end.offset-e[n][1].start.offset)%3))continue;c=e[r][1].end.offset-e[r][1].start.offset>1&&e[n][1].end.offset-e[n][1].start.offset>1?2:1;const d={...e[r][1].end},p={...e[n][1].start};Rp(d,-c),Rp(p,c),l={type:c>1?"strongSequence":"emphasisSequence",start:d,end:{...e[r][1].end}},o={type:c>1?"strongSequence":"emphasisSequence",start:{...e[n][1].start},end:p},i={type:c>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[n][1].start}},a={type:c>1?"strong":"emphasis",start:{...l.start},end:{...o.end}},e[r][1].end={...l.start},e[n][1].start={...o.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=on(u,[["enter",e[r][1],t],["exit",e[r][1],t]])),u=on(u,[["enter",a,t],["enter",l,t],["exit",l,t],["enter",i,t]]),u=on(u,dc(t.parser.constructs.insideSpan.null,e.slice(r+1,n),t)),u=on(u,[["exit",i,t],["enter",o,t],["exit",o,t],["exit",a,t]]),e[n][1].end.offset-e[n][1].start.offset?(m=2,u=on(u,[["enter",e[n][1],t],["exit",e[n][1],t]])):m=0,Zt(e,r-1,n-r+3,u),n=r+u.length-m-2;break}}for(n=-1;++n<e.length;)e[n][1].type==="attentionSequence"&&(e[n][1].type="data");return e}function Kk(e,t){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,a=ha(r);let i;return l;function l(c){return i=c,e.enter("attentionSequence"),o(c)}function o(c){if(c===i)return e.consume(c),o;const u=e.exit("attentionSequence"),m=ha(c),d=!m||m===2&&a||n.includes(c),p=!a||a===2&&m||n.includes(r);return u._open=!!(i===42?d:d&&(a||!p)),u._close=!!(i===42?p:p&&(m||!d)),t(c)}}function Rp(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const Gk={name:"autolink",tokenize:Qk};function Qk(e,t,n){let r=0;return a;function a(f){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(f),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),i}function i(f){return jt(f)?(e.consume(f),l):f===64?n(f):u(f)}function l(f){return f===43||f===45||f===46||Nt(f)?(r=1,o(f)):u(f)}function o(f){return f===58?(e.consume(f),r=0,c):(f===43||f===45||f===46||Nt(f))&&r++<32?(e.consume(f),o):(r=0,u(f))}function c(f){return f===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(f),e.exit("autolinkMarker"),e.exit("autolink"),t):f===null||f===32||f===60||_o(f)?n(f):(e.consume(f),c)}function u(f){return f===64?(e.consume(f),m):Bk(f)?(e.consume(f),u):n(f)}function m(f){return Nt(f)?d(f):n(f)}function d(f){return f===46?(e.consume(f),r=0,m):f===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(f),e.exit("autolinkMarker"),e.exit("autolink"),t):p(f)}function p(f){if((f===45||Nt(f))&&r++<63){const g=f===45?p:d;return e.consume(f),g}return n(f)}}const el={partial:!0,tokenize:Xk};function Xk(e,t,n){return r;function r(i){return Ne(i)?ke(e,a,"linePrefix")(i):a(i)}function a(i){return i===null||oe(i)?t(i):n(i)}}const n1={continuation:{tokenize:Zk},exit:ej,name:"blockQuote",tokenize:Jk};function Jk(e,t,n){const r=this;return a;function a(l){if(l===62){const o=r.containerState;return o.open||(e.enter("blockQuote",{_container:!0}),o.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),i}return n(l)}function i(l){return Ne(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(l))}}function Zk(e,t,n){const r=this;return a;function a(l){return Ne(l)?ke(e,i,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):i(l)}function i(l){return e.attempt(n1,t,n)(l)}}function ej(e){e.exit("blockQuote")}const r1={name:"characterEscape",tokenize:tj};function tj(e,t,n){return r;function r(i){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(i),e.exit("escapeMarker"),a}function a(i){return Hk(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(i)}}const s1={name:"characterReference",tokenize:nj};function nj(e,t,n){const r=this;let a=0,i,l;return o;function o(d){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(d),e.exit("characterReferenceMarker"),c}function c(d){return d===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(d),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),i=31,l=Nt,m(d))}function u(d){return d===88||d===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(d),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),i=6,l=Uk,m):(e.enter("characterReferenceValue"),i=7,l=Md,m(d))}function m(d){if(d===59&&a){const p=e.exit("characterReferenceValue");return l===Nt&&!pm(r.sliceSerialize(p))?n(d):(e.enter("characterReferenceMarker"),e.consume(d),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return l(d)&&a++<i?(e.consume(d),m):n(d)}}const Pp={partial:!0,tokenize:sj},Mp={concrete:!0,name:"codeFenced",tokenize:rj};function rj(e,t,n){const r=this,a={partial:!0,tokenize:C};let i=0,l=0,o;return c;function c(E){return u(E)}function u(E){const N=r.events[r.events.length-1];return i=N&&N[1].type==="linePrefix"?N[2].sliceSerialize(N[1],!0).length:0,o=E,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),m(E)}function m(E){return E===o?(l++,e.consume(E),m):l<3?n(E):(e.exit("codeFencedFenceSequence"),Ne(E)?ke(e,d,"whitespace")(E):d(E))}function d(E){return E===null||oe(E)?(e.exit("codeFencedFence"),r.interrupt?t(E):e.check(Pp,v,I)(E)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),p(E))}function p(E){return E===null||oe(E)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),d(E)):Ne(E)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),ke(e,f,"whitespace")(E)):E===96&&E===o?n(E):(e.consume(E),p)}function f(E){return E===null||oe(E)?d(E):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),g(E))}function g(E){return E===null||oe(E)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),d(E)):E===96&&E===o?n(E):(e.consume(E),g)}function v(E){return e.attempt(a,I,T)(E)}function T(E){return e.enter("lineEnding"),e.consume(E),e.exit("lineEnding"),y}function y(E){return i>0&&Ne(E)?ke(e,b,"linePrefix",i+1)(E):b(E)}function b(E){return E===null||oe(E)?e.check(Pp,v,I)(E):(e.enter("codeFlowValue"),x(E))}function x(E){return E===null||oe(E)?(e.exit("codeFlowValue"),b(E)):(e.consume(E),x)}function I(E){return e.exit("codeFenced"),t(E)}function C(E,N,O){let D=0;return A;function A(Y){return E.enter("lineEnding"),E.consume(Y),E.exit("lineEnding"),z}function z(Y){return E.enter("codeFencedFence"),Ne(Y)?ke(E,M,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(Y):M(Y)}function M(Y){return Y===o?(E.enter("codeFencedFenceSequence"),R(Y)):O(Y)}function R(Y){return Y===o?(D++,E.consume(Y),R):D>=l?(E.exit("codeFencedFenceSequence"),Ne(Y)?ke(E,H,"whitespace")(Y):H(Y)):O(Y)}function H(Y){return Y===null||oe(Y)?(E.exit("codeFencedFence"),N(Y)):O(Y)}}}function sj(e,t,n){const r=this;return a;function a(l){return l===null?n(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),i)}function i(l){return r.parser.lazy[r.now().line]?n(l):t(l)}}const au={name:"codeIndented",tokenize:ij},aj={partial:!0,tokenize:lj};function ij(e,t,n){const r=this;return a;function a(u){return e.enter("codeIndented"),ke(e,i,"linePrefix",5)(u)}function i(u){const m=r.events[r.events.length-1];return m&&m[1].type==="linePrefix"&&m[2].sliceSerialize(m[1],!0).length>=4?l(u):n(u)}function l(u){return u===null?c(u):oe(u)?e.attempt(aj,l,c)(u):(e.enter("codeFlowValue"),o(u))}function o(u){return u===null||oe(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),o)}function c(u){return e.exit("codeIndented"),t(u)}}function lj(e,t,n){const r=this;return a;function a(l){return r.parser.lazy[r.now().line]?n(l):oe(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):ke(e,i,"linePrefix",5)(l)}function i(l){const o=r.events[r.events.length-1];return o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(l):oe(l)?a(l):n(l)}}const oj={name:"codeText",previous:uj,resolve:cj,tokenize:dj};function cj(e){let t=e.length-4,n=3,r,a;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(r=n;++r<t;)if(e[r][1].type==="codeTextData"){e[n][1].type="codeTextPadding",e[t][1].type="codeTextPadding",n+=2,t-=2;break}}for(r=n-1,t++;++r<=t;)a===void 0?r!==t&&e[r][1].type!=="lineEnding"&&(a=r):(r===t||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),t-=r-a-2,r=a+2),a=void 0);return e}function uj(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function dj(e,t,n){let r=0,a,i;return l;function l(d){return e.enter("codeText"),e.enter("codeTextSequence"),o(d)}function o(d){return d===96?(e.consume(d),r++,o):(e.exit("codeTextSequence"),c(d))}function c(d){return d===null?n(d):d===32?(e.enter("space"),e.consume(d),e.exit("space"),c):d===96?(i=e.enter("codeTextSequence"),a=0,m(d)):oe(d)?(e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),c):(e.enter("codeTextData"),u(d))}function u(d){return d===null||d===32||d===96||oe(d)?(e.exit("codeTextData"),c(d)):(e.consume(d),u)}function m(d){return d===96?(e.consume(d),a++,m):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),t(d)):(i.type="codeTextData",u(d))}}class hj{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(t,r):t>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(t,n,r){const a=n||0;this.setCursor(Math.trunc(t));const i=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Ya(this.left,r),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),Ya(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),Ya(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const n=this.left.splice(t,Number.POSITIVE_INFINITY);Ya(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);Ya(this.left,n.reverse())}}}function Ya(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function a1(e){const t={};let n=-1,r,a,i,l,o,c,u;const m=new hj(e);for(;++n<m.length;){for(;n in t;)n=t[n];if(r=m.get(n),n&&r[1].type==="chunkFlow"&&m.get(n-1)[1].type==="listItemPrefix"&&(c=r[1]._tokenizer.events,i=0,i<c.length&&c[i][1].type==="lineEndingBlank"&&(i+=2),i<c.length&&c[i][1].type==="content"))for(;++i<c.length&&c[i][1].type!=="content";)c[i][1].type==="chunkText"&&(c[i][1]._isInFirstContentOfListItem=!0,i++);if(r[0]==="enter")r[1].contentType&&(Object.assign(t,mj(m,n)),n=t[n],u=!0);else if(r[1]._container){for(i=n,a=void 0;i--;)if(l=m.get(i),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(m.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=i);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(r[1].end={...m.get(a)[1].start},o=m.slice(a,n),o.unshift(r),m.splice(a,n-a+1,o))}}return Zt(e,0,Number.POSITIVE_INFINITY,m.slice(0)),!u}function mj(e,t){const n=e.get(t)[1],r=e.get(t)[2];let a=t-1;const i=[];let l=n._tokenizer;l||(l=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const o=l.events,c=[],u={};let m,d,p=-1,f=n,g=0,v=0;const T=[v];for(;f;){for(;e.get(++a)[1]!==f;);i.push(a),f._tokenizer||(m=r.sliceStream(f),f.next||m.push(null),d&&l.defineSkip(f.start),f._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(m),f._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),d=f,f=f.next}for(f=n;++p<o.length;)o[p][0]==="exit"&&o[p-1][0]==="enter"&&o[p][1].type===o[p-1][1].type&&o[p][1].start.line!==o[p][1].end.line&&(v=p+1,T.push(v),f._tokenizer=void 0,f.previous=void 0,f=f.next);for(l.events=[],f?(f._tokenizer=void 0,f.previous=void 0):T.pop(),p=T.length;p--;){const y=o.slice(T[p],T[p+1]),b=i.pop();c.push([b,b+y.length-1]),e.splice(b,2,y)}for(c.reverse(),p=-1;++p<c.length;)u[g+c[p][0]]=g+c[p][1],g+=c[p][1]-c[p][0]-1;return u}const fj={resolve:gj,tokenize:xj},pj={partial:!0,tokenize:yj};function gj(e){return a1(e),e}function xj(e,t){let n;return r;function r(o){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),a(o)}function a(o){return o===null?i(o):oe(o)?e.check(pj,l,i)(o):(e.consume(o),a)}function i(o){return e.exit("chunkContent"),e.exit("content"),t(o)}function l(o){return e.consume(o),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,a}}function yj(e,t,n){const r=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),ke(e,i,"linePrefix")}function i(l){if(l===null||oe(l))return n(l);const o=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(l):e.interrupt(r.parser.constructs.flow,n,t)(l)}}function i1(e,t,n,r,a,i,l,o,c){const u=c||Number.POSITIVE_INFINITY;let m=0;return d;function d(y){return y===60?(e.enter(r),e.enter(a),e.enter(i),e.consume(y),e.exit(i),p):y===null||y===32||y===41||_o(y)?n(y):(e.enter(r),e.enter(l),e.enter(o),e.enter("chunkString",{contentType:"string"}),v(y))}function p(y){return y===62?(e.enter(i),e.consume(y),e.exit(i),e.exit(a),e.exit(r),t):(e.enter(o),e.enter("chunkString",{contentType:"string"}),f(y))}function f(y){return y===62?(e.exit("chunkString"),e.exit(o),p(y)):y===null||y===60||oe(y)?n(y):(e.consume(y),y===92?g:f)}function g(y){return y===60||y===62||y===92?(e.consume(y),f):f(y)}function v(y){return!m&&(y===null||y===41||Me(y))?(e.exit("chunkString"),e.exit(o),e.exit(l),e.exit(r),t(y)):m<u&&y===40?(e.consume(y),m++,v):y===41?(e.consume(y),m--,v):y===null||y===32||y===40||_o(y)?n(y):(e.consume(y),y===92?T:v)}function T(y){return y===40||y===41||y===92?(e.consume(y),v):v(y)}}function l1(e,t,n,r,a,i){const l=this;let o=0,c;return u;function u(f){return e.enter(r),e.enter(a),e.consume(f),e.exit(a),e.enter(i),m}function m(f){return o>999||f===null||f===91||f===93&&!c||f===94&&!o&&"_hiddenFootnoteSupport"in l.parser.constructs?n(f):f===93?(e.exit(i),e.enter(a),e.consume(f),e.exit(a),e.exit(r),t):oe(f)?(e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),m):(e.enter("chunkString",{contentType:"string"}),d(f))}function d(f){return f===null||f===91||f===93||oe(f)||o++>999?(e.exit("chunkString"),m(f)):(e.consume(f),c||(c=!Ne(f)),f===92?p:d)}function p(f){return f===91||f===92||f===93?(e.consume(f),o++,d):d(f)}}function o1(e,t,n,r,a,i){let l;return o;function o(p){return p===34||p===39||p===40?(e.enter(r),e.enter(a),e.consume(p),e.exit(a),l=p===40?41:p,c):n(p)}function c(p){return p===l?(e.enter(a),e.consume(p),e.exit(a),e.exit(r),t):(e.enter(i),u(p))}function u(p){return p===l?(e.exit(i),c(l)):p===null?n(p):oe(p)?(e.enter("lineEnding"),e.consume(p),e.exit("lineEnding"),ke(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),m(p))}function m(p){return p===l||p===null||oe(p)?(e.exit("chunkString"),u(p)):(e.consume(p),p===92?d:m)}function d(p){return p===l||p===92?(e.consume(p),m):m(p)}}function hi(e,t){let n;return r;function r(a){return oe(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),n=!0,r):Ne(a)?ke(e,r,n?"linePrefix":"lineSuffix")(a):t(a)}}const bj={name:"definition",tokenize:Ej},vj={partial:!0,tokenize:Nj};function Ej(e,t,n){const r=this;let a;return i;function i(f){return e.enter("definition"),l(f)}function l(f){return l1.call(r,e,o,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(f)}function o(f){return a=An(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),f===58?(e.enter("definitionMarker"),e.consume(f),e.exit("definitionMarker"),c):n(f)}function c(f){return Me(f)?hi(e,u)(f):u(f)}function u(f){return i1(e,m,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(f)}function m(f){return e.attempt(vj,d,d)(f)}function d(f){return Ne(f)?ke(e,p,"whitespace")(f):p(f)}function p(f){return f===null||oe(f)?(e.exit("definition"),r.parser.defined.push(a),t(f)):n(f)}}function Nj(e,t,n){return r;function r(o){return Me(o)?hi(e,a)(o):n(o)}function a(o){return o1(e,i,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(o)}function i(o){return Ne(o)?ke(e,l,"whitespace")(o):l(o)}function l(o){return o===null||oe(o)?t(o):n(o)}}const Tj={name:"hardBreakEscape",tokenize:wj};function wj(e,t,n){return r;function r(i){return e.enter("hardBreakEscape"),e.consume(i),a}function a(i){return oe(i)?(e.exit("hardBreakEscape"),t(i)):n(i)}}const Sj={name:"headingAtx",resolve:Cj,tokenize:kj};function Cj(e,t){let n=e.length-2,r=3,a,i;return e[r][1].type==="whitespace"&&(r+=2),n-2>r&&e[n][1].type==="whitespace"&&(n-=2),e[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&e[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[n][1].end},i={type:"chunkText",start:e[r][1].start,end:e[n][1].end,contentType:"text"},Zt(e,r,n-r+1,[["enter",a,t],["enter",i,t],["exit",i,t],["exit",a,t]])),e}function kj(e,t,n){let r=0;return a;function a(m){return e.enter("atxHeading"),i(m)}function i(m){return e.enter("atxHeadingSequence"),l(m)}function l(m){return m===35&&r++<6?(e.consume(m),l):m===null||Me(m)?(e.exit("atxHeadingSequence"),o(m)):n(m)}function o(m){return m===35?(e.enter("atxHeadingSequence"),c(m)):m===null||oe(m)?(e.exit("atxHeading"),t(m)):Ne(m)?ke(e,o,"whitespace")(m):(e.enter("atxHeadingText"),u(m))}function c(m){return m===35?(e.consume(m),c):(e.exit("atxHeadingSequence"),o(m))}function u(m){return m===null||m===35||Me(m)?(e.exit("atxHeadingText"),o(m)):(e.consume(m),u)}}const jj=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Op=["pre","script","style","textarea"],Aj={concrete:!0,name:"htmlFlow",resolveTo:Lj,tokenize:Rj},_j={partial:!0,tokenize:Mj},Ij={partial:!0,tokenize:Pj};function Lj(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function Rj(e,t,n){const r=this;let a,i,l,o,c;return u;function u(_){return m(_)}function m(_){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(_),d}function d(_){return _===33?(e.consume(_),p):_===47?(e.consume(_),i=!0,v):_===63?(e.consume(_),a=3,r.interrupt?t:k):jt(_)?(e.consume(_),l=String.fromCharCode(_),T):n(_)}function p(_){return _===45?(e.consume(_),a=2,f):_===91?(e.consume(_),a=5,o=0,g):jt(_)?(e.consume(_),a=4,r.interrupt?t:k):n(_)}function f(_){return _===45?(e.consume(_),r.interrupt?t:k):n(_)}function g(_){const ce="CDATA[";return _===ce.charCodeAt(o++)?(e.consume(_),o===ce.length?r.interrupt?t:M:g):n(_)}function v(_){return jt(_)?(e.consume(_),l=String.fromCharCode(_),T):n(_)}function T(_){if(_===null||_===47||_===62||Me(_)){const ce=_===47,qe=l.toLowerCase();return!ce&&!i&&Op.includes(qe)?(a=1,r.interrupt?t(_):M(_)):jj.includes(l.toLowerCase())?(a=6,ce?(e.consume(_),y):r.interrupt?t(_):M(_)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(_):i?b(_):x(_))}return _===45||Nt(_)?(e.consume(_),l+=String.fromCharCode(_),T):n(_)}function y(_){return _===62?(e.consume(_),r.interrupt?t:M):n(_)}function b(_){return Ne(_)?(e.consume(_),b):A(_)}function x(_){return _===47?(e.consume(_),A):_===58||_===95||jt(_)?(e.consume(_),I):Ne(_)?(e.consume(_),x):A(_)}function I(_){return _===45||_===46||_===58||_===95||Nt(_)?(e.consume(_),I):C(_)}function C(_){return _===61?(e.consume(_),E):Ne(_)?(e.consume(_),C):x(_)}function E(_){return _===null||_===60||_===61||_===62||_===96?n(_):_===34||_===39?(e.consume(_),c=_,N):Ne(_)?(e.consume(_),E):O(_)}function N(_){return _===c?(e.consume(_),c=null,D):_===null||oe(_)?n(_):(e.consume(_),N)}function O(_){return _===null||_===34||_===39||_===47||_===60||_===61||_===62||_===96||Me(_)?C(_):(e.consume(_),O)}function D(_){return _===47||_===62||Ne(_)?x(_):n(_)}function A(_){return _===62?(e.consume(_),z):n(_)}function z(_){return _===null||oe(_)?M(_):Ne(_)?(e.consume(_),z):n(_)}function M(_){return _===45&&a===2?(e.consume(_),P):_===60&&a===1?(e.consume(_),q):_===62&&a===4?(e.consume(_),le):_===63&&a===3?(e.consume(_),k):_===93&&a===5?(e.consume(_),W):oe(_)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(_j,xe,R)(_)):_===null||oe(_)?(e.exit("htmlFlowData"),R(_)):(e.consume(_),M)}function R(_){return e.check(Ij,H,xe)(_)}function H(_){return e.enter("lineEnding"),e.consume(_),e.exit("lineEnding"),Y}function Y(_){return _===null||oe(_)?R(_):(e.enter("htmlFlowData"),M(_))}function P(_){return _===45?(e.consume(_),k):M(_)}function q(_){return _===47?(e.consume(_),l="",B):M(_)}function B(_){if(_===62){const ce=l.toLowerCase();return Op.includes(ce)?(e.consume(_),le):M(_)}return jt(_)&&l.length<8?(e.consume(_),l+=String.fromCharCode(_),B):M(_)}function W(_){return _===93?(e.consume(_),k):M(_)}function k(_){return _===62?(e.consume(_),le):_===45&&a===2?(e.consume(_),k):M(_)}function le(_){return _===null||oe(_)?(e.exit("htmlFlowData"),xe(_)):(e.consume(_),le)}function xe(_){return e.exit("htmlFlow"),t(_)}}function Pj(e,t,n){const r=this;return a;function a(l){return oe(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),i):n(l)}function i(l){return r.parser.lazy[r.now().line]?n(l):t(l)}}function Mj(e,t,n){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(el,t,n)}}const Oj={name:"htmlText",tokenize:Dj};function Dj(e,t,n){const r=this;let a,i,l;return o;function o(k){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(k),c}function c(k){return k===33?(e.consume(k),u):k===47?(e.consume(k),C):k===63?(e.consume(k),x):jt(k)?(e.consume(k),O):n(k)}function u(k){return k===45?(e.consume(k),m):k===91?(e.consume(k),i=0,g):jt(k)?(e.consume(k),b):n(k)}function m(k){return k===45?(e.consume(k),f):n(k)}function d(k){return k===null?n(k):k===45?(e.consume(k),p):oe(k)?(l=d,q(k)):(e.consume(k),d)}function p(k){return k===45?(e.consume(k),f):d(k)}function f(k){return k===62?P(k):k===45?p(k):d(k)}function g(k){const le="CDATA[";return k===le.charCodeAt(i++)?(e.consume(k),i===le.length?v:g):n(k)}function v(k){return k===null?n(k):k===93?(e.consume(k),T):oe(k)?(l=v,q(k)):(e.consume(k),v)}function T(k){return k===93?(e.consume(k),y):v(k)}function y(k){return k===62?P(k):k===93?(e.consume(k),y):v(k)}function b(k){return k===null||k===62?P(k):oe(k)?(l=b,q(k)):(e.consume(k),b)}function x(k){return k===null?n(k):k===63?(e.consume(k),I):oe(k)?(l=x,q(k)):(e.consume(k),x)}function I(k){return k===62?P(k):x(k)}function C(k){return jt(k)?(e.consume(k),E):n(k)}function E(k){return k===45||Nt(k)?(e.consume(k),E):N(k)}function N(k){return oe(k)?(l=N,q(k)):Ne(k)?(e.consume(k),N):P(k)}function O(k){return k===45||Nt(k)?(e.consume(k),O):k===47||k===62||Me(k)?D(k):n(k)}function D(k){return k===47?(e.consume(k),P):k===58||k===95||jt(k)?(e.consume(k),A):oe(k)?(l=D,q(k)):Ne(k)?(e.consume(k),D):P(k)}function A(k){return k===45||k===46||k===58||k===95||Nt(k)?(e.consume(k),A):z(k)}function z(k){return k===61?(e.consume(k),M):oe(k)?(l=z,q(k)):Ne(k)?(e.consume(k),z):D(k)}function M(k){return k===null||k===60||k===61||k===62||k===96?n(k):k===34||k===39?(e.consume(k),a=k,R):oe(k)?(l=M,q(k)):Ne(k)?(e.consume(k),M):(e.consume(k),H)}function R(k){return k===a?(e.consume(k),a=void 0,Y):k===null?n(k):oe(k)?(l=R,q(k)):(e.consume(k),R)}function H(k){return k===null||k===34||k===39||k===60||k===61||k===96?n(k):k===47||k===62||Me(k)?D(k):(e.consume(k),H)}function Y(k){return k===47||k===62||Me(k)?D(k):n(k)}function P(k){return k===62?(e.consume(k),e.exit("htmlTextData"),e.exit("htmlText"),t):n(k)}function q(k){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(k),e.exit("lineEnding"),B}function B(k){return Ne(k)?ke(e,W,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(k):W(k)}function W(k){return e.enter("htmlTextData"),l(k)}}const gm={name:"labelEnd",resolveAll:Hj,resolveTo:zj,tokenize:$j},Fj={tokenize:qj},Bj={tokenize:Vj},Uj={tokenize:Yj};function Hj(e){let t=-1;const n=[];for(;++t<e.length;){const r=e[t][1];if(n.push(e[t]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",t+=a}}return e.length!==n.length&&Zt(e,0,e.length,n),e}function zj(e,t){let n=e.length,r=0,a,i,l,o;for(;n--;)if(a=e[n][1],i){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[n][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[n][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(i=n,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(l=n);const c={type:e[i][1].type==="labelLink"?"link":"image",start:{...e[i][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[i][1].start},end:{...e[l][1].end}},m={type:"labelText",start:{...e[i+r+2][1].end},end:{...e[l-2][1].start}};return o=[["enter",c,t],["enter",u,t]],o=on(o,e.slice(i+1,i+r+3)),o=on(o,[["enter",m,t]]),o=on(o,dc(t.parser.constructs.insideSpan.null,e.slice(i+r+4,l-3),t)),o=on(o,[["exit",m,t],e[l-2],e[l-1],["exit",u,t]]),o=on(o,e.slice(l+1)),o=on(o,[["exit",c,t]]),Zt(e,i,e.length,o),e}function $j(e,t,n){const r=this;let a=r.events.length,i,l;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){i=r.events[a][1];break}return o;function o(p){return i?i._inactive?d(p):(l=r.parser.defined.includes(An(r.sliceSerialize({start:i.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(p),e.exit("labelMarker"),e.exit("labelEnd"),c):n(p)}function c(p){return p===40?e.attempt(Fj,m,l?m:d)(p):p===91?e.attempt(Bj,m,l?u:d)(p):l?m(p):d(p)}function u(p){return e.attempt(Uj,m,d)(p)}function m(p){return t(p)}function d(p){return i._balanced=!0,n(p)}}function qj(e,t,n){return r;function r(d){return e.enter("resource"),e.enter("resourceMarker"),e.consume(d),e.exit("resourceMarker"),a}function a(d){return Me(d)?hi(e,i)(d):i(d)}function i(d){return d===41?m(d):i1(e,l,o,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(d)}function l(d){return Me(d)?hi(e,c)(d):m(d)}function o(d){return n(d)}function c(d){return d===34||d===39||d===40?o1(e,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(d):m(d)}function u(d){return Me(d)?hi(e,m)(d):m(d)}function m(d){return d===41?(e.enter("resourceMarker"),e.consume(d),e.exit("resourceMarker"),e.exit("resource"),t):n(d)}}function Vj(e,t,n){const r=this;return a;function a(o){return l1.call(r,e,i,l,"reference","referenceMarker","referenceString")(o)}function i(o){return r.parser.defined.includes(An(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(o):n(o)}function l(o){return n(o)}}function Yj(e,t,n){return r;function r(i){return e.enter("reference"),e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),a}function a(i){return i===93?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):n(i)}}const Wj={name:"labelStartImage",resolveAll:gm.resolveAll,tokenize:Kj};function Kj(e,t,n){const r=this;return a;function a(o){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(o),e.exit("labelImageMarker"),i}function i(o){return o===91?(e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelImage"),l):n(o)}function l(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):t(o)}}const Gj={name:"labelStartLink",resolveAll:gm.resolveAll,tokenize:Qj};function Qj(e,t,n){const r=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),i}function i(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(l):t(l)}}const iu={name:"lineEnding",tokenize:Xj};function Xj(e,t){return n;function n(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),ke(e,t,"linePrefix")}}const Wl={name:"thematicBreak",tokenize:Jj};function Jj(e,t,n){let r=0,a;return i;function i(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,o(u)}function o(u){return u===a?(e.enter("thematicBreakSequence"),c(u)):r>=3&&(u===null||oe(u))?(e.exit("thematicBreak"),t(u)):n(u)}function c(u){return u===a?(e.consume(u),r++,c):(e.exit("thematicBreakSequence"),Ne(u)?ke(e,o,"whitespace")(u):o(u))}}const Dt={continuation:{tokenize:nA},exit:sA,name:"list",tokenize:tA},Zj={partial:!0,tokenize:aA},eA={partial:!0,tokenize:rA};function tA(e,t,n){const r=this,a=r.events[r.events.length-1];let i=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return o;function o(f){const g=r.containerState.type||(f===42||f===43||f===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!r.containerState.marker||f===r.containerState.marker:Md(f)){if(r.containerState.type||(r.containerState.type=g,e.enter(g,{_container:!0})),g==="listUnordered")return e.enter("listItemPrefix"),f===42||f===45?e.check(Wl,n,u)(f):u(f);if(!r.interrupt||f===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),c(f)}return n(f)}function c(f){return Md(f)&&++l<10?(e.consume(f),c):(!r.interrupt||l<2)&&(r.containerState.marker?f===r.containerState.marker:f===41||f===46)?(e.exit("listItemValue"),u(f)):n(f)}function u(f){return e.enter("listItemMarker"),e.consume(f),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||f,e.check(el,r.interrupt?n:m,e.attempt(Zj,p,d))}function m(f){return r.containerState.initialBlankLine=!0,i++,p(f)}function d(f){return Ne(f)?(e.enter("listItemPrefixWhitespace"),e.consume(f),e.exit("listItemPrefixWhitespace"),p):n(f)}function p(f){return r.containerState.size=i+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(f)}}function nA(e,t,n){const r=this;return r.containerState._closeFlow=void 0,e.check(el,a,i);function a(o){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,ke(e,t,"listItemIndent",r.containerState.size+1)(o)}function i(o){return r.containerState.furtherBlankLines||!Ne(o)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,l(o)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(eA,t,l)(o))}function l(o){return r.containerState._closeFlow=!0,r.interrupt=void 0,ke(e,e.attempt(Dt,t,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o)}}function rA(e,t,n){const r=this;return ke(e,a,"listItemIndent",r.containerState.size+1);function a(i){const l=r.events[r.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===r.containerState.size?t(i):n(i)}}function sA(e){e.exit(this.containerState.type)}function aA(e,t,n){const r=this;return ke(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(i){const l=r.events[r.events.length-1];return!Ne(i)&&l&&l[1].type==="listItemPrefixWhitespace"?t(i):n(i)}}const Dp={name:"setextUnderline",resolveTo:iA,tokenize:lA};function iA(e,t){let n=e.length,r,a,i;for(;n--;)if(e[n][0]==="enter"){if(e[n][1].type==="content"){r=n;break}e[n][1].type==="paragraph"&&(a=n)}else e[n][1].type==="content"&&e.splice(n,1),!i&&e[n][1].type==="definition"&&(i=n);const l={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",i?(e.splice(a,0,["enter",l,t]),e.splice(i+1,0,["exit",e[r][1],t]),e[r][1].end={...e[i][1].end}):e[r][1]=l,e.push(["exit",l,t]),e}function lA(e,t,n){const r=this;let a;return i;function i(u){let m=r.events.length,d;for(;m--;)if(r.events[m][1].type!=="lineEnding"&&r.events[m][1].type!=="linePrefix"&&r.events[m][1].type!=="content"){d=r.events[m][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||d)?(e.enter("setextHeadingLine"),a=u,l(u)):n(u)}function l(u){return e.enter("setextHeadingLineSequence"),o(u)}function o(u){return u===a?(e.consume(u),o):(e.exit("setextHeadingLineSequence"),Ne(u)?ke(e,c,"lineSuffix")(u):c(u))}function c(u){return u===null||oe(u)?(e.exit("setextHeadingLine"),t(u)):n(u)}}const oA={tokenize:cA};function cA(e){const t=this,n=e.attempt(el,r,e.attempt(this.parser.constructs.flowInitial,a,ke(e,e.attempt(this.parser.constructs.flow,a,e.attempt(fj,a)),"linePrefix")));return n;function r(i){if(i===null){e.consume(i);return}return e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}function a(i){if(i===null){e.consume(i);return}return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,n}}const uA={resolveAll:u1()},dA=c1("string"),hA=c1("text");function c1(e){return{resolveAll:u1(e==="text"?mA:void 0),tokenize:t};function t(n){const r=this,a=this.parser.constructs[e],i=n.attempt(a,l,o);return l;function l(m){return u(m)?i(m):o(m)}function o(m){if(m===null){n.consume(m);return}return n.enter("data"),n.consume(m),c}function c(m){return u(m)?(n.exit("data"),i(m)):(n.consume(m),c)}function u(m){if(m===null)return!0;const d=a[m];let p=-1;if(d)for(;++p<d.length;){const f=d[p];if(!f.previous||f.previous.call(r,r.previous))return!0}return!1}}}function u1(e){return t;function t(n,r){let a=-1,i;for(;++a<=n.length;)i===void 0?n[a]&&n[a][1].type==="data"&&(i=a,a++):(!n[a]||n[a][1].type!=="data")&&(a!==i+2&&(n[i][1].end=n[a-1][1].end,n.splice(i+2,a-i-2),a=i+2),i=void 0);return e?e(n,r):n}}function mA(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||e[n][1].type==="lineEnding")&&e[n-1][1].type==="data"){const r=e[n-1][1],a=t.sliceStream(r);let i=a.length,l=-1,o=0,c;for(;i--;){const u=a[i];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)o++,l--;if(l)break;l=-1}else if(u===-2)c=!0,o++;else if(u!==-1){i++;break}}if(t._contentTypeTextTrailing&&n===e.length&&(o=0),o){const u={type:n===e.length||c||o<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:i?l:r.start._bufferIndex+l,_index:r.start._index+i,line:r.end.line,column:r.end.column-o,offset:r.end.offset-o},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(n,0,["enter",u,t],["exit",u,t]),n+=2)}n++}return e}const fA={42:Dt,43:Dt,45:Dt,48:Dt,49:Dt,50:Dt,51:Dt,52:Dt,53:Dt,54:Dt,55:Dt,56:Dt,57:Dt,62:n1},pA={91:bj},gA={[-2]:au,[-1]:au,32:au},xA={35:Sj,42:Wl,45:[Dp,Wl],60:Aj,61:Dp,95:Wl,96:Mp,126:Mp},yA={38:s1,92:r1},bA={[-5]:iu,[-4]:iu,[-3]:iu,33:Wj,38:s1,42:Od,60:[Gk,Oj],91:Gj,92:[Tj,r1],93:gm,95:Od,96:oj},vA={null:[Od,uA]},EA={null:[42,95]},NA={null:[]},TA=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:EA,contentInitial:pA,disable:NA,document:fA,flow:xA,flowInitial:gA,insideSpan:vA,string:yA,text:bA},Symbol.toStringTag,{value:"Module"}));function wA(e,t,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const a={},i=[];let l=[],o=[];const c={attempt:N(C),check:N(E),consume:b,enter:x,exit:I,interrupt:N(E,{interrupt:!0})},u={code:null,containerState:{},defineSkip:v,events:[],now:g,parser:e,previous:null,sliceSerialize:p,sliceStream:f,write:d};let m=t.tokenize.call(u,c);return t.resolveAll&&i.push(t),u;function d(z){return l=on(l,z),T(),l[l.length-1]!==null?[]:(O(t,0),u.events=dc(i,u.events,u),u.events)}function p(z,M){return CA(f(z),M)}function f(z){return SA(l,z)}function g(){const{_bufferIndex:z,_index:M,line:R,column:H,offset:Y}=r;return{_bufferIndex:z,_index:M,line:R,column:H,offset:Y}}function v(z){a[z.line]=z.column,A()}function T(){let z;for(;r._index<l.length;){const M=l[r._index];if(typeof M=="string")for(z=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===z&&r._bufferIndex<M.length;)y(M.charCodeAt(r._bufferIndex));else y(M)}}function y(z){m=m(z)}function b(z){oe(z)?(r.line++,r.column=1,r.offset+=z===-3?2:1,A()):z!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===l[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=z}function x(z,M){const R=M||{};return R.type=z,R.start=g(),u.events.push(["enter",R,u]),o.push(R),R}function I(z){const M=o.pop();return M.end=g(),u.events.push(["exit",M,u]),M}function C(z,M){O(z,M.from)}function E(z,M){M.restore()}function N(z,M){return R;function R(H,Y,P){let q,B,W,k;return Array.isArray(H)?xe(H):"tokenize"in H?xe([H]):le(H);function le(we){return Rt;function Rt(rn){const xn=rn!==null&&we[rn],ur=rn!==null&&we.null,Jr=[...Array.isArray(xn)?xn:xn?[xn]:[],...Array.isArray(ur)?ur:ur?[ur]:[]];return xe(Jr)(rn)}}function xe(we){return q=we,B=0,we.length===0?P:_(we[B])}function _(we){return Rt;function Rt(rn){return k=D(),W=we,we.partial||(u.currentConstruct=we),we.name&&u.parser.constructs.disable.null.includes(we.name)?qe():we.tokenize.call(M?Object.assign(Object.create(u),M):u,c,ce,qe)(rn)}}function ce(we){return z(W,k),Y}function qe(we){return k.restore(),++B<q.length?_(q[B]):P}}}function O(z,M){z.resolveAll&&!i.includes(z)&&i.push(z),z.resolve&&Zt(u.events,M,u.events.length-M,z.resolve(u.events.slice(M),u)),z.resolveTo&&(u.events=z.resolveTo(u.events,u))}function D(){const z=g(),M=u.previous,R=u.currentConstruct,H=u.events.length,Y=Array.from(o);return{from:H,restore:P};function P(){r=z,u.previous=M,u.currentConstruct=R,u.events.length=H,o=Y,A()}}function A(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function SA(e,t){const n=t.start._index,r=t.start._bufferIndex,a=t.end._index,i=t.end._bufferIndex;let l;if(n===a)l=[e[n].slice(r,i)];else{if(l=e.slice(n,a),r>-1){const o=l[0];typeof o=="string"?l[0]=o.slice(r):l.shift()}i>0&&l.push(e[a].slice(0,i))}return l}function CA(e,t){let n=-1;const r=[];let a;for(;++n<e.length;){const i=e[n];let l;if(typeof i=="string")l=i;else switch(i){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=t?" ":"	";break}case-1:{if(!t&&a)continue;l=" ";break}default:l=String.fromCharCode(i)}a=i===-2,r.push(l)}return r.join("")}function kA(e){const r={constructs:e1([TA,...(e||{}).extensions||[]]),content:a(zk),defined:[],document:a(qk),flow:a(oA),lazy:{},string:a(dA),text:a(hA)};return r;function a(i){return l;function l(o){return wA(r,i,o)}}}function jA(e){for(;!a1(e););return e}const Fp=/[\0\t\n\r]/g;function AA(){let e=1,t="",n=!0,r;return a;function a(i,l,o){const c=[];let u,m,d,p,f;for(i=t+(typeof i=="string"?i.toString():new TextDecoder(l||void 0).decode(i)),d=0,t="",n&&(i.charCodeAt(0)===65279&&d++,n=void 0);d<i.length;){if(Fp.lastIndex=d,u=Fp.exec(i),p=u&&u.index!==void 0?u.index:i.length,f=i.charCodeAt(p),!u){t=i.slice(d);break}if(f===10&&d===p&&r)c.push(-3),r=void 0;else switch(r&&(c.push(-5),r=void 0),d<p&&(c.push(i.slice(d,p)),e+=p-d),f){case 0:{c.push(65533),e++;break}case 9:{for(m=Math.ceil(e/4)*4,c.push(-2);e++<m;)c.push(-1);break}case 10:{c.push(-4),e=1;break}default:r=!0,e=1}d=p+1}return o&&(r&&c.push(-5),t&&c.push(t),c.push(null)),c}}const _A=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function IA(e){return e.replace(_A,LA)}function LA(e,t,n){if(t)return t;if(n.charCodeAt(0)===35){const a=n.charCodeAt(1),i=a===120||a===88;return t1(n.slice(i?2:1),i?16:10)}return pm(n)||e}const d1={}.hasOwnProperty;function RA(e,t,n){return typeof t!="string"&&(n=t,t=void 0),PA(n)(jA(kA(n).document().write(AA()(e,t,!0))))}function PA(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(yn),autolinkProtocol:D,autolinkEmail:D,atxHeading:i(Vt),blockQuote:i(ur),characterEscape:D,characterReference:D,codeFenced:i(Jr),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:i(Jr,l),codeText:i(V,l),codeTextData:D,data:D,codeFlowValue:D,definition:i(ie),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:i(Ae),hardBreakEscape:i(Zr),hardBreakTrailing:i(Zr),htmlFlow:i(Pt,l),htmlFlowData:D,htmlText:i(Pt,l),htmlTextData:D,image:i(Yn),label:l,link:i(yn),listItem:i(Rn),listItemValue:p,listOrdered:i(ht,d),listUnordered:i(ht),paragraph:i(Lm),reference:_,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:i(Vt),strong:i(Mt),thematicBreak:i(vc)},exit:{atxHeading:c(),atxHeadingSequence:C,autolink:c(),autolinkEmail:xn,autolinkProtocol:rn,blockQuote:c(),characterEscapeValue:A,characterReferenceMarkerHexadecimal:qe,characterReferenceMarkerNumeric:qe,characterReferenceValue:we,characterReference:Rt,codeFenced:c(T),codeFencedFence:v,codeFencedFenceInfo:f,codeFencedFenceMeta:g,codeFlowValue:A,codeIndented:c(y),codeText:c(Y),codeTextData:A,data:A,definition:c(),definitionDestinationString:I,definitionLabelString:b,definitionTitleString:x,emphasis:c(),hardBreakEscape:c(M),hardBreakTrailing:c(M),htmlFlow:c(R),htmlFlowData:A,htmlText:c(H),htmlTextData:A,image:c(q),label:W,labelText:B,lineEnding:z,link:c(P),listItem:c(),listOrdered:c(),listUnordered:c(),paragraph:c(),referenceString:ce,resourceDestinationString:k,resourceTitleString:le,resource:xe,setextHeading:c(O),setextHeadingLineSequence:N,setextHeadingText:E,strong:c(),thematicBreak:c()}};h1(t,(e||{}).mdastExtensions||[]);const n={};return r;function r($){let re={type:"root",children:[]};const me={stack:[re],tokenStack:[],config:t,enter:o,exit:u,buffer:l,resume:m,data:n},Se=[];let Pe=-1;for(;++Pe<$.length;)if($[Pe][1].type==="listOrdered"||$[Pe][1].type==="listUnordered")if($[Pe][0]==="enter")Se.push(Pe);else{const bn=Se.pop();Pe=a($,bn,Pe)}for(Pe=-1;++Pe<$.length;){const bn=t[$[Pe][0]];d1.call(bn,$[Pe][1].type)&&bn[$[Pe][1].type].call(Object.assign({sliceSerialize:$[Pe][2].sliceSerialize},me),$[Pe][1])}if(me.tokenStack.length>0){const bn=me.tokenStack[me.tokenStack.length-1];(bn[1]||Bp).call(me,void 0,bn[0])}for(re.position={start:mr($.length>0?$[0][1].start:{line:1,column:1,offset:0}),end:mr($.length>0?$[$.length-2][1].end:{line:1,column:1,offset:0})},Pe=-1;++Pe<t.transforms.length;)re=t.transforms[Pe](re)||re;return re}function a($,re,me){let Se=re-1,Pe=-1,bn=!1,ts,Wn,_a,Ia;for(;++Se<=me;){const Yt=$[Se];switch(Yt[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Yt[0]==="enter"?Pe++:Pe--,Ia=void 0;break}case"lineEndingBlank":{Yt[0]==="enter"&&(ts&&!Ia&&!Pe&&!_a&&(_a=Se),Ia=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Ia=void 0}if(!Pe&&Yt[0]==="enter"&&Yt[1].type==="listItemPrefix"||Pe===-1&&Yt[0]==="exit"&&(Yt[1].type==="listUnordered"||Yt[1].type==="listOrdered")){if(ts){let _s=Se;for(Wn=void 0;_s--;){const Kn=$[_s];if(Kn[1].type==="lineEnding"||Kn[1].type==="lineEndingBlank"){if(Kn[0]==="exit")continue;Wn&&($[Wn][1].type="lineEndingBlank",bn=!0),Kn[1].type="lineEnding",Wn=_s}else if(!(Kn[1].type==="linePrefix"||Kn[1].type==="blockQuotePrefix"||Kn[1].type==="blockQuotePrefixWhitespace"||Kn[1].type==="blockQuoteMarker"||Kn[1].type==="listItemIndent"))break}_a&&(!Wn||_a<Wn)&&(ts._spread=!0),ts.end=Object.assign({},Wn?$[Wn][1].start:Yt[1].end),$.splice(Wn||Se,0,["exit",ts,Yt[2]]),Se++,me++}if(Yt[1].type==="listItemPrefix"){const _s={type:"listItem",_spread:!1,start:Object.assign({},Yt[1].start),end:void 0};ts=_s,$.splice(Se,0,["enter",_s,Yt[2]]),Se++,me++,_a=void 0,Ia=!0}}}return $[re][1]._spread=bn,me}function i($,re){return me;function me(Se){o.call(this,$(Se),Se),re&&re.call(this,Se)}}function l(){this.stack.push({type:"fragment",children:[]})}function o($,re,me){this.stack[this.stack.length-1].children.push($),this.stack.push($),this.tokenStack.push([re,me||void 0]),$.position={start:mr(re.start),end:void 0}}function c($){return re;function re(me){$&&$.call(this,me),u.call(this,me)}}function u($,re){const me=this.stack.pop(),Se=this.tokenStack.pop();if(Se)Se[0].type!==$.type&&(re?re.call(this,$,Se[0]):(Se[1]||Bp).call(this,$,Se[0]));else throw new Error("Cannot close `"+$.type+"` ("+di({start:$.start,end:$.end})+"): its not open");me.position.end=mr($.end)}function m(){return fm(this.stack.pop())}function d(){this.data.expectingFirstListItemValue=!0}function p($){if(this.data.expectingFirstListItemValue){const re=this.stack[this.stack.length-2];re.start=Number.parseInt(this.sliceSerialize($),10),this.data.expectingFirstListItemValue=void 0}}function f(){const $=this.resume(),re=this.stack[this.stack.length-1];re.lang=$}function g(){const $=this.resume(),re=this.stack[this.stack.length-1];re.meta=$}function v(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const $=this.resume(),re=this.stack[this.stack.length-1];re.value=$.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function y(){const $=this.resume(),re=this.stack[this.stack.length-1];re.value=$.replace(/(\r?\n|\r)$/g,"")}function b($){const re=this.resume(),me=this.stack[this.stack.length-1];me.label=re,me.identifier=An(this.sliceSerialize($)).toLowerCase()}function x(){const $=this.resume(),re=this.stack[this.stack.length-1];re.title=$}function I(){const $=this.resume(),re=this.stack[this.stack.length-1];re.url=$}function C($){const re=this.stack[this.stack.length-1];if(!re.depth){const me=this.sliceSerialize($).length;re.depth=me}}function E(){this.data.setextHeadingSlurpLineEnding=!0}function N($){const re=this.stack[this.stack.length-1];re.depth=this.sliceSerialize($).codePointAt(0)===61?1:2}function O(){this.data.setextHeadingSlurpLineEnding=void 0}function D($){const me=this.stack[this.stack.length-1].children;let Se=me[me.length-1];(!Se||Se.type!=="text")&&(Se=es(),Se.position={start:mr($.start),end:void 0},me.push(Se)),this.stack.push(Se)}function A($){const re=this.stack.pop();re.value+=this.sliceSerialize($),re.position.end=mr($.end)}function z($){const re=this.stack[this.stack.length-1];if(this.data.atHardBreak){const me=re.children[re.children.length-1];me.position.end=mr($.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(re.type)&&(D.call(this,$),A.call(this,$))}function M(){this.data.atHardBreak=!0}function R(){const $=this.resume(),re=this.stack[this.stack.length-1];re.value=$}function H(){const $=this.resume(),re=this.stack[this.stack.length-1];re.value=$}function Y(){const $=this.resume(),re=this.stack[this.stack.length-1];re.value=$}function P(){const $=this.stack[this.stack.length-1];if(this.data.inReference){const re=this.data.referenceType||"shortcut";$.type+="Reference",$.referenceType=re,delete $.url,delete $.title}else delete $.identifier,delete $.label;this.data.referenceType=void 0}function q(){const $=this.stack[this.stack.length-1];if(this.data.inReference){const re=this.data.referenceType||"shortcut";$.type+="Reference",$.referenceType=re,delete $.url,delete $.title}else delete $.identifier,delete $.label;this.data.referenceType=void 0}function B($){const re=this.sliceSerialize($),me=this.stack[this.stack.length-2];me.label=IA(re),me.identifier=An(re).toLowerCase()}function W(){const $=this.stack[this.stack.length-1],re=this.resume(),me=this.stack[this.stack.length-1];if(this.data.inReference=!0,me.type==="link"){const Se=$.children;me.children=Se}else me.alt=re}function k(){const $=this.resume(),re=this.stack[this.stack.length-1];re.url=$}function le(){const $=this.resume(),re=this.stack[this.stack.length-1];re.title=$}function xe(){this.data.inReference=void 0}function _(){this.data.referenceType="collapsed"}function ce($){const re=this.resume(),me=this.stack[this.stack.length-1];me.label=re,me.identifier=An(this.sliceSerialize($)).toLowerCase(),this.data.referenceType="full"}function qe($){this.data.characterReferenceType=$.type}function we($){const re=this.sliceSerialize($),me=this.data.characterReferenceType;let Se;me?(Se=t1(re,me==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Se=pm(re);const Pe=this.stack[this.stack.length-1];Pe.value+=Se}function Rt($){const re=this.stack.pop();re.position.end=mr($.end)}function rn($){A.call(this,$);const re=this.stack[this.stack.length-1];re.url=this.sliceSerialize($)}function xn($){A.call(this,$);const re=this.stack[this.stack.length-1];re.url="mailto:"+this.sliceSerialize($)}function ur(){return{type:"blockquote",children:[]}}function Jr(){return{type:"code",lang:null,meta:null,value:""}}function V(){return{type:"inlineCode",value:""}}function ie(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Ae(){return{type:"emphasis",children:[]}}function Vt(){return{type:"heading",depth:0,children:[]}}function Zr(){return{type:"break"}}function Pt(){return{type:"html",value:""}}function Yn(){return{type:"image",title:null,url:"",alt:null}}function yn(){return{type:"link",title:null,url:"",children:[]}}function ht($){return{type:"list",ordered:$.type==="listOrdered",start:null,spread:$._spread,children:[]}}function Rn($){return{type:"listItem",spread:$._spread,checked:null,children:[]}}function Lm(){return{type:"paragraph",children:[]}}function Mt(){return{type:"strong",children:[]}}function es(){return{type:"text",value:""}}function vc(){return{type:"thematicBreak"}}}function mr(e){return{line:e.line,column:e.column,offset:e.offset}}function h1(e,t){let n=-1;for(;++n<t.length;){const r=t[n];Array.isArray(r)?h1(e,r):MA(e,r)}}function MA(e,t){let n;for(n in t)if(d1.call(t,n))switch(n){case"canContainEols":{const r=t[n];r&&e[n].push(...r);break}case"transforms":{const r=t[n];r&&e[n].push(...r);break}case"enter":case"exit":{const r=t[n];r&&Object.assign(e[n],r);break}}}function Bp(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+di({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+di({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+di({start:t.start,end:t.end})+") is still open")}function OA(e){const t=this;t.parser=n;function n(r){return RA(r,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function DA(e,t){const n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)}function FA(e,t){const n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:`
`}]}function BA(e,t){const n=t.value?t.value+`
`:"",r={};t.lang&&(r.className=["language-"+t.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return t.meta&&(a.data={meta:t.meta}),e.patch(t,a),a=e.applyData(t,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(t,a),a}function UA(e,t){const n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function HA(e,t){const n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function zA(e,t){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(t.identifier).toUpperCase(),a=Sa(r.toLowerCase()),i=e.footnoteOrder.indexOf(r);let l,o=e.footnoteCounts.get(r);o===void 0?(o=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=i+1,o+=1,e.footnoteCounts.set(r,o);const c={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+a,id:n+"fnref-"+a+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(t,c);const u={type:"element",tagName:"sup",properties:{},children:[c]};return e.patch(t,u),e.applyData(t,u)}function $A(e,t){const n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function qA(e,t){if(e.options.allowDangerousHtml){const n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}}function m1(e,t){const n=t.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+r}];const a=e.all(t),i=a[0];i&&i.type==="text"?i.value="["+i.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=r:a.push({type:"text",value:r}),a}function VA(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return m1(e,t);const a={src:Sa(r.url||""),alt:t.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const i={type:"element",tagName:"img",properties:a,children:[]};return e.patch(t,i),e.applyData(t,i)}function YA(e,t){const n={src:Sa(t.url)};t.alt!==null&&t.alt!==void 0&&(n.alt=t.alt),t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,r),e.applyData(t,r)}function WA(e,t){const n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,r),e.applyData(t,r)}function KA(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return m1(e,t);const a={href:Sa(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const i={type:"element",tagName:"a",properties:a,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function GA(e,t){const n={href:Sa(t.url)};t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function QA(e,t,n){const r=e.all(t),a=n?XA(n):f1(t),i={},l=[];if(typeof t.checked=="boolean"){const m=r[0];let d;m&&m.type==="element"&&m.tagName==="p"?d=m:(d={type:"element",tagName:"p",properties:{},children:[]},r.unshift(d)),d.children.length>0&&d.children.unshift({type:"text",value:" "}),d.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let o=-1;for(;++o<r.length;){const m=r[o];(a||o!==0||m.type!=="element"||m.tagName!=="p")&&l.push({type:"text",value:`
`}),m.type==="element"&&m.tagName==="p"&&!a?l.push(...m.children):l.push(m)}const c=r[r.length-1];c&&(a||c.type!=="element"||c.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:i,children:l};return e.patch(t,u),e.applyData(t,u)}function XA(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const n=e.children;let r=-1;for(;!t&&++r<n.length;)t=f1(n[r])}return t}function f1(e){const t=e.spread;return t??e.children.length>1}function JA(e,t){const n={},r=e.all(t);let a=-1;for(typeof t.start=="number"&&t.start!==1&&(n.start=t.start);++a<r.length;){const l=r[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const i={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(r,!0)};return e.patch(t,i),e.applyData(t,i)}function ZA(e,t){const n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function e_(e,t){const n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)}function t_(e,t){const n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function n_(e,t){const n=e.all(t),r=n.shift(),a=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(t.children[0],l),a.push(l)}if(n.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},o=qn(t.children[1]),c=cc(t.children[t.children.length-1]);o&&c&&(l.position={start:o,end:c}),a.push(l)}const i={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(t,i),e.applyData(t,i)}function r_(e,t,n){const r=n?n.children:void 0,i=(r?r.indexOf(t):1)===0?"th":"td",l=n&&n.type==="table"?n.align:void 0,o=l?l.length:t.children.length;let c=-1;const u=[];for(;++c<o;){const d=t.children[c],p={},f=l?l[c]:void 0;f&&(p.align=f);let g={type:"element",tagName:i,properties:p,children:[]};d&&(g.children=e.all(d),e.patch(d,g),g=e.applyData(d,g)),u.push(g)}const m={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(t,m),e.applyData(t,m)}function s_(e,t){const n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}const Up=9,Hp=32;function a_(e){const t=String(e),n=/\r?\n|\r/g;let r=n.exec(t),a=0;const i=[];for(;r;)i.push(zp(t.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=n.exec(t);return i.push(zp(t.slice(a),a>0,!1)),i.join("")}function zp(e,t,n){let r=0,a=e.length;if(t){let i=e.codePointAt(r);for(;i===Up||i===Hp;)r++,i=e.codePointAt(r)}if(n){let i=e.codePointAt(a-1);for(;i===Up||i===Hp;)a--,i=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function i_(e,t){const n={type:"text",value:a_(String(t.value))};return e.patch(t,n),e.applyData(t,n)}function l_(e,t){const n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)}const o_={blockquote:DA,break:FA,code:BA,delete:UA,emphasis:HA,footnoteReference:zA,heading:$A,html:qA,imageReference:VA,image:YA,inlineCode:WA,linkReference:KA,link:GA,listItem:QA,list:JA,paragraph:ZA,root:e_,strong:t_,table:n_,tableCell:s_,tableRow:r_,text:i_,thematicBreak:l_,toml:Sl,yaml:Sl,definition:Sl,footnoteDefinition:Sl};function Sl(){}const p1=-1,hc=0,mi=1,Io=2,xm=3,ym=4,bm=5,vm=6,g1=7,x1=8,$p=typeof self=="object"?self:globalThis,c_=(e,t)=>{const n=(a,i)=>(e.set(i,a),a),r=a=>{if(e.has(a))return e.get(a);const[i,l]=t[a];switch(i){case hc:case p1:return n(l,a);case mi:{const o=n([],a);for(const c of l)o.push(r(c));return o}case Io:{const o=n({},a);for(const[c,u]of l)o[r(c)]=r(u);return o}case xm:return n(new Date(l),a);case ym:{const{source:o,flags:c}=l;return n(new RegExp(o,c),a)}case bm:{const o=n(new Map,a);for(const[c,u]of l)o.set(r(c),r(u));return o}case vm:{const o=n(new Set,a);for(const c of l)o.add(r(c));return o}case g1:{const{name:o,message:c}=l;return n(new $p[o](c),a)}case x1:return n(BigInt(l),a);case"BigInt":return n(Object(BigInt(l)),a);case"ArrayBuffer":return n(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:o}=new Uint8Array(l);return n(new DataView(o),l)}}return n(new $p[i](l),a)};return r},qp=e=>c_(new Map,e)(0),Ls="",{toString:u_}={},{keys:d_}=Object,Wa=e=>{const t=typeof e;if(t!=="object"||!e)return[hc,t];const n=u_.call(e).slice(8,-1);switch(n){case"Array":return[mi,Ls];case"Object":return[Io,Ls];case"Date":return[xm,Ls];case"RegExp":return[ym,Ls];case"Map":return[bm,Ls];case"Set":return[vm,Ls];case"DataView":return[mi,n]}return n.includes("Array")?[mi,n]:n.includes("Error")?[g1,n]:[Io,n]},Cl=([e,t])=>e===hc&&(t==="function"||t==="symbol"),h_=(e,t,n,r)=>{const a=(l,o)=>{const c=r.push(l)-1;return n.set(o,c),c},i=l=>{if(n.has(l))return n.get(l);let[o,c]=Wa(l);switch(o){case hc:{let m=l;switch(c){case"bigint":o=x1,m=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+c);m=null;break;case"undefined":return a([p1],l)}return a([o,m],l)}case mi:{if(c){let p=l;return c==="DataView"?p=new Uint8Array(l.buffer):c==="ArrayBuffer"&&(p=new Uint8Array(l)),a([c,[...p]],l)}const m=[],d=a([o,m],l);for(const p of l)m.push(i(p));return d}case Io:{if(c)switch(c){case"BigInt":return a([c,l.toString()],l);case"Boolean":case"Number":case"String":return a([c,l.valueOf()],l)}if(t&&"toJSON"in l)return i(l.toJSON());const m=[],d=a([o,m],l);for(const p of d_(l))(e||!Cl(Wa(l[p])))&&m.push([i(p),i(l[p])]);return d}case xm:return a([o,l.toISOString()],l);case ym:{const{source:m,flags:d}=l;return a([o,{source:m,flags:d}],l)}case bm:{const m=[],d=a([o,m],l);for(const[p,f]of l)(e||!(Cl(Wa(p))||Cl(Wa(f))))&&m.push([i(p),i(f)]);return d}case vm:{const m=[],d=a([o,m],l);for(const p of l)(e||!Cl(Wa(p)))&&m.push(i(p));return d}}const{message:u}=l;return a([o,{name:c,message:u}],l)};return i},Vp=(e,{json:t,lossy:n}={})=>{const r=[];return h_(!(t||n),!!t,new Map,r)(e),r},ma=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?qp(Vp(e,t)):structuredClone(e):(e,t)=>qp(Vp(e,t));function m_(e,t){const n=[{type:"text",value:""}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function f_(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function p_(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||m_,r=e.options.footnoteBackLabel||f_,a=e.options.footnoteLabel||"Footnotes",i=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let c=-1;for(;++c<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[c]);if(!u)continue;const m=e.all(u),d=String(u.identifier).toUpperCase(),p=Sa(d.toLowerCase());let f=0;const g=[],v=e.footnoteCounts.get(d);for(;v!==void 0&&++f<=v;){g.length>0&&g.push({type:"text",value:" "});let b=typeof n=="string"?n:n(c,f);typeof b=="string"&&(b={type:"text",value:b}),g.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+p+(f>1?"-"+f:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(c,f),className:["data-footnote-backref"]},children:Array.isArray(b)?b:[b]})}const T=m[m.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const b=T.children[T.children.length-1];b&&b.type==="text"?b.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...g)}else m.push(...g);const y={type:"element",tagName:"li",properties:{id:t+"fn-"+p},children:e.wrap(m,!0)};e.patch(u,y),o.push(y)}if(o.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...ma(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(o,!0)},{type:"text",value:`
`}]}}const mc=function(e){if(e==null)return b_;if(typeof e=="function")return fc(e);if(typeof e=="object")return Array.isArray(e)?g_(e):x_(e);if(typeof e=="string")return y_(e);throw new Error("Expected function, string, or object as test")};function g_(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=mc(e[n]);return fc(r);function r(...a){let i=-1;for(;++i<t.length;)if(t[i].apply(this,a))return!0;return!1}}function x_(e){const t=e;return fc(n);function n(r){const a=r;let i;for(i in e)if(a[i]!==t[i])return!1;return!0}}function y_(e){return fc(t);function t(n){return n&&n.type===e}}function fc(e){return t;function t(n,r,a){return!!(v_(n)&&e.call(this,n,typeof r=="number"?r:void 0,a||void 0))}}function b_(){return!0}function v_(e){return e!==null&&typeof e=="object"&&"type"in e}const y1=[],E_=!0,Dd=!1,N_="skip";function b1(e,t,n,r){let a;typeof t=="function"&&typeof n!="function"?(r=n,n=t):a=t;const i=mc(a),l=r?-1:1;o(e,void 0,[])();function o(c,u,m){const d=c&&typeof c=="object"?c:{};if(typeof d.type=="string"){const f=typeof d.tagName=="string"?d.tagName:typeof d.name=="string"?d.name:void 0;Object.defineProperty(p,"name",{value:"node ("+(c.type+(f?"<"+f+">":""))+")"})}return p;function p(){let f=y1,g,v,T;if((!t||i(c,u,m[m.length-1]||void 0))&&(f=T_(n(c,m)),f[0]===Dd))return f;if("children"in c&&c.children){const y=c;if(y.children&&f[0]!==N_)for(v=(r?y.children.length:-1)+l,T=m.concat(y);v>-1&&v<y.children.length;){const b=y.children[v];if(g=o(b,v,T)(),g[0]===Dd)return g;v=typeof g[1]=="number"?g[1]:v+l}}return f}}}function T_(e){return Array.isArray(e)?e:typeof e=="number"?[E_,e]:e==null?y1:[e]}function pc(e,t,n,r){let a,i,l;typeof t=="function"&&typeof n!="function"?(i=void 0,l=t,a=n):(i=t,l=n,a=r),b1(e,i,o,a);function o(c,u){const m=u[u.length-1],d=m?m.children.indexOf(c):void 0;return l(c,d,m)}}const Fd={}.hasOwnProperty,w_={};function S_(e,t){const n=t||w_,r=new Map,a=new Map,i=new Map,l={...o_,...n.handlers},o={all:u,applyData:k_,definitionById:r,footnoteById:a,footnoteCounts:i,footnoteOrder:[],handlers:l,one:c,options:n,patch:C_,wrap:A_};return pc(e,function(m){if(m.type==="definition"||m.type==="footnoteDefinition"){const d=m.type==="definition"?r:a,p=String(m.identifier).toUpperCase();d.has(p)||d.set(p,m)}}),o;function c(m,d){const p=m.type,f=o.handlers[p];if(Fd.call(o.handlers,p)&&f)return f(o,m,d);if(o.options.passThrough&&o.options.passThrough.includes(p)){if("children"in m){const{children:v,...T}=m,y=ma(T);return y.children=o.all(m),y}return ma(m)}return(o.options.unknownHandler||j_)(o,m,d)}function u(m){const d=[];if("children"in m){const p=m.children;let f=-1;for(;++f<p.length;){const g=o.one(p[f],m);if(g){if(f&&p[f-1].type==="break"&&(!Array.isArray(g)&&g.type==="text"&&(g.value=Yp(g.value)),!Array.isArray(g)&&g.type==="element")){const v=g.children[0];v&&v.type==="text"&&(v.value=Yp(v.value))}Array.isArray(g)?d.push(...g):d.push(g)}}}return d}}function C_(e,t){e.position&&(t.position=fk(e))}function k_(e,t){let n=t;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,i=e.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const l="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:l}}n.type==="element"&&i&&Object.assign(n.properties,ma(i)),"children"in n&&n.children&&a!==null&&a!==void 0&&(n.children=a)}return n}function j_(e,t){const n=t.data||{},r="value"in t&&!(Fd.call(n,"hProperties")||Fd.call(n,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function A_(e,t){const n=[];let r=-1;for(t&&n.push({type:"text",value:`
`});++r<e.length;)r&&n.push({type:"text",value:`
`}),n.push(e[r]);return t&&e.length>0&&n.push({type:"text",value:`
`}),n}function Yp(e){let t=0,n=e.charCodeAt(t);for(;n===9||n===32;)t++,n=e.charCodeAt(t);return e.slice(t)}function Wp(e,t){const n=S_(e,t),r=n.one(e,void 0),a=p_(n),i=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&i.children.push({type:"text",value:`
`},a),i}function __(e,t){return e&&"run"in e?async function(n,r){const a=Wp(n,{file:r,...t});await e.run(a,r)}:function(n,r){return Wp(n,{file:r,...e||t})}}function Kp(e){if(e)throw e}var Kl=Object.prototype.hasOwnProperty,v1=Object.prototype.toString,Gp=Object.defineProperty,Qp=Object.getOwnPropertyDescriptor,Xp=function(t){return typeof Array.isArray=="function"?Array.isArray(t):v1.call(t)==="[object Array]"},Jp=function(t){if(!t||v1.call(t)!=="[object Object]")return!1;var n=Kl.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&Kl.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;var a;for(a in t);return typeof a>"u"||Kl.call(t,a)},Zp=function(t,n){Gp&&n.name==="__proto__"?Gp(t,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):t[n.name]=n.newValue},e0=function(t,n){if(n==="__proto__")if(Kl.call(t,n)){if(Qp)return Qp(t,n).value}else return;return t[n]},I_=function e(){var t,n,r,a,i,l,o=arguments[0],c=1,u=arguments.length,m=!1;for(typeof o=="boolean"&&(m=o,o=arguments[1]||{},c=2),(o==null||typeof o!="object"&&typeof o!="function")&&(o={});c<u;++c)if(t=arguments[c],t!=null)for(n in t)r=e0(o,n),a=e0(t,n),o!==a&&(m&&a&&(Jp(a)||(i=Xp(a)))?(i?(i=!1,l=r&&Xp(r)?r:[]):l=r&&Jp(r)?r:{},Zp(o,{name:n,newValue:e(m,l,a)})):typeof a<"u"&&Zp(o,{name:n,newValue:a}));return o};const lu=Oo(I_);function Bd(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function L_(){const e=[],t={run:n,use:r};return t;function n(...a){let i=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);o(null,...a);function o(c,...u){const m=e[++i];let d=-1;if(c){l(c);return}for(;++d<a.length;)(u[d]===null||u[d]===void 0)&&(u[d]=a[d]);a=u,m?R_(m,o)(...u):l(null,...u)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),t}}function R_(e,t){let n;return r;function r(...l){const o=e.length>l.length;let c;o&&l.push(a);try{c=e.apply(this,l)}catch(u){const m=u;if(o&&n)throw m;return a(m)}o||(c&&c.then&&typeof c.then=="function"?c.then(i,a):c instanceof Error?a(c):i(c))}function a(l,...o){n||(n=!0,t(l,...o))}function i(l){a(null,l)}}const On={basename:P_,dirname:M_,extname:O_,join:D_,sep:"/"};function P_(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');tl(e);let n=0,r=-1,a=e.length,i;if(t===void 0||t.length===0||t.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(i){n=a+1;break}}else r<0&&(i=!0,r=a+1);return r<0?"":e.slice(n,r)}if(t===e)return"";let l=-1,o=t.length-1;for(;a--;)if(e.codePointAt(a)===47){if(i){n=a+1;break}}else l<0&&(i=!0,l=a+1),o>-1&&(e.codePointAt(a)===t.codePointAt(o--)?o<0&&(r=a):(o=-1,r=l));return n===r?r=l:r<0&&(r=e.length),e.slice(n,r)}function M_(e){if(tl(e),e.length===0)return".";let t=-1,n=e.length,r;for(;--n;)if(e.codePointAt(n)===47){if(r){t=n;break}}else r||(r=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function O_(e){tl(e);let t=e.length,n=-1,r=0,a=-1,i=0,l;for(;t--;){const o=e.codePointAt(t);if(o===47){if(l){r=t+1;break}continue}n<0&&(l=!0,n=t+1),o===46?a<0?a=t:i!==1&&(i=1):a>-1&&(i=-1)}return a<0||n<0||i===0||i===1&&a===n-1&&a===r+1?"":e.slice(a,n)}function D_(...e){let t=-1,n;for(;++t<e.length;)tl(e[t]),e[t]&&(n=n===void 0?e[t]:n+"/"+e[t]);return n===void 0?".":F_(n)}function F_(e){tl(e);const t=e.codePointAt(0)===47;let n=B_(e,!t);return n.length===0&&!t&&(n="."),n.length>0&&e.codePointAt(e.length-1)===47&&(n+="/"),t?"/"+n:n}function B_(e,t){let n="",r=0,a=-1,i=0,l=-1,o,c;for(;++l<=e.length;){if(l<e.length)o=e.codePointAt(l);else{if(o===47)break;o=47}if(o===47){if(!(a===l-1||i===1))if(a!==l-1&&i===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(c=n.lastIndexOf("/"),c!==n.length-1){c<0?(n="",r=0):(n=n.slice(0,c),r=n.length-1-n.lastIndexOf("/")),a=l,i=0;continue}}else if(n.length>0){n="",r=0,a=l,i=0;continue}}t&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(a+1,l):n=e.slice(a+1,l),r=l-a-1;a=l,i=0}else o===46&&i>-1?i++:i=-1}return n}function tl(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const U_={cwd:H_};function H_(){return"/"}function Ud(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function z_(e){if(typeof e=="string")e=new URL(e);else if(!Ud(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return $_(e)}function $_(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const t=e.pathname;let n=-1;for(;++n<t.length;)if(t.codePointAt(n)===37&&t.codePointAt(n+1)===50){const r=t.codePointAt(n+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(t)}const ou=["history","path","basename","stem","extname","dirname"];class E1{constructor(t){let n;t?Ud(t)?n={path:t}:typeof t=="string"||q_(t)?n={value:t}:n=t:n={},this.cwd="cwd"in n?"":U_.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<ou.length;){const i=ou[r];i in n&&n[i]!==void 0&&n[i]!==null&&(this[i]=i==="history"?[...n[i]]:n[i])}let a;for(a in n)ou.includes(a)||(this[a]=n[a])}get basename(){return typeof this.path=="string"?On.basename(this.path):void 0}set basename(t){uu(t,"basename"),cu(t,"basename"),this.path=On.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?On.dirname(this.path):void 0}set dirname(t){t0(this.basename,"dirname"),this.path=On.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?On.extname(this.path):void 0}set extname(t){if(cu(t,"extname"),t0(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=On.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){Ud(t)&&(t=z_(t)),uu(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?On.basename(this.path,this.extname):void 0}set stem(t){uu(t,"stem"),cu(t,"stem"),this.path=On.join(this.dirname||"",t+(this.extname||""))}fail(t,n,r){const a=this.message(t,n,r);throw a.fatal=!0,a}info(t,n,r){const a=this.message(t,n,r);return a.fatal=void 0,a}message(t,n,r){const a=new St(t,n,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function cu(e,t){if(e&&e.includes(On.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+On.sep+"`")}function uu(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function t0(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function q_(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const V_=function(e){const r=this.constructor.prototype,a=r[e],i=function(){return a.apply(i,arguments)};return Object.setPrototypeOf(i,r),i},Y_={}.hasOwnProperty;class Em extends V_{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=L_()}copy(){const t=new Em;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];t.use(...r)}return t.data(lu(!0,{},this.namespace)),t}data(t,n){return typeof t=="string"?arguments.length===2?(mu("data",this.frozen),this.namespace[t]=n,this):Y_.call(this.namespace,t)&&this.namespace[t]||void 0:t?(mu("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=n.call(t,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const n=kl(t),r=this.parser||this.Parser;return du("parse",r),r(String(n),n)}process(t,n){const r=this;return this.freeze(),du("process",this.parser||this.Parser),hu("process",this.compiler||this.Compiler),n?a(void 0,n):new Promise(a);function a(i,l){const o=kl(t),c=r.parse(o);r.run(c,o,function(m,d,p){if(m||!d||!p)return u(m);const f=d,g=r.stringify(f,p);G_(g)?p.value=g:p.result=g,u(m,p)});function u(m,d){m||!d?l(m):i?i(d):n(void 0,d)}}}processSync(t){let n=!1,r;return this.freeze(),du("processSync",this.parser||this.Parser),hu("processSync",this.compiler||this.Compiler),this.process(t,a),r0("processSync","process",n),r;function a(i,l){n=!0,Kp(i),r=l}}run(t,n,r){n0(t),this.freeze();const a=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?i(void 0,r):new Promise(i);function i(l,o){const c=kl(n);a.run(t,c,u);function u(m,d,p){const f=d||t;m?o(m):l?l(f):r(void 0,f,p)}}}runSync(t,n){let r=!1,a;return this.run(t,n,i),r0("runSync","run",r),a;function i(l,o){Kp(l),a=o,r=!0}}stringify(t,n){this.freeze();const r=kl(n),a=this.compiler||this.Compiler;return hu("stringify",a),n0(t),a(t,r)}use(t,...n){const r=this.attachers,a=this.namespace;if(mu("use",this.frozen),t!=null)if(typeof t=="function")c(t,n);else if(typeof t=="object")Array.isArray(t)?o(t):l(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function i(u){if(typeof u=="function")c(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[m,...d]=u;c(m,d)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(u.plugins),u.settings&&(a.settings=lu(!0,a.settings,u.settings))}function o(u){let m=-1;if(u!=null)if(Array.isArray(u))for(;++m<u.length;){const d=u[m];i(d)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function c(u,m){let d=-1,p=-1;for(;++d<r.length;)if(r[d][0]===u){p=d;break}if(p===-1)r.push([u,...m]);else if(m.length>0){let[f,...g]=m;const v=r[p][1];Bd(v)&&Bd(f)&&(f=lu(!0,v,f)),r[p]=[u,f,...g]}}}}const W_=new Em().freeze();function du(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function hu(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function mu(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function n0(e){if(!Bd(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function r0(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function kl(e){return K_(e)?e:new E1(e)}function K_(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function G_(e){return typeof e=="string"||Q_(e)}function Q_(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const X_="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",s0=[],a0={allowDangerousHtml:!0},J_=/^(https?|ircs?|mailto|xmpp)$/i,Z_=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function e3(e){const t=t3(e),n=n3(e);return r3(t.runSync(t.parse(n),n),e)}function t3(e){const t=e.rehypePlugins||s0,n=e.remarkPlugins||s0,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...a0}:a0;return W_().use(OA).use(n).use(__,r).use(t)}function n3(e){const t=e.children||"",n=new E1;return typeof t=="string"&&(n.value=t),n}function r3(e,t){const n=t.allowedElements,r=t.allowElement,a=t.components,i=t.disallowedElements,l=t.skipHtml,o=t.unwrapDisallowed,c=t.urlTransform||s3;for(const m of Z_)Object.hasOwn(t,m.from)&&(""+m.from+(m.to?"use `"+m.to+"` instead":"remove it")+X_+m.id,void 0);return pc(e,u),bk(e,{Fragment:s.Fragment,components:a,ignoreInvalidStyle:!0,jsx:s.jsx,jsxs:s.jsxs,passKeys:!0,passNode:!0});function u(m,d,p){if(m.type==="raw"&&p&&typeof d=="number")return l?p.children.splice(d,1):p.children[d]={type:"text",value:m.value},d;if(m.type==="element"){let f;for(f in su)if(Object.hasOwn(su,f)&&Object.hasOwn(m.properties,f)){const g=m.properties[f],v=su[f];(v===null||v.includes(m.tagName))&&(m.properties[f]=c(String(g||""),f,m))}}if(m.type==="element"){let f=n?!n.includes(m.tagName):i?i.includes(m.tagName):!1;if(!f&&r&&typeof d=="number"&&(f=!r(m,d,p)),f&&p&&typeof d=="number")return o&&m.children?p.children.splice(d,1,...m.children):p.children.splice(d,1),d}}}function s3(e){const t=e.indexOf(":"),n=e.indexOf("?"),r=e.indexOf("#"),a=e.indexOf("/");return t===-1||a!==-1&&t>a||n!==-1&&t>n||r!==-1&&t>r||J_.test(e.slice(0,t))?e:""}function i0(e,t){const n=String(e);if(typeof t!="string")throw new TypeError("Expected character");let r=0,a=n.indexOf(t);for(;a!==-1;)r++,a=n.indexOf(t,a+t.length);return r}function a3(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function N1(e,t,n){const a=mc((n||{}).ignore||[]),i=i3(t);let l=-1;for(;++l<i.length;)b1(e,"text",o);function o(u,m){let d=-1,p;for(;++d<m.length;){const f=m[d],g=p?p.children:void 0;if(a(f,g?g.indexOf(f):void 0,p))return;p=f}if(p)return c(u,m)}function c(u,m){const d=m[m.length-1],p=i[l][0],f=i[l][1];let g=0;const T=d.children.indexOf(u);let y=!1,b=[];p.lastIndex=0;let x=p.exec(u.value);for(;x;){const I=x.index,C={index:x.index,input:x.input,stack:[...m,u]};let E=f(...x,C);if(typeof E=="string"&&(E=E.length>0?{type:"text",value:E}:void 0),E===!1?p.lastIndex=I+1:(g!==I&&b.push({type:"text",value:u.value.slice(g,I)}),Array.isArray(E)?b.push(...E):E&&b.push(E),g=I+x[0].length,y=!0),!p.global)break;x=p.exec(u.value)}return y?(g<u.value.length&&b.push({type:"text",value:u.value.slice(g)}),d.children.splice(T,1,...b)):b=[u],T+b.length}}function i3(e){const t=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const n=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<n.length;){const a=n[r];t.push([l3(a[0]),o3(a[1])])}return t}function l3(e){return typeof e=="string"?new RegExp(a3(e),"g"):e}function o3(e){return typeof e=="function"?e:function(){return e}}const fu="phrasing",pu=["autolink","link","image","label"];function c3(){return{transforms:[g3],enter:{literalAutolink:d3,literalAutolinkEmail:gu,literalAutolinkHttp:gu,literalAutolinkWww:gu},exit:{literalAutolink:p3,literalAutolinkEmail:f3,literalAutolinkHttp:h3,literalAutolinkWww:m3}}}function u3(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:fu,notInConstruct:pu},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:fu,notInConstruct:pu},{character:":",before:"[ps]",after:"\\/",inConstruct:fu,notInConstruct:pu}]}}function d3(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function gu(e){this.config.enter.autolinkProtocol.call(this,e)}function h3(e){this.config.exit.autolinkProtocol.call(this,e)}function m3(e){this.config.exit.data.call(this,e);const t=this.stack[this.stack.length-1];t.type,t.url="http://"+this.sliceSerialize(e)}function f3(e){this.config.exit.autolinkEmail.call(this,e)}function p3(e){this.exit(e)}function g3(e){N1(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,x3],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),y3]],{ignore:["link","linkReference"]})}function x3(e,t,n,r,a){let i="";if(!T1(a)||(/^w/i.test(t)&&(n=t+n,t="",i="http://"),!b3(n)))return!1;const l=v3(n+r);if(!l[0])return!1;const o={type:"link",title:null,url:i+t+l[0],children:[{type:"text",value:t+l[0]}]};return l[1]?[o,{type:"text",value:l[1]}]:o}function y3(e,t,n,r){return!T1(r,!0)||/[-\d_]$/.test(n)?!1:{type:"link",title:null,url:"mailto:"+t+"@"+n,children:[{type:"text",value:t+"@"+n}]}}function b3(e){const t=e.split(".");return!(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))}function v3(e){const t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let n=t[0],r=n.indexOf(")");const a=i0(e,"(");let i=i0(e,")");for(;r!==-1&&a>i;)e+=n.slice(0,r+1),n=n.slice(r+1),r=n.indexOf(")"),i++;return[e,n]}function T1(e,t){const n=e.input.charCodeAt(e.index-1);return(e.index===0||ws(n)||uc(n))&&(!t||n!==47)}w1.peek=A3;function E3(){this.buffer()}function N3(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function T3(){this.buffer()}function w3(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function S3(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=An(this.sliceSerialize(e)).toLowerCase(),n.label=t}function C3(e){this.exit(e)}function k3(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=An(this.sliceSerialize(e)).toLowerCase(),n.label=t}function j3(e){this.exit(e)}function A3(){return"["}function w1(e,t,n,r){const a=n.createTracker(r);let i=a.move("[^");const l=n.enter("footnoteReference"),o=n.enter("reference");return i+=a.move(n.safe(n.associationId(e),{after:"]",before:i})),o(),l(),i+=a.move("]"),i}function _3(){return{enter:{gfmFootnoteCallString:E3,gfmFootnoteCall:N3,gfmFootnoteDefinitionLabelString:T3,gfmFootnoteDefinition:w3},exit:{gfmFootnoteCallString:S3,gfmFootnoteCall:C3,gfmFootnoteDefinitionLabelString:k3,gfmFootnoteDefinition:j3}}}function I3(e){let t=!1;return e&&e.firstLineBlank&&(t=!0),{handlers:{footnoteDefinition:n,footnoteReference:w1},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function n(r,a,i,l){const o=i.createTracker(l);let c=o.move("[^");const u=i.enter("footnoteDefinition"),m=i.enter("label");return c+=o.move(i.safe(i.associationId(r),{before:c,after:"]"})),m(),c+=o.move("]:"),r.children&&r.children.length>0&&(o.shift(4),c+=o.move((t?`
`:" ")+i.indentLines(i.containerFlow(r,o.current()),t?S1:L3))),u(),c}}function L3(e,t,n){return t===0?e:S1(e,t,n)}function S1(e,t,n){return(n?"":"    ")+e}const R3=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];C1.peek=F3;function P3(){return{canContainEols:["delete"],enter:{strikethrough:O3},exit:{strikethrough:D3}}}function M3(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:R3}],handlers:{delete:C1}}}function O3(e){this.enter({type:"delete",children:[]},e)}function D3(e){this.exit(e)}function C1(e,t,n,r){const a=n.createTracker(r),i=n.enter("strikethrough");let l=a.move("~~");return l+=n.containerPhrasing(e,{...a.current(),before:l,after:"~"}),l+=a.move("~~"),i(),l}function F3(){return"~"}function B3(e){return e.length}function U3(e,t){const n=t||{},r=(n.align||[]).concat(),a=n.stringLength||B3,i=[],l=[],o=[],c=[];let u=0,m=-1;for(;++m<e.length;){const v=[],T=[];let y=-1;for(e[m].length>u&&(u=e[m].length);++y<e[m].length;){const b=H3(e[m][y]);if(n.alignDelimiters!==!1){const x=a(b);T[y]=x,(c[y]===void 0||x>c[y])&&(c[y]=x)}v.push(b)}l[m]=v,o[m]=T}let d=-1;if(typeof r=="object"&&"length"in r)for(;++d<u;)i[d]=l0(r[d]);else{const v=l0(r);for(;++d<u;)i[d]=v}d=-1;const p=[],f=[];for(;++d<u;){const v=i[d];let T="",y="";v===99?(T=":",y=":"):v===108?T=":":v===114&&(y=":");let b=n.alignDelimiters===!1?1:Math.max(1,c[d]-T.length-y.length);const x=T+"-".repeat(b)+y;n.alignDelimiters!==!1&&(b=T.length+b+y.length,b>c[d]&&(c[d]=b),f[d]=b),p[d]=x}l.splice(1,0,p),o.splice(1,0,f),m=-1;const g=[];for(;++m<l.length;){const v=l[m],T=o[m];d=-1;const y=[];for(;++d<u;){const b=v[d]||"";let x="",I="";if(n.alignDelimiters!==!1){const C=c[d]-(T[d]||0),E=i[d];E===114?x=" ".repeat(C):E===99?C%2?(x=" ".repeat(C/2+.5),I=" ".repeat(C/2-.5)):(x=" ".repeat(C/2),I=x):I=" ".repeat(C)}n.delimiterStart!==!1&&!d&&y.push("|"),n.padding!==!1&&!(n.alignDelimiters===!1&&b==="")&&(n.delimiterStart!==!1||d)&&y.push(" "),n.alignDelimiters!==!1&&y.push(x),y.push(b),n.alignDelimiters!==!1&&y.push(I),n.padding!==!1&&y.push(" "),(n.delimiterEnd!==!1||d!==u-1)&&y.push("|")}g.push(n.delimiterEnd===!1?y.join("").replace(/ +$/,""):y.join(""))}return g.join(`
`)}function H3(e){return e==null?"":String(e)}function l0(e){const t=typeof e=="string"?e.codePointAt(0):0;return t===67||t===99?99:t===76||t===108?108:t===82||t===114?114:0}const o0={}.hasOwnProperty;function k1(e,t){const n=t||{};function r(a,...i){let l=r.invalid;const o=r.handlers;if(a&&o0.call(a,e)){const c=String(a[e]);l=o0.call(o,c)?o[c]:r.unknown}if(l)return l.call(this,a,...i)}return r.handlers=n.handlers||{},r.invalid=n.invalid,r.unknown=n.unknown,r}function z3(e,t,n,r){const a=n.enter("blockquote"),i=n.createTracker(r);i.move("> "),i.shift(2);const l=n.indentLines(n.containerFlow(e,i.current()),$3);return a(),l}function $3(e,t,n){return">"+(n?"":" ")+e}function q3(e,t){return c0(e,t.inConstruct,!0)&&!c0(e,t.notInConstruct,!1)}function c0(e,t,n){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return n;let r=-1;for(;++r<t.length;)if(e.includes(t[r]))return!0;return!1}function u0(e,t,n,r){let a=-1;for(;++a<n.unsafe.length;)if(n.unsafe[a].character===`
`&&q3(n.stack,n.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function V3(e,t){const n=String(e);let r=n.indexOf(t),a=r,i=0,l=0;if(typeof t!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++i>l&&(l=i):i=1,a=r+t.length,r=n.indexOf(t,a);return l}function Y3(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function W3(e){const t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function K3(e,t,n,r){const a=W3(n),i=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(Y3(e,n)){const d=n.enter("codeIndented"),p=n.indentLines(i,G3);return d(),p}const o=n.createTracker(r),c=a.repeat(Math.max(V3(i,a)+1,3)),u=n.enter("codeFenced");let m=o.move(c);if(e.lang){const d=n.enter(`codeFencedLang${l}`);m+=o.move(n.safe(e.lang,{before:m,after:" ",encode:["`"],...o.current()})),d()}if(e.lang&&e.meta){const d=n.enter(`codeFencedMeta${l}`);m+=o.move(" "),m+=o.move(n.safe(e.meta,{before:m,after:`
`,encode:["`"],...o.current()})),d()}return m+=o.move(`
`),i&&(m+=o.move(i+`
`)),m+=o.move(c),u(),m}function G3(e,t,n){return(n?"":"    ")+e}function Nm(e){const t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function Q3(e,t,n,r){const a=Nm(n),i=a==='"'?"Quote":"Apostrophe",l=n.enter("definition");let o=n.enter("label");const c=n.createTracker(r);let u=c.move("[");return u+=c.move(n.safe(n.associationId(e),{before:u,after:"]",...c.current()})),u+=c.move("]: "),o(),!e.url||/[\0- \u007F]/.test(e.url)?(o=n.enter("destinationLiteral"),u+=c.move("<"),u+=c.move(n.safe(e.url,{before:u,after:">",...c.current()})),u+=c.move(">")):(o=n.enter("destinationRaw"),u+=c.move(n.safe(e.url,{before:u,after:e.title?" ":`
`,...c.current()}))),o(),e.title&&(o=n.enter(`title${i}`),u+=c.move(" "+a),u+=c.move(n.safe(e.title,{before:u,after:a,...c.current()})),u+=c.move(a),o()),l(),u}function X3(e){const t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}function qi(e){return"&#x"+e.toString(16).toUpperCase()+";"}function Lo(e,t,n){const r=ha(e),a=ha(t);return r===void 0?a===void 0?n==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}j1.peek=J3;function j1(e,t,n,r){const a=X3(n),i=n.enter("emphasis"),l=n.createTracker(r),o=l.move(a);let c=l.move(n.containerPhrasing(e,{after:a,before:o,...l.current()}));const u=c.charCodeAt(0),m=Lo(r.before.charCodeAt(r.before.length-1),u,a);m.inside&&(c=qi(u)+c.slice(1));const d=c.charCodeAt(c.length-1),p=Lo(r.after.charCodeAt(0),d,a);p.inside&&(c=c.slice(0,-1)+qi(d));const f=l.move(a);return i(),n.attentionEncodeSurroundingInfo={after:p.outside,before:m.outside},o+c+f}function J3(e,t,n){return n.options.emphasis||"*"}function Z3(e,t){let n=!1;return pc(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return n=!0,Dd}),!!((!e.depth||e.depth<3)&&fm(e)&&(t.options.setext||n))}function e4(e,t,n,r){const a=Math.max(Math.min(6,e.depth||1),1),i=n.createTracker(r);if(Z3(e,n)){const m=n.enter("headingSetext"),d=n.enter("phrasing"),p=n.containerPhrasing(e,{...i.current(),before:`
`,after:`
`});return d(),m(),p+`
`+(a===1?"=":"-").repeat(p.length-(Math.max(p.lastIndexOf("\r"),p.lastIndexOf(`
`))+1))}const l="#".repeat(a),o=n.enter("headingAtx"),c=n.enter("phrasing");i.move(l+" ");let u=n.containerPhrasing(e,{before:"# ",after:`
`,...i.current()});return/^[\t ]/.test(u)&&(u=qi(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,n.options.closeAtx&&(u+=" "+l),c(),o(),u}A1.peek=t4;function A1(e){return e.value||""}function t4(){return"<"}_1.peek=n4;function _1(e,t,n,r){const a=Nm(n),i=a==='"'?"Quote":"Apostrophe",l=n.enter("image");let o=n.enter("label");const c=n.createTracker(r);let u=c.move("![");return u+=c.move(n.safe(e.alt,{before:u,after:"]",...c.current()})),u+=c.move("]("),o(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(o=n.enter("destinationLiteral"),u+=c.move("<"),u+=c.move(n.safe(e.url,{before:u,after:">",...c.current()})),u+=c.move(">")):(o=n.enter("destinationRaw"),u+=c.move(n.safe(e.url,{before:u,after:e.title?" ":")",...c.current()}))),o(),e.title&&(o=n.enter(`title${i}`),u+=c.move(" "+a),u+=c.move(n.safe(e.title,{before:u,after:a,...c.current()})),u+=c.move(a),o()),u+=c.move(")"),l(),u}function n4(){return"!"}I1.peek=r4;function I1(e,t,n,r){const a=e.referenceType,i=n.enter("imageReference");let l=n.enter("label");const o=n.createTracker(r);let c=o.move("![");const u=n.safe(e.alt,{before:c,after:"]",...o.current()});c+=o.move(u+"]["),l();const m=n.stack;n.stack=[],l=n.enter("reference");const d=n.safe(n.associationId(e),{before:c,after:"]",...o.current()});return l(),n.stack=m,i(),a==="full"||!u||u!==d?c+=o.move(d+"]"):a==="shortcut"?c=c.slice(0,-1):c+=o.move("]"),c}function r4(){return"!"}L1.peek=s4;function L1(e,t,n){let r=e.value||"",a="`",i=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++i<n.unsafe.length;){const l=n.unsafe[i],o=n.compilePattern(l);let c;if(l.atBreak)for(;c=o.exec(r);){let u=c.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(c.index+1)}}return a+r+a}function s4(){return"`"}function R1(e,t){const n=fm(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(n===e.url||"mailto:"+n===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}P1.peek=a4;function P1(e,t,n,r){const a=Nm(n),i=a==='"'?"Quote":"Apostrophe",l=n.createTracker(r);let o,c;if(R1(e,n)){const m=n.stack;n.stack=[],o=n.enter("autolink");let d=l.move("<");return d+=l.move(n.containerPhrasing(e,{before:d,after:">",...l.current()})),d+=l.move(">"),o(),n.stack=m,d}o=n.enter("link"),c=n.enter("label");let u=l.move("[");return u+=l.move(n.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),c(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(c=n.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(n.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(c=n.enter("destinationRaw"),u+=l.move(n.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),c(),e.title&&(c=n.enter(`title${i}`),u+=l.move(" "+a),u+=l.move(n.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),c()),u+=l.move(")"),o(),u}function a4(e,t,n){return R1(e,n)?"<":"["}M1.peek=i4;function M1(e,t,n,r){const a=e.referenceType,i=n.enter("linkReference");let l=n.enter("label");const o=n.createTracker(r);let c=o.move("[");const u=n.containerPhrasing(e,{before:c,after:"]",...o.current()});c+=o.move(u+"]["),l();const m=n.stack;n.stack=[],l=n.enter("reference");const d=n.safe(n.associationId(e),{before:c,after:"]",...o.current()});return l(),n.stack=m,i(),a==="full"||!u||u!==d?c+=o.move(d+"]"):a==="shortcut"?c=c.slice(0,-1):c+=o.move("]"),c}function i4(){return"["}function Tm(e){const t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function l4(e){const t=Tm(e),n=e.options.bulletOther;if(!n)return t==="*"?"-":"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(n===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+n+"`) to be different");return n}function o4(e){const t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function O1(e){const t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function c4(e,t,n,r){const a=n.enter("list"),i=n.bulletCurrent;let l=e.ordered?o4(n):Tm(n);const o=e.ordered?l==="."?")":".":l4(n);let c=t&&n.bulletLastUsed?l===n.bulletLastUsed:!1;if(!e.ordered){const m=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&m&&(!m.children||!m.children[0])&&n.stack[n.stack.length-1]==="list"&&n.stack[n.stack.length-2]==="listItem"&&n.stack[n.stack.length-3]==="list"&&n.stack[n.stack.length-4]==="listItem"&&n.indexStack[n.indexStack.length-1]===0&&n.indexStack[n.indexStack.length-2]===0&&n.indexStack[n.indexStack.length-3]===0&&(c=!0),O1(n)===l&&m){let d=-1;for(;++d<e.children.length;){const p=e.children[d];if(p&&p.type==="listItem"&&p.children&&p.children[0]&&p.children[0].type==="thematicBreak"){c=!0;break}}}}c&&(l=o),n.bulletCurrent=l;const u=n.containerFlow(e,r);return n.bulletLastUsed=l,n.bulletCurrent=i,a(),u}function u4(e){const t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function d4(e,t,n,r){const a=u4(n);let i=n.bulletCurrent||Tm(n);t&&t.type==="list"&&t.ordered&&(i=(typeof t.start=="number"&&t.start>-1?t.start:1)+(n.options.incrementListMarker===!1?0:t.children.indexOf(e))+i);let l=i.length+1;(a==="tab"||a==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(l=Math.ceil(l/4)*4);const o=n.createTracker(r);o.move(i+" ".repeat(l-i.length)),o.shift(l);const c=n.enter("listItem"),u=n.indentLines(n.containerFlow(e,o.current()),m);return c(),u;function m(d,p,f){return p?(f?"":" ".repeat(l))+d:(f?i:i+" ".repeat(l-i.length))+d}}function h4(e,t,n,r){const a=n.enter("paragraph"),i=n.enter("phrasing"),l=n.containerPhrasing(e,r);return i(),a(),l}const m4=mc(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function f4(e,t,n,r){return(e.children.some(function(l){return m4(l)})?n.containerPhrasing:n.containerFlow).call(n,e,r)}function p4(e){const t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}D1.peek=g4;function D1(e,t,n,r){const a=p4(n),i=n.enter("strong"),l=n.createTracker(r),o=l.move(a+a);let c=l.move(n.containerPhrasing(e,{after:a,before:o,...l.current()}));const u=c.charCodeAt(0),m=Lo(r.before.charCodeAt(r.before.length-1),u,a);m.inside&&(c=qi(u)+c.slice(1));const d=c.charCodeAt(c.length-1),p=Lo(r.after.charCodeAt(0),d,a);p.inside&&(c=c.slice(0,-1)+qi(d));const f=l.move(a+a);return i(),n.attentionEncodeSurroundingInfo={after:p.outside,before:m.outside},o+c+f}function g4(e,t,n){return n.options.strong||"*"}function x4(e,t,n,r){return n.safe(e.value,r)}function y4(e){const t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function b4(e,t,n){const r=(O1(n)+(n.options.ruleSpaces?" ":"")).repeat(y4(n));return n.options.ruleSpaces?r.slice(0,-1):r}const F1={blockquote:z3,break:u0,code:K3,definition:Q3,emphasis:j1,hardBreak:u0,heading:e4,html:A1,image:_1,imageReference:I1,inlineCode:L1,link:P1,linkReference:M1,list:c4,listItem:d4,paragraph:h4,root:f4,strong:D1,text:x4,thematicBreak:b4};function v4(){return{enter:{table:E4,tableData:d0,tableHeader:d0,tableRow:T4},exit:{codeText:w4,table:N4,tableData:xu,tableHeader:xu,tableRow:xu}}}function E4(e){const t=e._align;this.enter({type:"table",align:t.map(function(n){return n==="none"?null:n}),children:[]},e),this.data.inTable=!0}function N4(e){this.exit(e),this.data.inTable=void 0}function T4(e){this.enter({type:"tableRow",children:[]},e)}function xu(e){this.exit(e)}function d0(e){this.enter({type:"tableCell",children:[]},e)}function w4(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,S4));const n=this.stack[this.stack.length-1];n.type,n.value=t,this.exit(e)}function S4(e,t){return t==="|"?t:e}function C4(e){const t=e||{},n=t.tableCellPadding,r=t.tablePipeAlign,a=t.stringLength,i=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:p,table:l,tableCell:c,tableRow:o}};function l(f,g,v,T){return u(m(f,v,T),f.align)}function o(f,g,v,T){const y=d(f,v,T),b=u([y]);return b.slice(0,b.indexOf(`
`))}function c(f,g,v,T){const y=v.enter("tableCell"),b=v.enter("phrasing"),x=v.containerPhrasing(f,{...T,before:i,after:i});return b(),y(),x}function u(f,g){return U3(f,{align:g,alignDelimiters:r,padding:n,stringLength:a})}function m(f,g,v){const T=f.children;let y=-1;const b=[],x=g.enter("table");for(;++y<T.length;)b[y]=d(T[y],g,v);return x(),b}function d(f,g,v){const T=f.children;let y=-1;const b=[],x=g.enter("tableRow");for(;++y<T.length;)b[y]=c(T[y],f,g,v);return x(),b}function p(f,g,v){let T=F1.inlineCode(f,g,v);return v.stack.includes("tableCell")&&(T=T.replace(/\|/g,"\\$&")),T}}function k4(){return{exit:{taskListCheckValueChecked:h0,taskListCheckValueUnchecked:h0,paragraph:A4}}}function j4(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:_4}}}function h0(e){const t=this.stack[this.stack.length-2];t.type,t.checked=e.type==="taskListCheckValueChecked"}function A4(e){const t=this.stack[this.stack.length-2];if(t&&t.type==="listItem"&&typeof t.checked=="boolean"){const n=this.stack[this.stack.length-1];n.type;const r=n.children[0];if(r&&r.type==="text"){const a=t.children;let i=-1,l;for(;++i<a.length;){const o=a[i];if(o.type==="paragraph"){l=o;break}}l===n&&(r.value=r.value.slice(1),r.value.length===0?n.children.shift():n.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,n.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function _4(e,t,n,r){const a=e.children[0],i=typeof e.checked=="boolean"&&a&&a.type==="paragraph",l="["+(e.checked?"x":" ")+"] ",o=n.createTracker(r);i&&o.move(l);let c=F1.listItem(e,t,n,{...r,...o.current()});return i&&(c=c.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),c;function u(m){return m+l}}function I4(){return[c3(),_3(),P3(),v4(),k4()]}function L4(e){return{extensions:[u3(),I3(e),M3(),C4(e),j4()]}}const R4={tokenize:B4,partial:!0},B1={tokenize:U4,partial:!0},U1={tokenize:H4,partial:!0},H1={tokenize:z4,partial:!0},P4={tokenize:$4,partial:!0},z1={name:"wwwAutolink",tokenize:D4,previous:q1},$1={name:"protocolAutolink",tokenize:F4,previous:V1},cr={name:"emailAutolink",tokenize:O4,previous:Y1},Vn={};function M4(){return{text:Vn}}let ns=48;for(;ns<123;)Vn[ns]=cr,ns++,ns===58?ns=65:ns===91&&(ns=97);Vn[43]=cr;Vn[45]=cr;Vn[46]=cr;Vn[95]=cr;Vn[72]=[cr,$1];Vn[104]=[cr,$1];Vn[87]=[cr,z1];Vn[119]=[cr,z1];function O4(e,t,n){const r=this;let a,i;return l;function l(d){return!Hd(d)||!Y1.call(r,r.previous)||wm(r.events)?n(d):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),o(d))}function o(d){return Hd(d)?(e.consume(d),o):d===64?(e.consume(d),c):n(d)}function c(d){return d===46?e.check(P4,m,u)(d):d===45||d===95||Nt(d)?(i=!0,e.consume(d),c):m(d)}function u(d){return e.consume(d),a=!0,c}function m(d){return i&&a&&jt(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(d)):n(d)}}function D4(e,t,n){const r=this;return a;function a(l){return l!==87&&l!==119||!q1.call(r,r.previous)||wm(r.events)?n(l):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(R4,e.attempt(B1,e.attempt(U1,i),n),n)(l))}function i(l){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(l)}}function F4(e,t,n){const r=this;let a="",i=!1;return l;function l(d){return(d===72||d===104)&&V1.call(r,r.previous)&&!wm(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(d),e.consume(d),o):n(d)}function o(d){if(jt(d)&&a.length<5)return a+=String.fromCodePoint(d),e.consume(d),o;if(d===58){const p=a.toLowerCase();if(p==="http"||p==="https")return e.consume(d),c}return n(d)}function c(d){return d===47?(e.consume(d),i?u:(i=!0,c)):n(d)}function u(d){return d===null||_o(d)||Me(d)||ws(d)||uc(d)?n(d):e.attempt(B1,e.attempt(U1,m),n)(d)}function m(d){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(d)}}function B4(e,t,n){let r=0;return a;function a(l){return(l===87||l===119)&&r<3?(r++,e.consume(l),a):l===46&&r===3?(e.consume(l),i):n(l)}function i(l){return l===null?n(l):t(l)}}function U4(e,t,n){let r,a,i;return l;function l(u){return u===46||u===95?e.check(H1,c,o)(u):u===null||Me(u)||ws(u)||u!==45&&uc(u)?c(u):(i=!0,e.consume(u),l)}function o(u){return u===95?r=!0:(a=r,r=void 0),e.consume(u),l}function c(u){return a||r||!i?n(u):t(u)}}function H4(e,t){let n=0,r=0;return a;function a(l){return l===40?(n++,e.consume(l),a):l===41&&r<n?i(l):l===33||l===34||l===38||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===60||l===63||l===93||l===95||l===126?e.check(H1,t,i)(l):l===null||Me(l)||ws(l)?t(l):(e.consume(l),a)}function i(l){return l===41&&r++,e.consume(l),a}}function z4(e,t,n){return r;function r(o){return o===33||o===34||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===63||o===95||o===126?(e.consume(o),r):o===38?(e.consume(o),i):o===93?(e.consume(o),a):o===60||o===null||Me(o)||ws(o)?t(o):n(o)}function a(o){return o===null||o===40||o===91||Me(o)||ws(o)?t(o):r(o)}function i(o){return jt(o)?l(o):n(o)}function l(o){return o===59?(e.consume(o),r):jt(o)?(e.consume(o),l):n(o)}}function $4(e,t,n){return r;function r(i){return e.consume(i),a}function a(i){return Nt(i)?n(i):t(i)}}function q1(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||Me(e)}function V1(e){return!jt(e)}function Y1(e){return!(e===47||Hd(e))}function Hd(e){return e===43||e===45||e===46||e===95||Nt(e)}function wm(e){let t=e.length,n=!1;for(;t--;){const r=e[t][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){n=!0;break}if(r._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}const q4={tokenize:J4,partial:!0};function V4(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:G4,continuation:{tokenize:Q4},exit:X4}},text:{91:{name:"gfmFootnoteCall",tokenize:K4},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:Y4,resolveTo:W4}}}}function Y4(e,t,n){const r=this;let a=r.events.length;const i=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let l;for(;a--;){const c=r.events[a][1];if(c.type==="labelImage"){l=c;break}if(c.type==="gfmFootnoteCall"||c.type==="labelLink"||c.type==="label"||c.type==="image"||c.type==="link")break}return o;function o(c){if(!l||!l._balanced)return n(c);const u=An(r.sliceSerialize({start:l.end,end:r.now()}));return u.codePointAt(0)!==94||!i.includes(u.slice(1))?n(c):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(c),e.exit("gfmFootnoteCallLabelMarker"),t(c))}}function W4(e,t){let n=e.length;for(;n--;)if(e[n][1].type==="labelImage"&&e[n][0]==="enter"){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const i={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},e[e.length-1][1].start)},l={type:"chunkString",contentType:"string",start:Object.assign({},i.start),end:Object.assign({},i.end)},o=[e[n+1],e[n+2],["enter",r,t],e[n+3],e[n+4],["enter",a,t],["exit",a,t],["enter",i,t],["enter",l,t],["exit",l,t],["exit",i,t],e[e.length-2],e[e.length-1],["exit",r,t]];return e.splice(n,e.length-n+1,...o),e}function K4(e,t,n){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let i=0,l;return o;function o(d){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(d),e.exit("gfmFootnoteCallLabelMarker"),c}function c(d){return d!==94?n(d):(e.enter("gfmFootnoteCallMarker"),e.consume(d),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(d){if(i>999||d===93&&!l||d===null||d===91||Me(d))return n(d);if(d===93){e.exit("chunkString");const p=e.exit("gfmFootnoteCallString");return a.includes(An(r.sliceSerialize(p)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(d),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):n(d)}return Me(d)||(l=!0),i++,e.consume(d),d===92?m:u}function m(d){return d===91||d===92||d===93?(e.consume(d),i++,u):u(d)}}function G4(e,t,n){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let i,l=0,o;return c;function c(g){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(g){return g===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",m):n(g)}function m(g){if(l>999||g===93&&!o||g===null||g===91||Me(g))return n(g);if(g===93){e.exit("chunkString");const v=e.exit("gfmFootnoteDefinitionLabelString");return i=An(r.sliceSerialize(v)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),p}return Me(g)||(o=!0),l++,e.consume(g),g===92?d:m}function d(g){return g===91||g===92||g===93?(e.consume(g),l++,m):m(g)}function p(g){return g===58?(e.enter("definitionMarker"),e.consume(g),e.exit("definitionMarker"),a.includes(i)||a.push(i),ke(e,f,"gfmFootnoteDefinitionWhitespace")):n(g)}function f(g){return t(g)}}function Q4(e,t,n){return e.check(el,t,e.attempt(q4,t,n))}function X4(e){e.exit("gfmFootnoteDefinition")}function J4(e,t,n){const r=this;return ke(e,a,"gfmFootnoteDefinitionIndent",5);function a(i){const l=r.events[r.events.length-1];return l&&l[1].type==="gfmFootnoteDefinitionIndent"&&l[2].sliceSerialize(l[1],!0).length===4?t(i):n(i)}}function Z4(e){let n=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:i,resolveAll:a};return n==null&&(n=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function a(l,o){let c=-1;for(;++c<l.length;)if(l[c][0]==="enter"&&l[c][1].type==="strikethroughSequenceTemporary"&&l[c][1]._close){let u=c;for(;u--;)if(l[u][0]==="exit"&&l[u][1].type==="strikethroughSequenceTemporary"&&l[u][1]._open&&l[c][1].end.offset-l[c][1].start.offset===l[u][1].end.offset-l[u][1].start.offset){l[c][1].type="strikethroughSequence",l[u][1].type="strikethroughSequence";const m={type:"strikethrough",start:Object.assign({},l[u][1].start),end:Object.assign({},l[c][1].end)},d={type:"strikethroughText",start:Object.assign({},l[u][1].end),end:Object.assign({},l[c][1].start)},p=[["enter",m,o],["enter",l[u][1],o],["exit",l[u][1],o],["enter",d,o]],f=o.parser.constructs.insideSpan.null;f&&Zt(p,p.length,0,dc(f,l.slice(u+1,c),o)),Zt(p,p.length,0,[["exit",d,o],["enter",l[c][1],o],["exit",l[c][1],o],["exit",m,o]]),Zt(l,u-1,c-u+3,p),c=u+p.length-2;break}}for(c=-1;++c<l.length;)l[c][1].type==="strikethroughSequenceTemporary"&&(l[c][1].type="data");return l}function i(l,o,c){const u=this.previous,m=this.events;let d=0;return p;function p(g){return u===126&&m[m.length-1][1].type!=="characterEscape"?c(g):(l.enter("strikethroughSequenceTemporary"),f(g))}function f(g){const v=ha(u);if(g===126)return d>1?c(g):(l.consume(g),d++,f);if(d<2&&!n)return c(g);const T=l.exit("strikethroughSequenceTemporary"),y=ha(g);return T._open=!y||y===2&&!!v,T._close=!v||v===2&&!!y,o(g)}}}class e6{constructor(){this.map=[]}add(t,n,r){t6(this,t,n,r)}consume(t){if(this.map.sort(function(i,l){return i[0]-l[0]}),this.map.length===0)return;let n=this.map.length;const r=[];for(;n>0;)n-=1,r.push(t.slice(this.map[n][0]+this.map[n][1]),this.map[n][2]),t.length=this.map[n][0];r.push(t.slice()),t.length=0;let a=r.pop();for(;a;){for(const i of a)t.push(i);a=r.pop()}this.map.length=0}}function t6(e,t,n,r){let a=0;if(!(n===0&&r.length===0)){for(;a<e.map.length;){if(e.map[a][0]===t){e.map[a][1]+=n,e.map[a][2].push(...r);return}a+=1}e.map.push([t,n,r])}}function n6(e,t){let n=!1;const r=[];for(;t<e.length;){const a=e[t];if(n){if(a[0]==="enter")a[1].type==="tableContent"&&r.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const i=r.length-1;r[i]=r[i]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(n=!0);t+=1}return r}function r6(){return{flow:{null:{name:"table",tokenize:s6,resolveAll:a6}}}}function s6(e,t,n){const r=this;let a=0,i=0,l;return o;function o(A){let z=r.events.length-1;for(;z>-1;){const H=r.events[z][1].type;if(H==="lineEnding"||H==="linePrefix")z--;else break}const M=z>-1?r.events[z][1].type:null,R=M==="tableHead"||M==="tableRow"?E:c;return R===E&&r.parser.lazy[r.now().line]?n(A):R(A)}function c(A){return e.enter("tableHead"),e.enter("tableRow"),u(A)}function u(A){return A===124||(l=!0,i+=1),m(A)}function m(A){return A===null?n(A):oe(A)?i>1?(i=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),f):n(A):Ne(A)?ke(e,m,"whitespace")(A):(i+=1,l&&(l=!1,a+=1),A===124?(e.enter("tableCellDivider"),e.consume(A),e.exit("tableCellDivider"),l=!0,m):(e.enter("data"),d(A)))}function d(A){return A===null||A===124||Me(A)?(e.exit("data"),m(A)):(e.consume(A),A===92?p:d)}function p(A){return A===92||A===124?(e.consume(A),d):d(A)}function f(A){return r.interrupt=!1,r.parser.lazy[r.now().line]?n(A):(e.enter("tableDelimiterRow"),l=!1,Ne(A)?ke(e,g,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(A):g(A))}function g(A){return A===45||A===58?T(A):A===124?(l=!0,e.enter("tableCellDivider"),e.consume(A),e.exit("tableCellDivider"),v):C(A)}function v(A){return Ne(A)?ke(e,T,"whitespace")(A):T(A)}function T(A){return A===58?(i+=1,l=!0,e.enter("tableDelimiterMarker"),e.consume(A),e.exit("tableDelimiterMarker"),y):A===45?(i+=1,y(A)):A===null||oe(A)?I(A):C(A)}function y(A){return A===45?(e.enter("tableDelimiterFiller"),b(A)):C(A)}function b(A){return A===45?(e.consume(A),b):A===58?(l=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(A),e.exit("tableDelimiterMarker"),x):(e.exit("tableDelimiterFiller"),x(A))}function x(A){return Ne(A)?ke(e,I,"whitespace")(A):I(A)}function I(A){return A===124?g(A):A===null||oe(A)?!l||a!==i?C(A):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(A)):C(A)}function C(A){return n(A)}function E(A){return e.enter("tableRow"),N(A)}function N(A){return A===124?(e.enter("tableCellDivider"),e.consume(A),e.exit("tableCellDivider"),N):A===null||oe(A)?(e.exit("tableRow"),t(A)):Ne(A)?ke(e,N,"whitespace")(A):(e.enter("data"),O(A))}function O(A){return A===null||A===124||Me(A)?(e.exit("data"),N(A)):(e.consume(A),A===92?D:O)}function D(A){return A===92||A===124?(e.consume(A),O):O(A)}}function a6(e,t){let n=-1,r=!0,a=0,i=[0,0,0,0],l=[0,0,0,0],o=!1,c=0,u,m,d;const p=new e6;for(;++n<e.length;){const f=e[n],g=f[1];f[0]==="enter"?g.type==="tableHead"?(o=!1,c!==0&&(m0(p,t,c,u,m),m=void 0,c=0),u={type:"table",start:Object.assign({},g.start),end:Object.assign({},g.end)},p.add(n,0,[["enter",u,t]])):g.type==="tableRow"||g.type==="tableDelimiterRow"?(r=!0,d=void 0,i=[0,0,0,0],l=[0,n+1,0,0],o&&(o=!1,m={type:"tableBody",start:Object.assign({},g.start),end:Object.assign({},g.end)},p.add(n,0,[["enter",m,t]])),a=g.type==="tableDelimiterRow"?2:m?3:1):a&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")?(r=!1,l[2]===0&&(i[1]!==0&&(l[0]=l[1],d=jl(p,t,i,a,void 0,d),i=[0,0,0,0]),l[2]=n)):g.type==="tableCellDivider"&&(r?r=!1:(i[1]!==0&&(l[0]=l[1],d=jl(p,t,i,a,void 0,d)),i=l,l=[i[1],n,0,0])):g.type==="tableHead"?(o=!0,c=n):g.type==="tableRow"||g.type==="tableDelimiterRow"?(c=n,i[1]!==0?(l[0]=l[1],d=jl(p,t,i,a,n,d)):l[1]!==0&&(d=jl(p,t,l,a,n,d)),a=0):a&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")&&(l[3]=n)}for(c!==0&&m0(p,t,c,u,m),p.consume(t.events),n=-1;++n<t.events.length;){const f=t.events[n];f[0]==="enter"&&f[1].type==="table"&&(f[1]._align=n6(t.events,n))}return e}function jl(e,t,n,r,a,i){const l=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",o="tableContent";n[0]!==0&&(i.end=Object.assign({},Ps(t.events,n[0])),e.add(n[0],0,[["exit",i,t]]));const c=Ps(t.events,n[1]);if(i={type:l,start:Object.assign({},c),end:Object.assign({},c)},e.add(n[1],0,[["enter",i,t]]),n[2]!==0){const u=Ps(t.events,n[2]),m=Ps(t.events,n[3]),d={type:o,start:Object.assign({},u),end:Object.assign({},m)};if(e.add(n[2],0,[["enter",d,t]]),r!==2){const p=t.events[n[2]],f=t.events[n[3]];if(p[1].end=Object.assign({},f[1].end),p[1].type="chunkText",p[1].contentType="text",n[3]>n[2]+1){const g=n[2]+1,v=n[3]-n[2]-1;e.add(g,v,[])}}e.add(n[3]+1,0,[["exit",d,t]])}return a!==void 0&&(i.end=Object.assign({},Ps(t.events,a)),e.add(a,0,[["exit",i,t]]),i=void 0),i}function m0(e,t,n,r,a){const i=[],l=Ps(t.events,n);a&&(a.end=Object.assign({},l),i.push(["exit",a,t])),r.end=Object.assign({},l),i.push(["exit",r,t]),e.add(n+1,0,i)}function Ps(e,t){const n=e[t],r=n[0]==="enter"?"start":"end";return n[1][r]}const i6={name:"tasklistCheck",tokenize:o6};function l6(){return{text:{91:i6}}}function o6(e,t,n){const r=this;return a;function a(c){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?n(c):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(c),e.exit("taskListCheckMarker"),i)}function i(c){return Me(c)?(e.enter("taskListCheckValueUnchecked"),e.consume(c),e.exit("taskListCheckValueUnchecked"),l):c===88||c===120?(e.enter("taskListCheckValueChecked"),e.consume(c),e.exit("taskListCheckValueChecked"),l):n(c)}function l(c){return c===93?(e.enter("taskListCheckMarker"),e.consume(c),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),o):n(c)}function o(c){return oe(c)?t(c):Ne(c)?e.check({tokenize:c6},t,n)(c):n(c)}}function c6(e,t,n){return ke(e,r,"whitespace");function r(a){return a===null?n(a):t(a)}}function u6(e){return e1([M4(),V4(),Z4(e),r6(),l6()])}const d6={};function h6(e){const t=this,n=e||d6,r=t.data(),a=r.micromarkExtensions||(r.micromarkExtensions=[]),i=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),l=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);a.push(u6(n)),i.push(I4()),l.push(L4(n))}function m6(e){N1(e,[/\r?\n|\r/g,f6])}function f6(){return{type:"break"}}function p6(){return function(e){m6(e)}}const f0=/[#.]/g;function g6(e,t){const n=e||"",r={};let a=0,i,l;for(;a<n.length;){f0.lastIndex=a;const o=f0.exec(n),c=n.slice(a,o?o.index:n.length);c&&(i?i==="#"?r.id=c:Array.isArray(r.className)?r.className.push(c):r.className=[c]:l=c,a+=c.length),o&&(i=o[0],a++)}return{type:"element",tagName:l||t||"div",properties:r,children:[]}}function W1(e,t,n){const r=n?v6(n):void 0;function a(i,l,...o){let c;if(i==null){c={type:"root",children:[]};const u=l;o.unshift(u)}else{c=g6(i,t);const u=c.tagName.toLowerCase(),m=r?r.get(u):void 0;if(c.tagName=m||u,x6(l))o.unshift(l);else for(const[d,p]of Object.entries(l))y6(e,c.properties,d,p)}for(const u of o)zd(c.children,u);return c.type==="element"&&c.tagName==="template"&&(c.content={type:"root",children:c.children},c.children=[]),c}return a}function x6(e){if(e===null||typeof e!="object"||Array.isArray(e))return!0;if(typeof e.type!="string")return!1;const t=e,n=Object.keys(e);for(const r of n){const a=t[r];if(a&&typeof a=="object"){if(!Array.isArray(a))return!0;const i=a;for(const l of i)if(typeof l!="number"&&typeof l!="string")return!0}}return!!("children"in e&&Array.isArray(e.children))}function y6(e,t,n,r){const a=cm(e,n);let i;if(r!=null){if(typeof r=="number"){if(Number.isNaN(r))return;i=r}else typeof r=="boolean"?i=r:typeof r=="string"?a.spaceSeparated?i=Ep(r):a.commaSeparated?i=gp(r):a.commaOrSpaceSeparated?i=Ep(gp(r).join(" ")):i=p0(a,a.property,r):Array.isArray(r)?i=[...r]:i=a.property==="style"?b6(r):String(r);if(Array.isArray(i)){const l=[];for(const o of i)l.push(p0(a,a.property,o));i=l}a.property==="className"&&Array.isArray(t.className)&&(i=t.className.concat(i)),t[a.property]=i}}function zd(e,t){if(t!=null)if(typeof t=="number"||typeof t=="string")e.push({type:"text",value:String(t)});else if(Array.isArray(t))for(const n of t)zd(e,n);else if(typeof t=="object"&&"type"in t)t.type==="root"?zd(e,t.children):e.push(t);else throw new Error("Expected node, nodes, or string, got `"+t+"`")}function p0(e,t,n){if(typeof n=="string"){if(e.number&&n&&!Number.isNaN(Number(n)))return Number(n);if((e.boolean||e.overloadedBoolean)&&(n===""||zi(n)===zi(t)))return!0}return n}function b6(e){const t=[];for(const[n,r]of Object.entries(e))t.push([n,r].join(": "));return t.join("; ")}function v6(e){const t=new Map;for(const n of e)t.set(n.toLowerCase(),n);return t}const E6=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],N6=W1(lc,"div"),T6=W1(wa,"g",E6);function w6(e){const t=String(e),n=[];return{toOffset:a,toPoint:r};function r(i){if(typeof i=="number"&&i>-1&&i<=t.length){let l=0;for(;;){let o=n[l];if(o===void 0){const c=g0(t,n[l-1]);o=c===-1?t.length+1:c+1,n[l]=o}if(o>i)return{line:l+1,column:i-(l>0?n[l-1]:0)+1,offset:i};l++}}}function a(i){if(i&&typeof i.line=="number"&&typeof i.column=="number"&&!Number.isNaN(i.line)&&!Number.isNaN(i.column)){for(;n.length<i.line;){const o=n[n.length-1],c=g0(t,o),u=c===-1?t.length+1:c+1;if(o===u)break;n.push(u)}const l=(i.line>1?n[i.line-2]:0)+i.column-1;if(l<n[i.line-1])return l}}}function g0(e,t){const n=e.indexOf("\r",t),r=e.indexOf(`
`,t);return r===-1?n:n===-1||n+1===r?r:n<r?n:r}const ds={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},K1={}.hasOwnProperty,S6=Object.prototype;function C6(e,t){const n=t||{};return Sm({file:n.file||void 0,location:!1,schema:n.space==="svg"?wa:lc,verbose:n.verbose||!1},e)}function Sm(e,t){let n;switch(t.nodeName){case"#comment":{const r=t;return n={type:"comment",value:r.data},Gl(e,r,n),n}case"#document":case"#document-fragment":{const r=t,a="mode"in r?r.mode==="quirks"||r.mode==="limited-quirks":!1;if(n={type:"root",children:G1(e,t.childNodes),data:{quirksMode:a}},e.file&&e.location){const i=String(e.file),l=w6(i),o=l.toPoint(0),c=l.toPoint(i.length);n.position={start:o,end:c}}return n}case"#documentType":{const r=t;return n={type:"doctype"},Gl(e,r,n),n}case"#text":{const r=t;return n={type:"text",value:r.value},Gl(e,r,n),n}default:return n=k6(e,t),n}}function G1(e,t){let n=-1;const r=[];for(;++n<t.length;){const a=Sm(e,t[n]);r.push(a)}return r}function k6(e,t){const n=e.schema;e.schema=t.namespaceURI===ds.svg?wa:lc;let r=-1;const a={};for(;++r<t.attrs.length;){const o=t.attrs[r],c=(o.prefix?o.prefix+":":"")+o.name;K1.call(S6,c)||(a[c]=o.value)}const l=(e.schema.space==="svg"?T6:N6)(t.tagName,a,G1(e,t.childNodes));if(Gl(e,t,l),l.tagName==="template"){const o=t,c=o.sourceCodeLocation,u=c&&c.startTag&&Ks(c.startTag),m=c&&c.endTag&&Ks(c.endTag),d=Sm(e,o.content);u&&m&&e.file&&(d.position={start:u.end,end:m.start}),l.content=d}return e.schema=n,l}function Gl(e,t,n){if("sourceCodeLocation"in t&&t.sourceCodeLocation&&e.file){const r=j6(e,n,t.sourceCodeLocation);r&&(e.location=!0,n.position=r)}}function j6(e,t,n){const r=Ks(n);if(t.type==="element"){const a=t.children[t.children.length-1];if(r&&!n.endTag&&a&&a.position&&a.position.end&&(r.end=Object.assign({},a.position.end)),e.verbose){const i={};let l;if(n.attrs)for(l in n.attrs)K1.call(n.attrs,l)&&(i[cm(e.schema,l).property]=Ks(n.attrs[l]));n.startTag;const o=Ks(n.startTag),c=n.endTag?Ks(n.endTag):void 0,u={opening:o};c&&(u.closing=c),u.properties=i,t.data={position:u}}}return r}function Ks(e){const t=x0({line:e.startLine,column:e.startCol,offset:e.startOffset}),n=x0({line:e.endLine,column:e.endCol,offset:e.endOffset});return t||n?{start:t,end:n}:void 0}function x0(e){return e.line&&e.column?e:void 0}class nl{constructor(t,n,r){this.property=t,this.normal=n,r&&(this.space=r)}}nl.prototype.property={};nl.prototype.normal={};nl.prototype.space=null;function Q1(e,t){const n={},r={};let a=-1;for(;++a<e.length;)Object.assign(n,e[a].property),Object.assign(r,e[a].normal);return new nl(n,r,t)}function $d(e){return e.toLowerCase()}class gn{constructor(t,n){this.property=t,this.attribute=n}}gn.prototype.space=null;gn.prototype.boolean=!1;gn.prototype.booleanish=!1;gn.prototype.overloadedBoolean=!1;gn.prototype.number=!1;gn.prototype.commaSeparated=!1;gn.prototype.spaceSeparated=!1;gn.prototype.commaOrSpaceSeparated=!1;gn.prototype.mustUseProperty=!1;gn.prototype.defined=!1;let A6=0;const fe=js(),Ze=js(),X1=js(),te=js(),De=js(),na=js(),Gt=js();function js(){return 2**++A6}const qd=Object.freeze(Object.defineProperty({__proto__:null,boolean:fe,booleanish:Ze,commaOrSpaceSeparated:Gt,commaSeparated:na,number:te,overloadedBoolean:X1,spaceSeparated:De},Symbol.toStringTag,{value:"Module"})),yu=Object.keys(qd);class Cm extends gn{constructor(t,n,r,a){let i=-1;if(super(t,n),y0(this,"space",a),typeof r=="number")for(;++i<yu.length;){const l=yu[i];y0(this,yu[i],(r&qd[l])===qd[l])}}}Cm.prototype.defined=!0;function y0(e,t,n){n&&(e[t]=n)}const _6={}.hasOwnProperty;function Ca(e){const t={},n={};let r;for(r in e.properties)if(_6.call(e.properties,r)){const a=e.properties[r],i=new Cm(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(i.mustUseProperty=!0),t[r]=i,n[$d(r)]=r,n[$d(i.attribute)]=r}return new nl(t,n,e.space)}const J1=Ca({space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),Z1=Ca({space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function eb(e,t){return t in e?e[t]:t}function tb(e,t){return eb(e,t.toLowerCase())}const nb=Ca({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:tb,properties:{xmlns:null,xmlnsXLink:null}}),rb=Ca({transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:Ze,ariaAutoComplete:null,ariaBusy:Ze,ariaChecked:Ze,ariaColCount:te,ariaColIndex:te,ariaColSpan:te,ariaControls:De,ariaCurrent:null,ariaDescribedBy:De,ariaDetails:null,ariaDisabled:Ze,ariaDropEffect:De,ariaErrorMessage:null,ariaExpanded:Ze,ariaFlowTo:De,ariaGrabbed:Ze,ariaHasPopup:null,ariaHidden:Ze,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:De,ariaLevel:te,ariaLive:null,ariaModal:Ze,ariaMultiLine:Ze,ariaMultiSelectable:Ze,ariaOrientation:null,ariaOwns:De,ariaPlaceholder:null,ariaPosInSet:te,ariaPressed:Ze,ariaReadOnly:Ze,ariaRelevant:null,ariaRequired:Ze,ariaRoleDescription:De,ariaRowCount:te,ariaRowIndex:te,ariaRowSpan:te,ariaSelected:Ze,ariaSetSize:te,ariaSort:null,ariaValueMax:te,ariaValueMin:te,ariaValueNow:te,ariaValueText:null,role:null}}),I6=Ca({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:tb,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:na,acceptCharset:De,accessKey:De,action:null,allow:null,allowFullScreen:fe,allowPaymentRequest:fe,allowUserMedia:fe,alt:null,as:null,async:fe,autoCapitalize:null,autoComplete:De,autoFocus:fe,autoPlay:fe,blocking:De,capture:null,charSet:null,checked:fe,cite:null,className:De,cols:te,colSpan:null,content:null,contentEditable:Ze,controls:fe,controlsList:De,coords:te|na,crossOrigin:null,data:null,dateTime:null,decoding:null,default:fe,defer:fe,dir:null,dirName:null,disabled:fe,download:X1,draggable:Ze,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:fe,formTarget:null,headers:De,height:te,hidden:fe,high:te,href:null,hrefLang:null,htmlFor:De,httpEquiv:De,id:null,imageSizes:null,imageSrcSet:null,inert:fe,inputMode:null,integrity:null,is:null,isMap:fe,itemId:null,itemProp:De,itemRef:De,itemScope:fe,itemType:De,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:fe,low:te,manifest:null,max:null,maxLength:te,media:null,method:null,min:null,minLength:te,multiple:fe,muted:fe,name:null,nonce:null,noModule:fe,noValidate:fe,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:fe,optimum:te,pattern:null,ping:De,placeholder:null,playsInline:fe,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:fe,referrerPolicy:null,rel:De,required:fe,reversed:fe,rows:te,rowSpan:te,sandbox:De,scope:null,scoped:fe,seamless:fe,selected:fe,shadowRootClonable:fe,shadowRootDelegatesFocus:fe,shadowRootMode:null,shape:null,size:te,sizes:null,slot:null,span:te,spellCheck:Ze,src:null,srcDoc:null,srcLang:null,srcSet:null,start:te,step:null,style:null,tabIndex:te,target:null,title:null,translate:null,type:null,typeMustMatch:fe,useMap:null,value:Ze,width:te,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:De,axis:null,background:null,bgColor:null,border:te,borderColor:null,bottomMargin:te,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:fe,declare:fe,event:null,face:null,frame:null,frameBorder:null,hSpace:te,leftMargin:te,link:null,longDesc:null,lowSrc:null,marginHeight:te,marginWidth:te,noResize:fe,noHref:fe,noShade:fe,noWrap:fe,object:null,profile:null,prompt:null,rev:null,rightMargin:te,rules:null,scheme:null,scrolling:Ze,standby:null,summary:null,text:null,topMargin:te,valueType:null,version:null,vAlign:null,vLink:null,vSpace:te,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:fe,disableRemotePlayback:fe,prefix:null,property:null,results:te,security:null,unselectable:null}}),L6=Ca({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:eb,properties:{about:Gt,accentHeight:te,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:te,amplitude:te,arabicForm:null,ascent:te,attributeName:null,attributeType:null,azimuth:te,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:te,by:null,calcMode:null,capHeight:te,className:De,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:te,diffuseConstant:te,direction:null,display:null,dur:null,divisor:te,dominantBaseline:null,download:fe,dx:null,dy:null,edgeMode:null,editable:null,elevation:te,enableBackground:null,end:null,event:null,exponent:te,externalResourcesRequired:null,fill:null,fillOpacity:te,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:na,g2:na,glyphName:na,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:te,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:te,horizOriginX:te,horizOriginY:te,id:null,ideographic:te,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:te,k:te,k1:te,k2:te,k3:te,k4:te,kernelMatrix:Gt,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:te,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:te,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:te,overlineThickness:te,paintOrder:null,panose1:null,path:null,pathLength:te,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:De,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:te,pointsAtY:te,pointsAtZ:te,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Gt,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Gt,rev:Gt,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Gt,requiredFeatures:Gt,requiredFonts:Gt,requiredFormats:Gt,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:te,specularExponent:te,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:te,strikethroughThickness:te,string:null,stroke:null,strokeDashArray:Gt,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:te,strokeOpacity:te,strokeWidth:null,style:null,surfaceScale:te,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Gt,tabIndex:te,tableValues:null,target:null,targetX:te,targetY:te,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Gt,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:te,underlineThickness:te,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:te,values:null,vAlphabetic:te,vMathematical:te,vectorEffect:null,vHanging:te,vIdeographic:te,version:null,vertAdvY:te,vertOriginX:te,vertOriginY:te,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:te,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),R6=/^data[-\w.:]+$/i,b0=/-[a-z]/g,P6=/[A-Z]/g;function M6(e,t){const n=$d(t);let r=t,a=gn;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&R6.test(t)){if(t.charAt(4)==="-"){const i=t.slice(5).replace(b0,D6);r="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=t.slice(4);if(!b0.test(i)){let l=i.replace(P6,O6);l.charAt(0)!=="-"&&(l="-"+l),t="data"+l}}a=Cm}return new a(r,t)}function O6(e){return"-"+e.toLowerCase()}function D6(e){return e.charAt(1).toUpperCase()}const F6=Q1([Z1,J1,nb,rb,I6],"html"),sb=Q1([Z1,J1,nb,rb,L6],"svg"),B6={},U6={}.hasOwnProperty,ab=k1("type",{handlers:{root:z6,element:W6,text:V6,comment:Y6,doctype:q6}});function H6(e,t){const r=(t||B6).space;return ab(e,r==="svg"?sb:F6)}function z6(e,t){const n={nodeName:"#document",mode:(e.data||{}).quirksMode?"quirks":"no-quirks",childNodes:[]};return n.childNodes=km(e.children,n,t),ka(e,n),n}function $6(e,t){const n={nodeName:"#document-fragment",childNodes:[]};return n.childNodes=km(e.children,n,t),ka(e,n),n}function q6(e){const t={nodeName:"#documentType",name:"html",publicId:"",systemId:"",parentNode:null};return ka(e,t),t}function V6(e){const t={nodeName:"#text",value:e.value,parentNode:null};return ka(e,t),t}function Y6(e){const t={nodeName:"#comment",data:e.value,parentNode:null};return ka(e,t),t}function W6(e,t){const n=t;let r=n;e.type==="element"&&e.tagName.toLowerCase()==="svg"&&n.space==="html"&&(r=sb);const a=[];let i;if(e.properties){for(i in e.properties)if(i!=="children"&&U6.call(e.properties,i)){const c=K6(r,i,e.properties[i]);c&&a.push(c)}}const l=r.space,o={nodeName:e.tagName,tagName:e.tagName,attrs:a,namespaceURI:ds[l],childNodes:[],parentNode:null};return o.childNodes=km(e.children,o,r),ka(e,o),e.tagName==="template"&&e.content&&(o.content=$6(e.content,r)),o}function K6(e,t,n){const r=M6(e,t);if(n===!1||n===null||n===void 0||typeof n=="number"&&Number.isNaN(n)||!n&&r.boolean)return;Array.isArray(n)&&(n=r.commaSeparated?By(n):Wy(n));const a={name:r.attribute,value:n===!0?"":String(n)};if(r.space&&r.space!=="html"&&r.space!=="svg"){const i=a.name.indexOf(":");i<0?a.prefix="":(a.name=a.name.slice(i+1),a.prefix=r.attribute.slice(0,i)),a.namespace=ds[r.space]}return a}function km(e,t,n){let r=-1;const a=[];if(e)for(;++r<e.length;){const i=ab(e[r],n);i.parentNode=t,a.push(i)}return a}function ka(e,t){const n=e.position;n&&n.start&&n.end&&(n.start.offset,n.end.offset,t.sourceCodeLocation={startLine:n.start.line,startCol:n.start.column,startOffset:n.start.offset,endLine:n.end.line,endCol:n.end.column,endOffset:n.end.offset})}const G6=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],Q6=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),ze="";var w;(function(e){e[e.EOF=-1]="EOF",e[e.NULL=0]="NULL",e[e.TABULATION=9]="TABULATION",e[e.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",e[e.LINE_FEED=10]="LINE_FEED",e[e.FORM_FEED=12]="FORM_FEED",e[e.SPACE=32]="SPACE",e[e.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",e[e.QUOTATION_MARK=34]="QUOTATION_MARK",e[e.AMPERSAND=38]="AMPERSAND",e[e.APOSTROPHE=39]="APOSTROPHE",e[e.HYPHEN_MINUS=45]="HYPHEN_MINUS",e[e.SOLIDUS=47]="SOLIDUS",e[e.DIGIT_0=48]="DIGIT_0",e[e.DIGIT_9=57]="DIGIT_9",e[e.SEMICOLON=59]="SEMICOLON",e[e.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",e[e.EQUALS_SIGN=61]="EQUALS_SIGN",e[e.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",e[e.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",e[e.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",e[e.GRAVE_ACCENT=96]="GRAVE_ACCENT",e[e.LATIN_SMALL_A=97]="LATIN_SMALL_A",e[e.LATIN_SMALL_Z=122]="LATIN_SMALL_Z"})(w||(w={}));const Ot={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function ib(e){return e>=55296&&e<=57343}function X6(e){return e>=56320&&e<=57343}function J6(e,t){return(e-55296)*1024+9216+t}function lb(e){return e!==32&&e!==10&&e!==13&&e!==9&&e!==12&&e>=1&&e<=31||e>=127&&e<=159}function ob(e){return e>=64976&&e<=65007||Q6.has(e)}var U;(function(e){e.controlCharacterInInputStream="control-character-in-input-stream",e.noncharacterInInputStream="noncharacter-in-input-stream",e.surrogateInInputStream="surrogate-in-input-stream",e.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",e.endTagWithAttributes="end-tag-with-attributes",e.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",e.unexpectedSolidusInTag="unexpected-solidus-in-tag",e.unexpectedNullCharacter="unexpected-null-character",e.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",e.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",e.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",e.missingEndTagName="missing-end-tag-name",e.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",e.unknownNamedCharacterReference="unknown-named-character-reference",e.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",e.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",e.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",e.eofBeforeTagName="eof-before-tag-name",e.eofInTag="eof-in-tag",e.missingAttributeValue="missing-attribute-value",e.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",e.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",e.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",e.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",e.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",e.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",e.missingDoctypePublicIdentifier="missing-doctype-public-identifier",e.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",e.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",e.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",e.cdataInHtmlContent="cdata-in-html-content",e.incorrectlyOpenedComment="incorrectly-opened-comment",e.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",e.eofInDoctype="eof-in-doctype",e.nestedComment="nested-comment",e.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",e.eofInComment="eof-in-comment",e.incorrectlyClosedComment="incorrectly-closed-comment",e.eofInCdata="eof-in-cdata",e.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",e.nullCharacterReference="null-character-reference",e.surrogateCharacterReference="surrogate-character-reference",e.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",e.controlCharacterReference="control-character-reference",e.noncharacterCharacterReference="noncharacter-character-reference",e.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",e.missingDoctypeName="missing-doctype-name",e.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",e.duplicateAttribute="duplicate-attribute",e.nonConformingDoctype="non-conforming-doctype",e.missingDoctype="missing-doctype",e.misplacedDoctype="misplaced-doctype",e.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",e.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",e.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",e.openElementsLeftAfterEof="open-elements-left-after-eof",e.abandonedHeadElementChild="abandoned-head-element-child",e.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",e.nestedNoscriptInHead="nested-noscript-in-head",e.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(U||(U={}));const Z6=65536;class eI{constructor(t){this.handler=t,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=Z6,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(t,n){const{line:r,col:a,offset:i}=this,l=a+n,o=i+n;return{code:t,startLine:r,endLine:r,startCol:l,endCol:l,startOffset:o,endOffset:o}}_err(t){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(t,0)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(t){if(this.pos!==this.html.length-1){const n=this.html.charCodeAt(this.pos+1);if(X6(n))return this.pos++,this._addGap(),J6(t,n)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,w.EOF;return this._err(U.surrogateInInputStream),t}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(t,n){this.html.length>0?this.html+=t:this.html=t,this.endOfChunkHit=!1,this.lastChunkWritten=n}insertHtmlAtCurrentPos(t){this.html=this.html.substring(0,this.pos+1)+t+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(t,n){if(this.pos+t.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(n)return this.html.startsWith(t,this.pos);for(let r=0;r<t.length;r++)if((this.html.charCodeAt(this.pos+r)|32)!==t.charCodeAt(r))return!1;return!0}peek(t){const n=this.pos+t;if(n>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,w.EOF;const r=this.html.charCodeAt(n);return r===w.CARRIAGE_RETURN?w.LINE_FEED:r}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,w.EOF;let t=this.html.charCodeAt(this.pos);return t===w.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,w.LINE_FEED):t===w.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,ib(t)&&(t=this._processSurrogate(t)),this.handler.onParseError===null||t>31&&t<127||t===w.LINE_FEED||t===w.CARRIAGE_RETURN||t>159&&t<64976||this._checkForProblematicCharacters(t),t)}_checkForProblematicCharacters(t){lb(t)?this._err(U.controlCharacterInInputStream):ob(t)&&this._err(U.noncharacterInInputStream)}retreat(t){for(this.pos-=t;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var ve;(function(e){e[e.CHARACTER=0]="CHARACTER",e[e.NULL_CHARACTER=1]="NULL_CHARACTER",e[e.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",e[e.START_TAG=3]="START_TAG",e[e.END_TAG=4]="END_TAG",e[e.COMMENT=5]="COMMENT",e[e.DOCTYPE=6]="DOCTYPE",e[e.EOF=7]="EOF",e[e.HIBERNATION=8]="HIBERNATION"})(ve||(ve={}));function cb(e,t){for(let n=e.attrs.length-1;n>=0;n--)if(e.attrs[n].name===t)return e.attrs[n].value;return null}const tI=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(e=>e.charCodeAt(0))),nI=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);function rI(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=nI.get(e))!==null&&t!==void 0?t:e}var ct;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"})(ct||(ct={}));const sI=32;var Sr;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(Sr||(Sr={}));function Vd(e){return e>=ct.ZERO&&e<=ct.NINE}function aI(e){return e>=ct.UPPER_A&&e<=ct.UPPER_F||e>=ct.LOWER_A&&e<=ct.LOWER_F}function iI(e){return e>=ct.UPPER_A&&e<=ct.UPPER_Z||e>=ct.LOWER_A&&e<=ct.LOWER_Z||Vd(e)}function lI(e){return e===ct.EQUALS||iI(e)}var lt;(function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"})(lt||(lt={}));var Xn;(function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"})(Xn||(Xn={}));class oI{constructor(t,n,r){this.decodeTree=t,this.emitCodePoint=n,this.errors=r,this.state=lt.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Xn.Strict}startEntity(t){this.decodeMode=t,this.state=lt.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,n){switch(this.state){case lt.EntityStart:return t.charCodeAt(n)===ct.NUM?(this.state=lt.NumericStart,this.consumed+=1,this.stateNumericStart(t,n+1)):(this.state=lt.NamedEntity,this.stateNamedEntity(t,n));case lt.NumericStart:return this.stateNumericStart(t,n);case lt.NumericDecimal:return this.stateNumericDecimal(t,n);case lt.NumericHex:return this.stateNumericHex(t,n);case lt.NamedEntity:return this.stateNamedEntity(t,n)}}stateNumericStart(t,n){return n>=t.length?-1:(t.charCodeAt(n)|sI)===ct.LOWER_X?(this.state=lt.NumericHex,this.consumed+=1,this.stateNumericHex(t,n+1)):(this.state=lt.NumericDecimal,this.stateNumericDecimal(t,n))}addToNumericResult(t,n,r,a){if(n!==r){const i=r-n;this.result=this.result*Math.pow(a,i)+Number.parseInt(t.substr(n,i),a),this.consumed+=i}}stateNumericHex(t,n){const r=n;for(;n<t.length;){const a=t.charCodeAt(n);if(Vd(a)||aI(a))n+=1;else return this.addToNumericResult(t,r,n,16),this.emitNumericEntity(a,3)}return this.addToNumericResult(t,r,n,16),-1}stateNumericDecimal(t,n){const r=n;for(;n<t.length;){const a=t.charCodeAt(n);if(Vd(a))n+=1;else return this.addToNumericResult(t,r,n,10),this.emitNumericEntity(a,2)}return this.addToNumericResult(t,r,n,10),-1}emitNumericEntity(t,n){var r;if(this.consumed<=n)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===ct.SEMI)this.consumed+=1;else if(this.decodeMode===Xn.Strict)return 0;return this.emitCodePoint(rI(this.result),this.consumed),this.errors&&(t!==ct.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,n){const{decodeTree:r}=this;let a=r[this.treeIndex],i=(a&Sr.VALUE_LENGTH)>>14;for(;n<t.length;n++,this.excess++){const l=t.charCodeAt(n);if(this.treeIndex=cI(r,a,this.treeIndex+Math.max(1,i),l),this.treeIndex<0)return this.result===0||this.decodeMode===Xn.Attribute&&(i===0||lI(l))?0:this.emitNotTerminatedNamedEntity();if(a=r[this.treeIndex],i=(a&Sr.VALUE_LENGTH)>>14,i!==0){if(l===ct.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==Xn.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:n,decodeTree:r}=this,a=(r[n]&Sr.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,a,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,n,r){const{decodeTree:a}=this;return this.emitCodePoint(n===1?a[t]&~Sr.VALUE_LENGTH:a[t+1],r),n===3&&this.emitCodePoint(a[t+2],r),r}end(){var t;switch(this.state){case lt.NamedEntity:return this.result!==0&&(this.decodeMode!==Xn.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case lt.NumericDecimal:return this.emitNumericEntity(0,2);case lt.NumericHex:return this.emitNumericEntity(0,3);case lt.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case lt.EntityStart:return 0}}}function cI(e,t,n,r){const a=(t&Sr.BRANCH_LENGTH)>>7,i=t&Sr.JUMP_TABLE;if(a===0)return i!==0&&r===i?n:-1;if(i){const c=r-i;return c<0||c>=a?-1:e[n+c]-1}let l=n,o=l+a-1;for(;l<=o;){const c=l+o>>>1,u=e[c];if(u<r)l=c+1;else if(u>r)o=c-1;else return e[c+a]}return-1}var K;(function(e){e.HTML="http://www.w3.org/1999/xhtml",e.MATHML="http://www.w3.org/1998/Math/MathML",e.SVG="http://www.w3.org/2000/svg",e.XLINK="http://www.w3.org/1999/xlink",e.XML="http://www.w3.org/XML/1998/namespace",e.XMLNS="http://www.w3.org/2000/xmlns/"})(K||(K={}));var ps;(function(e){e.TYPE="type",e.ACTION="action",e.ENCODING="encoding",e.PROMPT="prompt",e.NAME="name",e.COLOR="color",e.FACE="face",e.SIZE="size"})(ps||(ps={}));var cn;(function(e){e.NO_QUIRKS="no-quirks",e.QUIRKS="quirks",e.LIMITED_QUIRKS="limited-quirks"})(cn||(cn={}));var F;(function(e){e.A="a",e.ADDRESS="address",e.ANNOTATION_XML="annotation-xml",e.APPLET="applet",e.AREA="area",e.ARTICLE="article",e.ASIDE="aside",e.B="b",e.BASE="base",e.BASEFONT="basefont",e.BGSOUND="bgsound",e.BIG="big",e.BLOCKQUOTE="blockquote",e.BODY="body",e.BR="br",e.BUTTON="button",e.CAPTION="caption",e.CENTER="center",e.CODE="code",e.COL="col",e.COLGROUP="colgroup",e.DD="dd",e.DESC="desc",e.DETAILS="details",e.DIALOG="dialog",e.DIR="dir",e.DIV="div",e.DL="dl",e.DT="dt",e.EM="em",e.EMBED="embed",e.FIELDSET="fieldset",e.FIGCAPTION="figcaption",e.FIGURE="figure",e.FONT="font",e.FOOTER="footer",e.FOREIGN_OBJECT="foreignObject",e.FORM="form",e.FRAME="frame",e.FRAMESET="frameset",e.H1="h1",e.H2="h2",e.H3="h3",e.H4="h4",e.H5="h5",e.H6="h6",e.HEAD="head",e.HEADER="header",e.HGROUP="hgroup",e.HR="hr",e.HTML="html",e.I="i",e.IMG="img",e.IMAGE="image",e.INPUT="input",e.IFRAME="iframe",e.KEYGEN="keygen",e.LABEL="label",e.LI="li",e.LINK="link",e.LISTING="listing",e.MAIN="main",e.MALIGNMARK="malignmark",e.MARQUEE="marquee",e.MATH="math",e.MENU="menu",e.META="meta",e.MGLYPH="mglyph",e.MI="mi",e.MO="mo",e.MN="mn",e.MS="ms",e.MTEXT="mtext",e.NAV="nav",e.NOBR="nobr",e.NOFRAMES="noframes",e.NOEMBED="noembed",e.NOSCRIPT="noscript",e.OBJECT="object",e.OL="ol",e.OPTGROUP="optgroup",e.OPTION="option",e.P="p",e.PARAM="param",e.PLAINTEXT="plaintext",e.PRE="pre",e.RB="rb",e.RP="rp",e.RT="rt",e.RTC="rtc",e.RUBY="ruby",e.S="s",e.SCRIPT="script",e.SEARCH="search",e.SECTION="section",e.SELECT="select",e.SOURCE="source",e.SMALL="small",e.SPAN="span",e.STRIKE="strike",e.STRONG="strong",e.STYLE="style",e.SUB="sub",e.SUMMARY="summary",e.SUP="sup",e.TABLE="table",e.TBODY="tbody",e.TEMPLATE="template",e.TEXTAREA="textarea",e.TFOOT="tfoot",e.TD="td",e.TH="th",e.THEAD="thead",e.TITLE="title",e.TR="tr",e.TRACK="track",e.TT="tt",e.U="u",e.UL="ul",e.SVG="svg",e.VAR="var",e.WBR="wbr",e.XMP="xmp"})(F||(F={}));var h;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.A=1]="A",e[e.ADDRESS=2]="ADDRESS",e[e.ANNOTATION_XML=3]="ANNOTATION_XML",e[e.APPLET=4]="APPLET",e[e.AREA=5]="AREA",e[e.ARTICLE=6]="ARTICLE",e[e.ASIDE=7]="ASIDE",e[e.B=8]="B",e[e.BASE=9]="BASE",e[e.BASEFONT=10]="BASEFONT",e[e.BGSOUND=11]="BGSOUND",e[e.BIG=12]="BIG",e[e.BLOCKQUOTE=13]="BLOCKQUOTE",e[e.BODY=14]="BODY",e[e.BR=15]="BR",e[e.BUTTON=16]="BUTTON",e[e.CAPTION=17]="CAPTION",e[e.CENTER=18]="CENTER",e[e.CODE=19]="CODE",e[e.COL=20]="COL",e[e.COLGROUP=21]="COLGROUP",e[e.DD=22]="DD",e[e.DESC=23]="DESC",e[e.DETAILS=24]="DETAILS",e[e.DIALOG=25]="DIALOG",e[e.DIR=26]="DIR",e[e.DIV=27]="DIV",e[e.DL=28]="DL",e[e.DT=29]="DT",e[e.EM=30]="EM",e[e.EMBED=31]="EMBED",e[e.FIELDSET=32]="FIELDSET",e[e.FIGCAPTION=33]="FIGCAPTION",e[e.FIGURE=34]="FIGURE",e[e.FONT=35]="FONT",e[e.FOOTER=36]="FOOTER",e[e.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",e[e.FORM=38]="FORM",e[e.FRAME=39]="FRAME",e[e.FRAMESET=40]="FRAMESET",e[e.H1=41]="H1",e[e.H2=42]="H2",e[e.H3=43]="H3",e[e.H4=44]="H4",e[e.H5=45]="H5",e[e.H6=46]="H6",e[e.HEAD=47]="HEAD",e[e.HEADER=48]="HEADER",e[e.HGROUP=49]="HGROUP",e[e.HR=50]="HR",e[e.HTML=51]="HTML",e[e.I=52]="I",e[e.IMG=53]="IMG",e[e.IMAGE=54]="IMAGE",e[e.INPUT=55]="INPUT",e[e.IFRAME=56]="IFRAME",e[e.KEYGEN=57]="KEYGEN",e[e.LABEL=58]="LABEL",e[e.LI=59]="LI",e[e.LINK=60]="LINK",e[e.LISTING=61]="LISTING",e[e.MAIN=62]="MAIN",e[e.MALIGNMARK=63]="MALIGNMARK",e[e.MARQUEE=64]="MARQUEE",e[e.MATH=65]="MATH",e[e.MENU=66]="MENU",e[e.META=67]="META",e[e.MGLYPH=68]="MGLYPH",e[e.MI=69]="MI",e[e.MO=70]="MO",e[e.MN=71]="MN",e[e.MS=72]="MS",e[e.MTEXT=73]="MTEXT",e[e.NAV=74]="NAV",e[e.NOBR=75]="NOBR",e[e.NOFRAMES=76]="NOFRAMES",e[e.NOEMBED=77]="NOEMBED",e[e.NOSCRIPT=78]="NOSCRIPT",e[e.OBJECT=79]="OBJECT",e[e.OL=80]="OL",e[e.OPTGROUP=81]="OPTGROUP",e[e.OPTION=82]="OPTION",e[e.P=83]="P",e[e.PARAM=84]="PARAM",e[e.PLAINTEXT=85]="PLAINTEXT",e[e.PRE=86]="PRE",e[e.RB=87]="RB",e[e.RP=88]="RP",e[e.RT=89]="RT",e[e.RTC=90]="RTC",e[e.RUBY=91]="RUBY",e[e.S=92]="S",e[e.SCRIPT=93]="SCRIPT",e[e.SEARCH=94]="SEARCH",e[e.SECTION=95]="SECTION",e[e.SELECT=96]="SELECT",e[e.SOURCE=97]="SOURCE",e[e.SMALL=98]="SMALL",e[e.SPAN=99]="SPAN",e[e.STRIKE=100]="STRIKE",e[e.STRONG=101]="STRONG",e[e.STYLE=102]="STYLE",e[e.SUB=103]="SUB",e[e.SUMMARY=104]="SUMMARY",e[e.SUP=105]="SUP",e[e.TABLE=106]="TABLE",e[e.TBODY=107]="TBODY",e[e.TEMPLATE=108]="TEMPLATE",e[e.TEXTAREA=109]="TEXTAREA",e[e.TFOOT=110]="TFOOT",e[e.TD=111]="TD",e[e.TH=112]="TH",e[e.THEAD=113]="THEAD",e[e.TITLE=114]="TITLE",e[e.TR=115]="TR",e[e.TRACK=116]="TRACK",e[e.TT=117]="TT",e[e.U=118]="U",e[e.UL=119]="UL",e[e.SVG=120]="SVG",e[e.VAR=121]="VAR",e[e.WBR=122]="WBR",e[e.XMP=123]="XMP"})(h||(h={}));const uI=new Map([[F.A,h.A],[F.ADDRESS,h.ADDRESS],[F.ANNOTATION_XML,h.ANNOTATION_XML],[F.APPLET,h.APPLET],[F.AREA,h.AREA],[F.ARTICLE,h.ARTICLE],[F.ASIDE,h.ASIDE],[F.B,h.B],[F.BASE,h.BASE],[F.BASEFONT,h.BASEFONT],[F.BGSOUND,h.BGSOUND],[F.BIG,h.BIG],[F.BLOCKQUOTE,h.BLOCKQUOTE],[F.BODY,h.BODY],[F.BR,h.BR],[F.BUTTON,h.BUTTON],[F.CAPTION,h.CAPTION],[F.CENTER,h.CENTER],[F.CODE,h.CODE],[F.COL,h.COL],[F.COLGROUP,h.COLGROUP],[F.DD,h.DD],[F.DESC,h.DESC],[F.DETAILS,h.DETAILS],[F.DIALOG,h.DIALOG],[F.DIR,h.DIR],[F.DIV,h.DIV],[F.DL,h.DL],[F.DT,h.DT],[F.EM,h.EM],[F.EMBED,h.EMBED],[F.FIELDSET,h.FIELDSET],[F.FIGCAPTION,h.FIGCAPTION],[F.FIGURE,h.FIGURE],[F.FONT,h.FONT],[F.FOOTER,h.FOOTER],[F.FOREIGN_OBJECT,h.FOREIGN_OBJECT],[F.FORM,h.FORM],[F.FRAME,h.FRAME],[F.FRAMESET,h.FRAMESET],[F.H1,h.H1],[F.H2,h.H2],[F.H3,h.H3],[F.H4,h.H4],[F.H5,h.H5],[F.H6,h.H6],[F.HEAD,h.HEAD],[F.HEADER,h.HEADER],[F.HGROUP,h.HGROUP],[F.HR,h.HR],[F.HTML,h.HTML],[F.I,h.I],[F.IMG,h.IMG],[F.IMAGE,h.IMAGE],[F.INPUT,h.INPUT],[F.IFRAME,h.IFRAME],[F.KEYGEN,h.KEYGEN],[F.LABEL,h.LABEL],[F.LI,h.LI],[F.LINK,h.LINK],[F.LISTING,h.LISTING],[F.MAIN,h.MAIN],[F.MALIGNMARK,h.MALIGNMARK],[F.MARQUEE,h.MARQUEE],[F.MATH,h.MATH],[F.MENU,h.MENU],[F.META,h.META],[F.MGLYPH,h.MGLYPH],[F.MI,h.MI],[F.MO,h.MO],[F.MN,h.MN],[F.MS,h.MS],[F.MTEXT,h.MTEXT],[F.NAV,h.NAV],[F.NOBR,h.NOBR],[F.NOFRAMES,h.NOFRAMES],[F.NOEMBED,h.NOEMBED],[F.NOSCRIPT,h.NOSCRIPT],[F.OBJECT,h.OBJECT],[F.OL,h.OL],[F.OPTGROUP,h.OPTGROUP],[F.OPTION,h.OPTION],[F.P,h.P],[F.PARAM,h.PARAM],[F.PLAINTEXT,h.PLAINTEXT],[F.PRE,h.PRE],[F.RB,h.RB],[F.RP,h.RP],[F.RT,h.RT],[F.RTC,h.RTC],[F.RUBY,h.RUBY],[F.S,h.S],[F.SCRIPT,h.SCRIPT],[F.SEARCH,h.SEARCH],[F.SECTION,h.SECTION],[F.SELECT,h.SELECT],[F.SOURCE,h.SOURCE],[F.SMALL,h.SMALL],[F.SPAN,h.SPAN],[F.STRIKE,h.STRIKE],[F.STRONG,h.STRONG],[F.STYLE,h.STYLE],[F.SUB,h.SUB],[F.SUMMARY,h.SUMMARY],[F.SUP,h.SUP],[F.TABLE,h.TABLE],[F.TBODY,h.TBODY],[F.TEMPLATE,h.TEMPLATE],[F.TEXTAREA,h.TEXTAREA],[F.TFOOT,h.TFOOT],[F.TD,h.TD],[F.TH,h.TH],[F.THEAD,h.THEAD],[F.TITLE,h.TITLE],[F.TR,h.TR],[F.TRACK,h.TRACK],[F.TT,h.TT],[F.U,h.U],[F.UL,h.UL],[F.SVG,h.SVG],[F.VAR,h.VAR],[F.WBR,h.WBR],[F.XMP,h.XMP]]);function ja(e){var t;return(t=uI.get(e))!==null&&t!==void 0?t:h.UNKNOWN}const X=h,dI={[K.HTML]:new Set([X.ADDRESS,X.APPLET,X.AREA,X.ARTICLE,X.ASIDE,X.BASE,X.BASEFONT,X.BGSOUND,X.BLOCKQUOTE,X.BODY,X.BR,X.BUTTON,X.CAPTION,X.CENTER,X.COL,X.COLGROUP,X.DD,X.DETAILS,X.DIR,X.DIV,X.DL,X.DT,X.EMBED,X.FIELDSET,X.FIGCAPTION,X.FIGURE,X.FOOTER,X.FORM,X.FRAME,X.FRAMESET,X.H1,X.H2,X.H3,X.H4,X.H5,X.H6,X.HEAD,X.HEADER,X.HGROUP,X.HR,X.HTML,X.IFRAME,X.IMG,X.INPUT,X.LI,X.LINK,X.LISTING,X.MAIN,X.MARQUEE,X.MENU,X.META,X.NAV,X.NOEMBED,X.NOFRAMES,X.NOSCRIPT,X.OBJECT,X.OL,X.P,X.PARAM,X.PLAINTEXT,X.PRE,X.SCRIPT,X.SECTION,X.SELECT,X.SOURCE,X.STYLE,X.SUMMARY,X.TABLE,X.TBODY,X.TD,X.TEMPLATE,X.TEXTAREA,X.TFOOT,X.TH,X.THEAD,X.TITLE,X.TR,X.TRACK,X.UL,X.WBR,X.XMP]),[K.MATHML]:new Set([X.MI,X.MO,X.MN,X.MS,X.MTEXT,X.ANNOTATION_XML]),[K.SVG]:new Set([X.TITLE,X.FOREIGN_OBJECT,X.DESC]),[K.XLINK]:new Set,[K.XML]:new Set,[K.XMLNS]:new Set},Yd=new Set([X.H1,X.H2,X.H3,X.H4,X.H5,X.H6]);F.STYLE,F.SCRIPT,F.XMP,F.IFRAME,F.NOEMBED,F.NOFRAMES,F.PLAINTEXT;var j;(function(e){e[e.DATA=0]="DATA",e[e.RCDATA=1]="RCDATA",e[e.RAWTEXT=2]="RAWTEXT",e[e.SCRIPT_DATA=3]="SCRIPT_DATA",e[e.PLAINTEXT=4]="PLAINTEXT",e[e.TAG_OPEN=5]="TAG_OPEN",e[e.END_TAG_OPEN=6]="END_TAG_OPEN",e[e.TAG_NAME=7]="TAG_NAME",e[e.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",e[e.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",e[e.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",e[e.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",e[e.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",e[e.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",e[e.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",e[e.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",e[e.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",e[e.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",e[e.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",e[e.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",e[e.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",e[e.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",e[e.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",e[e.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",e[e.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",e[e.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",e[e.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",e[e.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",e[e.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",e[e.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",e[e.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",e[e.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",e[e.BOGUS_COMMENT=40]="BOGUS_COMMENT",e[e.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",e[e.COMMENT_START=42]="COMMENT_START",e[e.COMMENT_START_DASH=43]="COMMENT_START_DASH",e[e.COMMENT=44]="COMMENT",e[e.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",e[e.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",e[e.COMMENT_END_DASH=49]="COMMENT_END_DASH",e[e.COMMENT_END=50]="COMMENT_END",e[e.COMMENT_END_BANG=51]="COMMENT_END_BANG",e[e.DOCTYPE=52]="DOCTYPE",e[e.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",e[e.DOCTYPE_NAME=54]="DOCTYPE_NAME",e[e.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",e[e.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",e[e.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",e[e.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",e[e.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",e[e.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",e[e.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",e[e.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",e[e.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",e[e.CDATA_SECTION=68]="CDATA_SECTION",e[e.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",e[e.CDATA_SECTION_END=70]="CDATA_SECTION_END",e[e.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",e[e.AMBIGUOUS_AMPERSAND=72]="AMBIGUOUS_AMPERSAND"})(j||(j={}));const Xe={DATA:j.DATA,RCDATA:j.RCDATA,RAWTEXT:j.RAWTEXT,SCRIPT_DATA:j.SCRIPT_DATA,PLAINTEXT:j.PLAINTEXT,CDATA_SECTION:j.CDATA_SECTION};function hI(e){return e>=w.DIGIT_0&&e<=w.DIGIT_9}function ti(e){return e>=w.LATIN_CAPITAL_A&&e<=w.LATIN_CAPITAL_Z}function mI(e){return e>=w.LATIN_SMALL_A&&e<=w.LATIN_SMALL_Z}function fr(e){return mI(e)||ti(e)}function v0(e){return fr(e)||hI(e)}function Al(e){return e+32}function ub(e){return e===w.SPACE||e===w.LINE_FEED||e===w.TABULATION||e===w.FORM_FEED}function E0(e){return ub(e)||e===w.SOLIDUS||e===w.GREATER_THAN_SIGN}function fI(e){return e===w.NULL?U.nullCharacterReference:e>1114111?U.characterReferenceOutsideUnicodeRange:ib(e)?U.surrogateCharacterReference:ob(e)?U.noncharacterCharacterReference:lb(e)||e===w.CARRIAGE_RETURN?U.controlCharacterReference:null}class pI{constructor(t,n){this.options=t,this.handler=n,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=j.DATA,this.returnState=j.DATA,this.entityStartPos=0,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new eI(n),this.currentLocation=this.getCurrentLocation(-1),this.entityDecoder=new oI(tI,(r,a)=>{this.preprocessor.pos=this.entityStartPos+a-1,this._flushCodePointConsumedAsCharacterReference(r)},n.onParseError?{missingSemicolonAfterCharacterReference:()=>{this._err(U.missingSemicolonAfterCharacterReference,1)},absenceOfDigitsInNumericCharacterReference:r=>{this._err(U.absenceOfDigitsInNumericCharacterReference,this.entityStartPos-this.preprocessor.pos+r)},validateNumericCharacterReference:r=>{const a=fI(r);a&&this._err(a,1)}}:void 0)}_err(t,n=0){var r,a;(a=(r=this.handler).onParseError)===null||a===void 0||a.call(r,this.preprocessor.getError(t,n))}getCurrentLocation(t){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-t,startOffset:this.preprocessor.offset-t,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const t=this._consume();this._ensureHibernation()||this._callState(t)}this.inLoop=!1}}pause(){this.paused=!0}resume(t){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||t==null||t())}write(t,n,r){this.active=!0,this.preprocessor.write(t,n),this._runParsingLoop(),this.paused||r==null||r()}insertHtmlAtCurrentPos(t){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(t),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this.preprocessor.retreat(this.consumedAfterSnapshot),this.consumedAfterSnapshot=0,this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_advanceBy(t){this.consumedAfterSnapshot+=t;for(let n=0;n<t;n++)this.preprocessor.advance()}_consumeSequenceIfMatch(t,n){return this.preprocessor.startsWith(t,n)?(this._advanceBy(t.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:ve.START_TAG,tagName:"",tagID:h.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:ve.END_TAG,tagName:"",tagID:h.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(t){this.currentToken={type:ve.COMMENT,data:"",location:this.getCurrentLocation(t)}}_createDoctypeToken(t){this.currentToken={type:ve.DOCTYPE,name:t,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(t,n){this.currentCharacterToken={type:t,chars:n,location:this.currentLocation}}_createAttr(t){this.currentAttr={name:t,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var t,n;const r=this.currentToken;if(cb(r,this.currentAttr.name)===null){if(r.attrs.push(this.currentAttr),r.location&&this.currentLocation){const a=(t=(n=r.location).attrs)!==null&&t!==void 0?t:n.attrs=Object.create(null);a[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(U.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(t){this._emitCurrentCharacterToken(t.location),this.currentToken=null,t.location&&(t.location.endLine=this.preprocessor.line,t.location.endCol=this.preprocessor.col+1,t.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const t=this.currentToken;this.prepareToken(t),t.tagID=ja(t.tagName),t.type===ve.START_TAG?(this.lastStartTagName=t.tagName,this.handler.onStartTag(t)):(t.attrs.length>0&&this._err(U.endTagWithAttributes),t.selfClosing&&this._err(U.endTagWithTrailingSolidus),this.handler.onEndTag(t)),this.preprocessor.dropParsedChunk()}emitCurrentComment(t){this.prepareToken(t),this.handler.onComment(t),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(t){this.prepareToken(t),this.handler.onDoctype(t),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(t){if(this.currentCharacterToken){switch(t&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=t.startLine,this.currentCharacterToken.location.endCol=t.startCol,this.currentCharacterToken.location.endOffset=t.startOffset),this.currentCharacterToken.type){case ve.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case ve.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case ve.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const t=this.getCurrentLocation(0);t&&(t.endLine=t.startLine,t.endCol=t.startCol,t.endOffset=t.startOffset),this._emitCurrentCharacterToken(t),this.handler.onEof({type:ve.EOF,location:t}),this.active=!1}_appendCharToCurrentCharacterToken(t,n){if(this.currentCharacterToken)if(this.currentCharacterToken.type===t){this.currentCharacterToken.chars+=n;return}else this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();this._createCharacterToken(t,n)}_emitCodePoint(t){const n=ub(t)?ve.WHITESPACE_CHARACTER:t===w.NULL?ve.NULL_CHARACTER:ve.CHARACTER;this._appendCharToCurrentCharacterToken(n,String.fromCodePoint(t))}_emitChars(t){this._appendCharToCurrentCharacterToken(ve.CHARACTER,t)}_startCharacterReference(){this.returnState=this.state,this.state=j.CHARACTER_REFERENCE,this.entityStartPos=this.preprocessor.pos,this.entityDecoder.startEntity(this._isCharacterReferenceInAttribute()?Xn.Attribute:Xn.Legacy)}_isCharacterReferenceInAttribute(){return this.returnState===j.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===j.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===j.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(t){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(t):this._emitCodePoint(t)}_callState(t){switch(this.state){case j.DATA:{this._stateData(t);break}case j.RCDATA:{this._stateRcdata(t);break}case j.RAWTEXT:{this._stateRawtext(t);break}case j.SCRIPT_DATA:{this._stateScriptData(t);break}case j.PLAINTEXT:{this._statePlaintext(t);break}case j.TAG_OPEN:{this._stateTagOpen(t);break}case j.END_TAG_OPEN:{this._stateEndTagOpen(t);break}case j.TAG_NAME:{this._stateTagName(t);break}case j.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(t);break}case j.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(t);break}case j.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(t);break}case j.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(t);break}case j.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(t);break}case j.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(t);break}case j.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(t);break}case j.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(t);break}case j.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(t);break}case j.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(t);break}case j.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(t);break}case j.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(t);break}case j.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(t);break}case j.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(t);break}case j.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(t);break}case j.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(t);break}case j.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(t);break}case j.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(t);break}case j.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(t);break}case j.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(t);break}case j.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(t);break}case j.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(t);break}case j.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(t);break}case j.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(t);break}case j.ATTRIBUTE_NAME:{this._stateAttributeName(t);break}case j.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(t);break}case j.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(t);break}case j.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(t);break}case j.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(t);break}case j.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(t);break}case j.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(t);break}case j.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(t);break}case j.BOGUS_COMMENT:{this._stateBogusComment(t);break}case j.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(t);break}case j.COMMENT_START:{this._stateCommentStart(t);break}case j.COMMENT_START_DASH:{this._stateCommentStartDash(t);break}case j.COMMENT:{this._stateComment(t);break}case j.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(t);break}case j.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(t);break}case j.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(t);break}case j.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(t);break}case j.COMMENT_END_DASH:{this._stateCommentEndDash(t);break}case j.COMMENT_END:{this._stateCommentEnd(t);break}case j.COMMENT_END_BANG:{this._stateCommentEndBang(t);break}case j.DOCTYPE:{this._stateDoctype(t);break}case j.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(t);break}case j.DOCTYPE_NAME:{this._stateDoctypeName(t);break}case j.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(t);break}case j.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(t);break}case j.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(t);break}case j.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(t);break}case j.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(t);break}case j.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(t);break}case j.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(t);break}case j.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(t);break}case j.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(t);break}case j.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(t);break}case j.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(t);break}case j.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(t);break}case j.BOGUS_DOCTYPE:{this._stateBogusDoctype(t);break}case j.CDATA_SECTION:{this._stateCdataSection(t);break}case j.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(t);break}case j.CDATA_SECTION_END:{this._stateCdataSectionEnd(t);break}case j.CHARACTER_REFERENCE:{this._stateCharacterReference();break}case j.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(t);break}default:throw new Error("Unknown state")}}_stateData(t){switch(t){case w.LESS_THAN_SIGN:{this.state=j.TAG_OPEN;break}case w.AMPERSAND:{this._startCharacterReference();break}case w.NULL:{this._err(U.unexpectedNullCharacter),this._emitCodePoint(t);break}case w.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRcdata(t){switch(t){case w.AMPERSAND:{this._startCharacterReference();break}case w.LESS_THAN_SIGN:{this.state=j.RCDATA_LESS_THAN_SIGN;break}case w.NULL:{this._err(U.unexpectedNullCharacter),this._emitChars(ze);break}case w.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRawtext(t){switch(t){case w.LESS_THAN_SIGN:{this.state=j.RAWTEXT_LESS_THAN_SIGN;break}case w.NULL:{this._err(U.unexpectedNullCharacter),this._emitChars(ze);break}case w.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptData(t){switch(t){case w.LESS_THAN_SIGN:{this.state=j.SCRIPT_DATA_LESS_THAN_SIGN;break}case w.NULL:{this._err(U.unexpectedNullCharacter),this._emitChars(ze);break}case w.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_statePlaintext(t){switch(t){case w.NULL:{this._err(U.unexpectedNullCharacter),this._emitChars(ze);break}case w.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateTagOpen(t){if(fr(t))this._createStartTagToken(),this.state=j.TAG_NAME,this._stateTagName(t);else switch(t){case w.EXCLAMATION_MARK:{this.state=j.MARKUP_DECLARATION_OPEN;break}case w.SOLIDUS:{this.state=j.END_TAG_OPEN;break}case w.QUESTION_MARK:{this._err(U.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=j.BOGUS_COMMENT,this._stateBogusComment(t);break}case w.EOF:{this._err(U.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(U.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=j.DATA,this._stateData(t)}}_stateEndTagOpen(t){if(fr(t))this._createEndTagToken(),this.state=j.TAG_NAME,this._stateTagName(t);else switch(t){case w.GREATER_THAN_SIGN:{this._err(U.missingEndTagName),this.state=j.DATA;break}case w.EOF:{this._err(U.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(U.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=j.BOGUS_COMMENT,this._stateBogusComment(t)}}_stateTagName(t){const n=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=j.BEFORE_ATTRIBUTE_NAME;break}case w.SOLIDUS:{this.state=j.SELF_CLOSING_START_TAG;break}case w.GREATER_THAN_SIGN:{this.state=j.DATA,this.emitCurrentTagToken();break}case w.NULL:{this._err(U.unexpectedNullCharacter),n.tagName+=ze;break}case w.EOF:{this._err(U.eofInTag),this._emitEOFToken();break}default:n.tagName+=String.fromCodePoint(ti(t)?Al(t):t)}}_stateRcdataLessThanSign(t){t===w.SOLIDUS?this.state=j.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=j.RCDATA,this._stateRcdata(t))}_stateRcdataEndTagOpen(t){fr(t)?(this.state=j.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(t)):(this._emitChars("</"),this.state=j.RCDATA,this._stateRcdata(t))}handleSpecialEndTag(t){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const n=this.currentToken;switch(n.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=j.BEFORE_ATTRIBUTE_NAME,!1;case w.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=j.SELF_CLOSING_START_TAG,!1;case w.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=j.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=j.RCDATA,this._stateRcdata(t))}_stateRawtextLessThanSign(t){t===w.SOLIDUS?this.state=j.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=j.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagOpen(t){fr(t)?(this.state=j.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(t)):(this._emitChars("</"),this.state=j.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=j.RAWTEXT,this._stateRawtext(t))}_stateScriptDataLessThanSign(t){switch(t){case w.SOLIDUS:{this.state=j.SCRIPT_DATA_END_TAG_OPEN;break}case w.EXCLAMATION_MARK:{this.state=j.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=j.SCRIPT_DATA,this._stateScriptData(t)}}_stateScriptDataEndTagOpen(t){fr(t)?(this.state=j.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(t)):(this._emitChars("</"),this.state=j.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=j.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStart(t){t===w.HYPHEN_MINUS?(this.state=j.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=j.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStartDash(t){t===w.HYPHEN_MINUS?(this.state=j.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=j.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscaped(t){switch(t){case w.HYPHEN_MINUS:{this.state=j.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=j.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case w.NULL:{this._err(U.unexpectedNullCharacter),this._emitChars(ze);break}case w.EOF:{this._err(U.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataEscapedDash(t){switch(t){case w.HYPHEN_MINUS:{this.state=j.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=j.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case w.NULL:{this._err(U.unexpectedNullCharacter),this.state=j.SCRIPT_DATA_ESCAPED,this._emitChars(ze);break}case w.EOF:{this._err(U.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=j.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedDashDash(t){switch(t){case w.HYPHEN_MINUS:{this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=j.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case w.GREATER_THAN_SIGN:{this.state=j.SCRIPT_DATA,this._emitChars(">");break}case w.NULL:{this._err(U.unexpectedNullCharacter),this.state=j.SCRIPT_DATA_ESCAPED,this._emitChars(ze);break}case w.EOF:{this._err(U.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=j.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedLessThanSign(t){t===w.SOLIDUS?this.state=j.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:fr(t)?(this._emitChars("<"),this.state=j.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(t)):(this._emitChars("<"),this.state=j.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagOpen(t){fr(t)?(this.state=j.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(t)):(this._emitChars("</"),this.state=j.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=j.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscapeStart(t){if(this.preprocessor.startsWith(Ot.SCRIPT,!1)&&E0(this.preprocessor.peek(Ot.SCRIPT.length))){this._emitCodePoint(t);for(let n=0;n<Ot.SCRIPT.length;n++)this._emitCodePoint(this._consume());this.state=j.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=j.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscaped(t){switch(t){case w.HYPHEN_MINUS:{this.state=j.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=j.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case w.NULL:{this._err(U.unexpectedNullCharacter),this._emitChars(ze);break}case w.EOF:{this._err(U.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDash(t){switch(t){case w.HYPHEN_MINUS:{this.state=j.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=j.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case w.NULL:{this._err(U.unexpectedNullCharacter),this.state=j.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(ze);break}case w.EOF:{this._err(U.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=j.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDashDash(t){switch(t){case w.HYPHEN_MINUS:{this._emitChars("-");break}case w.LESS_THAN_SIGN:{this.state=j.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case w.GREATER_THAN_SIGN:{this.state=j.SCRIPT_DATA,this._emitChars(">");break}case w.NULL:{this._err(U.unexpectedNullCharacter),this.state=j.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(ze);break}case w.EOF:{this._err(U.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=j.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedLessThanSign(t){t===w.SOLIDUS?(this.state=j.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=j.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateScriptDataDoubleEscapeEnd(t){if(this.preprocessor.startsWith(Ot.SCRIPT,!1)&&E0(this.preprocessor.peek(Ot.SCRIPT.length))){this._emitCodePoint(t);for(let n=0;n<Ot.SCRIPT.length;n++)this._emitCodePoint(this._consume());this.state=j.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=j.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateBeforeAttributeName(t){switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.SOLIDUS:case w.GREATER_THAN_SIGN:case w.EOF:{this.state=j.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case w.EQUALS_SIGN:{this._err(U.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=j.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=j.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateAttributeName(t){switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:case w.SOLIDUS:case w.GREATER_THAN_SIGN:case w.EOF:{this._leaveAttrName(),this.state=j.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case w.EQUALS_SIGN:{this._leaveAttrName(),this.state=j.BEFORE_ATTRIBUTE_VALUE;break}case w.QUOTATION_MARK:case w.APOSTROPHE:case w.LESS_THAN_SIGN:{this._err(U.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(t);break}case w.NULL:{this._err(U.unexpectedNullCharacter),this.currentAttr.name+=ze;break}default:this.currentAttr.name+=String.fromCodePoint(ti(t)?Al(t):t)}}_stateAfterAttributeName(t){switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.SOLIDUS:{this.state=j.SELF_CLOSING_START_TAG;break}case w.EQUALS_SIGN:{this.state=j.BEFORE_ATTRIBUTE_VALUE;break}case w.GREATER_THAN_SIGN:{this.state=j.DATA,this.emitCurrentTagToken();break}case w.EOF:{this._err(U.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=j.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateBeforeAttributeValue(t){switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.QUOTATION_MARK:{this.state=j.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case w.APOSTROPHE:{this.state=j.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case w.GREATER_THAN_SIGN:{this._err(U.missingAttributeValue),this.state=j.DATA,this.emitCurrentTagToken();break}default:this.state=j.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(t)}}_stateAttributeValueDoubleQuoted(t){switch(t){case w.QUOTATION_MARK:{this.state=j.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case w.AMPERSAND:{this._startCharacterReference();break}case w.NULL:{this._err(U.unexpectedNullCharacter),this.currentAttr.value+=ze;break}case w.EOF:{this._err(U.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueSingleQuoted(t){switch(t){case w.APOSTROPHE:{this.state=j.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case w.AMPERSAND:{this._startCharacterReference();break}case w.NULL:{this._err(U.unexpectedNullCharacter),this.currentAttr.value+=ze;break}case w.EOF:{this._err(U.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueUnquoted(t){switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this._leaveAttrValue(),this.state=j.BEFORE_ATTRIBUTE_NAME;break}case w.AMPERSAND:{this._startCharacterReference();break}case w.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=j.DATA,this.emitCurrentTagToken();break}case w.NULL:{this._err(U.unexpectedNullCharacter),this.currentAttr.value+=ze;break}case w.QUOTATION_MARK:case w.APOSTROPHE:case w.LESS_THAN_SIGN:case w.EQUALS_SIGN:case w.GRAVE_ACCENT:{this._err(U.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(t);break}case w.EOF:{this._err(U.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAfterAttributeValueQuoted(t){switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this._leaveAttrValue(),this.state=j.BEFORE_ATTRIBUTE_NAME;break}case w.SOLIDUS:{this._leaveAttrValue(),this.state=j.SELF_CLOSING_START_TAG;break}case w.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=j.DATA,this.emitCurrentTagToken();break}case w.EOF:{this._err(U.eofInTag),this._emitEOFToken();break}default:this._err(U.missingWhitespaceBetweenAttributes),this.state=j.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateSelfClosingStartTag(t){switch(t){case w.GREATER_THAN_SIGN:{const n=this.currentToken;n.selfClosing=!0,this.state=j.DATA,this.emitCurrentTagToken();break}case w.EOF:{this._err(U.eofInTag),this._emitEOFToken();break}default:this._err(U.unexpectedSolidusInTag),this.state=j.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateBogusComment(t){const n=this.currentToken;switch(t){case w.GREATER_THAN_SIGN:{this.state=j.DATA,this.emitCurrentComment(n);break}case w.EOF:{this.emitCurrentComment(n),this._emitEOFToken();break}case w.NULL:{this._err(U.unexpectedNullCharacter),n.data+=ze;break}default:n.data+=String.fromCodePoint(t)}}_stateMarkupDeclarationOpen(t){this._consumeSequenceIfMatch(Ot.DASH_DASH,!0)?(this._createCommentToken(Ot.DASH_DASH.length+1),this.state=j.COMMENT_START):this._consumeSequenceIfMatch(Ot.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(Ot.DOCTYPE.length+1),this.state=j.DOCTYPE):this._consumeSequenceIfMatch(Ot.CDATA_START,!0)?this.inForeignNode?this.state=j.CDATA_SECTION:(this._err(U.cdataInHtmlContent),this._createCommentToken(Ot.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=j.BOGUS_COMMENT):this._ensureHibernation()||(this._err(U.incorrectlyOpenedComment),this._createCommentToken(2),this.state=j.BOGUS_COMMENT,this._stateBogusComment(t))}_stateCommentStart(t){switch(t){case w.HYPHEN_MINUS:{this.state=j.COMMENT_START_DASH;break}case w.GREATER_THAN_SIGN:{this._err(U.abruptClosingOfEmptyComment),this.state=j.DATA;const n=this.currentToken;this.emitCurrentComment(n);break}default:this.state=j.COMMENT,this._stateComment(t)}}_stateCommentStartDash(t){const n=this.currentToken;switch(t){case w.HYPHEN_MINUS:{this.state=j.COMMENT_END;break}case w.GREATER_THAN_SIGN:{this._err(U.abruptClosingOfEmptyComment),this.state=j.DATA,this.emitCurrentComment(n);break}case w.EOF:{this._err(U.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="-",this.state=j.COMMENT,this._stateComment(t)}}_stateComment(t){const n=this.currentToken;switch(t){case w.HYPHEN_MINUS:{this.state=j.COMMENT_END_DASH;break}case w.LESS_THAN_SIGN:{n.data+="<",this.state=j.COMMENT_LESS_THAN_SIGN;break}case w.NULL:{this._err(U.unexpectedNullCharacter),n.data+=ze;break}case w.EOF:{this._err(U.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+=String.fromCodePoint(t)}}_stateCommentLessThanSign(t){const n=this.currentToken;switch(t){case w.EXCLAMATION_MARK:{n.data+="!",this.state=j.COMMENT_LESS_THAN_SIGN_BANG;break}case w.LESS_THAN_SIGN:{n.data+="<";break}default:this.state=j.COMMENT,this._stateComment(t)}}_stateCommentLessThanSignBang(t){t===w.HYPHEN_MINUS?this.state=j.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=j.COMMENT,this._stateComment(t))}_stateCommentLessThanSignBangDash(t){t===w.HYPHEN_MINUS?this.state=j.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=j.COMMENT_END_DASH,this._stateCommentEndDash(t))}_stateCommentLessThanSignBangDashDash(t){t!==w.GREATER_THAN_SIGN&&t!==w.EOF&&this._err(U.nestedComment),this.state=j.COMMENT_END,this._stateCommentEnd(t)}_stateCommentEndDash(t){const n=this.currentToken;switch(t){case w.HYPHEN_MINUS:{this.state=j.COMMENT_END;break}case w.EOF:{this._err(U.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="-",this.state=j.COMMENT,this._stateComment(t)}}_stateCommentEnd(t){const n=this.currentToken;switch(t){case w.GREATER_THAN_SIGN:{this.state=j.DATA,this.emitCurrentComment(n);break}case w.EXCLAMATION_MARK:{this.state=j.COMMENT_END_BANG;break}case w.HYPHEN_MINUS:{n.data+="-";break}case w.EOF:{this._err(U.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="--",this.state=j.COMMENT,this._stateComment(t)}}_stateCommentEndBang(t){const n=this.currentToken;switch(t){case w.HYPHEN_MINUS:{n.data+="--!",this.state=j.COMMENT_END_DASH;break}case w.GREATER_THAN_SIGN:{this._err(U.incorrectlyClosedComment),this.state=j.DATA,this.emitCurrentComment(n);break}case w.EOF:{this._err(U.eofInComment),this.emitCurrentComment(n),this._emitEOFToken();break}default:n.data+="--!",this.state=j.COMMENT,this._stateComment(t)}}_stateDoctype(t){switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=j.BEFORE_DOCTYPE_NAME;break}case w.GREATER_THAN_SIGN:{this.state=j.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t);break}case w.EOF:{this._err(U.eofInDoctype),this._createDoctypeToken(null);const n=this.currentToken;n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(U.missingWhitespaceBeforeDoctypeName),this.state=j.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t)}}_stateBeforeDoctypeName(t){if(ti(t))this._createDoctypeToken(String.fromCharCode(Al(t))),this.state=j.DOCTYPE_NAME;else switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.NULL:{this._err(U.unexpectedNullCharacter),this._createDoctypeToken(ze),this.state=j.DOCTYPE_NAME;break}case w.GREATER_THAN_SIGN:{this._err(U.missingDoctypeName),this._createDoctypeToken(null);const n=this.currentToken;n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=j.DATA;break}case w.EOF:{this._err(U.eofInDoctype),this._createDoctypeToken(null);const n=this.currentToken;n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(t)),this.state=j.DOCTYPE_NAME}}_stateDoctypeName(t){const n=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=j.AFTER_DOCTYPE_NAME;break}case w.GREATER_THAN_SIGN:{this.state=j.DATA,this.emitCurrentDoctype(n);break}case w.NULL:{this._err(U.unexpectedNullCharacter),n.name+=ze;break}case w.EOF:{this._err(U.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.name+=String.fromCodePoint(ti(t)?Al(t):t)}}_stateAfterDoctypeName(t){const n=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.GREATER_THAN_SIGN:{this.state=j.DATA,this.emitCurrentDoctype(n);break}case w.EOF:{this._err(U.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(Ot.PUBLIC,!1)?this.state=j.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(Ot.SYSTEM,!1)?this.state=j.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(U.invalidCharacterSequenceAfterDoctypeName),n.forceQuirks=!0,this.state=j.BOGUS_DOCTYPE,this._stateBogusDoctype(t))}}_stateAfterDoctypePublicKeyword(t){const n=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=j.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case w.QUOTATION_MARK:{this._err(U.missingWhitespaceAfterDoctypePublicKeyword),n.publicId="",this.state=j.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{this._err(U.missingWhitespaceAfterDoctypePublicKeyword),n.publicId="",this.state=j.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case w.GREATER_THAN_SIGN:{this._err(U.missingDoctypePublicIdentifier),n.forceQuirks=!0,this.state=j.DATA,this.emitCurrentDoctype(n);break}case w.EOF:{this._err(U.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(U.missingQuoteBeforeDoctypePublicIdentifier),n.forceQuirks=!0,this.state=j.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypePublicIdentifier(t){const n=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.QUOTATION_MARK:{n.publicId="",this.state=j.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{n.publicId="",this.state=j.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case w.GREATER_THAN_SIGN:{this._err(U.missingDoctypePublicIdentifier),n.forceQuirks=!0,this.state=j.DATA,this.emitCurrentDoctype(n);break}case w.EOF:{this._err(U.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(U.missingQuoteBeforeDoctypePublicIdentifier),n.forceQuirks=!0,this.state=j.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypePublicIdentifierDoubleQuoted(t){const n=this.currentToken;switch(t){case w.QUOTATION_MARK:{this.state=j.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case w.NULL:{this._err(U.unexpectedNullCharacter),n.publicId+=ze;break}case w.GREATER_THAN_SIGN:{this._err(U.abruptDoctypePublicIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=j.DATA;break}case w.EOF:{this._err(U.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.publicId+=String.fromCodePoint(t)}}_stateDoctypePublicIdentifierSingleQuoted(t){const n=this.currentToken;switch(t){case w.APOSTROPHE:{this.state=j.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case w.NULL:{this._err(U.unexpectedNullCharacter),n.publicId+=ze;break}case w.GREATER_THAN_SIGN:{this._err(U.abruptDoctypePublicIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=j.DATA;break}case w.EOF:{this._err(U.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.publicId+=String.fromCodePoint(t)}}_stateAfterDoctypePublicIdentifier(t){const n=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=j.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case w.GREATER_THAN_SIGN:{this.state=j.DATA,this.emitCurrentDoctype(n);break}case w.QUOTATION_MARK:{this._err(U.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),n.systemId="",this.state=j.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{this._err(U.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),n.systemId="",this.state=j.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case w.EOF:{this._err(U.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(U.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=j.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBetweenDoctypePublicAndSystemIdentifiers(t){const n=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.GREATER_THAN_SIGN:{this.emitCurrentDoctype(n),this.state=j.DATA;break}case w.QUOTATION_MARK:{n.systemId="",this.state=j.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{n.systemId="",this.state=j.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case w.EOF:{this._err(U.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(U.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=j.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateAfterDoctypeSystemKeyword(t){const n=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:{this.state=j.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case w.QUOTATION_MARK:{this._err(U.missingWhitespaceAfterDoctypeSystemKeyword),n.systemId="",this.state=j.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{this._err(U.missingWhitespaceAfterDoctypeSystemKeyword),n.systemId="",this.state=j.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case w.GREATER_THAN_SIGN:{this._err(U.missingDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=j.DATA,this.emitCurrentDoctype(n);break}case w.EOF:{this._err(U.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(U.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=j.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypeSystemIdentifier(t){const n=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.QUOTATION_MARK:{n.systemId="",this.state=j.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case w.APOSTROPHE:{n.systemId="",this.state=j.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case w.GREATER_THAN_SIGN:{this._err(U.missingDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=j.DATA,this.emitCurrentDoctype(n);break}case w.EOF:{this._err(U.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(U.missingQuoteBeforeDoctypeSystemIdentifier),n.forceQuirks=!0,this.state=j.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypeSystemIdentifierDoubleQuoted(t){const n=this.currentToken;switch(t){case w.QUOTATION_MARK:{this.state=j.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case w.NULL:{this._err(U.unexpectedNullCharacter),n.systemId+=ze;break}case w.GREATER_THAN_SIGN:{this._err(U.abruptDoctypeSystemIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=j.DATA;break}case w.EOF:{this._err(U.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.systemId+=String.fromCodePoint(t)}}_stateDoctypeSystemIdentifierSingleQuoted(t){const n=this.currentToken;switch(t){case w.APOSTROPHE:{this.state=j.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case w.NULL:{this._err(U.unexpectedNullCharacter),n.systemId+=ze;break}case w.GREATER_THAN_SIGN:{this._err(U.abruptDoctypeSystemIdentifier),n.forceQuirks=!0,this.emitCurrentDoctype(n),this.state=j.DATA;break}case w.EOF:{this._err(U.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:n.systemId+=String.fromCodePoint(t)}}_stateAfterDoctypeSystemIdentifier(t){const n=this.currentToken;switch(t){case w.SPACE:case w.LINE_FEED:case w.TABULATION:case w.FORM_FEED:break;case w.GREATER_THAN_SIGN:{this.emitCurrentDoctype(n),this.state=j.DATA;break}case w.EOF:{this._err(U.eofInDoctype),n.forceQuirks=!0,this.emitCurrentDoctype(n),this._emitEOFToken();break}default:this._err(U.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=j.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBogusDoctype(t){const n=this.currentToken;switch(t){case w.GREATER_THAN_SIGN:{this.emitCurrentDoctype(n),this.state=j.DATA;break}case w.NULL:{this._err(U.unexpectedNullCharacter);break}case w.EOF:{this.emitCurrentDoctype(n),this._emitEOFToken();break}}}_stateCdataSection(t){switch(t){case w.RIGHT_SQUARE_BRACKET:{this.state=j.CDATA_SECTION_BRACKET;break}case w.EOF:{this._err(U.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateCdataSectionBracket(t){t===w.RIGHT_SQUARE_BRACKET?this.state=j.CDATA_SECTION_END:(this._emitChars("]"),this.state=j.CDATA_SECTION,this._stateCdataSection(t))}_stateCdataSectionEnd(t){switch(t){case w.GREATER_THAN_SIGN:{this.state=j.DATA;break}case w.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=j.CDATA_SECTION,this._stateCdataSection(t)}}_stateCharacterReference(){let t=this.entityDecoder.write(this.preprocessor.html,this.preprocessor.pos);if(t<0)if(this.preprocessor.lastChunkWritten)t=this.entityDecoder.end();else{this.active=!1,this.preprocessor.pos=this.preprocessor.html.length-1,this.consumedAfterSnapshot=0,this.preprocessor.endOfChunkHit=!0;return}t===0?(this.preprocessor.pos=this.entityStartPos,this._flushCodePointConsumedAsCharacterReference(w.AMPERSAND),this.state=!this._isCharacterReferenceInAttribute()&&v0(this.preprocessor.peek(1))?j.AMBIGUOUS_AMPERSAND:this.returnState):this.state=this.returnState}_stateAmbiguousAmpersand(t){v0(t)?this._flushCodePointConsumedAsCharacterReference(t):(t===w.SEMICOLON&&this._err(U.unknownNamedCharacterReference),this.state=this.returnState,this._callState(t))}}const db=new Set([h.DD,h.DT,h.LI,h.OPTGROUP,h.OPTION,h.P,h.RB,h.RP,h.RT,h.RTC]),N0=new Set([...db,h.CAPTION,h.COLGROUP,h.TBODY,h.TD,h.TFOOT,h.TH,h.THEAD,h.TR]),Ro=new Set([h.APPLET,h.CAPTION,h.HTML,h.MARQUEE,h.OBJECT,h.TABLE,h.TD,h.TEMPLATE,h.TH]),gI=new Set([...Ro,h.OL,h.UL]),xI=new Set([...Ro,h.BUTTON]),T0=new Set([h.ANNOTATION_XML,h.MI,h.MN,h.MO,h.MS,h.MTEXT]),w0=new Set([h.DESC,h.FOREIGN_OBJECT,h.TITLE]),yI=new Set([h.TR,h.TEMPLATE,h.HTML]),bI=new Set([h.TBODY,h.TFOOT,h.THEAD,h.TEMPLATE,h.HTML]),vI=new Set([h.TABLE,h.TEMPLATE,h.HTML]),EI=new Set([h.TD,h.TH]);class NI{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(t,n,r){this.treeAdapter=n,this.handler=r,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=h.UNKNOWN,this.current=t}_indexOf(t){return this.items.lastIndexOf(t,this.stackTop)}_isInTemplate(){return this.currentTagId===h.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===K.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(t,n){this.stackTop++,this.items[this.stackTop]=t,this.current=t,this.tagIDs[this.stackTop]=n,this.currentTagId=n,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(t,n,!0)}pop(){const t=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!0)}replace(t,n){const r=this._indexOf(t);this.items[r]=n,r===this.stackTop&&(this.current=n)}insertAfter(t,n,r){const a=this._indexOf(t)+1;this.items.splice(a,0,n),this.tagIDs.splice(a,0,r),this.stackTop++,a===this.stackTop&&this._updateCurrentElement(),this.current&&this.currentTagId!==void 0&&this.handler.onItemPush(this.current,this.currentTagId,a===this.stackTop)}popUntilTagNamePopped(t){let n=this.stackTop+1;do n=this.tagIDs.lastIndexOf(t,n-1);while(n>0&&this.treeAdapter.getNamespaceURI(this.items[n])!==K.HTML);this.shortenToLength(Math.max(n,0))}shortenToLength(t){for(;this.stackTop>=t;){const n=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(n,this.stackTop<t)}}popUntilElementPopped(t){const n=this._indexOf(t);this.shortenToLength(Math.max(n,0))}popUntilPopped(t,n){const r=this._indexOfTagNames(t,n);this.shortenToLength(Math.max(r,0))}popUntilNumberedHeaderPopped(){this.popUntilPopped(Yd,K.HTML)}popUntilTableCellPopped(){this.popUntilPopped(EI,K.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(t,n){for(let r=this.stackTop;r>=0;r--)if(t.has(this.tagIDs[r])&&this.treeAdapter.getNamespaceURI(this.items[r])===n)return r;return-1}clearBackTo(t,n){const r=this._indexOfTagNames(t,n);this.shortenToLength(r+1)}clearBackToTableContext(){this.clearBackTo(vI,K.HTML)}clearBackToTableBodyContext(){this.clearBackTo(bI,K.HTML)}clearBackToTableRowContext(){this.clearBackTo(yI,K.HTML)}remove(t){const n=this._indexOf(t);n>=0&&(n===this.stackTop?this.pop():(this.items.splice(n,1),this.tagIDs.splice(n,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===h.BODY?this.items[1]:null}contains(t){return this._indexOf(t)>-1}getCommonAncestor(t){const n=this._indexOf(t)-1;return n>=0?this.items[n]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===h.HTML}hasInDynamicScope(t,n){for(let r=this.stackTop;r>=0;r--){const a=this.tagIDs[r];switch(this.treeAdapter.getNamespaceURI(this.items[r])){case K.HTML:{if(a===t)return!0;if(n.has(a))return!1;break}case K.SVG:{if(w0.has(a))return!1;break}case K.MATHML:{if(T0.has(a))return!1;break}}}return!0}hasInScope(t){return this.hasInDynamicScope(t,Ro)}hasInListItemScope(t){return this.hasInDynamicScope(t,gI)}hasInButtonScope(t){return this.hasInDynamicScope(t,xI)}hasNumberedHeaderInScope(){for(let t=this.stackTop;t>=0;t--){const n=this.tagIDs[t];switch(this.treeAdapter.getNamespaceURI(this.items[t])){case K.HTML:{if(Yd.has(n))return!0;if(Ro.has(n))return!1;break}case K.SVG:{if(w0.has(n))return!1;break}case K.MATHML:{if(T0.has(n))return!1;break}}}return!0}hasInTableScope(t){for(let n=this.stackTop;n>=0;n--)if(this.treeAdapter.getNamespaceURI(this.items[n])===K.HTML)switch(this.tagIDs[n]){case t:return!0;case h.TABLE:case h.HTML:return!1}return!0}hasTableBodyContextInTableScope(){for(let t=this.stackTop;t>=0;t--)if(this.treeAdapter.getNamespaceURI(this.items[t])===K.HTML)switch(this.tagIDs[t]){case h.TBODY:case h.THEAD:case h.TFOOT:return!0;case h.TABLE:case h.HTML:return!1}return!0}hasInSelectScope(t){for(let n=this.stackTop;n>=0;n--)if(this.treeAdapter.getNamespaceURI(this.items[n])===K.HTML)switch(this.tagIDs[n]){case t:return!0;case h.OPTION:case h.OPTGROUP:break;default:return!1}return!0}generateImpliedEndTags(){for(;this.currentTagId!==void 0&&db.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;this.currentTagId!==void 0&&N0.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(t){for(;this.currentTagId!==void 0&&this.currentTagId!==t&&N0.has(this.currentTagId);)this.pop()}}const bu=3;var Dn;(function(e){e[e.Marker=0]="Marker",e[e.Element=1]="Element"})(Dn||(Dn={}));const S0={type:Dn.Marker};class TI{constructor(t){this.treeAdapter=t,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(t,n){const r=[],a=n.length,i=this.treeAdapter.getTagName(t),l=this.treeAdapter.getNamespaceURI(t);for(let o=0;o<this.entries.length;o++){const c=this.entries[o];if(c.type===Dn.Marker)break;const{element:u}=c;if(this.treeAdapter.getTagName(u)===i&&this.treeAdapter.getNamespaceURI(u)===l){const m=this.treeAdapter.getAttrList(u);m.length===a&&r.push({idx:o,attrs:m})}}return r}_ensureNoahArkCondition(t){if(this.entries.length<bu)return;const n=this.treeAdapter.getAttrList(t),r=this._getNoahArkConditionCandidates(t,n);if(r.length<bu)return;const a=new Map(n.map(l=>[l.name,l.value]));let i=0;for(let l=0;l<r.length;l++){const o=r[l];o.attrs.every(c=>a.get(c.name)===c.value)&&(i+=1,i>=bu&&this.entries.splice(o.idx,1))}}insertMarker(){this.entries.unshift(S0)}pushElement(t,n){this._ensureNoahArkCondition(t),this.entries.unshift({type:Dn.Element,element:t,token:n})}insertElementAfterBookmark(t,n){const r=this.entries.indexOf(this.bookmark);this.entries.splice(r,0,{type:Dn.Element,element:t,token:n})}removeEntry(t){const n=this.entries.indexOf(t);n!==-1&&this.entries.splice(n,1)}clearToLastMarker(){const t=this.entries.indexOf(S0);t===-1?this.entries.length=0:this.entries.splice(0,t+1)}getElementEntryInScopeWithTagName(t){const n=this.entries.find(r=>r.type===Dn.Marker||this.treeAdapter.getTagName(r.element)===t);return n&&n.type===Dn.Element?n:null}getElementEntry(t){return this.entries.find(n=>n.type===Dn.Element&&n.element===t)}}const pr={createDocument(){return{nodeName:"#document",mode:cn.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(e,t,n){return{nodeName:e,tagName:e,attrs:n,namespaceURI:t,childNodes:[],parentNode:null}},createCommentNode(e){return{nodeName:"#comment",data:e,parentNode:null}},createTextNode(e){return{nodeName:"#text",value:e,parentNode:null}},appendChild(e,t){e.childNodes.push(t),t.parentNode=e},insertBefore(e,t,n){const r=e.childNodes.indexOf(n);e.childNodes.splice(r,0,t),t.parentNode=e},setTemplateContent(e,t){e.content=t},getTemplateContent(e){return e.content},setDocumentType(e,t,n,r){const a=e.childNodes.find(i=>i.nodeName==="#documentType");if(a)a.name=t,a.publicId=n,a.systemId=r;else{const i={nodeName:"#documentType",name:t,publicId:n,systemId:r,parentNode:null};pr.appendChild(e,i)}},setDocumentMode(e,t){e.mode=t},getDocumentMode(e){return e.mode},detachNode(e){if(e.parentNode){const t=e.parentNode.childNodes.indexOf(e);e.parentNode.childNodes.splice(t,1),e.parentNode=null}},insertText(e,t){if(e.childNodes.length>0){const n=e.childNodes[e.childNodes.length-1];if(pr.isTextNode(n)){n.value+=t;return}}pr.appendChild(e,pr.createTextNode(t))},insertTextBefore(e,t,n){const r=e.childNodes[e.childNodes.indexOf(n)-1];r&&pr.isTextNode(r)?r.value+=t:pr.insertBefore(e,pr.createTextNode(t),n)},adoptAttributes(e,t){const n=new Set(e.attrs.map(r=>r.name));for(let r=0;r<t.length;r++)n.has(t[r].name)||e.attrs.push(t[r])},getFirstChild(e){return e.childNodes[0]},getChildNodes(e){return e.childNodes},getParentNode(e){return e.parentNode},getAttrList(e){return e.attrs},getTagName(e){return e.tagName},getNamespaceURI(e){return e.namespaceURI},getTextNodeContent(e){return e.value},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){return e.name},getDocumentTypeNodePublicId(e){return e.publicId},getDocumentTypeNodeSystemId(e){return e.systemId},isTextNode(e){return e.nodeName==="#text"},isCommentNode(e){return e.nodeName==="#comment"},isDocumentTypeNode(e){return e.nodeName==="#documentType"},isElementNode(e){return Object.prototype.hasOwnProperty.call(e,"tagName")},setNodeSourceCodeLocation(e,t){e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){e.sourceCodeLocation={...e.sourceCodeLocation,...t}}},hb="html",wI="about:legacy-compat",SI="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",mb=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],CI=[...mb,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],kI=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),fb=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],jI=[...fb,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function C0(e,t){return t.some(n=>e.startsWith(n))}function AI(e){return e.name===hb&&e.publicId===null&&(e.systemId===null||e.systemId===wI)}function _I(e){if(e.name!==hb)return cn.QUIRKS;const{systemId:t}=e;if(t&&t.toLowerCase()===SI)return cn.QUIRKS;let{publicId:n}=e;if(n!==null){if(n=n.toLowerCase(),kI.has(n))return cn.QUIRKS;let r=t===null?CI:mb;if(C0(n,r))return cn.QUIRKS;if(r=t===null?fb:jI,C0(n,r))return cn.LIMITED_QUIRKS}return cn.NO_QUIRKS}const k0={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},II="definitionurl",LI="definitionURL",RI=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(e=>[e.toLowerCase(),e])),PI=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:K.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:K.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:K.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:K.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:K.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:K.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:K.XLINK}],["xml:lang",{prefix:"xml",name:"lang",namespace:K.XML}],["xml:space",{prefix:"xml",name:"space",namespace:K.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:K.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:K.XMLNS}]]),MI=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(e=>[e.toLowerCase(),e])),OI=new Set([h.B,h.BIG,h.BLOCKQUOTE,h.BODY,h.BR,h.CENTER,h.CODE,h.DD,h.DIV,h.DL,h.DT,h.EM,h.EMBED,h.H1,h.H2,h.H3,h.H4,h.H5,h.H6,h.HEAD,h.HR,h.I,h.IMG,h.LI,h.LISTING,h.MENU,h.META,h.NOBR,h.OL,h.P,h.PRE,h.RUBY,h.S,h.SMALL,h.SPAN,h.STRONG,h.STRIKE,h.SUB,h.SUP,h.TABLE,h.TT,h.U,h.UL,h.VAR]);function DI(e){const t=e.tagID;return t===h.FONT&&e.attrs.some(({name:r})=>r===ps.COLOR||r===ps.SIZE||r===ps.FACE)||OI.has(t)}function pb(e){for(let t=0;t<e.attrs.length;t++)if(e.attrs[t].name===II){e.attrs[t].name=LI;break}}function gb(e){for(let t=0;t<e.attrs.length;t++){const n=RI.get(e.attrs[t].name);n!=null&&(e.attrs[t].name=n)}}function jm(e){for(let t=0;t<e.attrs.length;t++){const n=PI.get(e.attrs[t].name);n&&(e.attrs[t].prefix=n.prefix,e.attrs[t].name=n.name,e.attrs[t].namespace=n.namespace)}}function FI(e){const t=MI.get(e.tagName);t!=null&&(e.tagName=t,e.tagID=ja(e.tagName))}function BI(e,t){return t===K.MATHML&&(e===h.MI||e===h.MO||e===h.MN||e===h.MS||e===h.MTEXT)}function UI(e,t,n){if(t===K.MATHML&&e===h.ANNOTATION_XML){for(let r=0;r<n.length;r++)if(n[r].name===ps.ENCODING){const a=n[r].value.toLowerCase();return a===k0.TEXT_HTML||a===k0.APPLICATION_XML}}return t===K.SVG&&(e===h.FOREIGN_OBJECT||e===h.DESC||e===h.TITLE)}function HI(e,t,n,r){return(!r||r===K.HTML)&&UI(e,t,n)||(!r||r===K.MATHML)&&BI(e,t)}const zI="hidden",$I=8,qI=3;var L;(function(e){e[e.INITIAL=0]="INITIAL",e[e.BEFORE_HTML=1]="BEFORE_HTML",e[e.BEFORE_HEAD=2]="BEFORE_HEAD",e[e.IN_HEAD=3]="IN_HEAD",e[e.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",e[e.AFTER_HEAD=5]="AFTER_HEAD",e[e.IN_BODY=6]="IN_BODY",e[e.TEXT=7]="TEXT",e[e.IN_TABLE=8]="IN_TABLE",e[e.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",e[e.IN_CAPTION=10]="IN_CAPTION",e[e.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",e[e.IN_TABLE_BODY=12]="IN_TABLE_BODY",e[e.IN_ROW=13]="IN_ROW",e[e.IN_CELL=14]="IN_CELL",e[e.IN_SELECT=15]="IN_SELECT",e[e.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",e[e.IN_TEMPLATE=17]="IN_TEMPLATE",e[e.AFTER_BODY=18]="AFTER_BODY",e[e.IN_FRAMESET=19]="IN_FRAMESET",e[e.AFTER_FRAMESET=20]="AFTER_FRAMESET",e[e.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",e[e.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(L||(L={}));const VI={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},xb=new Set([h.TABLE,h.TBODY,h.TFOOT,h.THEAD,h.TR]),j0={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:pr,onParseError:null};class A0{constructor(t,n,r=null,a=null){this.fragmentContext=r,this.scriptHandler=a,this.currentToken=null,this.stopped=!1,this.insertionMode=L.INITIAL,this.originalInsertionMode=L.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...j0,...t},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=n??this.treeAdapter.createDocument(),this.tokenizer=new pI(this.options,this),this.activeFormattingElements=new TI(this.treeAdapter),this.fragmentContextID=r?ja(this.treeAdapter.getTagName(r)):h.UNKNOWN,this._setContextModes(r??this.document,this.fragmentContextID),this.openElements=new NI(this.document,this.treeAdapter,this)}static parse(t,n){const r=new this(n);return r.tokenizer.write(t,!0),r.document}static getFragmentParser(t,n){const r={...j0,...n};t??(t=r.treeAdapter.createElement(F.TEMPLATE,K.HTML,[]));const a=r.treeAdapter.createElement("documentmock",K.HTML,[]),i=new this(r,a,t);return i.fragmentContextID===h.TEMPLATE&&i.tmplInsertionModeStack.unshift(L.IN_TEMPLATE),i._initTokenizerForFragmentParsing(),i._insertFakeRootElement(),i._resetInsertionMode(),i._findFormInFragmentContext(),i}getFragment(){const t=this.treeAdapter.getFirstChild(this.document),n=this.treeAdapter.createDocumentFragment();return this._adoptNodes(t,n),n}_err(t,n,r){var a;if(!this.onParseError)return;const i=(a=t.location)!==null&&a!==void 0?a:VI,l={code:n,startLine:i.startLine,startCol:i.startCol,startOffset:i.startOffset,endLine:r?i.startLine:i.endLine,endCol:r?i.startCol:i.endCol,endOffset:r?i.startOffset:i.endOffset};this.onParseError(l)}onItemPush(t,n,r){var a,i;(i=(a=this.treeAdapter).onItemPush)===null||i===void 0||i.call(a,t),r&&this.openElements.stackTop>0&&this._setContextModes(t,n)}onItemPop(t,n){var r,a;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(t,this.currentToken),(a=(r=this.treeAdapter).onItemPop)===null||a===void 0||a.call(r,t,this.openElements.current),n){let i,l;this.openElements.stackTop===0&&this.fragmentContext?(i=this.fragmentContext,l=this.fragmentContextID):{current:i,currentTagId:l}=this.openElements,this._setContextModes(i,l)}}_setContextModes(t,n){const r=t===this.document||t&&this.treeAdapter.getNamespaceURI(t)===K.HTML;this.currentNotInHTML=!r,this.tokenizer.inForeignNode=!r&&t!==void 0&&n!==void 0&&!this._isIntegrationPoint(n,t)}_switchToTextParsing(t,n){this._insertElement(t,K.HTML),this.tokenizer.state=n,this.originalInsertionMode=this.insertionMode,this.insertionMode=L.TEXT}switchToPlaintextParsing(){this.insertionMode=L.TEXT,this.originalInsertionMode=L.IN_BODY,this.tokenizer.state=Xe.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let t=this.fragmentContext;for(;t;){if(this.treeAdapter.getTagName(t)===F.FORM){this.formElement=t;break}t=this.treeAdapter.getParentNode(t)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==K.HTML))switch(this.fragmentContextID){case h.TITLE:case h.TEXTAREA:{this.tokenizer.state=Xe.RCDATA;break}case h.STYLE:case h.XMP:case h.IFRAME:case h.NOEMBED:case h.NOFRAMES:case h.NOSCRIPT:{this.tokenizer.state=Xe.RAWTEXT;break}case h.SCRIPT:{this.tokenizer.state=Xe.SCRIPT_DATA;break}case h.PLAINTEXT:{this.tokenizer.state=Xe.PLAINTEXT;break}}}_setDocumentType(t){const n=t.name||"",r=t.publicId||"",a=t.systemId||"";if(this.treeAdapter.setDocumentType(this.document,n,r,a),t.location){const l=this.treeAdapter.getChildNodes(this.document).find(o=>this.treeAdapter.isDocumentTypeNode(o));l&&this.treeAdapter.setNodeSourceCodeLocation(l,t.location)}}_attachElementToTree(t,n){if(this.options.sourceCodeLocationInfo){const r=n&&{...n,startTag:n};this.treeAdapter.setNodeSourceCodeLocation(t,r)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(t);else{const r=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(r??this.document,t)}}_appendElement(t,n){const r=this.treeAdapter.createElement(t.tagName,n,t.attrs);this._attachElementToTree(r,t.location)}_insertElement(t,n){const r=this.treeAdapter.createElement(t.tagName,n,t.attrs);this._attachElementToTree(r,t.location),this.openElements.push(r,t.tagID)}_insertFakeElement(t,n){const r=this.treeAdapter.createElement(t,K.HTML,[]);this._attachElementToTree(r,null),this.openElements.push(r,n)}_insertTemplate(t){const n=this.treeAdapter.createElement(t.tagName,K.HTML,t.attrs),r=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(n,r),this._attachElementToTree(n,t.location),this.openElements.push(n,t.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(r,null)}_insertFakeRootElement(){const t=this.treeAdapter.createElement(F.HTML,K.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(t,null),this.treeAdapter.appendChild(this.openElements.current,t),this.openElements.push(t,h.HTML)}_appendCommentNode(t,n){const r=this.treeAdapter.createCommentNode(t.data);this.treeAdapter.appendChild(n,r),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(r,t.location)}_insertCharacters(t){let n,r;if(this._shouldFosterParentOnInsertion()?({parent:n,beforeElement:r}=this._findFosterParentingLocation(),r?this.treeAdapter.insertTextBefore(n,t.chars,r):this.treeAdapter.insertText(n,t.chars)):(n=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(n,t.chars)),!t.location)return;const a=this.treeAdapter.getChildNodes(n),i=r?a.lastIndexOf(r):a.length,l=a[i-1];if(this.treeAdapter.getNodeSourceCodeLocation(l)){const{endLine:c,endCol:u,endOffset:m}=t.location;this.treeAdapter.updateNodeSourceCodeLocation(l,{endLine:c,endCol:u,endOffset:m})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(l,t.location)}_adoptNodes(t,n){for(let r=this.treeAdapter.getFirstChild(t);r;r=this.treeAdapter.getFirstChild(t))this.treeAdapter.detachNode(r),this.treeAdapter.appendChild(n,r)}_setEndLocation(t,n){if(this.treeAdapter.getNodeSourceCodeLocation(t)&&n.location){const r=n.location,a=this.treeAdapter.getTagName(t),i=n.type===ve.END_TAG&&a===n.tagName?{endTag:{...r},endLine:r.endLine,endCol:r.endCol,endOffset:r.endOffset}:{endLine:r.startLine,endCol:r.startCol,endOffset:r.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(t,i)}}shouldProcessStartTagTokenInForeignContent(t){if(!this.currentNotInHTML)return!1;let n,r;return this.openElements.stackTop===0&&this.fragmentContext?(n=this.fragmentContext,r=this.fragmentContextID):{current:n,currentTagId:r}=this.openElements,t.tagID===h.SVG&&this.treeAdapter.getTagName(n)===F.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(n)===K.MATHML?!1:this.tokenizer.inForeignNode||(t.tagID===h.MGLYPH||t.tagID===h.MALIGNMARK)&&r!==void 0&&!this._isIntegrationPoint(r,n,K.HTML)}_processToken(t){switch(t.type){case ve.CHARACTER:{this.onCharacter(t);break}case ve.NULL_CHARACTER:{this.onNullCharacter(t);break}case ve.COMMENT:{this.onComment(t);break}case ve.DOCTYPE:{this.onDoctype(t);break}case ve.START_TAG:{this._processStartTag(t);break}case ve.END_TAG:{this.onEndTag(t);break}case ve.EOF:{this.onEof(t);break}case ve.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(t);break}}}_isIntegrationPoint(t,n,r){const a=this.treeAdapter.getNamespaceURI(n),i=this.treeAdapter.getAttrList(n);return HI(t,a,i,r)}_reconstructActiveFormattingElements(){const t=this.activeFormattingElements.entries.length;if(t){const n=this.activeFormattingElements.entries.findIndex(a=>a.type===Dn.Marker||this.openElements.contains(a.element)),r=n===-1?t-1:n-1;for(let a=r;a>=0;a--){const i=this.activeFormattingElements.entries[a];this._insertElement(i.token,this.treeAdapter.getNamespaceURI(i.element)),i.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=L.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(h.P),this.openElements.popUntilTagNamePopped(h.P)}_resetInsertionMode(){for(let t=this.openElements.stackTop;t>=0;t--)switch(t===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[t]){case h.TR:{this.insertionMode=L.IN_ROW;return}case h.TBODY:case h.THEAD:case h.TFOOT:{this.insertionMode=L.IN_TABLE_BODY;return}case h.CAPTION:{this.insertionMode=L.IN_CAPTION;return}case h.COLGROUP:{this.insertionMode=L.IN_COLUMN_GROUP;return}case h.TABLE:{this.insertionMode=L.IN_TABLE;return}case h.BODY:{this.insertionMode=L.IN_BODY;return}case h.FRAMESET:{this.insertionMode=L.IN_FRAMESET;return}case h.SELECT:{this._resetInsertionModeForSelect(t);return}case h.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case h.HTML:{this.insertionMode=this.headElement?L.AFTER_HEAD:L.BEFORE_HEAD;return}case h.TD:case h.TH:{if(t>0){this.insertionMode=L.IN_CELL;return}break}case h.HEAD:{if(t>0){this.insertionMode=L.IN_HEAD;return}break}}this.insertionMode=L.IN_BODY}_resetInsertionModeForSelect(t){if(t>0)for(let n=t-1;n>0;n--){const r=this.openElements.tagIDs[n];if(r===h.TEMPLATE)break;if(r===h.TABLE){this.insertionMode=L.IN_SELECT_IN_TABLE;return}}this.insertionMode=L.IN_SELECT}_isElementCausesFosterParenting(t){return xb.has(t)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this.openElements.currentTagId!==void 0&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let t=this.openElements.stackTop;t>=0;t--){const n=this.openElements.items[t];switch(this.openElements.tagIDs[t]){case h.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(n)===K.HTML)return{parent:this.treeAdapter.getTemplateContent(n),beforeElement:null};break}case h.TABLE:{const r=this.treeAdapter.getParentNode(n);return r?{parent:r,beforeElement:n}:{parent:this.openElements.items[t-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(t){const n=this._findFosterParentingLocation();n.beforeElement?this.treeAdapter.insertBefore(n.parent,t,n.beforeElement):this.treeAdapter.appendChild(n.parent,t)}_isSpecialElement(t,n){const r=this.treeAdapter.getNamespaceURI(t);return dI[r].has(n)}onCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){ER(this,t);return}switch(this.insertionMode){case L.INITIAL:{Ka(this,t);break}case L.BEFORE_HTML:{fi(this,t);break}case L.BEFORE_HEAD:{pi(this,t);break}case L.IN_HEAD:{gi(this,t);break}case L.IN_HEAD_NO_SCRIPT:{xi(this,t);break}case L.AFTER_HEAD:{yi(this,t);break}case L.IN_BODY:case L.IN_CAPTION:case L.IN_CELL:case L.IN_TEMPLATE:{bb(this,t);break}case L.TEXT:case L.IN_SELECT:case L.IN_SELECT_IN_TABLE:{this._insertCharacters(t);break}case L.IN_TABLE:case L.IN_TABLE_BODY:case L.IN_ROW:{vu(this,t);break}case L.IN_TABLE_TEXT:{Sb(this,t);break}case L.IN_COLUMN_GROUP:{Po(this,t);break}case L.AFTER_BODY:{Mo(this,t);break}case L.AFTER_AFTER_BODY:{Ql(this,t);break}}}onNullCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){vR(this,t);return}switch(this.insertionMode){case L.INITIAL:{Ka(this,t);break}case L.BEFORE_HTML:{fi(this,t);break}case L.BEFORE_HEAD:{pi(this,t);break}case L.IN_HEAD:{gi(this,t);break}case L.IN_HEAD_NO_SCRIPT:{xi(this,t);break}case L.AFTER_HEAD:{yi(this,t);break}case L.TEXT:{this._insertCharacters(t);break}case L.IN_TABLE:case L.IN_TABLE_BODY:case L.IN_ROW:{vu(this,t);break}case L.IN_COLUMN_GROUP:{Po(this,t);break}case L.AFTER_BODY:{Mo(this,t);break}case L.AFTER_AFTER_BODY:{Ql(this,t);break}}}onComment(t){if(this.skipNextNewLine=!1,this.currentNotInHTML){Wd(this,t);return}switch(this.insertionMode){case L.INITIAL:case L.BEFORE_HTML:case L.BEFORE_HEAD:case L.IN_HEAD:case L.IN_HEAD_NO_SCRIPT:case L.AFTER_HEAD:case L.IN_BODY:case L.IN_TABLE:case L.IN_CAPTION:case L.IN_COLUMN_GROUP:case L.IN_TABLE_BODY:case L.IN_ROW:case L.IN_CELL:case L.IN_SELECT:case L.IN_SELECT_IN_TABLE:case L.IN_TEMPLATE:case L.IN_FRAMESET:case L.AFTER_FRAMESET:{Wd(this,t);break}case L.IN_TABLE_TEXT:{Ga(this,t);break}case L.AFTER_BODY:{JI(this,t);break}case L.AFTER_AFTER_BODY:case L.AFTER_AFTER_FRAMESET:{ZI(this,t);break}}}onDoctype(t){switch(this.skipNextNewLine=!1,this.insertionMode){case L.INITIAL:{eL(this,t);break}case L.BEFORE_HEAD:case L.IN_HEAD:case L.IN_HEAD_NO_SCRIPT:case L.AFTER_HEAD:{this._err(t,U.misplacedDoctype);break}case L.IN_TABLE_TEXT:{Ga(this,t);break}}}onStartTag(t){this.skipNextNewLine=!1,this.currentToken=t,this._processStartTag(t),t.selfClosing&&!t.ackSelfClosing&&this._err(t,U.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(t){this.shouldProcessStartTagTokenInForeignContent(t)?NR(this,t):this._startTagOutsideForeignContent(t)}_startTagOutsideForeignContent(t){switch(this.insertionMode){case L.INITIAL:{Ka(this,t);break}case L.BEFORE_HTML:{tL(this,t);break}case L.BEFORE_HEAD:{rL(this,t);break}case L.IN_HEAD:{Ln(this,t);break}case L.IN_HEAD_NO_SCRIPT:{iL(this,t);break}case L.AFTER_HEAD:{oL(this,t);break}case L.IN_BODY:{Ct(this,t);break}case L.IN_TABLE:{fa(this,t);break}case L.IN_TABLE_TEXT:{Ga(this,t);break}case L.IN_CAPTION:{sR(this,t);break}case L.IN_COLUMN_GROUP:{Im(this,t);break}case L.IN_TABLE_BODY:{yc(this,t);break}case L.IN_ROW:{bc(this,t);break}case L.IN_CELL:{lR(this,t);break}case L.IN_SELECT:{jb(this,t);break}case L.IN_SELECT_IN_TABLE:{cR(this,t);break}case L.IN_TEMPLATE:{dR(this,t);break}case L.AFTER_BODY:{mR(this,t);break}case L.IN_FRAMESET:{fR(this,t);break}case L.AFTER_FRAMESET:{gR(this,t);break}case L.AFTER_AFTER_BODY:{yR(this,t);break}case L.AFTER_AFTER_FRAMESET:{bR(this,t);break}}}onEndTag(t){this.skipNextNewLine=!1,this.currentToken=t,this.currentNotInHTML?TR(this,t):this._endTagOutsideForeignContent(t)}_endTagOutsideForeignContent(t){switch(this.insertionMode){case L.INITIAL:{Ka(this,t);break}case L.BEFORE_HTML:{nL(this,t);break}case L.BEFORE_HEAD:{sL(this,t);break}case L.IN_HEAD:{aL(this,t);break}case L.IN_HEAD_NO_SCRIPT:{lL(this,t);break}case L.AFTER_HEAD:{cL(this,t);break}case L.IN_BODY:{xc(this,t);break}case L.TEXT:{KL(this,t);break}case L.IN_TABLE:{Vi(this,t);break}case L.IN_TABLE_TEXT:{Ga(this,t);break}case L.IN_CAPTION:{aR(this,t);break}case L.IN_COLUMN_GROUP:{iR(this,t);break}case L.IN_TABLE_BODY:{Kd(this,t);break}case L.IN_ROW:{kb(this,t);break}case L.IN_CELL:{oR(this,t);break}case L.IN_SELECT:{Ab(this,t);break}case L.IN_SELECT_IN_TABLE:{uR(this,t);break}case L.IN_TEMPLATE:{hR(this,t);break}case L.AFTER_BODY:{Ib(this,t);break}case L.IN_FRAMESET:{pR(this,t);break}case L.AFTER_FRAMESET:{xR(this,t);break}case L.AFTER_AFTER_BODY:{Ql(this,t);break}}}onEof(t){switch(this.insertionMode){case L.INITIAL:{Ka(this,t);break}case L.BEFORE_HTML:{fi(this,t);break}case L.BEFORE_HEAD:{pi(this,t);break}case L.IN_HEAD:{gi(this,t);break}case L.IN_HEAD_NO_SCRIPT:{xi(this,t);break}case L.AFTER_HEAD:{yi(this,t);break}case L.IN_BODY:case L.IN_TABLE:case L.IN_CAPTION:case L.IN_COLUMN_GROUP:case L.IN_TABLE_BODY:case L.IN_ROW:case L.IN_CELL:case L.IN_SELECT:case L.IN_SELECT_IN_TABLE:{Tb(this,t);break}case L.TEXT:{GL(this,t);break}case L.IN_TABLE_TEXT:{Ga(this,t);break}case L.IN_TEMPLATE:{_b(this,t);break}case L.AFTER_BODY:case L.IN_FRAMESET:case L.AFTER_FRAMESET:case L.AFTER_AFTER_BODY:case L.AFTER_AFTER_FRAMESET:{_m(this,t);break}}}onWhitespaceCharacter(t){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,t.chars.charCodeAt(0)===w.LINE_FEED)){if(t.chars.length===1)return;t.chars=t.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(t);return}switch(this.insertionMode){case L.IN_HEAD:case L.IN_HEAD_NO_SCRIPT:case L.AFTER_HEAD:case L.TEXT:case L.IN_COLUMN_GROUP:case L.IN_SELECT:case L.IN_SELECT_IN_TABLE:case L.IN_FRAMESET:case L.AFTER_FRAMESET:{this._insertCharacters(t);break}case L.IN_BODY:case L.IN_CAPTION:case L.IN_CELL:case L.IN_TEMPLATE:case L.AFTER_BODY:case L.AFTER_AFTER_BODY:case L.AFTER_AFTER_FRAMESET:{yb(this,t);break}case L.IN_TABLE:case L.IN_TABLE_BODY:case L.IN_ROW:{vu(this,t);break}case L.IN_TABLE_TEXT:{wb(this,t);break}}}}function YI(e,t){let n=e.activeFormattingElements.getElementEntryInScopeWithTagName(t.tagName);return n?e.openElements.contains(n.element)?e.openElements.hasInScope(t.tagID)||(n=null):(e.activeFormattingElements.removeEntry(n),n=null):Nb(e,t),n}function WI(e,t){let n=null,r=e.openElements.stackTop;for(;r>=0;r--){const a=e.openElements.items[r];if(a===t.element)break;e._isSpecialElement(a,e.openElements.tagIDs[r])&&(n=a)}return n||(e.openElements.shortenToLength(Math.max(r,0)),e.activeFormattingElements.removeEntry(t)),n}function KI(e,t,n){let r=t,a=e.openElements.getCommonAncestor(t);for(let i=0,l=a;l!==n;i++,l=a){a=e.openElements.getCommonAncestor(l);const o=e.activeFormattingElements.getElementEntry(l),c=o&&i>=qI;!o||c?(c&&e.activeFormattingElements.removeEntry(o),e.openElements.remove(l)):(l=GI(e,o),r===t&&(e.activeFormattingElements.bookmark=o),e.treeAdapter.detachNode(r),e.treeAdapter.appendChild(l,r),r=l)}return r}function GI(e,t){const n=e.treeAdapter.getNamespaceURI(t.element),r=e.treeAdapter.createElement(t.token.tagName,n,t.token.attrs);return e.openElements.replace(t.element,r),t.element=r,r}function QI(e,t,n){const r=e.treeAdapter.getTagName(t),a=ja(r);if(e._isElementCausesFosterParenting(a))e._fosterParentElement(n);else{const i=e.treeAdapter.getNamespaceURI(t);a===h.TEMPLATE&&i===K.HTML&&(t=e.treeAdapter.getTemplateContent(t)),e.treeAdapter.appendChild(t,n)}}function XI(e,t,n){const r=e.treeAdapter.getNamespaceURI(n.element),{token:a}=n,i=e.treeAdapter.createElement(a.tagName,r,a.attrs);e._adoptNodes(t,i),e.treeAdapter.appendChild(t,i),e.activeFormattingElements.insertElementAfterBookmark(i,a),e.activeFormattingElements.removeEntry(n),e.openElements.remove(n.element),e.openElements.insertAfter(t,i,a.tagID)}function Am(e,t){for(let n=0;n<$I;n++){const r=YI(e,t);if(!r)break;const a=WI(e,r);if(!a)break;e.activeFormattingElements.bookmark=r;const i=KI(e,a,r.element),l=e.openElements.getCommonAncestor(r.element);e.treeAdapter.detachNode(i),l&&QI(e,l,i),XI(e,a,r)}}function Wd(e,t){e._appendCommentNode(t,e.openElements.currentTmplContentOrNode)}function JI(e,t){e._appendCommentNode(t,e.openElements.items[0])}function ZI(e,t){e._appendCommentNode(t,e.document)}function _m(e,t){if(e.stopped=!0,t.location){const n=e.fragmentContext?0:2;for(let r=e.openElements.stackTop;r>=n;r--)e._setEndLocation(e.openElements.items[r],t);if(!e.fragmentContext&&e.openElements.stackTop>=0){const r=e.openElements.items[0],a=e.treeAdapter.getNodeSourceCodeLocation(r);if(a&&!a.endTag&&(e._setEndLocation(r,t),e.openElements.stackTop>=1)){const i=e.openElements.items[1],l=e.treeAdapter.getNodeSourceCodeLocation(i);l&&!l.endTag&&e._setEndLocation(i,t)}}}}function eL(e,t){e._setDocumentType(t);const n=t.forceQuirks?cn.QUIRKS:_I(t);AI(t)||e._err(t,U.nonConformingDoctype),e.treeAdapter.setDocumentMode(e.document,n),e.insertionMode=L.BEFORE_HTML}function Ka(e,t){e._err(t,U.missingDoctype,!0),e.treeAdapter.setDocumentMode(e.document,cn.QUIRKS),e.insertionMode=L.BEFORE_HTML,e._processToken(t)}function tL(e,t){t.tagID===h.HTML?(e._insertElement(t,K.HTML),e.insertionMode=L.BEFORE_HEAD):fi(e,t)}function nL(e,t){const n=t.tagID;(n===h.HTML||n===h.HEAD||n===h.BODY||n===h.BR)&&fi(e,t)}function fi(e,t){e._insertFakeRootElement(),e.insertionMode=L.BEFORE_HEAD,e._processToken(t)}function rL(e,t){switch(t.tagID){case h.HTML:{Ct(e,t);break}case h.HEAD:{e._insertElement(t,K.HTML),e.headElement=e.openElements.current,e.insertionMode=L.IN_HEAD;break}default:pi(e,t)}}function sL(e,t){const n=t.tagID;n===h.HEAD||n===h.BODY||n===h.HTML||n===h.BR?pi(e,t):e._err(t,U.endTagWithoutMatchingOpenElement)}function pi(e,t){e._insertFakeElement(F.HEAD,h.HEAD),e.headElement=e.openElements.current,e.insertionMode=L.IN_HEAD,e._processToken(t)}function Ln(e,t){switch(t.tagID){case h.HTML:{Ct(e,t);break}case h.BASE:case h.BASEFONT:case h.BGSOUND:case h.LINK:case h.META:{e._appendElement(t,K.HTML),t.ackSelfClosing=!0;break}case h.TITLE:{e._switchToTextParsing(t,Xe.RCDATA);break}case h.NOSCRIPT:{e.options.scriptingEnabled?e._switchToTextParsing(t,Xe.RAWTEXT):(e._insertElement(t,K.HTML),e.insertionMode=L.IN_HEAD_NO_SCRIPT);break}case h.NOFRAMES:case h.STYLE:{e._switchToTextParsing(t,Xe.RAWTEXT);break}case h.SCRIPT:{e._switchToTextParsing(t,Xe.SCRIPT_DATA);break}case h.TEMPLATE:{e._insertTemplate(t),e.activeFormattingElements.insertMarker(),e.framesetOk=!1,e.insertionMode=L.IN_TEMPLATE,e.tmplInsertionModeStack.unshift(L.IN_TEMPLATE);break}case h.HEAD:{e._err(t,U.misplacedStartTagForHeadElement);break}default:gi(e,t)}}function aL(e,t){switch(t.tagID){case h.HEAD:{e.openElements.pop(),e.insertionMode=L.AFTER_HEAD;break}case h.BODY:case h.BR:case h.HTML:{gi(e,t);break}case h.TEMPLATE:{As(e,t);break}default:e._err(t,U.endTagWithoutMatchingOpenElement)}}function As(e,t){e.openElements.tmplCount>0?(e.openElements.generateImpliedEndTagsThoroughly(),e.openElements.currentTagId!==h.TEMPLATE&&e._err(t,U.closingOfElementWithOpenChildElements),e.openElements.popUntilTagNamePopped(h.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode()):e._err(t,U.endTagWithoutMatchingOpenElement)}function gi(e,t){e.openElements.pop(),e.insertionMode=L.AFTER_HEAD,e._processToken(t)}function iL(e,t){switch(t.tagID){case h.HTML:{Ct(e,t);break}case h.BASEFONT:case h.BGSOUND:case h.HEAD:case h.LINK:case h.META:case h.NOFRAMES:case h.STYLE:{Ln(e,t);break}case h.NOSCRIPT:{e._err(t,U.nestedNoscriptInHead);break}default:xi(e,t)}}function lL(e,t){switch(t.tagID){case h.NOSCRIPT:{e.openElements.pop(),e.insertionMode=L.IN_HEAD;break}case h.BR:{xi(e,t);break}default:e._err(t,U.endTagWithoutMatchingOpenElement)}}function xi(e,t){const n=t.type===ve.EOF?U.openElementsLeftAfterEof:U.disallowedContentInNoscriptInHead;e._err(t,n),e.openElements.pop(),e.insertionMode=L.IN_HEAD,e._processToken(t)}function oL(e,t){switch(t.tagID){case h.HTML:{Ct(e,t);break}case h.BODY:{e._insertElement(t,K.HTML),e.framesetOk=!1,e.insertionMode=L.IN_BODY;break}case h.FRAMESET:{e._insertElement(t,K.HTML),e.insertionMode=L.IN_FRAMESET;break}case h.BASE:case h.BASEFONT:case h.BGSOUND:case h.LINK:case h.META:case h.NOFRAMES:case h.SCRIPT:case h.STYLE:case h.TEMPLATE:case h.TITLE:{e._err(t,U.abandonedHeadElementChild),e.openElements.push(e.headElement,h.HEAD),Ln(e,t),e.openElements.remove(e.headElement);break}case h.HEAD:{e._err(t,U.misplacedStartTagForHeadElement);break}default:yi(e,t)}}function cL(e,t){switch(t.tagID){case h.BODY:case h.HTML:case h.BR:{yi(e,t);break}case h.TEMPLATE:{As(e,t);break}default:e._err(t,U.endTagWithoutMatchingOpenElement)}}function yi(e,t){e._insertFakeElement(F.BODY,h.BODY),e.insertionMode=L.IN_BODY,gc(e,t)}function gc(e,t){switch(t.type){case ve.CHARACTER:{bb(e,t);break}case ve.WHITESPACE_CHARACTER:{yb(e,t);break}case ve.COMMENT:{Wd(e,t);break}case ve.START_TAG:{Ct(e,t);break}case ve.END_TAG:{xc(e,t);break}case ve.EOF:{Tb(e,t);break}}}function yb(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t)}function bb(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t),e.framesetOk=!1}function uL(e,t){e.openElements.tmplCount===0&&e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}function dL(e,t){const n=e.openElements.tryPeekProperlyNestedBodyElement();n&&e.openElements.tmplCount===0&&(e.framesetOk=!1,e.treeAdapter.adoptAttributes(n,t.attrs))}function hL(e,t){const n=e.openElements.tryPeekProperlyNestedBodyElement();e.framesetOk&&n&&(e.treeAdapter.detachNode(n),e.openElements.popAllUpToHtmlElement(),e._insertElement(t,K.HTML),e.insertionMode=L.IN_FRAMESET)}function mL(e,t){e.openElements.hasInButtonScope(h.P)&&e._closePElement(),e._insertElement(t,K.HTML)}function fL(e,t){e.openElements.hasInButtonScope(h.P)&&e._closePElement(),e.openElements.currentTagId!==void 0&&Yd.has(e.openElements.currentTagId)&&e.openElements.pop(),e._insertElement(t,K.HTML)}function pL(e,t){e.openElements.hasInButtonScope(h.P)&&e._closePElement(),e._insertElement(t,K.HTML),e.skipNextNewLine=!0,e.framesetOk=!1}function gL(e,t){const n=e.openElements.tmplCount>0;(!e.formElement||n)&&(e.openElements.hasInButtonScope(h.P)&&e._closePElement(),e._insertElement(t,K.HTML),n||(e.formElement=e.openElements.current))}function xL(e,t){e.framesetOk=!1;const n=t.tagID;for(let r=e.openElements.stackTop;r>=0;r--){const a=e.openElements.tagIDs[r];if(n===h.LI&&a===h.LI||(n===h.DD||n===h.DT)&&(a===h.DD||a===h.DT)){e.openElements.generateImpliedEndTagsWithExclusion(a),e.openElements.popUntilTagNamePopped(a);break}if(a!==h.ADDRESS&&a!==h.DIV&&a!==h.P&&e._isSpecialElement(e.openElements.items[r],a))break}e.openElements.hasInButtonScope(h.P)&&e._closePElement(),e._insertElement(t,K.HTML)}function yL(e,t){e.openElements.hasInButtonScope(h.P)&&e._closePElement(),e._insertElement(t,K.HTML),e.tokenizer.state=Xe.PLAINTEXT}function bL(e,t){e.openElements.hasInScope(h.BUTTON)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(h.BUTTON)),e._reconstructActiveFormattingElements(),e._insertElement(t,K.HTML),e.framesetOk=!1}function vL(e,t){const n=e.activeFormattingElements.getElementEntryInScopeWithTagName(F.A);n&&(Am(e,t),e.openElements.remove(n.element),e.activeFormattingElements.removeEntry(n)),e._reconstructActiveFormattingElements(),e._insertElement(t,K.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function EL(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,K.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function NL(e,t){e._reconstructActiveFormattingElements(),e.openElements.hasInScope(h.NOBR)&&(Am(e,t),e._reconstructActiveFormattingElements()),e._insertElement(t,K.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function TL(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,K.HTML),e.activeFormattingElements.insertMarker(),e.framesetOk=!1}function wL(e,t){e.treeAdapter.getDocumentMode(e.document)!==cn.QUIRKS&&e.openElements.hasInButtonScope(h.P)&&e._closePElement(),e._insertElement(t,K.HTML),e.framesetOk=!1,e.insertionMode=L.IN_TABLE}function vb(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,K.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function Eb(e){const t=cb(e,ps.TYPE);return t!=null&&t.toLowerCase()===zI}function SL(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,K.HTML),Eb(t)||(e.framesetOk=!1),t.ackSelfClosing=!0}function CL(e,t){e._appendElement(t,K.HTML),t.ackSelfClosing=!0}function kL(e,t){e.openElements.hasInButtonScope(h.P)&&e._closePElement(),e._appendElement(t,K.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function jL(e,t){t.tagName=F.IMG,t.tagID=h.IMG,vb(e,t)}function AL(e,t){e._insertElement(t,K.HTML),e.skipNextNewLine=!0,e.tokenizer.state=Xe.RCDATA,e.originalInsertionMode=e.insertionMode,e.framesetOk=!1,e.insertionMode=L.TEXT}function _L(e,t){e.openElements.hasInButtonScope(h.P)&&e._closePElement(),e._reconstructActiveFormattingElements(),e.framesetOk=!1,e._switchToTextParsing(t,Xe.RAWTEXT)}function IL(e,t){e.framesetOk=!1,e._switchToTextParsing(t,Xe.RAWTEXT)}function _0(e,t){e._switchToTextParsing(t,Xe.RAWTEXT)}function LL(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,K.HTML),e.framesetOk=!1,e.insertionMode=e.insertionMode===L.IN_TABLE||e.insertionMode===L.IN_CAPTION||e.insertionMode===L.IN_TABLE_BODY||e.insertionMode===L.IN_ROW||e.insertionMode===L.IN_CELL?L.IN_SELECT_IN_TABLE:L.IN_SELECT}function RL(e,t){e.openElements.currentTagId===h.OPTION&&e.openElements.pop(),e._reconstructActiveFormattingElements(),e._insertElement(t,K.HTML)}function PL(e,t){e.openElements.hasInScope(h.RUBY)&&e.openElements.generateImpliedEndTags(),e._insertElement(t,K.HTML)}function ML(e,t){e.openElements.hasInScope(h.RUBY)&&e.openElements.generateImpliedEndTagsWithExclusion(h.RTC),e._insertElement(t,K.HTML)}function OL(e,t){e._reconstructActiveFormattingElements(),pb(t),jm(t),t.selfClosing?e._appendElement(t,K.MATHML):e._insertElement(t,K.MATHML),t.ackSelfClosing=!0}function DL(e,t){e._reconstructActiveFormattingElements(),gb(t),jm(t),t.selfClosing?e._appendElement(t,K.SVG):e._insertElement(t,K.SVG),t.ackSelfClosing=!0}function I0(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,K.HTML)}function Ct(e,t){switch(t.tagID){case h.I:case h.S:case h.B:case h.U:case h.EM:case h.TT:case h.BIG:case h.CODE:case h.FONT:case h.SMALL:case h.STRIKE:case h.STRONG:{EL(e,t);break}case h.A:{vL(e,t);break}case h.H1:case h.H2:case h.H3:case h.H4:case h.H5:case h.H6:{fL(e,t);break}case h.P:case h.DL:case h.OL:case h.UL:case h.DIV:case h.DIR:case h.NAV:case h.MAIN:case h.MENU:case h.ASIDE:case h.CENTER:case h.FIGURE:case h.FOOTER:case h.HEADER:case h.HGROUP:case h.DIALOG:case h.DETAILS:case h.ADDRESS:case h.ARTICLE:case h.SEARCH:case h.SECTION:case h.SUMMARY:case h.FIELDSET:case h.BLOCKQUOTE:case h.FIGCAPTION:{mL(e,t);break}case h.LI:case h.DD:case h.DT:{xL(e,t);break}case h.BR:case h.IMG:case h.WBR:case h.AREA:case h.EMBED:case h.KEYGEN:{vb(e,t);break}case h.HR:{kL(e,t);break}case h.RB:case h.RTC:{PL(e,t);break}case h.RT:case h.RP:{ML(e,t);break}case h.PRE:case h.LISTING:{pL(e,t);break}case h.XMP:{_L(e,t);break}case h.SVG:{DL(e,t);break}case h.HTML:{uL(e,t);break}case h.BASE:case h.LINK:case h.META:case h.STYLE:case h.TITLE:case h.SCRIPT:case h.BGSOUND:case h.BASEFONT:case h.TEMPLATE:{Ln(e,t);break}case h.BODY:{dL(e,t);break}case h.FORM:{gL(e,t);break}case h.NOBR:{NL(e,t);break}case h.MATH:{OL(e,t);break}case h.TABLE:{wL(e,t);break}case h.INPUT:{SL(e,t);break}case h.PARAM:case h.TRACK:case h.SOURCE:{CL(e,t);break}case h.IMAGE:{jL(e,t);break}case h.BUTTON:{bL(e,t);break}case h.APPLET:case h.OBJECT:case h.MARQUEE:{TL(e,t);break}case h.IFRAME:{IL(e,t);break}case h.SELECT:{LL(e,t);break}case h.OPTION:case h.OPTGROUP:{RL(e,t);break}case h.NOEMBED:case h.NOFRAMES:{_0(e,t);break}case h.FRAMESET:{hL(e,t);break}case h.TEXTAREA:{AL(e,t);break}case h.NOSCRIPT:{e.options.scriptingEnabled?_0(e,t):I0(e,t);break}case h.PLAINTEXT:{yL(e,t);break}case h.COL:case h.TH:case h.TD:case h.TR:case h.HEAD:case h.FRAME:case h.TBODY:case h.TFOOT:case h.THEAD:case h.CAPTION:case h.COLGROUP:break;default:I0(e,t)}}function FL(e,t){if(e.openElements.hasInScope(h.BODY)&&(e.insertionMode=L.AFTER_BODY,e.options.sourceCodeLocationInfo)){const n=e.openElements.tryPeekProperlyNestedBodyElement();n&&e._setEndLocation(n,t)}}function BL(e,t){e.openElements.hasInScope(h.BODY)&&(e.insertionMode=L.AFTER_BODY,Ib(e,t))}function UL(e,t){const n=t.tagID;e.openElements.hasInScope(n)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(n))}function HL(e){const t=e.openElements.tmplCount>0,{formElement:n}=e;t||(e.formElement=null),(n||t)&&e.openElements.hasInScope(h.FORM)&&(e.openElements.generateImpliedEndTags(),t?e.openElements.popUntilTagNamePopped(h.FORM):n&&e.openElements.remove(n))}function zL(e){e.openElements.hasInButtonScope(h.P)||e._insertFakeElement(F.P,h.P),e._closePElement()}function $L(e){e.openElements.hasInListItemScope(h.LI)&&(e.openElements.generateImpliedEndTagsWithExclusion(h.LI),e.openElements.popUntilTagNamePopped(h.LI))}function qL(e,t){const n=t.tagID;e.openElements.hasInScope(n)&&(e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.popUntilTagNamePopped(n))}function VL(e){e.openElements.hasNumberedHeaderInScope()&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilNumberedHeaderPopped())}function YL(e,t){const n=t.tagID;e.openElements.hasInScope(n)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(n),e.activeFormattingElements.clearToLastMarker())}function WL(e){e._reconstructActiveFormattingElements(),e._insertFakeElement(F.BR,h.BR),e.openElements.pop(),e.framesetOk=!1}function Nb(e,t){const n=t.tagName,r=t.tagID;for(let a=e.openElements.stackTop;a>0;a--){const i=e.openElements.items[a],l=e.openElements.tagIDs[a];if(r===l&&(r!==h.UNKNOWN||e.treeAdapter.getTagName(i)===n)){e.openElements.generateImpliedEndTagsWithExclusion(r),e.openElements.stackTop>=a&&e.openElements.shortenToLength(a);break}if(e._isSpecialElement(i,l))break}}function xc(e,t){switch(t.tagID){case h.A:case h.B:case h.I:case h.S:case h.U:case h.EM:case h.TT:case h.BIG:case h.CODE:case h.FONT:case h.NOBR:case h.SMALL:case h.STRIKE:case h.STRONG:{Am(e,t);break}case h.P:{zL(e);break}case h.DL:case h.UL:case h.OL:case h.DIR:case h.DIV:case h.NAV:case h.PRE:case h.MAIN:case h.MENU:case h.ASIDE:case h.BUTTON:case h.CENTER:case h.FIGURE:case h.FOOTER:case h.HEADER:case h.HGROUP:case h.DIALOG:case h.ADDRESS:case h.ARTICLE:case h.DETAILS:case h.SEARCH:case h.SECTION:case h.SUMMARY:case h.LISTING:case h.FIELDSET:case h.BLOCKQUOTE:case h.FIGCAPTION:{UL(e,t);break}case h.LI:{$L(e);break}case h.DD:case h.DT:{qL(e,t);break}case h.H1:case h.H2:case h.H3:case h.H4:case h.H5:case h.H6:{VL(e);break}case h.BR:{WL(e);break}case h.BODY:{FL(e,t);break}case h.HTML:{BL(e,t);break}case h.FORM:{HL(e);break}case h.APPLET:case h.OBJECT:case h.MARQUEE:{YL(e,t);break}case h.TEMPLATE:{As(e,t);break}default:Nb(e,t)}}function Tb(e,t){e.tmplInsertionModeStack.length>0?_b(e,t):_m(e,t)}function KL(e,t){var n;t.tagID===h.SCRIPT&&((n=e.scriptHandler)===null||n===void 0||n.call(e,e.openElements.current)),e.openElements.pop(),e.insertionMode=e.originalInsertionMode}function GL(e,t){e._err(t,U.eofInElementThatCanContainOnlyText),e.openElements.pop(),e.insertionMode=e.originalInsertionMode,e.onEof(t)}function vu(e,t){if(e.openElements.currentTagId!==void 0&&xb.has(e.openElements.currentTagId))switch(e.pendingCharacterTokens.length=0,e.hasNonWhitespacePendingCharacterToken=!1,e.originalInsertionMode=e.insertionMode,e.insertionMode=L.IN_TABLE_TEXT,t.type){case ve.CHARACTER:{Sb(e,t);break}case ve.WHITESPACE_CHARACTER:{wb(e,t);break}}else rl(e,t)}function QL(e,t){e.openElements.clearBackToTableContext(),e.activeFormattingElements.insertMarker(),e._insertElement(t,K.HTML),e.insertionMode=L.IN_CAPTION}function XL(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,K.HTML),e.insertionMode=L.IN_COLUMN_GROUP}function JL(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(F.COLGROUP,h.COLGROUP),e.insertionMode=L.IN_COLUMN_GROUP,Im(e,t)}function ZL(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,K.HTML),e.insertionMode=L.IN_TABLE_BODY}function eR(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(F.TBODY,h.TBODY),e.insertionMode=L.IN_TABLE_BODY,yc(e,t)}function tR(e,t){e.openElements.hasInTableScope(h.TABLE)&&(e.openElements.popUntilTagNamePopped(h.TABLE),e._resetInsertionMode(),e._processStartTag(t))}function nR(e,t){Eb(t)?e._appendElement(t,K.HTML):rl(e,t),t.ackSelfClosing=!0}function rR(e,t){!e.formElement&&e.openElements.tmplCount===0&&(e._insertElement(t,K.HTML),e.formElement=e.openElements.current,e.openElements.pop())}function fa(e,t){switch(t.tagID){case h.TD:case h.TH:case h.TR:{eR(e,t);break}case h.STYLE:case h.SCRIPT:case h.TEMPLATE:{Ln(e,t);break}case h.COL:{JL(e,t);break}case h.FORM:{rR(e,t);break}case h.TABLE:{tR(e,t);break}case h.TBODY:case h.TFOOT:case h.THEAD:{ZL(e,t);break}case h.INPUT:{nR(e,t);break}case h.CAPTION:{QL(e,t);break}case h.COLGROUP:{XL(e,t);break}default:rl(e,t)}}function Vi(e,t){switch(t.tagID){case h.TABLE:{e.openElements.hasInTableScope(h.TABLE)&&(e.openElements.popUntilTagNamePopped(h.TABLE),e._resetInsertionMode());break}case h.TEMPLATE:{As(e,t);break}case h.BODY:case h.CAPTION:case h.COL:case h.COLGROUP:case h.HTML:case h.TBODY:case h.TD:case h.TFOOT:case h.TH:case h.THEAD:case h.TR:break;default:rl(e,t)}}function rl(e,t){const n=e.fosterParentingEnabled;e.fosterParentingEnabled=!0,gc(e,t),e.fosterParentingEnabled=n}function wb(e,t){e.pendingCharacterTokens.push(t)}function Sb(e,t){e.pendingCharacterTokens.push(t),e.hasNonWhitespacePendingCharacterToken=!0}function Ga(e,t){let n=0;if(e.hasNonWhitespacePendingCharacterToken)for(;n<e.pendingCharacterTokens.length;n++)rl(e,e.pendingCharacterTokens[n]);else for(;n<e.pendingCharacterTokens.length;n++)e._insertCharacters(e.pendingCharacterTokens[n]);e.insertionMode=e.originalInsertionMode,e._processToken(t)}const Cb=new Set([h.CAPTION,h.COL,h.COLGROUP,h.TBODY,h.TD,h.TFOOT,h.TH,h.THEAD,h.TR]);function sR(e,t){const n=t.tagID;Cb.has(n)?e.openElements.hasInTableScope(h.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(h.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=L.IN_TABLE,fa(e,t)):Ct(e,t)}function aR(e,t){const n=t.tagID;switch(n){case h.CAPTION:case h.TABLE:{e.openElements.hasInTableScope(h.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(h.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=L.IN_TABLE,n===h.TABLE&&Vi(e,t));break}case h.BODY:case h.COL:case h.COLGROUP:case h.HTML:case h.TBODY:case h.TD:case h.TFOOT:case h.TH:case h.THEAD:case h.TR:break;default:xc(e,t)}}function Im(e,t){switch(t.tagID){case h.HTML:{Ct(e,t);break}case h.COL:{e._appendElement(t,K.HTML),t.ackSelfClosing=!0;break}case h.TEMPLATE:{Ln(e,t);break}default:Po(e,t)}}function iR(e,t){switch(t.tagID){case h.COLGROUP:{e.openElements.currentTagId===h.COLGROUP&&(e.openElements.pop(),e.insertionMode=L.IN_TABLE);break}case h.TEMPLATE:{As(e,t);break}case h.COL:break;default:Po(e,t)}}function Po(e,t){e.openElements.currentTagId===h.COLGROUP&&(e.openElements.pop(),e.insertionMode=L.IN_TABLE,e._processToken(t))}function yc(e,t){switch(t.tagID){case h.TR:{e.openElements.clearBackToTableBodyContext(),e._insertElement(t,K.HTML),e.insertionMode=L.IN_ROW;break}case h.TH:case h.TD:{e.openElements.clearBackToTableBodyContext(),e._insertFakeElement(F.TR,h.TR),e.insertionMode=L.IN_ROW,bc(e,t);break}case h.CAPTION:case h.COL:case h.COLGROUP:case h.TBODY:case h.TFOOT:case h.THEAD:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=L.IN_TABLE,fa(e,t));break}default:fa(e,t)}}function Kd(e,t){const n=t.tagID;switch(t.tagID){case h.TBODY:case h.TFOOT:case h.THEAD:{e.openElements.hasInTableScope(n)&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=L.IN_TABLE);break}case h.TABLE:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=L.IN_TABLE,Vi(e,t));break}case h.BODY:case h.CAPTION:case h.COL:case h.COLGROUP:case h.HTML:case h.TD:case h.TH:case h.TR:break;default:Vi(e,t)}}function bc(e,t){switch(t.tagID){case h.TH:case h.TD:{e.openElements.clearBackToTableRowContext(),e._insertElement(t,K.HTML),e.insertionMode=L.IN_CELL,e.activeFormattingElements.insertMarker();break}case h.CAPTION:case h.COL:case h.COLGROUP:case h.TBODY:case h.TFOOT:case h.THEAD:case h.TR:{e.openElements.hasInTableScope(h.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=L.IN_TABLE_BODY,yc(e,t));break}default:fa(e,t)}}function kb(e,t){switch(t.tagID){case h.TR:{e.openElements.hasInTableScope(h.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=L.IN_TABLE_BODY);break}case h.TABLE:{e.openElements.hasInTableScope(h.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=L.IN_TABLE_BODY,Kd(e,t));break}case h.TBODY:case h.TFOOT:case h.THEAD:{(e.openElements.hasInTableScope(t.tagID)||e.openElements.hasInTableScope(h.TR))&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=L.IN_TABLE_BODY,Kd(e,t));break}case h.BODY:case h.CAPTION:case h.COL:case h.COLGROUP:case h.HTML:case h.TD:case h.TH:break;default:Vi(e,t)}}function lR(e,t){const n=t.tagID;Cb.has(n)?(e.openElements.hasInTableScope(h.TD)||e.openElements.hasInTableScope(h.TH))&&(e._closeTableCell(),bc(e,t)):Ct(e,t)}function oR(e,t){const n=t.tagID;switch(n){case h.TD:case h.TH:{e.openElements.hasInTableScope(n)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(n),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=L.IN_ROW);break}case h.TABLE:case h.TBODY:case h.TFOOT:case h.THEAD:case h.TR:{e.openElements.hasInTableScope(n)&&(e._closeTableCell(),kb(e,t));break}case h.BODY:case h.CAPTION:case h.COL:case h.COLGROUP:case h.HTML:break;default:xc(e,t)}}function jb(e,t){switch(t.tagID){case h.HTML:{Ct(e,t);break}case h.OPTION:{e.openElements.currentTagId===h.OPTION&&e.openElements.pop(),e._insertElement(t,K.HTML);break}case h.OPTGROUP:{e.openElements.currentTagId===h.OPTION&&e.openElements.pop(),e.openElements.currentTagId===h.OPTGROUP&&e.openElements.pop(),e._insertElement(t,K.HTML);break}case h.HR:{e.openElements.currentTagId===h.OPTION&&e.openElements.pop(),e.openElements.currentTagId===h.OPTGROUP&&e.openElements.pop(),e._appendElement(t,K.HTML),t.ackSelfClosing=!0;break}case h.INPUT:case h.KEYGEN:case h.TEXTAREA:case h.SELECT:{e.openElements.hasInSelectScope(h.SELECT)&&(e.openElements.popUntilTagNamePopped(h.SELECT),e._resetInsertionMode(),t.tagID!==h.SELECT&&e._processStartTag(t));break}case h.SCRIPT:case h.TEMPLATE:{Ln(e,t);break}}}function Ab(e,t){switch(t.tagID){case h.OPTGROUP:{e.openElements.stackTop>0&&e.openElements.currentTagId===h.OPTION&&e.openElements.tagIDs[e.openElements.stackTop-1]===h.OPTGROUP&&e.openElements.pop(),e.openElements.currentTagId===h.OPTGROUP&&e.openElements.pop();break}case h.OPTION:{e.openElements.currentTagId===h.OPTION&&e.openElements.pop();break}case h.SELECT:{e.openElements.hasInSelectScope(h.SELECT)&&(e.openElements.popUntilTagNamePopped(h.SELECT),e._resetInsertionMode());break}case h.TEMPLATE:{As(e,t);break}}}function cR(e,t){const n=t.tagID;n===h.CAPTION||n===h.TABLE||n===h.TBODY||n===h.TFOOT||n===h.THEAD||n===h.TR||n===h.TD||n===h.TH?(e.openElements.popUntilTagNamePopped(h.SELECT),e._resetInsertionMode(),e._processStartTag(t)):jb(e,t)}function uR(e,t){const n=t.tagID;n===h.CAPTION||n===h.TABLE||n===h.TBODY||n===h.TFOOT||n===h.THEAD||n===h.TR||n===h.TD||n===h.TH?e.openElements.hasInTableScope(n)&&(e.openElements.popUntilTagNamePopped(h.SELECT),e._resetInsertionMode(),e.onEndTag(t)):Ab(e,t)}function dR(e,t){switch(t.tagID){case h.BASE:case h.BASEFONT:case h.BGSOUND:case h.LINK:case h.META:case h.NOFRAMES:case h.SCRIPT:case h.STYLE:case h.TEMPLATE:case h.TITLE:{Ln(e,t);break}case h.CAPTION:case h.COLGROUP:case h.TBODY:case h.TFOOT:case h.THEAD:{e.tmplInsertionModeStack[0]=L.IN_TABLE,e.insertionMode=L.IN_TABLE,fa(e,t);break}case h.COL:{e.tmplInsertionModeStack[0]=L.IN_COLUMN_GROUP,e.insertionMode=L.IN_COLUMN_GROUP,Im(e,t);break}case h.TR:{e.tmplInsertionModeStack[0]=L.IN_TABLE_BODY,e.insertionMode=L.IN_TABLE_BODY,yc(e,t);break}case h.TD:case h.TH:{e.tmplInsertionModeStack[0]=L.IN_ROW,e.insertionMode=L.IN_ROW,bc(e,t);break}default:e.tmplInsertionModeStack[0]=L.IN_BODY,e.insertionMode=L.IN_BODY,Ct(e,t)}}function hR(e,t){t.tagID===h.TEMPLATE&&As(e,t)}function _b(e,t){e.openElements.tmplCount>0?(e.openElements.popUntilTagNamePopped(h.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode(),e.onEof(t)):_m(e,t)}function mR(e,t){t.tagID===h.HTML?Ct(e,t):Mo(e,t)}function Ib(e,t){var n;if(t.tagID===h.HTML){if(e.fragmentContext||(e.insertionMode=L.AFTER_AFTER_BODY),e.options.sourceCodeLocationInfo&&e.openElements.tagIDs[0]===h.HTML){e._setEndLocation(e.openElements.items[0],t);const r=e.openElements.items[1];r&&!(!((n=e.treeAdapter.getNodeSourceCodeLocation(r))===null||n===void 0)&&n.endTag)&&e._setEndLocation(r,t)}}else Mo(e,t)}function Mo(e,t){e.insertionMode=L.IN_BODY,gc(e,t)}function fR(e,t){switch(t.tagID){case h.HTML:{Ct(e,t);break}case h.FRAMESET:{e._insertElement(t,K.HTML);break}case h.FRAME:{e._appendElement(t,K.HTML),t.ackSelfClosing=!0;break}case h.NOFRAMES:{Ln(e,t);break}}}function pR(e,t){t.tagID===h.FRAMESET&&!e.openElements.isRootHtmlElementCurrent()&&(e.openElements.pop(),!e.fragmentContext&&e.openElements.currentTagId!==h.FRAMESET&&(e.insertionMode=L.AFTER_FRAMESET))}function gR(e,t){switch(t.tagID){case h.HTML:{Ct(e,t);break}case h.NOFRAMES:{Ln(e,t);break}}}function xR(e,t){t.tagID===h.HTML&&(e.insertionMode=L.AFTER_AFTER_FRAMESET)}function yR(e,t){t.tagID===h.HTML?Ct(e,t):Ql(e,t)}function Ql(e,t){e.insertionMode=L.IN_BODY,gc(e,t)}function bR(e,t){switch(t.tagID){case h.HTML:{Ct(e,t);break}case h.NOFRAMES:{Ln(e,t);break}}}function vR(e,t){t.chars=ze,e._insertCharacters(t)}function ER(e,t){e._insertCharacters(t),e.framesetOk=!1}function Lb(e){for(;e.treeAdapter.getNamespaceURI(e.openElements.current)!==K.HTML&&e.openElements.currentTagId!==void 0&&!e._isIntegrationPoint(e.openElements.currentTagId,e.openElements.current);)e.openElements.pop()}function NR(e,t){if(DI(t))Lb(e),e._startTagOutsideForeignContent(t);else{const n=e._getAdjustedCurrentElement(),r=e.treeAdapter.getNamespaceURI(n);r===K.MATHML?pb(t):r===K.SVG&&(FI(t),gb(t)),jm(t),t.selfClosing?e._appendElement(t,r):e._insertElement(t,r),t.ackSelfClosing=!0}}function TR(e,t){if(t.tagID===h.P||t.tagID===h.BR){Lb(e),e._endTagOutsideForeignContent(t);return}for(let n=e.openElements.stackTop;n>0;n--){const r=e.openElements.items[n];if(e.treeAdapter.getNamespaceURI(r)===K.HTML){e._endTagOutsideForeignContent(t);break}const a=e.treeAdapter.getTagName(r);if(a.toLowerCase()===t.tagName){t.tagName=a,e.openElements.shortenToLength(n);break}}}F.AREA,F.BASE,F.BASEFONT,F.BGSOUND,F.BR,F.COL,F.EMBED,F.FRAME,F.HR,F.IMG,F.INPUT,F.KEYGEN,F.LINK,F.META,F.PARAM,F.SOURCE,F.TRACK,F.WBR;const wR=/<(\/?)(iframe|noembed|noframes|plaintext|script|style|textarea|title|xmp)(?=[\t\n\f\r />])/gi,SR=new Set(["mdxFlowExpression","mdxJsxFlowElement","mdxJsxTextElement","mdxTextExpression","mdxjsEsm"]),L0={sourceCodeLocationInfo:!0,scriptingEnabled:!1};function Rb(e,t){const n=MR(e),r=k1("type",{handlers:{root:CR,element:kR,text:jR,comment:Mb,doctype:AR,raw:IR},unknown:LR}),a={parser:n?new A0(L0):A0.getFragmentParser(void 0,L0),handle(o){r(o,a)},stitches:!1,options:t||{}};r(e,a),Aa(a,qn());const i=n?a.parser.document:a.parser.getFragment(),l=C6(i,{file:a.options.file});return a.stitches&&pc(l,"comment",function(o,c,u){const m=o;if(m.value.stitch&&u&&c!==void 0){const d=u.children;return d[c]=m.value.stitch,c}}),l.type==="root"&&l.children.length===1&&l.children[0].type===e.type?l.children[0]:l}function Pb(e,t){let n=-1;if(e)for(;++n<e.length;)t.handle(e[n])}function CR(e,t){Pb(e.children,t)}function kR(e,t){RR(e,t),Pb(e.children,t),PR(e,t)}function jR(e,t){t.parser.tokenizer.state>4&&(t.parser.tokenizer.state=0);const n={type:ve.CHARACTER,chars:e.value,location:sl(e)};Aa(t,qn(e)),t.parser.currentToken=n,t.parser._processToken(t.parser.currentToken)}function AR(e,t){const n={type:ve.DOCTYPE,name:"html",forceQuirks:!1,publicId:"",systemId:"",location:sl(e)};Aa(t,qn(e)),t.parser.currentToken=n,t.parser._processToken(t.parser.currentToken)}function _R(e,t){t.stitches=!0;const n=OR(e);if("children"in e&&"children"in n){const r=Rb({type:"root",children:e.children},t.options);n.children=r.children}Mb({type:"comment",value:{stitch:n}},t)}function Mb(e,t){const n=e.value,r={type:ve.COMMENT,data:n,location:sl(e)};Aa(t,qn(e)),t.parser.currentToken=r,t.parser._processToken(t.parser.currentToken)}function IR(e,t){if(t.parser.tokenizer.preprocessor.html="",t.parser.tokenizer.preprocessor.pos=-1,t.parser.tokenizer.preprocessor.lastGapPos=-2,t.parser.tokenizer.preprocessor.gapStack=[],t.parser.tokenizer.preprocessor.skipNextNewLine=!1,t.parser.tokenizer.preprocessor.lastChunkWritten=!1,t.parser.tokenizer.preprocessor.endOfChunkHit=!1,t.parser.tokenizer.preprocessor.isEol=!1,Ob(t,qn(e)),t.parser.tokenizer.write(t.options.tagfilter?e.value.replace(wR,"&lt;$1$2"):e.value,!1),t.parser.tokenizer._runParsingLoop(),t.parser.tokenizer.state===72||t.parser.tokenizer.state===78){t.parser.tokenizer.preprocessor.lastChunkWritten=!0;const n=t.parser.tokenizer._consume();t.parser.tokenizer._callState(n)}}function LR(e,t){const n=e;if(t.options.passThrough&&t.options.passThrough.includes(n.type))_R(n,t);else{let r="";throw SR.has(n.type)&&(r=". It looks like you are using MDX nodes with `hast-util-raw` (or `rehype-raw`). If you use this because you are using remark or rehype plugins that inject `'html'` nodes, then please raise an issue with that plugin, as its a bad and slow idea. If you use this because you are using markdown syntax, then you have to configure this utility (or plugin) to pass through these nodes (see `passThrough` in docs), but you can also migrate to use the MDX syntax"),new Error("Cannot compile `"+n.type+"` node"+r)}}function Aa(e,t){Ob(e,t);const n=e.parser.tokenizer.currentCharacterToken;n&&n.location&&(n.location.endLine=e.parser.tokenizer.preprocessor.line,n.location.endCol=e.parser.tokenizer.preprocessor.col+1,n.location.endOffset=e.parser.tokenizer.preprocessor.offset+1,e.parser.currentToken=n,e.parser._processToken(e.parser.currentToken)),e.parser.tokenizer.paused=!1,e.parser.tokenizer.inLoop=!1,e.parser.tokenizer.active=!1,e.parser.tokenizer.returnState=Xe.DATA,e.parser.tokenizer.charRefCode=-1,e.parser.tokenizer.consumedAfterSnapshot=-1,e.parser.tokenizer.currentLocation=null,e.parser.tokenizer.currentCharacterToken=null,e.parser.tokenizer.currentToken=null,e.parser.tokenizer.currentAttr={name:"",value:""}}function Ob(e,t){if(t&&t.offset!==void 0){const n={startLine:t.line,startCol:t.column,startOffset:t.offset,endLine:-1,endCol:-1,endOffset:-1};e.parser.tokenizer.preprocessor.lineStartPos=-t.column+1,e.parser.tokenizer.preprocessor.droppedBufferSize=t.offset,e.parser.tokenizer.preprocessor.line=t.line,e.parser.tokenizer.currentLocation=n}}function RR(e,t){const n=e.tagName.toLowerCase();if(t.parser.tokenizer.state===Xe.PLAINTEXT)return;Aa(t,qn(e));const r=t.parser.openElements.current;let a="namespaceURI"in r?r.namespaceURI:ds.html;a===ds.html&&n==="svg"&&(a=ds.svg);const i=H6({...e,children:[]},{space:a===ds.svg?"svg":"html"}),l={type:ve.START_TAG,tagName:n,tagID:ja(n),selfClosing:!1,ackSelfClosing:!1,attrs:"attrs"in i?i.attrs:[],location:sl(e)};t.parser.currentToken=l,t.parser._processToken(t.parser.currentToken),t.parser.tokenizer.lastStartTagName=n}function PR(e,t){const n=e.tagName.toLowerCase();if(!t.parser.tokenizer.inForeignNode&&G6.includes(n)||t.parser.tokenizer.state===Xe.PLAINTEXT)return;Aa(t,cc(e));const r={type:ve.END_TAG,tagName:n,tagID:ja(n),selfClosing:!1,ackSelfClosing:!1,attrs:[],location:sl(e)};t.parser.currentToken=r,t.parser._processToken(t.parser.currentToken),n===t.parser.tokenizer.lastStartTagName&&(t.parser.tokenizer.state===Xe.RCDATA||t.parser.tokenizer.state===Xe.RAWTEXT||t.parser.tokenizer.state===Xe.SCRIPT_DATA)&&(t.parser.tokenizer.state=Xe.DATA)}function MR(e){const t=e.type==="root"?e.children[0]:e;return!!(t&&(t.type==="doctype"||t.type==="element"&&t.tagName.toLowerCase()==="html"))}function sl(e){const t=qn(e)||{line:void 0,column:void 0,offset:void 0},n=cc(e)||{line:void 0,column:void 0,offset:void 0};return{startLine:t.line,startCol:t.column,startOffset:t.offset,endLine:n.line,endCol:n.column,endOffset:n.offset}}function OR(e){return"children"in e?ma({...e,children:[]}):ma(e)}function DR(e){return function(t,n){return Rb(t,{...e,file:n})}}const FR=({children:e,className:t=""})=>s.jsx("div",{className:t,children:s.jsx(e3,{remarkPlugins:[h6,p6],rehypePlugins:[DR],components:{table:({children:n})=>s.jsx("div",{className:"overflow-x-auto my-4",children:s.jsx("table",{className:"min-w-full border-collapse border border-gray-200 text-sm",children:n})}),thead:({children:n})=>s.jsx("thead",{className:"bg-gray-50",children:n}),tbody:({children:n})=>s.jsx("tbody",{className:"bg-white",children:n}),tr:({children:n})=>s.jsx("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:n}),th:({children:n})=>s.jsx("th",{className:"border border-gray-200 px-4 py-2 text-left font-semibold text-gray-900 bg-gray-100",children:n}),td:({children:n})=>s.jsx("td",{className:"border border-gray-200 px-4 py-2 text-gray-700",children:n}),h1:({children:n})=>s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4 mt-6",children:n}),h2:({children:n})=>s.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-3 mt-5",children:n}),h3:({children:n})=>s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2 mt-4",children:n}),h4:({children:n})=>s.jsx("h4",{className:"text-base font-semibold text-gray-800 mb-2 mt-3",children:n}),ul:({children:n})=>s.jsx("ul",{className:"list-disc list-inside my-2 space-y-1 text-gray-700",children:n}),ol:({children:n})=>s.jsx("ol",{className:"list-decimal list-inside my-2 space-y-1 text-gray-700",children:n}),li:({children:n})=>s.jsx("li",{className:"leading-relaxed",children:n}),pre:({children:n})=>s.jsx("pre",{className:"bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto my-4 text-sm",children:n}),code:({children:n,className:r})=>!r?s.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-sm font-mono text-gray-800",children:n}):s.jsx("code",{className:"font-mono",children:n}),blockquote:({children:n})=>s.jsx("blockquote",{className:"border-l-4 border-blue-500 pl-4 py-2 my-4 bg-blue-50 italic text-gray-700",children:n}),a:({href:n,children:r})=>s.jsx("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline hover:no-underline",children:r}),p:({children:n})=>s.jsx("p",{className:"my-2 leading-relaxed text-gray-700",children:n}),strong:({children:n})=>s.jsx("strong",{className:"font-semibold text-gray-900",children:n}),em:({children:n})=>s.jsx("em",{className:"italic text-gray-700",children:n}),hr:()=>s.jsx("hr",{className:"border-t border-gray-200 my-6"}),input:({checked:n,type:r})=>r==="checkbox"?s.jsx("input",{type:"checkbox",checked:n,readOnly:!0,className:"mr-2 rounded border-gray-300"}):null},children:e})});class R0{constructor(t){_e(this,"config");this.config=t}protectMCPResult(t,n){return this.config.enableMasking?(console.log(` Applying ${this.config.maskingLevel} privacy protection to ${n} result`),n==="search_archer_records"?this.protectArcherRecords(t):this.protectGenericResult(t)):(console.warn(" Privacy masking is DISABLED - confidential data may be sent to LLM"),t)}protectArcherRecords(t){var a,i,l;if(!((l=(i=(a=t==null?void 0:t.result)==null?void 0:a.content)==null?void 0:i[0])!=null&&l.text))return t;const n=t.result.content[0].text,r=this.maskSensitiveData(n);return{...t,result:{...t.result,content:[{...t.result.content[0],text:r}]}}}maskSensitiveData(t){let n=t;return n=n.replace(/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g,"[MASKED_EMAIL]"),n=n.replace(/(\+?\d{1,3}[-.\s]?)?\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}/g,"[MASKED_PHONE]"),n=n.replace(/\b[A-Z][a-z]{1,15}[,\s]+[A-Z][a-z]{1,15}\b/g,"[MASKED_NAME]"),this.config.maskingLevel==="strict"&&(n=n.replace(/\b\d{6,}\b/g,"[MASKED_ID]")),this.config.customSensitiveFields.forEach(r=>{const a=new RegExp(`\\b${r}[:s]+[^s
]+`,"gi");n=n.replace(a,`${r}: [MASKED]`)}),n}protectGenericResult(t){return t}}async function BR(e,t){try{const n=t?"user":"tenant",r=localStorage.getItem("auth_token"),a={"Content-Type":"application/json"};r&&(a.Authorization=`Bearer ${r}`),e&&(a["X-Tenant-ID"]=e);const i=await fetch(`https://grc-backend-simple.calmmeadow-5080198e.australiasoutheast.azurecontainerapps.io/api/v1/api/v1/privacy/settings?scope=${n}`,{method:"GET",headers:a});if(!i.ok)throw new Error(`Failed to get privacy config: ${i.statusText}`);const l=await i.json();if(l.success&&l.data)return{enableMasking:l.data.enable_privacy_masking,maskingLevel:l.data.masking_level,customSensitiveFields:l.data.custom_sensitive_fields||[]};throw new Error("Invalid privacy config response")}catch(n){return console.error("Error getting privacy config from API, using safe defaults:",n),{enableMasking:!0,maskingLevel:"strict",customSensitiveFields:["employee_id","ssn","account_number","credit_card","passport","license","salary","address","phone","email"]}}}const Db=rc((e,t)=>({token:null,setToken:n=>{console.log("[OAuth Token Store] Setting token:",n?"token provided":"token cleared"),e({token:n})},clearToken:()=>{console.log("[OAuth Token Store] Clearing token"),e({token:null})},isValidToken:()=>{const n=t();return n.token!==null&&n.token.access_token!==""},getAccessToken:()=>{var r;return((r=t().token)==null?void 0:r.access_token)||null}})),UR=()=>Db.getState().getAccessToken(),Fb=rc((e,t)=>({session:null,setSession:n=>{console.log("[Archer Session Store] Setting session:",n?"session provided":"session cleared"),e({session:n})},clearSession:()=>{console.log("[Archer Session Store] Clearing session"),e({session:null})},isValidSession:()=>{const n=t();return n.session?new Date<new Date(n.session.expiresAt):!1},getArcherConnection:()=>{const n=t();return!n.session||!n.isValidSession()?null:{sessionId:n.session.sessionId,baseUrl:n.session.userInfo.baseUrl,instanceId:n.session.userInfo.instanceId,username:n.session.userInfo.username}}}));class Bb{constructor(){_e(this,"connection",null);_e(this,"messageId",1);_e(this,"mcpStandardUrl","https://grc-mcp-server-prod.eastus.azurecontainer.io:3006/mcp");_e(this,"backendUrl","https://func-grc-backend-prod.azurewebsites.net/api/v1")}async connect(){var t,n;if((t=this.connection)!=null&&t.isConnected)return this.connection;console.log("[MCP Streamable HTTP] Testing connection to MCP server...");try{const r=await fetch(this.mcpStandardUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:"connection-test",method:"tools/list",params:{}}),signal:AbortSignal.timeout(5e3)});if(!r.ok)throw new Error(`Connection failed: ${r.status} ${r.statusText}`);const a=await r.json();if(a.error)throw new Error(`MCP error: ${a.error.message}`);const i=((n=r.headers.get("content-type"))==null?void 0:n.includes("text/event-stream"))||!1;return this.connection={sessionId:crypto.randomUUID(),endpoint:this.mcpStandardUrl,isConnected:!0,supportsStreaming:i},console.log("[MCP Streamable HTTP] Connection established"),console.log(`[MCP Streamable HTTP] Supports streaming: ${i}`),this.connection}catch(r){throw console.error("[MCP Streamable HTTP] Connection failed:",r),new Error(`Failed to connect to MCP server: ${r.message}`)}}async callTool(t,n,r={}){var d;const a=this.connection||await this.connect(),i=UR(),l=Fb.getState().session,o={...n,oauth_token:i,sessionId:n.archer_session_id||(l==null?void 0:l.sessionId)},u={jsonrpc:"2.0",id:this.messageId++,method:"tools/call",params:{name:t,arguments:o}};console.log(`[MCP Streamable HTTP] Calling tool: ${t}`,{args:n,hasOAuthToken:!!i,hasSessionId:!!(n.archer_session_id||l!=null&&l.sessionId),sessionIdSource:n.archer_session_id?"parameter":l!=null&&l.sessionId?"store":"none",actualSessionId:n.archer_session_id||(l==null?void 0:l.sessionId)});const m=r.streaming&&a.supportsStreaming&&r.onProgress;try{const p={"Content-Type":"application/json"};m&&(p.Accept="text/event-stream",console.log(`[MCP Streamable HTTP] Requesting SSE streaming for ${t}`));const f=await fetch(a.endpoint,{method:"POST",headers:p,body:JSON.stringify(u),signal:AbortSignal.timeout(r.timeout||6e4)});if(!f.ok)throw new Error(`HTTP request failed: ${f.status} ${f.statusText}`);if(((d=f.headers.get("content-type"))==null?void 0:d.includes("text/event-stream"))&&m)return await this.handleStreamingResponse(f,t,r.onProgress);{const v=await f.json();if(console.log(`[MCP Streamable HTTP] Received JSON response for ${t}:`,v),v.error)throw new Error(`MCP JSON-RPC error: ${v.error.message}`);return v.result}}catch(p){throw console.error(`[MCP Streamable HTTP] Tool call failed for ${t}:`,p),p}}async handleStreamingResponse(t,n,r){return new Promise((a,i)=>{var d;const l=(d=t.body)==null?void 0:d.getReader();if(!l){i(new Error("No response body for streaming"));return}const o=new TextDecoder;let c="",u=null;(async()=>{try{for(;;){const{done:p,value:f}=await l.read();if(p){u!==null?a(u):i(new Error("Stream ended without final result"));break}c+=o.decode(f,{stream:!0});const g=c.split(`
`);c=g.pop()||"";for(const v of g)if(v.startsWith("data: "))try{const T=JSON.parse(v.slice(6));if(T.type==="progress")r({tool:n,progress:T.progress||0,status:T.status||"processing",data:T.data,timestamp:new Date().toISOString()});else if(T.result!==void 0)u=T.result;else if(T.error){i(new Error(`MCP Streaming error: ${T.error.message}`));return}}catch{console.warn("[MCP Streamable HTTP] Failed to parse streaming data:",v)}}}catch(p){i(p)}})()})}async getTools(){try{const t=await fetch(this.mcpStandardUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:"get-tools",method:"tools/list"})});if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const n=await t.json();if(n.error)throw new Error(n.error.message||"Failed to get tools");return n.result.tools||[]}catch(t){throw console.error("[MCP SSE Client] Error getting tools:",t),t}}async getHealth(){return await(await fetch(`${this.mcpStandardUrl.replace("/mcp","/health")}`)).json()}async getStatus(){return await(await fetch(`${this.mcpStandardUrl.replace("/mcp","/status")}`)).json()}disconnect(){this.connection=null,console.log("[MCP Streamable HTTP] Connection cleared")}isConnected(){var t;return((t=this.connection)==null?void 0:t.isConnected)||!1}getSessionInfo(){return this.connection?{sessionId:this.connection.sessionId,endpoint:this.connection.endpoint}:null}}const Ub=new Bb,HR=Object.freeze(Object.defineProperty({__proto__:null,MCPSSEClient:Bb,mcpSSEClient:Ub},Symbol.toStringTag,{value:"Module"}));class zR{constructor(t,n){_e(this,"tenantId");_e(this,"privacyService",null);_e(this,"config",null);_e(this,"rateLimitQueue",[]);_e(this,"isProcessingQueue",!1);_e(this,"requestCount",0);_e(this,"windowStart",Date.now());this.tenantId=t,this.config=n||null,this.initializePrivacyProtection()}async initializePrivacyProtection(){try{const t=await BR(this.tenantId);this.privacyService=new R0(t),console.log(` Privacy protection initialized for tenant ${this.tenantId}:`,{masking:t.enableMasking,level:t.maskingLevel})}catch(t){console.error(" Failed to initialize privacy protection - using safe defaults:",t),this.privacyService=new R0({enableMasking:!0,maskingLevel:"strict",customSensitiveFields:[]})}}async getMCPToolsAsLLMFunctions(t){var n;try{console.log(`[LLM Service]  Fetching MCP tools for agent ${t.name} with enabled servers:`,t.enabledMcpServers);const r=await fetch("/api/v1/simple-mcp-configs");if(!r.ok)throw new Error(`Failed to fetch MCP configs: ${r.status}`);const i=((n=(await r.json()).data)==null?void 0:n.mcp_servers)||[];console.log("[LLM Service]  Available MCP servers:",i.map(p=>p.server_id));const l=i.filter(p=>t.enabledMcpServers.includes(p.server_id)&&p.is_enabled);if(console.log(`[LLM Service]  Enabled servers for agent ${t.name}:`,l.map(p=>p.server_name)),l.length===0)return console.warn(`[LLM Service]  No enabled MCP servers found for agent ${t.name}`),[];const o=await fetch("/api/v1/mcp/tools");if(!o.ok)throw new Error(`Failed to fetch tools from backend: ${o.status}`);const m=((await o.json()).tools||[]).filter(p=>p.serverId?l.some(f=>f.server_id===p.serverId):!0);console.log(`[LLM Service]  Filtered to ${m.length} tools from ${l.length} enabled servers`);const d=this.convertMcpToolsToLLMFunctions(m);return console.log(`[LLM Service]  Available MCP functions for agent ${t.name}:`,d.length),d}catch(r){return console.error(`[LLM Service]  Error fetching MCP tools for agent ${t.name}:`,r),[]}}filterAndConvertTools(t,n){return!n.enabledMcpServers||n.enabledMcpServers.length===0?(console.log(`[LLM Service] Agent ${n.name} has no enabled MCP servers`),[]):this.convertMcpToolsToLLMFunctions(t)}convertMcpToolsToLLMFunctions(t){const n=new Map;return t.forEach(r=>{const a=r.name,i=r.serverId||"unknown",l=a;(!n.has(l)||i!=="unknown")&&n.set(l,{name:a,description:r.description||`${a} tool from ${i}`,parameters:r.inputSchema||{type:"object",properties:{},required:[]},serverId:i})}),Array.from(n.values())}generateFallbackResponse(t,n,r){let a=`I've analyzed your request using the following tools and gathered this information:

`;return t.forEach((i,l)=>{var c,u,m,d,p;const o=n[l];if(a+=`## ${i}
`,o!=null&&o.success&&(o!=null&&o.result))if(i==="search_archer_records"){const f=(m=(u=(c=o.result)==null?void 0:c.content)==null?void 0:u[0])==null?void 0:m.text;if(f){const g=f.split(`
`),v=((d=g.find(b=>b.includes("Total Records:")))==null?void 0:d.replace(/[^0-9]/g,""))||"Unknown",T=((p=g.find(b=>b.includes("Records from")))==null?void 0:p.match(/"([^"]+)"/))||["","Unknown"];a+=`Found ${v} records from ${T[1]} application.
`;const y=g.filter(b=>b.match(/^\d+\. Record:/));y.length>0&&(a+=`
**Sample Records:**
`,y.slice(0,3).forEach(b=>{a+=`- ${b}
`}))}}else i.includes("security_events")?a+=`Security events analysis completed successfully.
`:a+=`Tool executed successfully and returned data.
`;else a+=`Tool execution ${o!=null&&o.success?"completed":"failed"}.
`;a+=`
`}),a+="This analysis used the available data from your Archer GRC platform. Please let me know if you need more specific information or additional analysis.",a}generateSystemPrompt(t,n,r){let a=t.systemPrompt;const i=`

# MULTI-STEP ANALYSIS FRAMEWORK

You can perform complex, multi-step analysis workflows by calling multiple tools in sequence. For comprehensive requests:

1. **Data Gathering Phase**: Use tools like get_archer_applications, search_archer_records, get_security_events
2. **Analysis Phase**: Process the retrieved data to identify patterns, trends, and insights  
3. **Reporting Phase**: Use tools like generate_security_events_report for detailed summaries
4. **Follow-up**: Ask clarifying questions or suggest additional analysis if needed

## Common Multi-Step Workflows:
- "Security analysis": get_security_events  analyze patterns  generate_security_events_report
- "Application audit": get_archer_applications  search_archer_records  get_archer_stats
- "Compliance review": Multiple data gathering calls  cross-reference analysis  summary report

## Response Guidelines:
1. Always stay in character as ${t.name}
2. **Announce your multi-step approach**: "I'll analyze this in several steps..."
3. **Explain each tool call**: State what you're doing and why before each tool call
4. **Provide methodology**: Explain your analysis approach and data sources
5. **CRITICAL: Always provide a comprehensive final response** that synthesizes all tool results into a clear, actionable summary
6. **Present data clearly**: Use tables, bullet points, and structured formatting to make complex data readable
7. **Include specific details**: Always include record counts, field values, and specific findings from tool results
8. Be professional but approachable in your communication
9. If you cannot help with a request, explain why and suggest alternatives

## Tool Usage Best Practices:
- **Think multi-step**: Complex requests often require multiple tool calls in sequence
- **Validate data**: Always check data quality before making recommendations  
- **Cross-reference**: Use multiple data sources when possible for comprehensive analysis
- **Provide record counts**: Always mention how many records were processed
- **Security events**: For date ranges like "last 30 days", use the timeRange parameter (e.g., "30d")
- **Error handling**: If a tool fails, try alternative approaches or explain limitations

## Search Results Handling:
- **Always summarize search_archer_records results**: Include record count, key fields, and representative examples
- **Format tabular data**: Present record data in clear tables or structured lists
- **Highlight important findings**: Call out significant patterns, anomalies, or key insights
- **Provide context**: Explain what the records represent and their business relevance
- **Never say "no results"**: If tools return data, always summarize and present the findings

## Privacy and Security:
- Never expose sensitive personal information
- Redact PII in responses  
- Focus on business insights rather than personal details
- Follow data governance principles
- Report any security concerns found in the data`;return a+=i,n.promptTemplate&&(a+=`

Special Instructions:
${n.promptTemplate}`),a}async processMessage(t,n,r,a=[],i,l,o){var v,T,y,b,x,I,C,E,N;console.log(`[LLM Service]  STARTING processMessage for agent: ${t.name} (${t.id})`),console.log(`[LLM Service] User message: "${r}"`),console.log("[LLM Service] LLM Config:",{provider:n.provider,model:n.model,endpoint:n.endpoint,hasApiKey:!!n.apiKey,temperature:n.temperature,maxTokens:n.maxTokens}),console.log("[LLM Service] Archer session ID:",i||"None"),console.log(`[LLM Service] Conversation history length: ${a.length}`);const c=Date.now();let u=[],m=[],d=0,p=0,f=0;const g={promptTemplate:t.systemPrompt};try{console.log("[LLM Service]   Getting MCP tools for agent...");const O=await this.getMCPToolsAsLLMFunctions(t);console.log(`[LLM Service]  Agent ${t.name} has ${O.length} MCP functions available:`,O.map(P=>P.name)),console.log("[LLM Service]  Generating system prompt...");const D=this.generateSystemPrompt(t,g,l);console.log(`[LLM Service] System prompt length: ${D.length} characters`);const A=[{role:"system",content:D},...a,{role:"user",content:r}];console.log(`[LLM Service]  Total conversation messages: ${A.length}`);const z=8;let M=[...A],R=null;console.log(`[LLM Service]  Starting multi-step orchestration (max ${z} steps)`),o==null||o({step:0,totalSteps:z,message:`Starting AI analysis with ${t.name}...`});for(let P=1;P<=z;P++){console.log(`[LLM Service]  Multi-step orchestration - Step ${P}/${z}`),console.log(`[LLM Service] Current conversation has ${M.length} messages`),o==null||o({step:P,totalSteps:z,message:`Step ${P}: Analyzing and planning...`}),console.log("[LLM Service]  Calling real LLM API...");const q=await this.callRealLLM(M,O,n);console.log(`[LLM Service]  Step ${P} LLM Response received:`,{hasContent:!!q.content,contentPreview:q.content?q.content.substring(0,100)+"...":"No content",hasFunctionCalls:!!(q.functionCalls&&q.functionCalls.length>0),functionCallCount:((v=q.functionCalls)==null?void 0:v.length)||0,functionNames:((T=q.functionCalls)==null?void 0:T.map(W=>W.name))||[]});const B={role:"assistant",content:q.content||(q.functionCalls&&q.functionCalls.length>0?"":"I'll help you with that."),tool_calls:(y=q.functionCalls)==null?void 0:y.map(W=>({id:W.id,type:"function",function:{name:W.name,arguments:JSON.stringify(W.arguments)}}))};if(M.push(B),!q.functionCalls||q.functionCalls.length===0){console.log(`[LLM Service]  No more tool calls - orchestration complete at step ${P}`),R=q;break}console.log(`[LLM Service]   Processing ${q.functionCalls.length} function calls in step ${P}`),q.functionCalls.length>0&&(o==null||o({step:P,totalSteps:z,message:`Step ${P}: Executing ${q.functionCalls.length} tool${q.functionCalls.length>1?"s":""}...`}));for(const W of q.functionCalls){let k;try{console.log(`[LLM Service]  Step ${P}: Executing MCP tool: ${W.name}`),console.log("[LLM Service] Tool arguments:",W.arguments),o==null||o({step:P,totalSteps:z,message:`Step ${P}: Executing ${W.name}...`,toolName:W.name,toolStatus:"starting"}),console.log(`[LLM Service]  Calling MCP tool directly via SSE: ${W.name}`),k=await this.callDirectMCPTool(W.name,W.arguments,i,t,o?we=>{o({step:P,totalSteps:z,message:`Step ${P}: ${we.status}`,toolName:we.tool,toolProgress:we.progress,toolStatus:we.status})}:void 0),console.log(`[LLM Service]  MCP tool ${W.name} executed successfully:`,{success:k.success,hasResult:!!k.result,serverId:k.serverId});const ce=this.extractRecordCount(k),qe=ce>0?`Step ${P}: Retrieved ${ce.toLocaleString()} records from ${W.name}`:`Step ${P}: ${W.name} completed successfully`;o==null||o({step:P,totalSteps:z,message:qe,toolName:W.name,toolStatus:"completed"}),u.push(W.name),m.push(k)}catch(ce){console.error(`[LLM Service]  Step ${P}: Error executing function ${W.name}:`,ce),k={success:!1,error:ce instanceof Error?ce.message:"Unknown error",content:`Failed to execute ${W.name}: ${ce instanceof Error?ce.message:"Unknown error"}`}}let le=k;this.privacyService&&k.success&&k.result&&(console.log(` Applying privacy protection to ${W.name} before sending to LLM`),le=this.privacyService.protectMCPResult(k,W.name));let xe;le.success&&le.result?W.name==="search_archer_records"?xe=`SEARCH_RESULTS_SUCCESS:
${((I=(x=(b=le.result)==null?void 0:b.content)==null?void 0:x[0])==null?void 0:I.text)||JSON.stringify(le.result)}`:xe=`TOOL_SUCCESS: ${JSON.stringify(le.result)}`:xe=`TOOL_ERROR: ${le.error||"Unknown error"}`;const _={role:"tool",content:xe,tool_call_id:W.id,name:W.name};M.push(_)}}R||(console.warn(`[LLM Service]   Hit max steps (${z}) - using last response`),R={content:"I've completed the available analysis steps. Please let me know if you need additional information.",finishReason:"stop"}),m.length>0&&this.needsBatchProcessing(m)?(console.log("[LLM Service]  Large dataset detected, switching to batch processing mode"),R=await this.processLargeDataset(r,m,O,o)):m.length>0&&(!R.content||R.content.length<100)&&(console.log("[LLM Service]  Enhancing insufficient final response with tool result summary"),R.content=this.generateFallbackResponse(u,m,r));const H=Date.now()-c;return p=M.length*50,f=m.length*100+(((C=R.content)==null?void 0:C.length)||0)/4,d=p+f,console.log("[LLM Service]  Multi-step orchestration complete:",{totalSteps:M.filter(P=>P.role==="assistant").length,toolsUsed:u.length,uniqueTools:[...new Set(u)],processingTime:`${H}ms`,totalTokens:d,finalResponseLength:((E=R.content)==null?void 0:E.length)||0}),console.log("[LLM Service]  FINAL RESPONSE:",{content:((N=R.content)==null?void 0:N.substring(0,200))+"...",toolsUsed:u,processingTime:`${H}ms`}),{content:R.content||"I've completed your request using the available tools.",usage:{promptTokens:p,completionTokens:f,totalTokens:d},model:n.model,finishReason:R.finishReason||"stop",toolsUsed:u,toolResults:m,processingTime:H}}catch(O){throw console.error("[LLM Service]  ERROR in multi-step orchestration:",O),console.error("[LLM Service] Error details:",{error:O,stack:O instanceof Error?O.stack:"No stack trace",agent:{id:t.id,name:t.name},llmConfig:{provider:n.provider,model:n.model},userMessage:r,processingTime:`${Date.now()-c}ms`}),new Error(`LLM processing failed: ${O instanceof Error?O.message:"Unknown error"}`)}}async callDirectMCPTool(t,n,r,a,i){try{console.log(`[LLM Service]  Calling MCP tool directly via SSE: ${t}`),console.log(`[LLM Service] Tool: ${t}, Agent: ${a==null?void 0:a.name} (${a==null?void 0:a.id})`),console.log(`[LLM Service] Session ID: ${r}`);const l={...n,tenant_id:this.tenantId};r&&(l.archer_session_id=r);const o=await this.retryWithBackoff(async()=>await Ub.callTool(t,l,{timeout:12e4,onProgress:i,streaming:!!i}),2,2e3);return console.log(`[LLM Service]  Direct MCP tool ${t} response received`),{success:!0,content:typeof o=="string"?o:JSON.stringify(o,null,2),result:o,serverId:"direct-sse-connection",dataSource:"direct-mcp-sse-server"}}catch(l){return console.error(`[LLM Service]  Direct MCP tool call failed for ${t}:`,l),{success:!1,error:l instanceof Error?l.message:"Unknown error",content:`Failed to execute ${t}: ${l instanceof Error?l.message:"Unknown error"}`}}}async callRealLLM(t,n,r){console.log(`[LLM Service] Real LLM call to ${r.provider} with ${t.length} messages, ${n.length} functions`);try{const a=r.provider.replace("-","_");switch(a){case"azure_openai":return await this.callAzureOpenAI(t,n,r);case"openai":return await this.callOpenAI(t,n,r);case"anthropic":return await this.callAnthropic(t,n,r);default:throw new Error(`Unsupported LLM provider: ${r.provider} (normalized: ${a})`)}}catch(a){throw console.error("[LLM Service] Real LLM call failed:",a),a}}async retryWithBackoff(t,n=3,r=1e3){let a;for(let i=0;i<=n;i++)try{return await t()}catch(l){if(a=l,l instanceof Error&&l.message.includes("404"))throw l;const o=l instanceof Error&&l.message.includes("429"),c=l instanceof Error&&/5\d\d/.test(l.message);if(!o&&!c)throw l;if(i===n)throw console.warn(`[LLM Service] Max retries (${n}) exceeded`),a;const u=r*Math.pow(2,i)+Math.random()*1e3;console.warn(`[LLM Service] Attempt ${i+1} failed, retrying in ${u}ms:`,l.message),await new Promise(m=>setTimeout(m,u))}throw a}needsBatchProcessing(t){for(const n of t)if(n!=null&&n.content)try{const r=JSON.parse(n.content);if(r!=null&&r.records&&Array.isArray(r.records)&&r.records.length>100)return console.log(`[LLM Service] Large dataset detected: ${r.records.length} records`),!0;if(r!=null&&r.data&&Array.isArray(r.data)&&r.data.length>100)return console.log(`[LLM Service] Large dataset detected: ${r.data.length} data items`),!0;if(r!=null&&r.results&&Array.isArray(r.results)&&r.results.length>100)return console.log(`[LLM Service] Large dataset detected: ${r.results.length} results`),!0}catch{if(n.content.length>5e4)return console.log(`[LLM Service] Large content detected: ${n.content.length} characters`),!0}return!1}async processLargeDataset(t,n,r,a){var d;console.log("[LLM Service]  Processing large dataset with batch analysis");let i=[],l="";for(const p of n)if(p!=null&&p.content)try{const f=JSON.parse(p.content);if(f!=null&&f.records&&Array.isArray(f.records)){i=f.records,l=`Retrieved ${i.length} records from ${((d=f.metadata)==null?void 0:d.applicationName)||"Archer"}`;break}if(f!=null&&f.data&&Array.isArray(f.data)){i=f.data,l=`Retrieved ${i.length} data items`;break}if(f!=null&&f.results&&Array.isArray(f.results)){i=f.results,l=`Retrieved ${i.length} results`;break}}catch{console.warn("[LLM Service] Could not parse tool result as JSON")}if(i.length===0){console.warn("[LLM Service] No dataset found in tool results, falling back to normal processing");const p=n.map(g=>g.content).join(`

`);return await this.callRealLLM([{role:"user",content:`${t}

Tool Results:
${p}`}],r,this.config)}console.log(`[LLM Service]  Processing ${i.length} items with intelligent analysis`),a==null||a({message:`Analyzing ${i.length.toLocaleString()} records...`,toolStatus:"running"});const o=Math.min(20,Math.max(5,Math.floor(i.length/50)));console.log(`[LLM Service]  Using batch size: ${o}`);const c=await this.processBatch(i,async(p,f,g)=>{const v=`Analyze this item (${f+1}/${g}) in context of: "${t}"

Item: ${JSON.stringify(p,null,2)}

Provide focused analysis relevant to the user's request.`;try{const T=await this.callRealLLM([{role:"user",content:v}],[],this.config);return{index:f+1,item_id:p.id||p.Id||`item_${f}`,analysis:T.content}}catch(T){return console.error(`[LLM Service] Error analyzing item ${f}:`,T),{index:f+1,item_id:p.id||p.Id||`item_${f}`,analysis:`Error: ${T.message}`}}},{batchSize:o,concurrency:1,onProgress:(p,f,g)=>{console.log(`[LLM Service] Progress: ${p}/${f} (${Math.round(p/f*100)}%)`);const v=Math.round(p/f*100);a==null||a({message:`Analyzing ${p.toLocaleString()}/${f.toLocaleString()} records (${v}%)...`,toolStatus:"running",toolProgress:v})}});a==null||a({message:`Completed analysis of ${i.length.toLocaleString()} records. Generating summary...`,toolStatus:"completed",toolProgress:100});const u=`Based on analysis of ${i.length} items, provide a comprehensive response to: "${t}"

Analysis Results: ${JSON.stringify(c,null,2)}

Provide a comprehensive summary that directly answers the user's question with all important findings and details.`,m=await this.callRealLLM([{role:"user",content:u}],[],this.config);return{content:m.content,toolCalls:[],usage:m.usage}}async throttleRequest(){var a,i;const t=Date.now(),n=60*1e3,r=(a=this.config)==null?void 0:a.rateLimit;if(r){if(t-this.windowStart>n&&(this.requestCount=0,this.windowStart=t),this.requestCount>=r){const l=n-(t-this.windowStart)+1e3,o=(i=this.config)!=null&&i.rateLimit?"configured":"default";console.log(`[LLM Service] Rate limit reached (${r}/min ${o}), waiting ${l}ms`),await new Promise(c=>setTimeout(c,l)),this.requestCount=0,this.windowStart=Date.now()}this.requestCount++}}extractRecordCount(t){try{if(!(t!=null&&t.content))return 0;const n=typeof t.content=="string"?JSON.parse(t.content):t.content;return n!=null&&n.records&&Array.isArray(n.records)?n.records.length:n!=null&&n.data&&Array.isArray(n.data)?n.data.length:n!=null&&n.results&&Array.isArray(n.results)?n.results.length:n!=null&&n.ResponseData&&Array.isArray(n.ResponseData)?n.ResponseData.length:0}catch{return 0}}async processBatch(t,n,r={}){const{batchSize:a=10,concurrency:i=1,onProgress:l,onBatchComplete:o}=r,c=[],u=Math.ceil(t.length/a);console.log(`[LLM Service] Starting batch processing: ${t.length} items in ${u} batches`);for(let m=0;m<u;m++){const d=m*a,p=Math.min(d+a,t.length),f=t.slice(d,p);console.log(`[LLM Service] Processing batch ${m+1}/${u} (${f.length} items)`);const g=[];for(let T=0;T<f.length;T+=i){const b=f.slice(T,Math.min(T+i,f.length)).map(async(I,C)=>{const E=d+T+C;await this.throttleRequest();try{const N=await n(I,E,t.length);return l&&l(E+1,t.length,I),N}catch(N){throw console.error(`[LLM Service] Error processing item ${E}:`,N),N}}),x=await Promise.all(b);g.push(...x.map(I=>Promise.resolve(I)))}const v=await Promise.all(g);c.push(...v),o&&o(v,m,u),m<u-1&&await new Promise(T=>setTimeout(T,1e3))}return console.log(`[LLM Service] Batch processing complete: ${c.length} results`),c}async analyzeBulkIncidentsForCPS230(t,n){return console.log(`[LLM Service] Starting CPS230 analysis for ${t.length} incidents`),this.processBatch(t,async(r,a,i)=>{const l=`Analyze this incident for potential CPS230 breach indicators:

Incident: ${JSON.stringify(r,null,2)}

CPS230 requires financial institutions to report:
1. Material service disruptions (>4 hours for critical services)
2. Cyber security incidents affecting business operations
3. Data breaches involving customer information
4. Third-party service provider failures
5. Incidents affecting business resilience

Provide analysis as JSON:
{
  "isPotentialBreach": boolean,
  "confidence": number (0-1),
  "breachCategories": string[],
  "reasoning": string,
  "reportingRequired": boolean,
  "timelineCompliance": string,
  "recommendedActions": string[]
}`;try{const o=await this.callRealLLM([{role:"user",content:l}],[],this.config);return{incidentId:r.id||`incident_${a}`,incident:r,analysis:o.content,processedAt:new Date}}catch(o){return console.error(`[LLM Service] Failed to analyze incident ${r.id||a}:`,o),{incidentId:r.id||`incident_${a}`,incident:r,analysis:{error:o.message},processedAt:new Date}}},{batchSize:5,concurrency:1,onProgress:n,onBatchComplete:(r,a,i)=>{console.log(`[LLM Service] Completed batch ${a+1}/${i}: ${r.length} incidents analyzed`)}})}async callAzureOpenAI(t,n,r){let a=r.endpoint;a.startsWith("https://")||(a="https://"+a),a.endsWith("/")&&(a=a.slice(0,-1));let i;if(a.includes("/openai/deployments/")&&a.includes("/chat/completions"))i=a.includes("api-version=")?a:`${a}&api-version=2024-08-01-preview`,console.log(`[LLM Service] Using complete Azure OpenAI URL: ${i}`);else{const m=r.model;i=`${a}/openai/deployments/${m}/chat/completions?api-version=2024-08-01-preview`,console.log(`[LLM Service] Constructed Azure OpenAI URL: ${i}`),console.log(`[LLM Service] Endpoint: ${a}, Deployment: ${m}`)}const l={messages:t.map(m=>({role:m.role,content:m.content,...m.name&&{name:m.name},...m.tool_calls&&{tool_calls:m.tool_calls},...m.tool_call_id&&{tool_call_id:m.tool_call_id}})),temperature:r.temperature,max_tokens:r.maxTokens};n.length>0&&(l.tools=n.map(m=>({type:"function",function:{name:m.name,description:m.description,parameters:m.parameters}})),l.tool_choice="auto"),console.log(`[LLM Service] Azure OpenAI API call to ${i}`);const c=(await this.retryWithBackoff(async()=>{const m=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json","api-key":r.apiKey},body:JSON.stringify(l)});if(!m.ok){const d=await m.json().catch(()=>({error:"Unknown error"}));console.error("[LLM Service] Azure OpenAI API error details:",{status:m.status,statusText:m.statusText,url:i,errorData:d});let p=`Azure OpenAI API error: ${m.status} - ${m.statusText}`;throw m.status===404&&(p+=`. Check deployment name '${r.model}' and endpoint URL.`),new Error(p)}return await m.json()},5,2e3)).choices[0],u=c.message;return u.tool_calls&&u.tool_calls.length>0?{functionCalls:u.tool_calls.map(m=>({id:m.id,name:m.function.name,arguments:JSON.parse(m.function.arguments)})),content:u.content||"I'll help you with that information.",finishReason:c.finish_reason}:{content:u.content,finishReason:c.finish_reason}}async callOpenAI(t,n,r){var m;const a=`${r.endpoint}/v1/chat/completions`,i={model:r.model,messages:t.map(d=>({role:d.role,content:d.content,...d.name&&{name:d.name}})),temperature:r.temperature,max_tokens:r.maxTokens};n.length>0&&(i.tools=n.map(d=>({type:"function",function:{name:d.name,description:d.description,parameters:d.parameters}})),i.tool_choice="auto"),console.log(`[LLM Service] OpenAI API call to ${a}`);const l=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.apiKey}`},body:JSON.stringify(i)});if(!l.ok){const d=await l.json().catch(()=>({error:"Unknown error"}));throw new Error(`OpenAI API error: ${l.status} - ${((m=d.error)==null?void 0:m.message)||"Unknown error"}`)}const c=(await l.json()).choices[0],u=c.message;return u.tool_calls&&u.tool_calls.length>0?{functionCalls:u.tool_calls.map(d=>({id:d.id,name:d.function.name,arguments:JSON.parse(d.function.arguments)})),content:u.content||"I'll help you with that information.",finishReason:c.finish_reason}:{content:u.content,finishReason:c.finish_reason}}async callAnthropic(t,n,r){var m,d,p;const a=`${r.endpoint}/v1/messages`,i=t.filter(f=>f.role!=="system").map(f=>({role:f.role==="assistant"?"assistant":"user",content:f.content})),l=(m=t.find(f=>f.role==="system"))==null?void 0:m.content,o={model:r.model,max_tokens:r.maxTokens,temperature:r.temperature,messages:i,...l&&{system:l}};n.length>0&&(o.tools=n.map(f=>({name:f.name,description:f.description,input_schema:f.parameters}))),console.log(`[LLM Service] Anthropic API call to ${a}`);const c=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":r.apiKey,"anthropic-version":"2024-06-01"},body:JSON.stringify(o)});if(!c.ok){const f=await c.json().catch(()=>({error:"Unknown error"}));throw new Error(`Anthropic API error: ${c.status} - ${((d=f.error)==null?void 0:d.message)||"Unknown error"}`)}const u=await c.json();return u.content&&u.content.some(f=>f.type==="tool_use")?{functionCalls:u.content.filter(g=>g.type==="tool_use").map(g=>({id:g.id,name:g.name,arguments:g.input})),content:u.content.filter(g=>g.type==="text").map(g=>g.text).join("")||"I'll help you with that information.",finishReason:u.stop_reason}:{content:((p=u.content)==null?void 0:p.map(f=>f.text).join(""))||"",finishReason:u.stop_reason}}}const $R=e=>new zR(e),qR=({isOpen:e,onClose:t,onAuthenticated:n,tenantId:r})=>{const[a,i]=S.useState(()=>{try{const T=localStorage.getItem("archerAuthData");if(T){const y=JSON.parse(T);return{baseUrl:y.baseUrl||"",instanceId:y.instanceId||"",username:y.username||"",password:"",userDomainId:y.userDomainId||""}}}catch(T){console.warn("[Auth Modal] Failed to load saved auth data:",T)}return{baseUrl:"",instanceId:"",username:"",password:"",userDomainId:""}}),[l,o]=S.useState(!1),[c,u]=S.useState(null),[m,d]=S.useState("form"),{setSession:p}=Fb(),f=(T,y)=>{i(b=>({...b,[T]:y})),u(null)},g=async()=>{const T={baseUrl:a.baseUrl,instanceId:a.instanceId,username:a.username,password:a.password,userDomainId:a.userDomainId},y=await fetch("http://localhost:3005/api/v1/auth/archer/authenticate",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(T)});if(!y.ok){const x=await y.json().catch(()=>({error:"Authentication failed"}));throw new Error(x.error||`Authentication failed: ${y.status} ${y.statusText}`)}const b=await y.json();if(!b.success)throw new Error(b.error||"Authentication failed");return{sessionId:b.sessionData.sessionId,expiresAt:new Date(b.sessionData.expiresAt),oauthToken:b.sessionData.oauthToken,userInfo:b.sessionData.userInfo}},v=async T=>{T.preventDefault(),o(!0),u(null),d("authenticating");try{if(!a.baseUrl||!a.instanceId||!a.username||!a.password)throw new Error("Please fill in all required fields");const y=await g();try{const b={baseUrl:a.baseUrl,instanceId:a.instanceId,username:a.username,userDomainId:a.userDomainId};localStorage.setItem("archerAuthData",JSON.stringify(b)),console.log("[Auth Modal] Saved authentication data for next session")}catch(b){console.warn("[Auth Modal] Failed to save authentication data:",b)}d("success"),console.log("[Auth Modal] Storing session data for MCP access:",{sessionId:y.sessionId}),p(y),setTimeout(()=>{n(y),t()},1500)}catch(y){console.error("Archer authentication failed:",y),u(y instanceof Error?y.message:"Authentication failed"),d("form")}finally{o(!1)}};return e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4 shadow-xl",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx(ge,{className:"h-6 w-6 text-blue-600"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Authenticate to Archer GRC"})]}),m==="form"&&s.jsxs("form",{onSubmit:v,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Archer Base URL *"}),s.jsx(pe,{type:"url",placeholder:"https://your-archer-instance.com",value:a.baseUrl,onChange:T=>f("baseUrl",T.target.value),required:!0,disabled:l})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Instance ID *"}),s.jsx(pe,{type:"text",placeholder:"e.g., 123456",value:a.instanceId,onChange:T=>f("instanceId",T.target.value),required:!0,disabled:l})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username *"}),s.jsx(pe,{type:"text",placeholder:"Your Archer username",value:a.username,onChange:T=>f("username",T.target.value),required:!0,disabled:l})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password *"}),s.jsx(pe,{type:"password",placeholder:"Your Archer password",value:a.password,onChange:T=>f("password",T.target.value),required:!0,disabled:l})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User Domain ID"}),s.jsx(pe,{type:"text",placeholder:"1",value:a.userDomainId,onChange:T=>f("userDomainId",T.target.value),disabled:l}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Usually "1" for default domain'})]}),c&&s.jsxs(Ie,{variant:"destructive",className:"mt-4",children:[s.jsx(us,{className:"h-4 w-4"}),s.jsxs("div",{children:[s.jsx("strong",{children:"Authentication Failed"}),s.jsx("p",{className:"text-sm mt-1",children:c})]})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx(G,{type:"button",variant:"outline",onClick:t,disabled:l,className:"flex-1",children:"Cancel"}),s.jsx(G,{type:"submit",disabled:l,className:"flex-1",children:l?s.jsxs(s.Fragment,{children:[s.jsx(tt,{className:"h-4 w-4 mr-2 animate-spin"}),"Authenticating..."]}):"Authenticate"})]})]}),m==="authenticating"&&s.jsxs("div",{className:"text-center py-8",children:[s.jsx(tt,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600"}),s.jsx("p",{className:"text-gray-600",children:"Authenticating with Archer..."}),s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"This may take a few seconds"})]}),m==="success"&&s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Le,{className:"h-8 w-8 mx-auto mb-4 text-green-600"}),s.jsx("p",{className:"text-gray-900 font-medium",children:"Authentication Successful!"}),s.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Connected to ",a.instanceId," as ",a.username]})]}),s.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(ge,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm text-blue-800",children:[s.jsx("p",{className:"font-medium mb-1",children:"Secure Authentication"}),s.jsx("p",{children:"Your credentials are sent directly to Archer and not stored by our platform. Your session will expire after 20 minutes of inactivity."})]})]})})]})}):null},VR="https://grc-backend-simple.calmmeadow-5080198e.australiasoutheast.azurecontainerapps.io/api/v1";class vr extends Error{constructor(t,n,r,a){super(n),this.code=t,this.statusCode=r,this.details=a,this.name="ApiError"}}class YR extends vr{constructor(t="Authentication required"){super("AUTHENTICATION_REQUIRED",t,401),this.name="AuthenticationError"}}class WR extends vr{constructor(t="Insufficient permissions"){super("INSUFFICIENT_PERMISSIONS",t,403),this.name="AuthorizationError"}}class KR extends vr{constructor(t="Tenant access denied"){super("TENANT_ACCESS_DENIED",t,403),this.name="TenantError"}}class GR{constructor(t=VR){_e(this,"baseURL");_e(this,"authToken",null);_e(this,"currentTenantId",null);this.baseURL=t,this.loadAuthFromStorage()}loadAuthFromStorage(){try{const t=localStorage.getItem("auth_token"),n=localStorage.getItem("current_tenant_id");t&&(this.authToken=t),n&&(this.currentTenantId=n)}catch(t){console.warn("Failed to load auth from storage:",t)}}setAuthToken(t){this.authToken=t,localStorage.setItem("auth_token",t)}setTenantId(t){this.currentTenantId=t,localStorage.setItem("current_tenant_id",t)}clearAuth(){this.authToken=null,this.currentTenantId=null,localStorage.removeItem("auth_token"),localStorage.removeItem("current_tenant_id")}async makeRequest(t,n={}){var c,u,m,d,p,f;const r=`${this.baseURL}${t}`,a=n.method||"GET",i=n.tenantId||this.currentTenantId,l={"Content-Type":"application/json",...n.headers};this.authToken&&(l.Authorization=`Bearer ${this.authToken}`),i&&(l["X-Tenant-ID"]=i),l["X-Request-ID"]=crypto.randomUUID();const o={method:a,headers:l};n.body&&a!=="GET"&&(o.body=JSON.stringify(n.body));try{const g=await fetch(r,o);if(g.status===429){const y=g.headers.get("Retry-After");throw new vr("RATE_LIMIT_EXCEEDED","Rate limit exceeded",429,{retryAfter:y})}let v;if((g.headers.get("Content-Type")||"").includes("application/json")?v=await g.json():v=await g.text(),!g.ok){if(g.status===401)throw this.clearAuth(),new YR(((c=v==null?void 0:v.error)==null?void 0:c.message)||"Authentication failed");if(g.status===403){const y=(u=v==null?void 0:v.error)==null?void 0:u.code;throw y!=null&&y.includes("TENANT")?new KR(v.error.message):new WR((m=v==null?void 0:v.error)==null?void 0:m.message)}throw new vr(((d=v==null?void 0:v.error)==null?void 0:d.code)||"API_ERROR",((p=v==null?void 0:v.error)==null?void 0:p.message)||"Request failed",g.status,(f=v==null?void 0:v.error)==null?void 0:f.details)}return v}catch(g){throw g instanceof vr?g:g instanceof TypeError&&g.message.includes("fetch")?new vr("NETWORK_ERROR","Network request failed. Please check your connection.",0):new vr("UNKNOWN_ERROR",g instanceof Error?g.message:"Unknown error occurred")}}async initiateLogin(t,n){return await this.makeRequest("/auth/login",{method:"POST",body:{email:t,redirect_uri:n}})}async handleAuthCallback(t,n){const r=await this.makeRequest("/auth/callback",{method:"POST",body:{code:t,state:n}});return this.setAuthToken(r.access_token),this.setTenantId(r.tenant.tenant_id),r}async getCurrentUser(){return await this.makeRequest("/auth/me")}async getAvailableTenants(){return await this.makeRequest("/auth/tenants")}async switchTenant(t){const n=await this.makeRequest("/auth/switch-tenant",{method:"POST",body:{tenant_id:t}});return this.setAuthToken(n.access_token),this.setTenantId(t),n}async logout(){try{await this.makeRequest("/auth/logout",{method:"POST"})}finally{this.clearAuth()}}async getAgents(t={}){const n=new URLSearchParams;t.enabled!==void 0&&n.set("enabled",String(t.enabled)),t.limit&&n.set("limit",String(t.limit)),t.offset&&n.set("offset",String(t.offset)),t.sort&&n.set("sort",t.sort),t.order&&n.set("order",t.order);const r=`/agents${n.toString()?"?"+n.toString():""}`;return await this.makeRequest(r)}async getAgent(t){return await this.makeRequest(`/agents/${t}`)}async createAgent(t){return await this.makeRequest("/agents",{method:"POST",body:t})}async createAgentFromPreset(t){return await this.makeRequest("/agents/from-preset",{method:"POST",body:t})}async updateAgent(t,n){return await this.makeRequest(`/agents/${t}`,{method:"PUT",body:n})}async deleteAgent(t){await this.makeRequest(`/agents/${t}`,{method:"DELETE"})}async recordAgentUsage(t,n){return await this.makeRequest(`/agents/${t}/usage`,{method:"POST",body:n})}async getAgentMetrics(t,n={}){const r=new URLSearchParams;n.period&&r.set("period",n.period),n.start_date&&r.set("start_date",n.start_date),n.end_date&&r.set("end_date",n.end_date);const a=`/agents/${t}/metrics${r.toString()?"?"+r.toString():""}`;return await this.makeRequest(a)}async getAgentPresets(){return await this.makeRequest("/agents/presets")}async getLlmConfigs(){return await this.makeRequest("/simple-llm-configs")}async getLlmConfig(t){return await this.makeRequest(`/llm-configs/${t}`)}async createLlmConfig(t){return await this.makeRequest("/simple-llm-configs",{method:"POST",body:t})}async updateLlmConfig(t,n){return await this.makeRequest(`/llm-configs/${t}`,{method:"PUT",body:n})}async deleteLlmConfig(t){await this.makeRequest(`/llm-configs/${t}`,{method:"DELETE"})}async testLlmConfig(t,n){return await this.makeRequest(`/llm-configs/${t}/test`,{method:"POST",body:{test_prompt:n}})}async getLlmProviders(){return await this.makeRequest("/llm-configs/providers")}async getMcpServers(){return await this.makeRequest("/mcp-servers")}async getMcpServerRegistry(){return await this.makeRequest("/mcp-servers/registry")}async enableMcpServer(t){return await this.makeRequest("/mcp-servers/enable",{method:"POST",body:t})}async updateMcpServer(t,n){return await this.makeRequest(`/mcp-servers/${t}`,{method:"PUT",body:n})}async testMcpServer(t,n){return await this.makeRequest(`/mcp-servers/${t}/test`,{method:"POST",body:n})}async getMcpServerHealth(t){return await this.makeRequest(`/mcp-servers/${t}/health`)}async getMcpTools(){return await this.makeRequest("/mcp/tools")}async callMcpTool(t,n,r={}){if(r.useSSE){const{mcpSSEClient:a}=await _d(async()=>{const{mcpSSEClient:i}=await Promise.resolve().then(()=>HR);return{mcpSSEClient:i}},void 0);return await a.callTool(t,n,{onProgress:r.onProgress,timeout:r.timeout})}else return await this.makeRequest("/mcp/call","POST",{tool:t,args:n})}async getChatSessions(t={}){const n=new URLSearchParams;t.agent_id&&n.set("agent_id",t.agent_id),t.active_only&&n.set("active_only","true"),t.limit&&n.set("limit",String(t.limit)),t.offset&&n.set("offset",String(t.offset));const r=`/chat/sessions${n.toString()?"?"+n.toString():""}`;return await this.makeRequest(r)}async createChatSession(t){return await this.makeRequest("/chat/sessions",{method:"POST",body:t})}async getChatMessages(t,n={}){const r=new URLSearchParams;n.limit&&r.set("limit",String(n.limit)),n.before_sequence&&r.set("before_sequence",String(n.before_sequence)),n.include_system&&r.set("include_system","true");const a=`/chat/sessions/${t}/messages${r.toString()?"?"+r.toString():""}`;return await this.makeRequest(a)}async sendChatMessage(t,n){return await this.makeRequest(`/chat/sessions/${t}/messages`,{method:"POST",body:n})}async getUsers(){return await this.makeRequest("/users")}async inviteUser(t){return await this.makeRequest("/users/invite",{method:"POST",body:t})}async updateUserRoles(t,n){return await this.makeRequest(`/users/${t}/roles`,{method:"PUT",body:{roles:n}})}async getAuditEvents(t={}){const n=new URLSearchParams;Object.entries(t).forEach(([a,i])=>{i!==void 0&&n.set(a,String(i))});const r=`/audit/events${n.toString()?"?"+n.toString():""}`;return await this.makeRequest(r)}async getAuditEvent(t){return await this.makeRequest(`/audit/events/${t}`)}async generateComplianceReport(t){const n=new URLSearchParams;return Object.entries(t).forEach(([r,a])=>{n.set(r,String(a))}),await this.makeRequest(`/audit/compliance-report?${n.toString()}`)}async getUsageAnalytics(t={}){const n=new URLSearchParams;Object.entries(t).forEach(([a,i])=>{i!==void 0&&n.set(a,String(i))});const r=`/analytics/usage${n.toString()?"?"+n.toString():""}`;return await this.makeRequest(r)}async getPerformanceMetrics(){return await this.makeRequest("/analytics/performance")}async getTenantSettings(){return await this.makeRequest("/tenant/settings")}async updateTenantSettings(t){return await this.makeRequest("/tenant/settings",{method:"PUT",body:{settings:t}})}async getArcherSession(t){return await this.makeRequest(`/auth/archer/session/${t}`)}async authenticateArcher(t){return await this.makeRequest("/auth/archer/authenticate",{method:"POST",body:t})}async logoutArcher(t){return await this.makeRequest(`/auth/archer/session/${t}`,{method:"DELETE"})}}const QR=new GR,XR=()=>{const{tenant:e}=it(),{setToken:t}=Db(),[n]=ry(),r=va(),a=n.get("agent"),i=V=>`chat_session_${e==null?void 0:e.id}_${V}`,l=()=>`chat_session_${e==null?void 0:e.id}_global`,o=V=>{try{const ie=localStorage.getItem(i(V));if(ie)return JSON.parse(ie).map(Vt=>({...Vt,timestamp:new Date(Vt.timestamp)}))}catch(ie){console.warn("Failed to load persisted messages:",ie)}return[]},c=(V,ie)=>{try{localStorage.setItem(i(V),JSON.stringify(ie))}catch(Ae){console.warn("Failed to save messages to storage:",Ae)}},u=()=>{try{const V=localStorage.getItem(l());if(V)return JSON.parse(V).selectedAgent}catch(V){console.warn("Failed to load persisted agent:",V)}return null},m=V=>{try{localStorage.setItem(l(),JSON.stringify({selectedAgent:V,lastUpdated:new Date().toISOString()}))}catch(ie){console.warn("Failed to save global chat state:",ie)}},[d,p]=S.useState([]),[f,g]=S.useState(""),[v,T]=S.useState(!1),[y,b]=S.useState([]),[x,I]=S.useState(u),[C,E]=S.useState({isConnected:!1,lastChecked:new Date,llmConfig:null,agentContext:null,archerConnections:[],selectedConnection:null,archerSession:null,sessionExpired:!1}),[N,O]=S.useState(!1),[D,A]=S.useState({}),[z,M]=S.useState(null),[R,H]=S.useState(!1),[Y,P]=S.useState(!1),q=S.useRef(null),B=S.useRef(null),W=V=>V?new Date<V.expiresAt:!1,k=V=>{try{const ie=`archer_session_id_${e==null?void 0:e.id}`;localStorage.setItem(ie,V.sessionId)}catch(ie){console.warn("Failed to save session ID to storage:",ie)}},le=async()=>{try{const V=`archer_session_id_${e==null?void 0:e.id}`,ie=localStorage.getItem(V);if(ie){const Ae=await QR.getArcherSession(ie);if(Ae.success&&Ae.sessionData){const Vt={sessionId:Ae.sessionData.sessionId,expiresAt:new Date(Ae.sessionData.expiresAt),userInfo:Ae.sessionData.userInfo,oauthToken:void 0};return W(Vt)?Vt:null}else console.warn("Failed to retrieve session from database:",Ae.error),localStorage.removeItem(V)}}catch(V){console.warn("Failed to load session from database:",V);const ie=`archer_session_id_${e==null?void 0:e.id}`;localStorage.removeItem(ie)}return null},xe=()=>{try{const V=`archer_session_id_${e==null?void 0:e.id}`;localStorage.removeItem(V);const ie=`archer_session_${e==null?void 0:e.id}`;localStorage.removeItem(ie)}catch(V){console.warn("Failed to clear session:",V)}},_=()=>{console.log("[Chat] New Connection requested - clearing session and showing auth modal"),xe(),E(V=>({...V,archerSession:null,sessionExpired:!1,isConnected:!1})),P(!0),H(!0)},ce=V=>{console.log("[Chat] User authenticated successfully:",V.userInfo),V.oauthToken&&(console.log("[Chat] Storing OAuth token for MCP tool access"),t(V.oauthToken)),k(V),E(ie=>({...ie,archerSession:V,sessionExpired:!1,isConnected:!0,lastChecked:new Date})),P(!1),H(!1)},qe=()=>{const V=C.archerSession;V&&!W(V)&&(console.log("[Chat] Session expired, requiring re-authentication"),E(ie=>({...ie,sessionExpired:!0,isConnected:!1})),xe(),P(!0))};S.useEffect(()=>{(async()=>{if(e!=null&&e.id)try{const Ae=await wr(e.id).getEnabledAgents();b(Ae),Ae.length>0&&!x&&I(Ae[0])}catch(ie){console.error("Failed to load agents:",ie),M("Failed to load AI agents. Please check your configuration.")}})()},[e==null?void 0:e.id]),S.useEffect(()=>{if(a&&y.length>0&&(!x||x.id!==a)){const V=y.find(ie=>ie.id===a);V?(console.log(`[Chat] Auto-selecting agent from URL: ${V.name}`),I(V),m(V)):console.warn(`[Chat] Agent ID from URL not found: ${a}`)}},[a,y,x]),S.useEffect(()=>{const V=async()=>{try{if(!x||!(e!=null&&e.id))return;Ue.setTenantContext(e.id),await Ue.initialize();const Ae=await wr(e.id).getAgentWithContext(x.id);if(!Ae)throw new Error("Failed to load agent configuration");if(!Ae.llmConfig)throw new Error("No LLM configuration found for this agent. Please configure an LLM in Settings.");if(!Ae.llmConfig.isEnabled)throw new Error("LLM configuration is disabled. Please enable it in Settings.");let Vt=[],Zr=null;const Pt=await le(),Yn=W(Pt);E({isConnected:Yn,lastChecked:new Date,llmConfig:Ae.llmConfig,agentContext:Ae,archerConnections:Vt,selectedConnection:Zr,archerSession:Pt,sessionExpired:!!(Pt&&!Yn)}),Yn||(console.log("[Chat] No valid Archer session found, authentication required"),P(!0),H(!0));const yn=o(x.id);if(yn.length===0){const ht={id:"welcome-"+Date.now(),type:"agent",content:`Hello! I'm ${x.name}. ${x.description} What would you like to analyze today?`,timestamp:new Date};p([ht]),c(x.id,[ht]),console.log(`[ChatPage] Initializing new agent ${x.id} with empty conversation history`),A({[x.id]:[]})}else{p(yn);const ht=[];yn.forEach(Rn=>{Rn.type==="user"?ht.push({role:"user",content:Rn.content}):Rn.type==="agent"&&!Rn.content.includes("analyzing your request")&&!Rn.content.includes("Hello!")&&ht.push({role:"assistant",content:Rn.content})}),A({[x.id]:ht})}}catch(ie){console.error("Failed to initialize agent connection:",ie);const Ae=ie instanceof Error?ie.message:"Unknown error occurred";M(`Failed to initialize agent: ${Ae}`),E({isConnected:!1,lastChecked:new Date,llmConfig:null,agentContext:null,archerConnections:[],selectedConnection:null})}};x&&(e!=null&&e.id)&&!N&&(V(),O(!0))},[x,e==null?void 0:e.id,N]),S.useEffect(()=>{x&&d.length>0&&c(x.id,d)},[d,x]),S.useEffect(()=>{m(x)},[x]),S.useEffect(()=>{var V;(V=q.current)==null||V.scrollIntoView({behavior:"smooth"})},[d]);const we=S.useCallback(async()=>{var Vt,Zr;if(!f.trim()||v||!x)return;qe();const V={id:"user-"+Date.now(),type:"user",content:f.trim(),timestamp:new Date},ie={id:"agent-"+Date.now(),type:"agent",content:`${x.name} is analyzing your request...`,timestamp:new Date,isLoading:!0};p(Pt=>[...Pt,V,ie]);const Ae=f.trim();g(""),T(!0),M(null);try{if(!C.llmConfig)throw new Error("No LLM configuration available for this agent");if(!(e!=null&&e.id))throw new Error("Tenant context not available");const Pt=$R(e.id),yn=[...D[x.id]||[],{role:"user",content:Ae}],ht=await Pt.processMessage(x,C.llmConfig,Ae,yn.slice(-10),(Vt=C.archerSession)==null?void 0:Vt.sessionId,e==null?void 0:e.id,Mt=>{const es=Mt.toolName?` ${Mt.toolName}${Mt.toolProgress?` (${Math.round(Mt.toolProgress)}%)`:""}`:Mt.message;p(vc=>vc.map($=>$.id===ie.id?{...$,content:es,progress:Mt.toolProgress,progressStep:Mt.step,progressTotal:Mt.totalSteps}:$))}),Rn=[...yn,{role:"assistant",content:ht.content}];A(Mt=>({...Mt,[x.id]:Rn})),p(Mt=>Mt.map(es=>es.id===ie.id?{...es,content:ht.content,isLoading:!1,response:ht}:es)),await wr(e.id).recordUsage(x.id)}catch(Pt){console.error("Failed to send message:",Pt);const Yn=Pt instanceof Error?Pt.message:"Unknown error occurred";p(yn=>yn.map(ht=>ht.id===ie.id?{...ht,content:"I apologize, but I encountered an error while processing your request. Please try again.",isLoading:!1,error:Yn}:ht)),M(Yn)}finally{T(!1),(Zr=B.current)==null||Zr.focus()}},[f,v,x,C,D,e==null?void 0:e.id]),Rt=S.useCallback(()=>{if(!x)return;try{localStorage.removeItem(i(x.id))}catch(ie){console.warn("Failed to clear chat from storage:",ie)}const V={id:"welcome-"+Date.now(),type:"agent",content:`Hello! I'm ${x.name}. ${x.description} What would you like to analyze today?`,timestamp:new Date};p([V]),console.log(`[ChatPage] Clearing chat for agent ${x.id}`),A({[x.id]:[]}),M(null)},[x]),rn=S.useCallback(V=>{x&&d.length>0&&c(x.id,d),I(V),O(!1),M(null),console.log(`[ChatPage] Switching from agent ${x==null?void 0:x.id} to ${V.id}`),console.log("[ChatPage] Clearing conversation history for isolation"),A({})},[x,d]),xn=S.useCallback(()=>{if(e!=null&&e.id)try{const V=Object.keys(localStorage).filter(ie=>ie.startsWith(`chat_session_${e.id}_`));V.forEach(ie=>localStorage.removeItem(ie)),console.log(`Cleared ${V.length} chat sessions for tenant ${e.id}`)}catch(V){console.warn("Failed to clear all chat sessions:",V)}},[e==null?void 0:e.id]);Wi.useEffect(()=>(e!=null&&e.id&&(window.clearAllChatSessions=xn),()=>{delete window.clearAllChatSessions}),[xn,e==null?void 0:e.id]);const ur=S.useCallback(async()=>{if(!(!x||!(e!=null&&e.id)))try{const ie=await wr(e.id).getAgentWithContext(x.id);if(!ie||!ie.llmConfig)throw new Error("Agent configuration not found");E(Ae=>({...Ae,isConnected:ie.llmConfig.isEnabled,lastChecked:new Date,llmConfig:ie.llmConfig,agentContext:ie})),M(null)}catch(V){console.error("Failed to refresh connection:",V),M("Failed to refresh connection to AI agent services.")}},[x,e==null?void 0:e.id]),Jr=V=>V.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return x?s.jsxs("div",{className:"flex flex-col h-screen",children:[s.jsx("div",{className:"sticky top-0 z-50 flex-shrink-0 border-b border-gray-200 bg-white shadow-sm",children:s.jsx("div",{className:"px-4 py-4 sm:px-6",children:s.jsx("div",{className:"w-full",children:s.jsxs("div",{className:"relative flex items-center gap-3",children:[s.jsxs("div",{className:"flex-1 flex items-center gap-3 rounded-2xl border border-gray-300 px-4 py-3 bg-white shadow-sm",children:[s.jsx(G,{variant:"ghost",size:"sm",onClick:()=>r("/agents"),className:"p-1 hover:bg-gray-50 rounded-lg flex-shrink-0",children:s.jsx(aT,{className:"h-4 w-4 text-gray-600"})}),s.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[s.jsx("div",{className:"h-7 w-7 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center",children:s.jsx(Es,{className:"h-4 w-4 text-white"})}),s.jsx("h1",{className:"text-sm font-semibold text-gray-900 hidden sm:block",children:"GRC AI Chat"})]}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsxs("div",{className:"relative",children:[s.jsx("select",{value:x.id,onChange:V=>{const ie=y.find(Ae=>Ae.id===V.target.value);ie&&rn(ie)},className:"w-full appearance-none bg-gray-50 border-0 rounded-lg px-3 py-1.5 pr-8 text-sm text-gray-700 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:bg-white","aria-label":"Select AI Agent",children:y.map(V=>s.jsx("option",{value:V.id,children:V.name},V.id))}),s.jsx(So,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-3 w-3 text-gray-400 pointer-events-none"})]})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"flex items-center space-x-1.5 bg-gray-50 rounded-full px-3 py-1.5 text-xs shadow-sm",children:[s.jsx("div",{className:Ee("h-2 w-2 rounded-full",C.archerSession&&!C.sessionExpired?"bg-green-500":"bg-amber-500")}),s.jsx("span",{className:"font-medium text-gray-700 hidden sm:inline",children:C.archerSession&&!C.sessionExpired?"Connected":"Offline"})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:_,disabled:v,className:"h-9 w-9 rounded-full bg-blue-500 hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center transition-colors shadow-sm",title:"Connect to Archer","aria-label":"Connect to Archer",children:s.jsx(ge,{className:"h-4 w-4 text-white"})}),s.jsxs("div",{className:"hidden md:flex items-center gap-1",children:[s.jsx("button",{onClick:ur,disabled:v,className:"h-9 w-9 rounded-full bg-white border border-gray-200 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center transition-colors shadow-sm",title:"Refresh Connection","aria-label":"Refresh connection",children:s.jsx($t,{className:Ee("h-4 w-4 text-gray-600",v&&"animate-spin")})}),s.jsx("button",{onClick:Rt,disabled:v,className:"h-9 w-9 rounded-full bg-white border border-gray-200 hover:bg-red-50 hover:border-red-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center transition-colors shadow-sm",title:"Clear Chat","aria-label":"Clear chat history",children:s.jsx(Ea,{className:"h-4 w-4 text-red-500"})})]}),s.jsx("button",{className:"h-9 w-9 rounded-full bg-white border border-gray-200 hover:bg-gray-50 flex items-center justify-center transition-colors shadow-sm md:hidden",title:"More Options","aria-label":"More options",children:s.jsx(yT,{className:"h-4 w-4 text-gray-600"})})]})]})]})})})}),z&&s.jsx("div",{className:"flex-shrink-0 px-4 py-2 sm:px-6",children:s.jsxs(Ie,{variant:"destructive",children:[s.jsx(ue,{className:"h-4 w-4"}),s.jsxs("div",{children:[s.jsx("strong",{children:"Connection Error:"})," ",z]})]})}),s.jsxs("div",{className:"flex-1 flex flex-col min-h-0 bg-gray-50",children:[s.jsxs("div",{className:"flex-1 px-4 pt-24 pb-24 overflow-y-auto space-y-6 sm:px-6 w-full",role:"log","aria-label":"Chat messages","aria-live":"polite","aria-atomic":"false",children:[d.map(V=>s.jsxs("article",{className:Ee("flex gap-4 group",V.type==="user"?"flex-row-reverse":"flex-row"),role:"article","aria-label":`${V.type==="user"?"User message":"AI agent response"} at ${Jr(V.timestamp)}`,children:[s.jsx("div",{className:"flex-shrink-0",children:V.type==="agent"?s.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center",children:s.jsx(Es,{className:"h-5 w-5 text-white"})}):s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center",children:s.jsx(Ts,{className:"h-5 w-5 text-white"})})}),s.jsx("div",{className:Ee("flex-1 max-w-[75%]",V.type==="user"?"mr-auto":"ml-0"),children:s.jsxs("div",{className:Ee("rounded-2xl px-4 py-3 shadow-sm",V.type==="user"?"bg-blue-600 text-white rounded-br-md":V.error?"bg-red-50 border border-red-200 text-red-900 rounded-bl-md":"bg-white border border-gray-200 text-gray-900 rounded-bl-md"),children:[s.jsx("div",{className:Ee("text-[15px] leading-relaxed markdown-content",V.type==="user"&&"text-white [&_*]:text-white [&_*]:border-none [&_h1]:border-none [&_h1]:border-b-0"),style:V.type==="user"?{color:"white"}:{},children:s.jsx(FR,{children:V.content})}),V.isLoading&&s.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce [animation-delay:-0.3s]"}),s.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce [animation-delay:-0.15s]"}),s.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce"})]}),s.jsx("span",{className:"text-sm text-gray-600",children:V.progressStep&&V.progressTotal?`Step ${V.progressStep}/${V.progressTotal}`:"Processing..."})]}),V.progress&&s.jsx("div",{className:"mt-2 w-full bg-gray-200 rounded-full h-1",children:s.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 h-1 rounded-full transition-all duration-500 ease-out",style:{width:`${V.progress}%`}})})]}),V.response&&!V.isLoading&&s.jsxs("div",{className:"space-y-2 text-xs",children:[V.response.toolsUsed&&V.response.toolsUsed.length>0&&s.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.jsx("span",{className:"text-muted-foreground mr-2",children:"Archer tools used:"}),V.response.toolsUsed.map((ie,Ae)=>s.jsx(J,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700",children:ie},`${V.id}-${ie}-${Ae}`))]}),s.jsxs("div",{className:"flex items-center justify-between",children:[V.response.usage&&s.jsxs("span",{className:"text-muted-foreground",children:["Tokens: ",V.response.usage.totalTokens||"N/A"]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[V.response.toolResults&&V.response.toolResults.length>0&&s.jsx(J,{variant:"outline",className:"text-xs bg-green-50 text-green-700",children:"Live Data"}),s.jsxs("span",{className:"text-muted-foreground",children:[V.response.processingTime,"ms"]})]})]})]}),s.jsxs("div",{className:"flex items-center justify-between mt-3",children:[s.jsx("div",{className:"flex items-center space-x-1",children:V.type==="agent"&&!V.isLoading&&s.jsxs("div",{className:"flex items-center space-x-1 bg-gray-50 rounded-full px-2 py-1 opacity-0 group-hover:opacity-100 transition-all duration-200",children:[s.jsx(G,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-gray-500 hover:text-gray-700 hover:bg-white rounded-full transition-colors",onClick:()=>navigator.clipboard.writeText(V.content),title:"Copy message",children:s.jsx(hT,{className:"h-3 w-3"})}),s.jsx("div",{className:"w-px h-3 bg-gray-300"}),s.jsx(G,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-full transition-colors",title:"Good response",children:s.jsx(wT,{className:"h-3 w-3"})}),s.jsx(G,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-full transition-colors",title:"Poor response",children:s.jsx(TT,{className:"h-3 w-3"})})]})}),s.jsx("span",{className:"text-xs text-gray-400",children:Jr(V.timestamp)})]})]})})]},V.id)),s.jsx("div",{ref:q})]}),s.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 bg-white px-4 py-4 sm:px-6",children:s.jsxs("div",{className:"w-full",children:[s.jsx("div",{className:"relative flex items-end gap-3",children:s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("textarea",{ref:B,value:f,onChange:V=>{g(V.target.value);const ie=V.target;ie.style.height="auto",ie.style.height=Math.min(ie.scrollHeight,120)+"px"},placeholder:`Message ${x.name}...`,disabled:v,onKeyDown:V=>{V.key==="Enter"&&!V.shiftKey&&(V.preventDefault(),we())},className:"w-full min-h-[44px] max-h-[120px] resize-none rounded-2xl border border-gray-300 px-4 py-3 pr-12 text-[15px] leading-relaxed focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none placeholder:text-gray-500 disabled:bg-gray-100 disabled:text-gray-500 disabled:cursor-not-allowed touch-manipulation",rows:1,"aria-label":"Type your message","aria-describedby":"input-hint","aria-expanded":!1}),s.jsx("button",{onClick:we,disabled:v||!f.trim(),className:"absolute right-3 bottom-3 h-9 w-9 rounded-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-all duration-200 shadow-md flex items-center justify-center border-none outline-none","aria-label":"Send message",title:"Send message (Enter)",children:s.jsx("div",{className:"text-white text-xl font-bold",children:""})})]})}),s.jsxs("div",{className:"flex items-center justify-between mt-3 px-1",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[s.jsx("span",{children:x.name}),s.jsx("span",{children:""}),s.jsx("span",{children:x.useCase}),C.llmConfig&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("span",{children:[C.llmConfig.provider," (",C.llmConfig.model,")"]})]}),C.archerSession&&!C.sessionExpired?s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("div",{className:"h-1.5 w-1.5 bg-green-500 rounded-full"}),s.jsx("span",{className:"text-green-600",children:"Archer Connected"})]})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("div",{className:"h-1.5 w-1.5 bg-orange-500 rounded-full"}),s.jsx("span",{className:"text-orange-600",children:"No Archer Connection"})]})]})]}),s.jsx("div",{id:"input-hint",className:"text-xs text-gray-400",children:"Press Shift+Enter for new line"})]})]})})]}),Y&&!R&&s.jsx("div",{className:"mx-4 mb-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-4 shadow-md",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center shadow-sm",children:s.jsx(ge,{className:"h-5 w-5 text-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-semibold text-blue-900",children:"Archer Authentication Required"}),s.jsx("p",{className:"text-xs text-blue-700 mt-0.5",children:"Connect to unlock enhanced GRC capabilities"})]}),s.jsx(G,{onClick:()=>H(!0),size:"sm",className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white border-0 px-5 py-2.5 text-sm font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md",children:"Connect"})]})}),s.jsx(qR,{isOpen:R,onClose:()=>H(!1),onAuthenticated:ce,tenantId:(e==null?void 0:e.id)||""})]}):s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})},Eu="https://func-grc-backend-prod.azurewebsites.net/api/v1";class JR{async request(t,n={}){const r=`${Eu}${t}`,a=await fetch(r,{headers:{"Content-Type":"application/json",...n.headers},...n});if(!a.ok)throw new Error(`API request failed: ${a.status} ${a.statusText}`);return a.json()}async getTenants(t=1,n=10,r){const a=new URLSearchParams({page:t.toString(),limit:n.toString(),...r&&{search:r}});return this.request(`/tenant-management/tenants?${a}`)}async getTenant(t){var r;const n=await this.request(`/tenant-management/tenants/${t}`);if(!n.success)throw new Error(((r=n.error)==null?void 0:r.message)||"Failed to fetch tenant");return n.data}async createTenant(t){var r;const n=await this.request("/tenant-management/tenants",{method:"POST",body:JSON.stringify(t)});if(!n.success)throw new Error(((r=n.error)==null?void 0:r.message)||"Failed to create tenant");return n.data}async updateTenant(t,n){var a;const r=await this.request(`/tenant-management/tenants/${t}`,{method:"PUT",body:JSON.stringify(n)});if(!r.success)throw new Error(((a=r.error)==null?void 0:a.message)||"Failed to update tenant");return r.data}async deleteTenant(t){var r;const n=await this.request(`/tenant-management/tenants/${t}`,{method:"DELETE"});if(!n.success)throw new Error(((r=n.error)==null?void 0:r.message)||"Failed to delete tenant")}async getTenantSAMLConfig(t){try{const n=await this.request(`/tenant-management/tenants/${t}/saml`);return n.success?n.data:null}catch{return null}}async configureTenantSAML(t,n){var a;const r=await this.request(`/tenant-management/tenants/${t}/saml`,{method:"POST",body:JSON.stringify(n)});if(!r.success)throw new Error(((a=r.error)==null?void 0:a.message)||"Failed to configure SAML");return r.data}async updateTenantSAML(t,n){var a;const r=await this.request(`/tenant-management/tenants/${t}/saml`,{method:"PUT",body:JSON.stringify(n)});if(!r.success)throw new Error(((a=r.error)==null?void 0:a.message)||"Failed to update SAML configuration");return r.data}async testSAMLConfiguration(t){var r;const n=await this.request(`/tenant-management/tenants/${t}/saml/test`,{method:"POST"});if(!n.success)throw new Error(((r=n.error)==null?void 0:r.message)||"Failed to test SAML configuration");return n.data}async getTenantGroupMappings(t){const n=await this.request(`/tenant-management/tenants/${t}/groups`);return n.success?n.data:[]}async createGroupMapping(t,n){var a;const r=await this.request(`/tenant-management/tenants/${t}/groups`,{method:"POST",body:JSON.stringify(n)});if(!r.success)throw new Error(((a=r.error)==null?void 0:a.message)||"Failed to create group mapping");return r.data}async updateGroupMapping(t,n,r){var i;const a=await this.request(`/tenant-management/tenants/${t}/groups/${n}`,{method:"PUT",body:JSON.stringify(r)});if(!a.success)throw new Error(((i=a.error)==null?void 0:i.message)||"Failed to update group mapping");return a.data}async deleteGroupMapping(t,n){var a;const r=await this.request(`/tenant-management/tenants/${t}/groups/${n}`,{method:"DELETE"});if(!r.success)throw new Error(((a=r.error)==null?void 0:a.message)||"Failed to delete group mapping")}async generateSAMLMetadata(t){const n=await fetch(`${Eu}/auth/saml/${t}/metadata`);if(!n.ok)throw new Error("Failed to generate SAML metadata");return n.text()}async testSAMLAuth(t){return(await this.request(`/auth/saml/${t}/test`)).data}getSAMLLoginUrl(t,n){const r=`${Eu}/auth/saml/${t}/login`;return n?`${r}?relayState=${encodeURIComponent(n)}`:r}}const ZR=new JR;function eP({canModify:e,isSaving:t}){const[n,r]=S.useState([]),[a,i]=S.useState(!0),[l,o]=S.useState(null),[c,u]=S.useState(null),[m,d]=S.useState(!1);S.useEffect(()=>{p()},[]);const p=async()=>{try{i(!0),o(null);const g=await ZR.getTenants();r(g.tenants)}catch(g){o(g instanceof Error?g.message:"Failed to load tenants")}finally{i(!1)}},f=g=>{switch(g){case"active":return s.jsx(J,{className:"bg-green-100 text-green-800 border-green-200",children:"Active"});case"inactive":return s.jsx(J,{variant:"secondary",children:"Inactive"});case"suspended":return s.jsx(J,{className:"bg-red-100 text-red-800 border-red-200",children:"Suspended"});default:return s.jsx(J,{variant:"outline",children:g})}};return a?s.jsx(Q,{children:s.jsx(ne,{className:"pt-6",children:s.jsx("div",{className:"flex items-center justify-center h-32",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs(Q,{children:[s.jsx(he,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ed,{className:"h-5 w-5 text-blue-600"}),s.jsx(be,{children:"Tenant Management"})]}),e&&s.jsxs("button",{onClick:()=>d(!0),className:"flex items-center space-x-2 px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",disabled:t,children:[s.jsx(pn,{className:"h-4 w-4"}),s.jsx("span",{children:"Create Tenant"})]})]})}),s.jsx(ne,{children:s.jsx("p",{className:"text-gray-600 text-sm",children:"Manage multi-tenant configurations, SAML authentication, and access controls."})})]}),l&&s.jsxs(Ie,{className:"border-red-200 bg-red-50",children:[s.jsx(ue,{className:"h-4 w-4 text-red-600"}),s.jsx("span",{className:"text-red-800",children:l})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsx(be,{className:"text-lg",children:"Current Tenants"})}),s.jsx(ne,{children:n.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ed,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 mb-2",children:"No tenants configured"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Create your first tenant to get started"})]}):s.jsx("div",{className:"space-y-4",children:n.map(g=>s.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("div",{className:"flex items-center space-x-3",children:s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:g.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:["/",g.slug]})]})}),s.jsx("div",{className:"flex items-center space-x-2",children:f(g.status)})]}),g.description&&s.jsx("p",{className:"text-sm text-gray-600 mb-3",children:g.description}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[s.jsxs("span",{children:["Contact: ",g.contact_email]}),g.domain&&s.jsxs("span",{children:["Domain: ",g.domain]}),s.jsxs("span",{children:["Created: ",new Date(g.created_at).toLocaleDateString()]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{onClick:()=>u(g),className:"flex items-center space-x-1 px-2 py-1 text-xs bg-blue-50 text-blue-700 rounded hover:bg-blue-100",children:[s.jsx(dt,{className:"h-3 w-3"}),s.jsx("span",{children:"Configure SAML"})]}),s.jsxs("button",{className:"flex items-center space-x-1 px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:[s.jsx(Hi,{className:"h-3 w-3"}),s.jsx("span",{children:"Users"})]})]})]})]},g.tenant_id))})})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsx(be,{className:"text-lg",children:"Quick Actions"})}),s.jsx(ne,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("button",{className:"flex items-center space-x-3 p-4 border rounded-lg hover:bg-gray-50 text-left",children:[s.jsx(ge,{className:"h-6 w-6 text-blue-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"SAML Testing"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Test SAML configurations"})]})]}),s.jsxs("button",{className:"flex items-center space-x-3 p-4 border rounded-lg hover:bg-gray-50 text-left",children:[s.jsx(Hi,{className:"h-6 w-6 text-green-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"User Management"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Manage tenant users"})]})]}),s.jsxs("button",{className:"flex items-center space-x-3 p-4 border rounded-lg hover:bg-gray-50 text-left",children:[s.jsx(Wh,{className:"h-6 w-6 text-purple-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"Documentation"}),s.jsx("p",{className:"text-sm text-gray-500",children:"SAML setup guides"})]})]})]})})]}),s.jsxs(Q,{children:[s.jsx(he,{children:s.jsx(be,{className:"text-lg",children:"Platform Statistics"})}),s.jsx(ne,{children:s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.length}),s.jsx("div",{className:"text-sm text-blue-700",children:"Total Tenants"})]}),s.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.filter(g=>g.status==="active").length}),s.jsx("div",{className:"text-sm text-green-700",children:"Active Tenants"})]}),s.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"0"}),s.jsx("div",{className:"text-sm text-purple-700",children:"SAML Configured"})]}),s.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:"0"}),s.jsx("div",{className:"text-sm text-orange-700",children:"Total Users"})]})]})})]})]})}function tP(){var r;const{user:e}=it(),t=((r=e==null?void 0:e.roles)==null?void 0:r.includes("PlatformOwner"))||!1,n=!1;return t?s.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-7xl",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[s.jsx(ge,{className:"h-8 w-8 text-blue-600"}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Platform Administration"})]}),s.jsx("p",{className:"text-gray-600",children:"Manage tenants, platform configuration, and system-wide settings for the GRC Analytics Platform."})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.jsx(Q,{children:s.jsx(ne,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Tenants"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"1"})]}),s.jsx(Ed,{className:"h-8 w-8 text-blue-600"})]})})}),s.jsx(Q,{children:s.jsx(ne,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Users"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"0"})]}),s.jsx(Hi,{className:"h-8 w-8 text-green-600"})]})})}),s.jsx(Q,{children:s.jsx(ne,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"SAML Configured"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"0"})]}),s.jsx(ge,{className:"h-8 w-8 text-purple-600"})]})})}),s.jsx(Q,{children:s.jsx(ne,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"System Health"}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Le,{className:"h-4 w-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Healthy"})]})]}),s.jsx(Mr,{className:"h-8 w-8 text-orange-600"})]})})})]}),s.jsx(eP,{canModify:t,isSaving:n}),s.jsxs(Q,{className:"mt-8",children:[s.jsx(he,{children:s.jsxs(be,{className:"flex items-center space-x-2",children:[s.jsx(dt,{className:"h-5 w-5"}),s.jsx("span",{children:"Platform Settings"})]})}),s.jsxs(ne,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"font-medium text-gray-900",children:"Security Settings"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded"}),s.jsx("span",{className:"text-sm",children:"Require SAML for all tenants"})]}),s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded"}),s.jsx("span",{className:"text-sm",children:"Enable platform audit logging"})]}),s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",className:"rounded"}),s.jsx("span",{className:"text-sm",children:"Force password complexity rules"})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"font-medium text-gray-900",children:"System Limits"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600",children:"Max tenants per platform"}),s.jsx("input",{type:"number",defaultValue:100,className:"w-full p-2 border border-gray-300 rounded-md text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-600",children:"Max users per tenant"}),s.jsx("input",{type:"number",defaultValue:1e3,className:"w-full p-2 border border-gray-300 rounded-md text-sm"})]})]})]})]}),s.jsx("div",{className:"mt-6 pt-6 border-t",children:s.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Save Platform Settings"})})]})]}),s.jsxs(Q,{className:"mt-8",children:[s.jsx(he,{children:s.jsx(be,{children:"System Information"})}),s.jsx(ne,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Database"}),s.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[s.jsx("p",{children:"Type: SQLite (Development)"}),s.jsxs("p",{children:["Status: ",s.jsx(J,{className:"bg-green-100 text-green-800 border-green-200",children:"Connected"})]}),s.jsx("p",{children:"Tables: 15"})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Authentication"}),s.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[s.jsx("p",{children:"SAML Providers: 0"}),s.jsx("p",{children:"Active Sessions: 0"}),s.jsx("p",{children:"Session Timeout: 8 hours"})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Platform"}),s.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[s.jsx("p",{children:"Version: 1.0.0"}),s.jsx("p",{children:"Environment: Development"}),s.jsx("p",{children:"Uptime: 2h 45m"})]})]})]})})]})]}):s.jsx("div",{className:"container mx-auto px-4 py-6 max-w-4xl",children:s.jsxs(Ie,{className:"border-red-200 bg-red-50",children:[s.jsx(ue,{className:"h-4 w-4 text-red-600"}),s.jsx("span",{className:"text-red-800",children:"Access denied. Platform administrator privileges required."})]})})}function nP(){const{initializeAuth:e}=it();return S.useEffect(()=>{localStorage.getItem("theme")==="dark"&&document.documentElement.classList.add("dark"),e()},[e]),s.jsx("div",{className:"min-h-screen bg-background text-foreground",children:s.jsxs(o2,{children:[s.jsx(yt,{path:"/login",element:s.jsx(_T,{})}),s.jsxs(yt,{path:"/",element:s.jsx(kT,{}),children:[s.jsx(yt,{index:!0,element:s.jsx(Ws,{to:"/analytics",replace:!0})}),s.jsx(yt,{path:"agents",element:s.jsx(XT,{})}),s.jsx(yt,{path:"mcp-servers",element:s.jsx(Ws,{to:"/settings?tab=mcp-servers",replace:!0})}),s.jsx(yt,{path:"audit",element:s.jsx(JT,{})}),s.jsx(yt,{path:"users",element:s.jsx(Zw,{})}),s.jsx(yt,{path:"analytics",element:s.jsx(tC,{})}),s.jsx(yt,{path:"tools",element:s.jsx(nC,{})}),s.jsx(yt,{path:"connections",element:s.jsx(aC,{})}),s.jsx(yt,{path:"chat",element:s.jsx(XR,{})}),s.jsx(yt,{path:"llm-config",element:s.jsx(Ws,{to:"/settings?tab=llm",replace:!0})}),s.jsx(yt,{path:"settings",element:s.jsx(kC,{})}),s.jsx(yt,{path:"platform-admin",element:s.jsx(tP,{})})]}),s.jsx(yt,{path:"*",element:s.jsx(Ws,{to:"/analytics",replace:!0})})]})})}Nu.createRoot(document.getElementById("root")).render(s.jsx(Wi.StrictMode,{children:s.jsx(x2,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:s.jsx(nP,{})})}));
//# sourceMappingURL=index-BrS90hKE.js.map
