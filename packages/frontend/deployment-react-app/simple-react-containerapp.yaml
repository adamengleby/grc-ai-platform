properties:
  template:
    containers:
    - image: mcr.microsoft.com/azure-functions/node:4-node20-appservice
      name: grc-frontend-simple
      env:
      - name: NODE_ENV
        value: production
      - name: PORT
        value: "8080"
      - name: VITE_API_BASE_URL
        value: "https://grc-backend-simple.calmmeadow-5080198e.australiasoutheast.azurecontainerapps.io/api/v1"
      command: ["/bin/sh"]
      args: ["-c", "echo 'Starting GRC Frontend...' && echo '{\"name\":\"grc-frontend\",\"version\":\"1.0.0\",\"dependencies\":{\"express\":\"^4.19.2\"}}' > package.json && npm install && echo 'const express=require(\"express\");const app=express();app.use(express.static(\".\"));app.get(\"/health\",(req,res)=>res.json({status:\"healthy\",service:\"GRC React Frontend\",timestamp:new Date().toISOString()}));app.get(\"*\",(req,res)=>res.sendFile(require(\"path\").join(__dirname,\"index.html\")));app.listen(process.env.PORT||8080,()=>console.log(\"Frontend ready\"));' > server.js && curl -s -o index.html 'https://raw.githubusercontent.com/adamengleby/grc-ai-platform/main/packages/frontend/dist/index.html' && mkdir -p assets && curl -s -o assets/index-BrS90hKE.js 'https://raw.githubusercontent.com/adamengleby/grc-ai-platform/main/packages/frontend/dist/assets/index-BrS90hKE.js' && curl -s -o assets/index-SeoJpoEb.css 'https://raw.githubusercontent.com/adamengleby/grc-ai-platform/main/packages/frontend/dist/assets/index-SeoJpoEb.css' && node server.js"]
      resources:
        cpu: 0.5
        memory: 1Gi
    scale:
      minReplicas: 1
      maxReplicas: 3
  configuration:
    ingress:
      external: true
      targetPort: 8080
